	section	.text,"ax",@progbits
	assume	adl = 1
	section	.text,"ax",@progbits
	public	_ui_to_engine_piece
_ui_to_engine_piece:
	call	__frameset0
	ld	l, (ix + 6)
	ld	e, 0
	ld	a, l
	or	a, a
	jr	z, BB0_4
	ld	a, l
	cp	a, 1
	call	pe, __setflag
	jp	m, BB0_3
	ld	e, l
	jr	BB0_4
BB0_3:
	ld	a, l
	neg
	or	a, -128
	ld	e, a
BB0_4:
	ld	a, e
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_to_ui_piece
_engine_to_ui_piece:
	call	__frameset0
	ld	e, (ix + 6)
	ld	l, 0
	ld	a, e
	and	a, 7
	ld	h, a
	neg
	ld	c, a
	ld	a, e
	cp	a, l
	call	pe, __setflag
	jp	m, BB1_2
	ld	c, h
BB1_2:
	ld	a, e
	or	a, a
	jr	z, BB1_4
	ld	l, c
BB1_4:
	ld	a, l
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_board_init
_board_init:
	call	__frameset0
	or	a, a
	sbc	hl, hl
	ld	a, (_zobrist_initialized)
	bit	0, a
	push	hl
	push	hl
	call	z, _zobrist_init
	pop	hl
	pop	hl
	ld	iy, (ix + 6)
	ld	(iy), 0
	lea	hl, iy
	inc	hl
	ld	bc, 444
	ex	de, hl
	lea	hl, iy
	ldir
	ld	de, 128
	ld	bc, 0
BB2_1:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jr	z, BB2_5
	ld	a, c
	and	a, -120
	or	a, a
	jr	z, BB2_4
	lea	hl, iy
	add	hl, bc
	ld	(hl), -1
BB2_4:
	inc	bc
	jr	BB2_1
BB2_5:
	ld	de, 128
	lea	hl, iy
	add	hl, de
	ld	(hl), -1
	push	hl
	pop	iy
	inc	iy
	lea	de, iy
	ld	bc, 127
	ldir
	ld	de, 288
	ld	hl, (ix + 6)
	add	hl, de
	ld	(hl), -1
	push	hl
	pop	iy
	inc	iy
	lea	de, iy
	ld	bc, 127
	ldir
	ld	de, 424
	ld	iy, (ix + 6)
	lea	hl, iy
	add	hl, de
	ld	(hl), -1
	ld	de, 420
	lea	hl, iy
	add	hl, de
	ld	(hl), -1
	inc	de
	add	iy, de
	ld	(iy), -1
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_board_set_from_ui
_board_set_from_ui:
	ld	hl, -37
	call	__frameset
	ld	de, (ix + 6)
	ld	hl, (ix + 9)
	ld	(ix - 6), hl
	ld.sis	hl, 0
	ld	(ix - 12), hl
	push	de
	call	_board_init
	ld	iy, (ix + 6)
	pop	hl
	ld	de, 8
	xor	a, a
	ld	(ix - 9), iy
	ld	bc, 0
BB3_1:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jp	z, BB3_16
	ld	(ix - 15), bc
	ld	(ix - 3), a
	ld	de, 0
BB3_3:
	push	de
	pop	hl
	ld	bc, 8
	or	a, a
	sbc	hl, bc
	jp	z, BB3_15
	ld	iy, (ix - 6)
	add	iy, de
	ld	h, (iy)
	ld	c, a
	ld	a, h
	or	a, a
	ld	a, c
	ld	c, (ix - 3)
	jp	z, BB3_14
	ld	(ix - 18), de
	ld	(ix - 22), a
	ld	a, h
	neg
	or	a, -128
	ld	c, a
	ld	a, h
	cp	a, 1
	call	pe, __setflag
	ld	(ix - 21), h
	ld	iy, (ix + 6)
	jp	p, BB3_7
	ld	h, c
BB3_7:
	ld	a, h
	ld	b, 7
	call	__bshru
	ld	c, a
	ld	a, h
	and	a, b
	ld	de, 0
	ld	e, c
	add	iy, de
	ld	(ix - 37), iy
	ld	de, 416
	add	iy, de
	ld	(ix - 31), iy
	ld	b, (iy)
	ld	iy, (ix - 9)
	ld	de, (ix - 18)
	add	iy, de
	ld	(iy), h
	ld	(ix - 28), a
	cp	a, 6
	jr	nz, BB3_9
	ld	hl, (ix - 37)
	ld	de, 420
	add	hl, de
	ld	a, (ix - 3)
	ld	(hl), a
BB3_9:
	or	a, a
	sbc	hl, hl
	push	hl
	pop	de
	ld	e, b
	ld	(ix - 25), c
	ld	a, c
	ld	(ix - 34), b
	ld	b, 4
	call	__bshl
	push	hl
	pop	bc
	ld	c, a
	ld	hl, (ix + 6)
	add	hl, bc
	add	hl, de
	ld	de, 256
	add	hl, de
	ld	c, (ix - 3)
	ld	(hl), c
	ld	de, 288
	add	iy, de
	ld	a, (ix - 34)
	ld	(iy), a
	inc	a
	ld	hl, (ix - 31)
	ld	(hl), a
	ld	a, (ix - 28)
	cp	a, 3
	ld	iyl, a
	jr	nz, BB3_11
	ld	de, 418
	ld	hl, (ix - 37)
	add	hl, de
	inc	(hl)
BB3_11:
	ld	a, c
	srl	a
	and	a, 56
	ld	h, a
	ld	a, c
	and	a, 7
	ld	b, a
	ld	a, h
	add	a, b
	ld	l, a
	xor	a, 56
	ld	h, a
	ld	a, (ix - 21)
	cp	a, 1
	ld	a, l
	call	pe, __setflag
	jp	p, BB3_13
	ld	a, h
BB3_13:
	dec	iyl
	ld	de, 0
	push	de
	pop	hl
	ex	de, hl
	ld	e, iyl
	ex	de, hl
	ld	(ix - 28), hl
	ld	c, 7
	call	__ishl
	ld	(ix - 21), hl
	ld	hl, _mg_table
	ld	bc, (ix - 21)
	add	hl, bc
	add	a, a
	push	de
	pop	bc
	ld	c, a
	ld	(ix - 31), bc
	add	hl, bc
	ld	hl, (hl)
	ld	(ix - 34), hl
	ld	a, (ix - 25)
	add	a, a
	ld	e, a
	ld	hl, (ix + 6)
	add	hl, de
	ld	(ix - 25), hl
	ld	bc, 436
	add	hl, bc
	ld	iy, (hl)
	ld	de, (ix - 34)
	add.sis	iy, de
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	hl, _eg_table
	ld	de, (ix - 21)
	add	hl, de
	ld	de, (ix - 31)
	add	hl, de
	ld	de, (hl)
	ld	hl, 440
	push	hl
	pop	bc
	ld	iy, (ix - 25)
	add	iy, bc
	ld	hl, (iy)
	add.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	iy, _phase_weight
	ld	de, (ix - 28)
	add	iy, de
	ld	hl, (ix + 6)
	ld	de, 444
	add	hl, de
	ld	a, (hl)
	add	a, (iy)
	ld	(hl), a
	ld	a, (ix - 22)
	ld	c, (ix - 3)
	ld	de, (ix - 18)
BB3_14:
	inc	de
	inc	c
	ld	(ix - 3), c
	ld	iy, (ix + 6)
	jp	BB3_3
BB3_15:
	ld	bc, (ix - 15)
	inc	bc
	lea	hl, iy
	ld	iy, (ix - 6)
	lea	iy, iy + 8
	ld	(ix - 6), iy
	ld	iy, (ix - 9)
	lea	iy, iy + 16
	ld	(ix - 9), iy
	push	hl
	pop	iy
	add	a, 16
	ld	de, 8
	jp	BB3_1
BB3_16:
	ld	a, (ix + 12)
	cp	a, 1
	jr	nz, BB3_18
	ld	a, 0
	jr	BB3_19
BB3_18:
	ld	a, 1
BB3_19:
	ld	c, (ix + 15)
	ld	b, (ix + 18)
	ld	de, 422
	lea	hl, iy
	add	hl, de
	ld	(hl), a
	inc	de
	lea	hl, iy
	add	hl, de
	ld	(hl), c
	ld	de, 425
	lea	hl, iy
	add	hl, de
	ld	a, (ix + 24)
	ld	(hl), a
	inc	de
	lea	hl, iy
	add	hl, de
	ld	de, (ix + 27)
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	a, b
	cp	a, -1
	ld	de, 424
	jr	z, BB3_22
	ld	a, (ix + 21)
	cp	a, -1
	jr	z, BB3_22
	ld	a, b
	ld	b, 4
	call	__bshl
	add	a, (ix + 21)
	lea	hl, iy
	add	hl, de
	ld	(hl), a
BB3_22:
	ld	bc, 128
	or	a, a
	sbc	hl, hl
	push	hl
	pop	de
	ld	(ix - 9), hl
	ld	(ix - 3), hl
BB3_23:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jp	z, BB3_32
	ld	a, e
	and	a, -120
	or	a, a
	jp	nz, BB3_31
	lea	hl, iy
	add	hl, de
	ld	l, (hl)
	ld	a, l
	or	a, a
	jp	z, BB3_31
	ld	a, l
	and	a, 7
	ld	c, a
	ld	a, l
	cp	a, 0
	call	pe, __setflag
	ld	l, 6
	jp	m, BB3_28
	ld	l, 0
BB3_28:
	ld	a, c
	dec	a
	add	a, l
	push	de
	pop	hl
	ld	(ix - 15), c
	ld	c, 1
	call	__ishru
	ld	bc, 56
	call	__iand
	push	hl
	pop	iy
	push	de
	pop	hl
	ld	bc, 7
	call	__iand
	push	hl
	pop	bc
	add	iy, bc
	ld	(ix - 6), iy
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	(ix - 18), hl
	ld	c, 8
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _zobrist_piece
	add	iy, bc
	ld	hl, (ix - 6)
	ld	c, 2
	call	__ishl
	push	hl
	pop	bc
	add	iy, bc
	ld	bc, (iy)
	ld	hl, (ix - 3)
	call	__ixor
	ld	(ix - 3), hl
	ld	a, (ix - 15)
	cp	a, 1
	jr	z, BB3_30
	ld	bc, 0
BB3_30:
	push	bc
	pop	hl
	ld	bc, (ix - 9)
	call	__ixor
	ld	(ix - 9), hl
	ld	hl, (ix - 18)
	ld	c, 7
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _lock_piece
	add	iy, bc
	ld	hl, (ix - 6)
	ld	c, 1
	call	__ishl
	push	hl
	pop	bc
	add	iy, bc
	ld	hl, (iy)
	ld	bc, (ix - 12)
	call	__sxor
	ld	(ix - 12), hl
	ld	iy, (ix + 6)
BB3_31:
	inc	de
	ld	bc, 128
	jp	BB3_23
BB3_32:
	ld	de, 0
	ld	e, (ix + 15)
	ld	c, 2
	push	de
	pop	hl
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _zobrist_castle
	add	hl, bc
	ld	bc, (hl)
	ld	hl, (ix - 3)
	call	__ixor
	ld	(ix - 3), hl
	ld	c, 1
	ex	de, hl
	call	__ishl
	push	hl
	pop	de
	ld	hl, _lock_castle
	add	hl, de
	ld	hl, (hl)
	ld	bc, (ix - 12)
	call	__sxor
	lea	de, iy
	ld	de, 424
	add	iy, de
	ld	a, (iy)
	cp	a, -1
	jr	nz, BB3_34
	ld	iy, (ix - 3)
	jp	BB3_35
BB3_34:
	and	a, 7
	ld	(ix - 12), a
	ld	(ix - 6), hl
	ld	b, 2
	call	__bshl
	ld	de, 0
	ld	e, a
	ld	hl, _zobrist_ep_file
	add	hl, de
	ld	bc, (hl)
	ld	hl, (ix - 3)
	call	__ixor
	push	hl
	pop	iy
	ld	a, (ix - 12)
	add	a, a
	ld	e, a
	ld	hl, _lock_ep_file
	add	hl, de
	ld	hl, (hl)
	ld	bc, (ix - 6)
	call	__sxor
BB3_35:
	ld	a, (ix + 12)
	cp	a, 1
	ld	(ix - 6), hl
	jp	z, BB3_37
	ld	bc, (_zobrist_side)
	lea	hl, iy
	call	__ixor
	ld	(ix - 3), hl
	ld	hl, _lock_side
	ld	hl, (hl)
	ld	bc, (ix - 6)
	call	__sxor
	ld	(ix - 6), hl
	ld	bc, (ix - 9)
	jr	BB3_38
BB3_37:
	ld	bc, (ix - 9)
	ld	(ix - 3), iy
BB3_38:
	ld	iy, (ix + 6)
	lea	hl, iy
	ld	de, 428
	add	hl, de
	ld	(hl), bc
	ld	bc, 431
	lea	hl, iy
	add	hl, bc
	ld	de, (ix - 3)
	ld	(hl), de
	ld	de, 434
	add	iy, de
	ld	hl, (ix - 6)
	ld	(iy), l
	ld	(iy + 1), h
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_board_startpos
_board_startpos:
	call	__frameset0
	ld	iy, (ix + 6)
	ld	de, _board_startpos.start
	ld	bc, 1
	push	bc
	or	a, a
	sbc	hl, hl
	push	hl
	dec	hl
	push	hl
	push	hl
	ld	hl, 15
	push	hl
	push	bc
	push	de
	push	iy
	call	_board_set_from_ui
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_board_make
_board_make:
	ld	hl, -92
	call	__frameset
	xor	a, a
	ld	(ix - 79), a
	ld	c, (ix + 9)
	ld	b, (ix + 10)
	ld	a, (ix + 11)
	ld	(ix - 5), a
	sbc	hl, hl
	push	hl
	pop	de
	ld	e, c
	ld	iy, (ix + 6)
	ld	(ix - 57), de
	add	iy, de
	ld	(ix - 66), iy
	ld	c, (iy)
	ld	iy, (ix + 6)
	ld	(ix - 17), hl
	ex	de, hl
	ld	e, b
	lea	hl, iy
	ld	(ix - 21), de
	add	hl, de
	ld	a, (hl)
	ld	(ix - 42), a
	ld	de, 422
	lea	hl, iy
	add	hl, de
	ld	(ix - 51), hl
	ld	a, (hl)
	ld	(ix - 1), a
	xor	a, d
	ld	l, a
	ld	(ix - 36), hl
	ld	d, c
	ld	a, d
	and	a, 7
	ld	(ix - 4), a
	ld	e, (ix + 9)
	ld	a, e
	srl	a
	and	a, 56
	ld	l, a
	ld	a, e
	and	a, 7
	ld	e, a
	ld	a, l
	add	a, e
	ld	h, a
	ld	a, b
	srl	a
	and	a, 56
	ld	l, a
	ld	(ix - 18), b
	ld	a, b
	and	a, 7
	ld	c, a
	ld	a, l
	add	a, c
	ld	(ix - 11), a
	ld	(ix - 30), d
	ld	a, d
	cp	a, 0
	call	pe, __setflag
	ld	a, 6
	ld	(ix - 78), a
	ld	l, a
	jp	m, BB5_2
	ld	l, 0
BB5_2:
	ld	a, (ix - 4)
	dec	a
	ld	(ix - 27), a
	add	a, l
	ld	(ix - 8), a
	ld	a, (ix - 1)
	or	a, a
	jr	z, BB5_4
	ld	e, 0
	jr	BB5_5
BB5_4:
	ld	e, -1
BB5_5:
	ld	a, h
	xor	a, 56
	bit	0, e
	ld	l, h
	jr	nz, BB5_7
	ld	l, a
BB5_7:
	ld	(ix - 14), h
	ld	(ix - 72), l
	ld	iy, (ix + 12)
	ld	l, (ix - 11)
	ld	a, l
	xor	a, 56
	bit	0, e
	jr	nz, BB5_9
	ld	l, a
BB5_9:
	ld	(ix - 85), a
	ld	(ix - 63), l
	ld	a, (ix - 42)
	ld	(iy), a
	ld	de, 423
	ld	bc, (ix + 6)
	push	bc
	pop	hl
	add	hl, de
	ld	(ix - 24), hl
	ld	a, (hl)
	ld	(iy + 1), a
	inc	de
	push	bc
	pop	hl
	add	hl, de
	ld	(ix - 54), hl
	ld	a, (hl)
	ld	(iy + 2), a
	inc	de
	push	bc
	pop	hl
	add	hl, de
	ld	a, (hl)
	ld	(ix - 45), a
	ld	(iy + 3), a
	inc	de
	push	bc
	pop	hl
	add	hl, de
	ld	hl, (hl)
	ld	(iy + 4), l
	ld	(iy + 5), h
	ld	de, 428
	push	bc
	pop	hl
	add	hl, de
	ld	(ix - 60), hl
	ld	hl, (hl)
	ld	(ix - 48), hl
	ld	(iy + 6), hl
	ld	de, 431
	push	bc
	pop	hl
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 33), hl
	ld	(iy + 9), hl
	ld	de, 434
	push	bc
	pop	hl
	add	hl, de
	ld	(ix - 39), hl
	ld	hl, (hl)
	ld	(ix - 69), hl
	ld	(iy + 12), l
	ld	(iy + 13), h
	ld	a, (ix - 30)
	ld	(iy + 14), a
	ld	a, (ix - 5)
	ld	(iy + 15), a
	and	a, d
	ld	h, a
	ld	a, (ix - 4)
	cp	a, d
	ld	a, 0
	jr	z, BB5_13
	bit	0, h
	ld	a, 0
	jr	nz, BB5_13
	ld	a, (ix - 45)
	cp	a, -1
	jr	z, BB5_14
	inc	a
BB5_13:
	ld	hl, (ix + 6)
	ld	de, 425
	add	hl, de
	ld	(hl), a
BB5_14:
	ld	hl, (ix - 17)
	ld	l, (ix - 1)
	ld	(ix - 17), hl
	ld	de, 0
	push	de
	pop	iy
	push	af
	ld	a, (ix - 8)
	ld	iyl, a
	pop	af
	ld	c, 8
	lea	hl, iy
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _zobrist_piece
	add	hl, bc
	ld	b, 2
	ld	a, (ix - 14)
	call	__bshl
	ld	e, a
	add	hl, de
	ld	bc, (hl)
	ld	hl, (ix - 33)
	ld	(ix - 75), bc
	call	__ixor
	ld	(ix - 45), hl
	ld	hl, (ix + 6)
	ld	bc, 431
	add	hl, bc
	ld	(ix - 8), hl
	ld	bc, (ix - 45)
	ld	(hl), bc
	ld	c, 7
	ld	(ix - 33), iy
	lea	hl, iy
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _lock_piece
	add	hl, bc
	ld	a, (ix - 14)
	add	a, a
	ld	e, a
	add	hl, de
	ld	hl, (hl)
	ld	bc, (ix - 69)
	call	__sxor
	ld	e, l
	ld	d, h
	ld	hl, (ix - 39)
	ld	(ix - 82), de
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	a, (ix - 4)
	cp	a, 1
	jr	nz, BB5_16
	ld	hl, (ix - 48)
	ld	bc, (ix - 75)
	call	__ixor
	ld	bc, (ix + 6)
	push	bc
	pop	iy
	ld	de, 428
	add	iy, de
	ld	(ix - 48), hl
	ld	(iy), hl
	push	bc
	pop	iy
	jr	BB5_17
BB5_16:
	ld	iy, (ix + 6)
BB5_17:
	ld	a, (ix - 5)
	ld	de, 0
	push	de
	pop	hl
	ld	l, (ix - 27)
	ld	c, 7
	ld	(ix - 69), hl
	call	__ishl
	push	hl
	pop	bc
	ld	(ix - 75), bc
	ld	hl, _mg_table
	add	hl, bc
	ld	c, 1
	ld	b, (ix - 72)
	sla	b
	ld	e, b
	ld	(ix - 72), de
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 27), hl
	ld	hl, (ix - 17)
	call	__ishl
	push	hl
	pop	bc
	add	iy, bc
	ld	(ix - 14), iy
	ld	bc, 436
	add	iy, bc
	lea	hl, iy
	ld	hl, (hl)
	ld	bc, (ix - 27)
	or	a, a
	sbc.sis	hl, bc
	ld	(ix - 27), iy
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, _eg_table
	ld	bc, (ix - 75)
	add	hl, bc
	ld	de, (ix - 72)
	add	hl, de
	ld	de, (hl)
	ld	bc, 440
	ld	iy, (ix - 14)
	add	iy, bc
	ld	hl, (iy)
	or	a, a
	sbc.sis	hl, de
	ld	(ix - 14), iy
	ld	(iy), l
	ld	(iy + 1), h
	bit	2, a
	jp	nz, BB5_27
	ld	l, (ix - 42)
	ld	a, l
	or	a, a
	ld	iy, (ix + 6)
	jp	z, BB5_39
	ld	a, l
	and	a, 7
	ld	(ix - 72), a
	ld	a, l
	cp	a, 0
	call	pe, __setflag
	ld	l, 6
	jp	m, BB5_21
	ld	l, 0
BB5_21:
	ld	a, (ix - 72)
	dec	a
	ld	(ix - 86), a
	add	a, l
	ld	l, a
	ld	de, (ix - 36)
	ld	a, e
	or	a, a
	ld	a, (ix - 11)
	jr	z, BB5_23
	ld	a, (ix - 85)
BB5_23:
	ld	(ix - 75), a
	ld	de, 0
	push	de
	pop	bc
	ld	de, (ix - 36)
	ld	c, e
	ld	(ix - 42), bc
	ld	de, 0
	push	de
	pop	bc
	ld	c, l
	push	bc
	pop	hl
	ld	(ix - 85), hl
	ld	c, 8
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _zobrist_piece
	add	hl, bc
	ld	b, 2
	ld	a, (ix - 11)
	call	__bshl
	ld	e, a
	add	hl, de
	ld	bc, (hl)
	ld	hl, (ix - 45)
	ld	(ix - 45), bc
	call	__ixor
	ld	bc, 431
	add	iy, bc
	ld	(iy), hl
	ld	c, 7
	ld	hl, (ix - 85)
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _lock_piece
	add	hl, bc
	ld	e, (ix - 11)
	sla	e
	add	hl, de
	ld	hl, (hl)
	ld	bc, (ix - 82)
	call	__sxor
	ld	iy, (ix - 39)
	ld	(iy), l
	ld	(iy + 1), h
	ld	a, (ix - 72)
	cp	a, 1
	jr	nz, BB5_25
	ld	hl, (ix - 48)
	ld	bc, (ix - 45)
	call	__ixor
	ld	iy, (ix + 6)
	ld	de, 428
	add	iy, de
	ld	(iy), hl
BB5_25:
	ld	de, 0
	push	de
	pop	hl
	ld	l, (ix - 86)
	ld	(ix - 39), hl
	ld	c, 7
	call	__ishl
	push	hl
	pop	bc
	ld	(ix - 45), bc
	ld	hl, _mg_table
	add	hl, bc
	ld	c, 1
	ld	a, (ix - 75)
	add	a, a
	ld	e, a
	ld	(ix - 75), de
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 48), hl
	ld	hl, (ix - 42)
	call	__ishl
	push	hl
	pop	bc
	ld	iy, (ix + 6)
	add	iy, bc
	ld	(ix - 82), iy
	ld	bc, 436
	add	iy, bc
	lea	hl, iy
	ld	hl, (hl)
	ld	bc, (ix - 48)
	or	a, a
	sbc.sis	hl, bc
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, _eg_table
	ld	bc, (ix - 45)
	add	hl, bc
	ld	de, (ix - 75)
	add	hl, de
	ld	de, (hl)
	ld	bc, 440
	ld	iy, (ix - 82)
	add	iy, bc
	ld	hl, (iy)
	or	a, a
	sbc.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	iy, _phase_weight
	ld	de, (ix - 39)
	add	iy, de
	ld	bc, (ix + 6)
	push	bc
	pop	hl
	ld	de, 444
	add	hl, de
	ld	a, (hl)
	sub	a, (iy)
	ld	(hl), a
	ld	l, (ix - 18)
	push	hl
	ld	hl, (ix - 36)
	push	hl
	push	bc
	call	_plist_remove
	pop	hl
	pop	hl
	pop	hl
	ld	a, (ix - 72)
	cp	a, 3
	ld	iy, (ix + 6)
	jp	nz, BB5_39
	lea	hl, iy
	ld	de, (ix - 42)
	add	hl, de
	ld	de, 418
	add	hl, de
	dec	(hl)
	jp	BB5_39
BB5_27:
	ld	a, (ix - 1)
	or	a, a
	ld	a, 16
	jr	z, BB5_29
	ld	a, -16
BB5_29:
	add	a, (ix - 18)
	ld	e, a
	or	a, a
	sbc	hl, hl
	push	hl
	pop	bc
	ld	c, e
	ld	hl, (ix + 6)
	ld	(ix - 72), bc
	add	hl, bc
	ld	c, (hl)
	ld	a, c
	or	a, a
	ld	iy, (ix + 12)
	jp	z, BB5_38
	ld	a, e
	srl	a
	and	a, 56
	ld	l, a
	ld	(ix - 87), e
	ld	a, e
	and	a, 7
	ld	e, a
	ld	a, l
	add	a, e
	ld	h, a
	ld	a, c
	and	a, 7
	ld	(ix - 42), a
	ld	(ix - 86), c
	ld	a, c
	cp	a, 0
	call	pe, __setflag
	ld	l, 6
	jp	m, BB5_32
	ld	l, 0
BB5_32:
	ld	a, (ix - 42)
	dec	a
	ld	(ix - 89), a
	add	a, l
	ld	l, a
	ld	a, h
	xor	a, 56
	ld	c, a
	ld	de, (ix - 36)
	ld	a, e
	or	a, a
	ld	(ix - 75), h
	ld	iy, (ix + 6)
	jr	z, BB5_34
	ld	h, c
BB5_34:
	ld	(ix - 88), h
	ld	de, 0
	push	de
	pop	bc
	ld	de, (ix - 36)
	ld	c, e
	ld	(ix - 85), bc
	ld	de, 0
	push	de
	pop	bc
	ld	c, l
	push	bc
	pop	hl
	ld	(ix - 92), hl
	ld	c, 8
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _zobrist_piece
	add	hl, bc
	ld	b, 2
	ld	a, (ix - 75)
	call	__bshl
	ld	e, a
	add	hl, de
	ld	bc, (hl)
	ld	hl, (ix - 45)
	ld	(ix - 45), bc
	call	__ixor
	ld	bc, 431
	add	iy, bc
	ld	(iy), hl
	ld	c, 7
	ld	hl, (ix - 92)
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _lock_piece
	add	hl, bc
	ld	a, (ix - 75)
	add	a, a
	ld	e, a
	add	hl, de
	ld	hl, (hl)
	ld	bc, (ix - 82)
	call	__sxor
	ld	iy, (ix - 39)
	ld	(iy), l
	ld	(iy + 1), h
	ld	a, (ix - 42)
	cp	a, 1
	jr	nz, BB5_36
	ld	hl, (ix - 48)
	ld	bc, (ix - 45)
	call	__ixor
	ld	iy, (ix + 6)
	ld	de, 428
	add	iy, de
	ld	(iy), hl
BB5_36:
	ld	de, 0
	push	de
	pop	hl
	ld	l, (ix - 89)
	ld	(ix - 39), hl
	ld	c, 7
	call	__ishl
	push	hl
	pop	bc
	ld	(ix - 45), bc
	ld	hl, _mg_table
	add	hl, bc
	ld	c, 1
	ld	a, (ix - 88)
	add	a, a
	ld	e, a
	ld	(ix - 75), de
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 48), hl
	ld	hl, (ix - 85)
	call	__ishl
	push	hl
	pop	bc
	ld	iy, (ix + 6)
	add	iy, bc
	ld	(ix - 82), iy
	ld	bc, 436
	add	iy, bc
	lea	hl, iy
	ld	hl, (hl)
	ld	bc, (ix - 48)
	or	a, a
	sbc.sis	hl, bc
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, _eg_table
	ld	bc, (ix - 45)
	add	hl, bc
	ld	de, (ix - 75)
	add	hl, de
	ld	de, (hl)
	ld	bc, 440
	ld	iy, (ix - 82)
	add	iy, bc
	ld	hl, (iy)
	or	a, a
	sbc.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	iy, _phase_weight
	ld	de, (ix - 39)
	add	iy, de
	ld	bc, (ix + 6)
	push	bc
	pop	hl
	ld	de, 444
	add	hl, de
	ld	a, (hl)
	sub	a, (iy)
	ld	(hl), a
	push	bc
	pop	hl
	ld	de, (ix - 72)
	add	hl, de
	ld	(hl), 0
	ld	l, (ix - 87)
	push	hl
	ld	hl, (ix - 36)
	push	hl
	push	bc
	call	_plist_remove
	pop	hl
	pop	hl
	pop	hl
	ld	a, (ix - 42)
	cp	a, 3
	ld	iy, (ix + 12)
	ld	c, (ix - 86)
	jr	nz, BB5_38
	ld	hl, (ix + 6)
	ld	de, (ix - 85)
	add	hl, de
	ld	de, 418
	add	hl, de
	dec	(hl)
BB5_38:
	ld	(iy), c
	ld	iy, (ix + 6)
BB5_39:
	ld	hl, (ix - 66)
	ld	(hl), 0
	lea	hl, iy
	ld	de, (ix - 21)
	add	hl, de
	ld	a, (ix - 30)
	ld	(hl), a
	ld	l, (ix - 18)
	push	hl
	ld	a, (ix + 9)
	ld	l, a
	push	hl
	ld	l, (ix - 1)
	push	hl
	push	iy
	call	_plist_move
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	c, 8
	ld	hl, (ix - 33)
	call	__ishl
	push	hl
	pop	de
	ld	hl, _zobrist_piece
	add	hl, de
	ld	b, 2
	ld	a, (ix - 11)
	call	__bshl
	ld	de, 0
	ld	e, a
	add	hl, de
	ld	bc, (hl)
	ld	iy, (ix - 8)
	ld	hl, (iy)
	ld	(ix - 42), hl
	ld	(ix - 39), bc
	call	__ixor
	ld	(iy), hl
	ld	c, 7
	ld	hl, (ix - 33)
	call	__ishl
	push	hl
	pop	de
	ld	iy, _lock_piece
	add	iy, de
	ld	a, (ix - 11)
	add	a, a
	ld	de, 0
	ld	e, a
	ld	(ix - 45), de
	add	iy, de
	ld	(ix - 66), iy
	ld	bc, (iy)
	ld	iy, (ix + 6)
	ld	de, 434
	add	iy, de
	ld	hl, (iy)
	call	__sxor
	ld	(ix - 30), iy
	ld	(ix - 72), hl
	ld	(iy), l
	ld	(iy + 1), h
	ld	a, (ix - 4)
	cp	a, d
	jr	nz, BB5_41
	ld	iy, (ix - 60)
	ld	hl, (iy)
	ld	bc, (ix - 39)
	call	__ixor
	ld	(iy), hl
BB5_41:
	ld	c, 7
	ld	hl, (ix - 69)
	call	__ishl
	push	hl
	pop	de
	ld	(ix - 36), de
	ld	hl, _mg_table
	add	hl, de
	ld	a, (ix - 63)
	add	a, a
	ld	bc, 0
	ld	c, a
	add	hl, bc
	ld	hl, (hl)
	ld	(ix - 33), hl
	ld	iy, (ix - 27)
	ld	hl, (iy)
	ld	(ix - 63), hl
	ld	de, (ix - 33)
	add.sis	hl, de
	ld	(ix - 33), hl
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, _eg_table
	ld	de, (ix - 36)
	add	hl, de
	ld	(ix - 48), bc
	add	hl, bc
	ld	de, (hl)
	ld	iy, (ix - 14)
	ld	bc, (iy)
	ld	l, c
	ld	h, b
	add.sis	hl, de
	ld	(ix - 36), hl
	ld	(iy), l
	ld	(iy + 1), h
	ld	a, (ix - 5)
	bit	3, a
	jp	z, BB5_57
	and	a, 48
	cp	a, 16
	jr	nz, BB5_44
	ld	hl, 4
	jr	BB5_49
BB5_44:
	cp	a, 32
	jr	nz, BB5_46
	ld	a, 1
	ld	(ix - 79), a
	ld	hl, 3
	jr	BB5_49
BB5_46:
	cp	a, 48
	jr	nz, BB5_48
	ld	hl, 2
	jr	BB5_49
BB5_48:
	ld	hl, 5
BB5_49:
	ld	a, (ix - 1)
	or	a, a
	ld	de, 0
	jr	z, BB5_51
	ld	de, 128
BB5_51:
	ld	a, l
	add	a, e
	ld	(ix - 75), a
	cp	a, 0
	call	pe, __setflag
	ld	(ix - 69), bc
	jp	m, BB5_53
	ld	iy, 0
	jr	BB5_54
BB5_53:
	ld	iy, 6
BB5_54:
	ld	de, 255
	add	hl, de
	push	hl
	pop	bc
	ld	(ix - 33), bc
	add	iy, bc
	ld	(ix - 82), iy
	ld	hl, (ix - 66)
	ld	hl, (hl)
	ld	bc, (ix - 72)
	call	__sxor
	ld	c, l
	ld	b, h
	ld	(ix - 36), bc
	ld	hl, (ix - 30)
	ld	(hl), c
	inc	hl
	ld	(hl), b
	ld	iy, (ix - 60)
	ld	bc, (iy)
	push	bc
	pop	hl
	ld	bc, (ix - 39)
	call	__ixor
	ld	(iy), hl
	ld	hl, (ix - 82)
	ld	bc, 255
	call	__iand
	ld	(ix - 39), hl
	ld	c, 8
	call	__ishl
	push	hl
	pop	de
	ld	hl, _zobrist_piece
	add	hl, de
	ld	b, 2
	ld	a, (ix - 11)
	call	__bshl
	ld	de, 0
	ld	e, a
	add	hl, de
	ld	bc, (hl)
	ld	hl, (ix - 42)
	call	__ixor
	ld	iy, (ix + 6)
	ld	bc, 431
	add	iy, bc
	ld	(iy), hl
	ld	a, 7
	ld	hl, (ix - 39)
	ld	c, a
	call	__ishl
	push	hl
	pop	de
	ld	hl, _lock_piece
	add	hl, de
	ld	de, (ix - 45)
	add	hl, de
	ld	hl, (hl)
	ld	bc, (ix - 36)
	call	__sxor
	ld	iy, (ix - 30)
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, (ix - 33)
	ld	bc, 255
	call	__iand
	ld	(ix - 11), hl
	ld	c, a
	call	__ishl
	push	hl
	pop	de
	ld	(ix - 36), de
	ld	hl, _mg_table
	add	hl, de
	ld	de, (ix - 48)
	add	hl, de
	ld	iy, (hl)
	ld	bc, (ix - 63)
	add.sis	iy, bc
	ld	hl, (ix - 27)
	ld	(ix - 33), iy
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	hl, _eg_table
	ld	bc, (ix - 36)
	add	hl, bc
	add	hl, de
	ld	iy, (hl)
	ld	de, (ix - 69)
	add.sis	iy, de
	ld	hl, (ix - 14)
	ld	(ix - 36), iy
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	iy, _phase_weight
	ld	de, (ix - 11)
	add	iy, de
	ld	hl, (ix + 6)
	push	hl
	pop	bc
	ld	de, 444
	add	hl, de
	ld	a, (hl)
	add	a, (iy)
	ld	(hl), a
	bit	0, (ix - 79)
	jr	z, BB5_56
	push	bc
	pop	hl
	ld	de, (ix - 17)
	add	hl, de
	ld	de, 418
	add	hl, de
	inc	(hl)
BB5_56:
	push	bc
	pop	hl
	ld	de, (ix - 21)
	add	hl, de
	ld	a, (ix - 75)
	ld	(hl), a
	ld	a, (ix - 5)
BB5_57:
	ld	l, -1
	ld	(ix - 11), l
	bit	1, a
	jp	z, BB5_74
	ld	a, (ix - 1)
	or	a, a
	jr	z, BB5_60
	ld	iyl, 0
	jr	BB5_61
BB5_60:
	ld	iyl, -1
BB5_61:
	ld	a, (ix + 9)
	ld	l, (ix - 18)
	cp	a, l
	sbc	a, a
	ld	l, a
	bit	0, l
	ld	bc, (ix + 6)
	jr	nz, BB5_63
	ld	a, -1
	jr	BB5_64
BB5_63:
	ld	a, 1
BB5_64:
	ld	e, (ix + 9)
	add	a, e
	ld	(ix - 39), a
	bit	0, l
	jr	nz, BB5_66
	ld	a, -4
	jr	BB5_67
BB5_66:
	ld	a, 3
BB5_67:
	ld	l, (ix + 9)
	add	a, l
	ld	de, 0
	ld	(ix - 42), a
	ld	e, a
	push	bc
	pop	hl
	add	hl, de
	ld	(ix - 63), hl
	ld	e, (hl)
	ld	a, e
	and	a, 7
	ld	l, a
	ld	(ix - 60), e
	ld	a, e
	cp	a, d
	call	pe, __setflag
	jp	m, BB5_69
	xor	a, a
	ld	(ix - 78), a
BB5_69:
	dec	l
	ld	a, l
	add	a, (ix - 78)
	ld	b, a
	ld	c, (ix - 42)
	ld	a, c
	srl	a
	and	a, 56
	ld	e, a
	ld	a, c
	and	a, 7
	ld	c, a
	ld	a, e
	add	a, c
	ld	d, a
	ld	c, (ix - 39)
	ld	a, c
	srl	a
	and	a, 56
	ld	e, a
	ld	a, c
	and	a, 7
	ld	c, a
	ld	a, e
	add	a, c
	ld	c, a
	ld	a, d
	xor	a, 56
	ex	de, hl
	ld	d, iyl
	ex	de, hl
	bit	0, h
	ld	(ix - 48), d
	jr	nz, BB5_71
	ld	d, a
BB5_71:
	ld	(ix - 69), d
	ld	de, 0
	ld	e, (ix - 39)
	ld	(ix - 66), de
	ld	a, c
	xor	a, 56
	bit	0, h
	ld	(ix - 45), c
	jr	nz, BB5_73
	ld	c, a
BB5_73:
	ld	(ix - 72), c
	ld	de, 0
	push	de
	pop	hl
	ld	l, b
	ld	(ix - 75), hl
	ld	c, 8
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _zobrist_piece
	add	iy, bc
	ld	b, 2
	ld	a, (ix - 48)
	call	__bshl
	ld	e, a
	lea	hl, iy
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 78), hl
	ld	hl, (ix - 8)
	ld	bc, (hl)
	push	bc
	pop	hl
	ld	bc, (ix - 78)
	call	__ixor
	ld	b, 2
	ld	a, (ix - 45)
	call	__bshl
	ld	e, a
	add	iy, de
	ld	bc, (iy)
	call	__ixor
	ld	iy, (ix - 8)
	ld	(iy), hl
	ld	c, 7
	ld	hl, (ix - 75)
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _lock_piece
	add	iy, bc
	ld	a, (ix - 48)
	add	a, a
	ld	e, a
	ld	(ix - 75), de
	lea	hl, iy
	add	hl, de
	ld	bc, (hl)
	ld	hl, (ix + 6)
	ld	de, 434
	add	hl, de
	ld	(ix - 48), hl
	ld	de, (hl)
	ld	l, e
	ld	h, d
	call	__sxor
	ld	c, l
	ld	b, h
	ld	hl, (ix - 48)
	ld	(hl), c
	inc	hl
	ld	(hl), b
	ld	a, (ix - 45)
	add	a, a
	ld	de, (ix - 75)
	ld	e, a
	add	iy, de
	ld	hl, (iy)
	call	__sxor
	ld	iy, (ix - 48)
	ld	(iy), l
	ld	(iy + 1), h
	ld	iy, _mg_table+384
	ld	a, (ix - 69)
	add	a, a
	ld	e, a
	lea	hl, iy
	add	hl, de
	ld	bc, (hl)
	ld	hl, (ix - 33)
	or	a, a
	sbc.sis	hl, bc
	ld	(ix - 33), hl
	ld	hl, _eg_table+384
	add	hl, de
	ld	bc, (hl)
	ld	hl, (ix - 36)
	or	a, a
	sbc.sis	hl, bc
	ld	a, (ix - 72)
	add	a, a
	ld	e, a
	add	iy, de
	ld	bc, (iy)
	ld	iy, (ix - 33)
	add.sis	iy, bc
	ld	c, iyl
	ld	b, iyh
	ld	iy, (ix - 27)
	ld	(iy), c
	ld	(iy + 1), b
	ld	iy, _eg_table+384
	add	iy, de
	ld	de, (iy)
	add.sis	hl, de
	ld	iy, (ix - 14)
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, (ix - 63)
	ld	(hl), 0
	ld	bc, (ix + 6)
	push	bc
	pop	hl
	ld	de, (ix - 66)
	add	hl, de
	ld	a, (ix - 60)
	ld	(hl), a
	ld	l, (ix - 39)
	push	hl
	ld	l, (ix - 42)
	push	hl
	ld	l, (ix - 1)
	push	hl
	push	bc
	call	_plist_move
	pop	hl
	pop	hl
	pop	hl
	pop	hl
BB5_74:
	ld	iy, _castling_mask
	ld	a, (ix - 4)
	cp	a, 6
	jr	nz, BB5_76
	ld	de, 420
	ld	hl, (ix + 6)
	ld	bc, (ix - 17)
	add	hl, bc
	add	hl, de
	ld	a, (ix - 18)
	ld	(hl), a
BB5_76:
	ld	hl, (ix - 24)
	ld	c, (hl)
	lea	hl, iy
	ld	de, (ix - 57)
	add	hl, de
	ld	a, (hl)
	and	a, c
	ld	de, (ix - 21)
	add	iy, de
	and	a, (iy)
	ld	e, a
	ld	hl, (ix - 24)
	ld	(hl), e
	ld	a, c
	cp	a, e
	jp	z, BB5_78
	ld	iy, _zobrist_castle
	or	a, a
	sbc	hl, hl
	ld	l, c
	ld	(ix - 14), hl
	ld	a, 2
	ld	c, a
	call	__ishl
	push	hl
	pop	bc
	lea	hl, iy
	add	hl, bc
	ld	hl, (hl)
	ld	(ix - 4), hl
	ld	hl, (ix - 8)
	ld	bc, (hl)
	push	bc
	pop	hl
	ld	bc, (ix - 4)
	call	__ixor
	ld	(ix - 17), hl
	or	a, a
	sbc	hl, hl
	ld	l, e
	ld	(ix - 4), hl
	ld	c, a
	call	__ishl
	push	hl
	pop	de
	add	iy, de
	ld	bc, (iy)
	ld	hl, (ix - 17)
	call	__ixor
	ld	iy, (ix - 8)
	ld	(iy), hl
	dec	a
	ld	hl, (ix - 14)
	ld	c, a
	call	__ishl
	push	hl
	pop	de
	ld	hl, _lock_castle
	add	hl, de
	ld	bc, (hl)
	ld	iy, (ix + 6)
	ld	de, 434
	add	iy, de
	ld	hl, (iy)
	call	__sxor
	ld	e, l
	ld	d, h
	ld	(iy), e
	ld	(iy + 1), d
	ld	hl, (ix - 4)
	ld	c, a
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _lock_castle
	add	hl, bc
	ld	hl, (hl)
	ld	c, e
	ld	b, d
	call	__sxor
	ld	(iy), l
	ld	(iy + 1), h
BB5_78:
	ld	a, (ix - 1)
	or	a, a
	ld	a, -16
	jr	z, BB5_80
	ld	a, 16
BB5_80:
	ld	hl, (ix - 54)
	ld	c, (hl)
	ld	e, (ix + 9)
	add	a, e
	bit	6, (ix - 5)
	jr	z, BB5_82
	ld	(ix - 11), a
BB5_82:
	ld	iy, _zobrist_ep_file
	ld	a, (ix - 11)
	ld	(hl), a
	ld	l, a
	ld	a, c
	cp	a, -1
	jp	z, BB5_84
	ld	a, c
	and	a, 7
	ld	e, a
	ld	b, 2
	call	__bshl
	or	a, a
	sbc	hl, hl
	push	hl
	pop	bc
	ld	c, a
	lea	hl, iy
	add	hl, bc
	ld	bc, (hl)
	ld	iy, (ix - 8)
	ld	hl, (iy)
	call	__ixor
	ld	(iy), hl
	sla	e
	ld	bc, 0
	ld	c, e
	ld	hl, _lock_ep_file
	add	hl, bc
	ld	bc, (hl)
	ld	iy, (ix + 6)
	ld	de, 434
	add	iy, de
	ld	hl, (iy)
	call	__sxor
	ld	(iy), l
	ld	(iy + 1), h
	ld	iy, _zobrist_ep_file
	ld	l, (ix - 11)
BB5_84:
	ld	a, l
	cp	a, -1
	jr	nz, BB5_86
	ld	hl, (ix - 8)
	ld	iy, (hl)
	ld	hl, (ix + 6)
	ld	de, 434
	add	hl, de
	ld	de, (hl)
	jp	BB5_87
BB5_86:
	ld	a, l
	and	a, 7
	ld	(ix - 4), a
	ld	b, 2
	call	__bshl
	ld	de, 0
	ld	e, a
	add	iy, de
	ld	bc, (iy)
	ld	hl, (ix - 8)
	ld	hl, (hl)
	call	__ixor
	push	hl
	pop	iy
	ld	a, (ix - 4)
	add	a, a
	ld	e, a
	ld	hl, _lock_ep_file
	add	hl, de
	ld	bc, (hl)
	ld	hl, (ix + 6)
	ld	de, 434
	add	hl, de
	ld	hl, (hl)
	call	__sxor
	ld	e, l
	ld	d, h
BB5_87:
	ld	hl, (ix - 51)
	ld	a, (hl)
	xor	a, 1
	ld	(hl), a
	ld	bc, (_zobrist_side)
	lea	hl, iy
	call	__ixor
	ld	iy, (ix + 6)
	ld	bc, 431
	add	iy, bc
	ld	(iy), hl
	ld	hl, _lock_side
	ld	hl, (hl)
	ld	c, e
	ld	b, d
	call	__sxor
	ld	iy, (ix - 30)
	ld	(iy), l
	ld	(iy + 1), h
	ld	a, (ix - 1)
	cp	a, 1
	jr	nz, BB5_89
	ld	de, 426
	ld	hl, (ix + 6)
	push	hl
	pop	iy
	add	iy, de
	ld	hl, (iy)
	inc.sis	hl
	ld	(iy), l
	ld	(iy + 1), h
BB5_89:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_plist_remove
_plist_remove:
	ld	hl, -9
	call	__frameset
	ld	iy, (ix + 6)
	or	a, a
	sbc	hl, hl
	push	hl
	pop	de
	ld	e, (ix + 12)
	ld	bc, 288
	add	iy, de
	add	iy, bc
	ld	a, (iy)
	cp	a, -1
	jr	z, BB6_5
	ex	de, hl
	ld	e, (ix + 9)
	ld	bc, 416
	ld	hl, (ix + 6)
	add	hl, de
	add	hl, bc
	ld	b, (hl)
	cp	a, b
	jr	nc, BB6_5
	dec	b
	ld	(ix - 6), hl
	or	a, a
	sbc	hl, hl
	ld	(ix - 3), hl
	ld	hl, (ix - 3)
	ld	l, b
	ld	(ix - 3), hl
	ld	c, 4
	ld	(ix - 9), de
	ex	de, hl
	call	__ishl
	push	hl
	pop	de
	ld	hl, (ix + 6)
	add	hl, de
	ld	de, (ix - 3)
	add	hl, de
	ld	de, 256
	add	hl, de
	ld	c, (hl)
	ld	hl, (ix - 6)
	ld	(hl), b
	cp	a, b
	jr	z, BB6_4
	ld	b, c
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	(ix - 3), hl
	ld	c, 4
	ld	hl, (ix - 9)
	call	__ishl
	push	hl
	pop	de
	ld	hl, (ix + 6)
	add	hl, de
	ld	de, (ix - 3)
	add	hl, de
	ld	de, 256
	add	hl, de
	ld	(hl), b
	or	a, a
	sbc	hl, hl
	ex	de, hl
	ld	e, b
	ld	hl, (ix + 6)
	add	hl, de
	ld	de, 288
	add	hl, de
	ld	(hl), a
BB6_4:
	ld	(iy), -1
BB6_5:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_plist_move
_plist_move:
	ld	hl, -3
	call	__frameset
	ld	iy, (ix + 6)
	ld	de, 0
	push	de
	pop	bc
	ld	c, (ix + 12)
	ld	hl, 288
	add	iy, bc
	push	hl
	pop	bc
	add	iy, bc
	ld	a, (iy)
	cp	a, -1
	jr	z, BB7_3
	push	de
	pop	bc
	ld	c, (ix + 9)
	ld	hl, (ix + 6)
	ld	(ix - 3), bc
	add	hl, bc
	ld	bc, 416
	add	hl, bc
	ld	l, (hl)
	cp	a, l
	jr	nc, BB7_3
	ld	e, a
	ld	c, 4
	ld	hl, (ix - 3)
	call	__ishl
	push	hl
	pop	bc
	ld	hl, (ix + 6)
	add	hl, bc
	add	hl, de
	ld	bc, 256
	add	hl, bc
	ld	c, (ix + 15)
	ld	(hl), c
	ld	e, c
	ld	hl, (ix + 6)
	add	hl, de
	ld	de, 288
	add	hl, de
	ld	(hl), a
	ld	(iy), -1
BB7_3:
	pop	hl
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_board_unmake
_board_unmake:
	ld	hl, -53
	call	__frameset
	ld	hl, (ix + 6)
	ld	iy, (ix + 12)
	xor	a, a
	ld	(ix - 35), a
	ld	d, (ix + 10)
	ld	a, (iy + 15)
	ld	(ix - 8), a
	ld	e, (iy + 14)
	ld	bc, 422
	add	hl, bc
	ld	c, d
	ld	a, (hl)
	ld	(ix - 39), a
	xor	a, b
	ld	d, a
	ld	(hl), d
	ld	(ix - 11), e
	ld	a, e
	and	a, 7
	ld	(ix - 17), a
	dec	a
	ld	(ix - 26), a
	ld	e, (ix + 9)
	ld	a, e
	srl	a
	and	a, 56
	ld	l, a
	ld	a, e
	and	a, 7
	ld	e, a
	ld	a, l
	add	a, e
	ld	h, a
	ld	a, c
	srl	a
	and	a, 56
	ld	l, a
	ld	a, c
	and	a, 7
	ld	e, a
	ld	a, l
	add	a, e
	ld	b, a
	ld	(ix - 3), d
	ld	a, d
	or	a, a
	jr	z, BB8_2
	ld	l, 0
	jr	BB8_3
BB8_2:
	ld	l, -1
BB8_3:
	ld	a, h
	xor	a, 56
	bit	0, l
	ld	de, 0
	jr	nz, BB8_5
	ld	h, a
BB8_5:
	ld	(ix - 20), h
	ld	a, b
	xor	a, 56
	bit	0, l
	ld	(ix - 40), b
	jr	nz, BB8_7
	ld	b, a
BB8_7:
	ld	(ix - 41), a
	push	de
	pop	hl
	ld	a, (ix + 9)
	ld	l, a
	ld	(ix - 23), hl
	push	de
	pop	iy
	ld	iyl, c
	ld	(ix - 14), iy
	push	de
	pop	hl
	ld	l, (ix - 3)
	ld	(ix - 7), hl
	ld	a, (ix - 8)
	bit	3, a
	ld	(ix - 4), c
	jr	nz, BB8_9
	ld	de, 0
	push	de
	pop	hl
	ld	l, (ix - 26)
	ld	c, 7
	ld	(ix - 26), hl
	call	__ishl
	ld	a, b
	push	hl
	pop	bc
	ld	(ix - 32), bc
	ld	iy, _mg_table
	lea	hl, iy
	add	hl, bc
	ld	c, 1
	add	a, a
	ld	e, a
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 35), hl
	ld	hl, (ix - 7)
	call	__ishl
	push	hl
	pop	bc
	ld	iy, (ix + 6)
	add	iy, bc
	lea	hl, iy
	ld	bc, 436
	add	hl, bc
	ld	hl, (hl)
	ld	(ix - 29), hl
	ld	hl, _eg_table
	ld	bc, (ix - 32)
	add	hl, bc
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 38), hl
	ld	de, 440
	add	iy, de
	ld	hl, (iy)
	ld	(ix - 32), hl
	ld	iy, (ix + 6)
	ld	a, (ix - 11)
	jp	BB8_19
BB8_9:
	and	a, 48
	push	de
	pop	iy
	cp	a, 16
	jr	nz, BB8_11
	ld	hl, 3
	jr	BB8_16
BB8_11:
	cp	a, 32
	jr	nz, BB8_13
	ld	hl, 2
	ld	a, 1
	ld	(ix - 35), a
	jr	BB8_16
BB8_13:
	cp	a, 48
	jr	nz, BB8_15
	ld	hl, 1
	jr	BB8_16
BB8_15:
	ld	hl, 4
BB8_16:
	ld	a, 7
	ld	(ix - 38), hl
	ld	c, a
	call	__ishl
	push	hl
	pop	de
	ld	(ix - 44), de
	ld	hl, _mg_table
	add	hl, de
	ld	c, 1
	sla	b
	lea	de, iy
	ld	e, b
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 29), hl
	ld	hl, (ix - 7)
	call	__ishl
	push	hl
	pop	bc
	ld	iy, (ix + 6)
	add	iy, bc
	lea	hl, iy
	ld	bc, 436
	add	hl, bc
	ld	(ix - 32), hl
	ld	hl, (ix - 32)
	ld	hl, (hl)
	ld	bc, (ix - 29)
	or	a, a
	sbc.sis	hl, bc
	ld	(ix - 29), hl
	ld	hl, _eg_table
	ld	bc, (ix - 44)
	add	hl, bc
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 44), hl
	ld	bc, 440
	add	iy, bc
	ld	(ix - 50), iy
	ld	hl, (iy)
	ld	bc, (ix - 44)
	or	a, a
	sbc.sis	hl, bc
	ld	(ix - 53), hl
	or	a, a
	sbc	hl, hl
	ld	l, (ix - 26)
	ld	(ix - 26), hl
	ld	c, a
	call	__ishl
	push	hl
	pop	bc
	ld	(ix - 47), bc
	ld	hl, _mg_table
	add	hl, bc
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 44), hl
	ld	bc, (ix - 29)
	add.sis	hl, bc
	ld	(ix - 29), hl
	ld	iy, (ix - 32)
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, _eg_table
	ld	bc, (ix - 47)
	add	hl, bc
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 47), hl
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	ld	de, (ix - 53)
	add.sis	iy, de
	ld	(ix - 32), iy
	ld	hl, (ix - 50)
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	iy, _phase_weight
	ld	de, (ix - 38)
	add	iy, de
	ld	hl, (ix + 6)
	ld	bc, 444
	add	hl, bc
	ld	a, (hl)
	sub	a, (iy)
	ld	iy, (ix + 6)
	ld	(hl), a
	bit	0, (ix - 35)
	jr	z, BB8_18
	lea	hl, iy
	ld	bc, (ix - 7)
	add	hl, bc
	ld	bc, 418
	add	hl, bc
	dec	(hl)
BB8_18:
	lea	hl, iy
	ld	bc, (ix - 14)
	add	hl, bc
	ld	a, (ix - 11)
	ld	(hl), a
	ld	hl, (ix - 47)
	ld	(ix - 38), hl
	ld	hl, (ix - 44)
	ld	(ix - 35), hl
BB8_19:
	ld	c, 1
	ld	hl, (ix - 7)
	call	__ishl
	push	hl
	pop	bc
	add	iy, bc
	lea	hl, iy
	ld	bc, 436
	add	hl, bc
	ld	(ix - 11), hl
	ld	hl, (ix - 29)
	ld	bc, (ix - 35)
	or	a, a
	sbc.sis	hl, bc
	ld	(ix - 29), hl
	ld	de, 440
	add	iy, de
	ld	hl, (ix - 32)
	ld	de, (ix - 38)
	or	a, a
	sbc.sis	hl, de
	ld	(ix - 32), hl
	ld	c, 7
	ld	hl, (ix - 26)
	call	__ishl
	push	hl
	pop	de
	ld	(ix - 26), de
	ld	hl, _mg_table
	add	hl, de
	ld	e, (ix - 20)
	sla	e
	ld	bc, 0
	ld	c, e
	add	hl, bc
	ld	de, (hl)
	ld	hl, (ix - 29)
	add.sis	hl, de
	ld	e, l
	ld	d, h
	ld	hl, (ix - 11)
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	hl, _eg_table
	ld	de, (ix - 26)
	add	hl, de
	add	hl, bc
	ld	de, (hl)
	ld	hl, (ix - 32)
	add.sis	hl, de
	ld	(ix - 20), iy
	ld	(iy), l
	ld	(iy + 1), h
	ld	bc, (ix + 6)
	push	bc
	pop	hl
	ld	de, (ix - 23)
	add	hl, de
	ld	(hl), a
	push	bc
	pop	hl
	ld	de, (ix - 14)
	add	hl, de
	ld	(hl), 0
	ld	a, (ix + 9)
	ld	l, a
	push	hl
	ld	l, (ix - 4)
	push	hl
	ld	l, (ix - 3)
	push	hl
	push	bc
	call	_plist_move
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	a, (ix - 17)
	cp	a, 6
	jr	nz, BB8_21
	ld	de, 420
	ld	hl, (ix + 6)
	ld	bc, (ix - 7)
	add	hl, bc
	add	hl, de
	ld	a, (ix + 9)
	ld	(hl), a
BB8_21:
	ld	a, (ix - 8)
	bit	1, a
	jp	z, BB8_36
	ld	a, (ix - 3)
	or	a, a
	ld	l, (ix - 4)
	jr	z, BB8_24
	ld	b, 0
	jr	BB8_25
BB8_24:
	ld	b, -1
BB8_25:
	ld	a, (ix + 9)
	cp	a, l
	sbc	a, a
	ld	l, a
	bit	0, l
	jr	nz, BB8_27
	ld	a, -1
	jr	BB8_28
BB8_27:
	ld	a, 1
BB8_28:
	ld	e, (ix + 9)
	add	a, e
	ld	iyl, a
	bit	0, l
	jr	nz, BB8_30
	ld	a, -4
	jr	BB8_31
BB8_30:
	ld	a, 3
BB8_31:
	ld	l, (ix + 9)
	add	a, l
	ld	c, a
	srl	a
	and	a, 56
	ld	l, a
	ld	(ix - 7), c
	ld	a, c
	and	a, 7
	ld	h, a
	ld	a, l
	add	a, h
	ld	e, a
	ld	a, iyl
	srl	a
	and	a, 56
	ld	l, a
	ld	a, iyl
	and	a, 7
	ld	h, a
	ld	a, l
	add	a, h
	ld	l, a
	ld	a, e
	xor	a, 56
	ld	h, b
	bit	0, h
	jr	nz, BB8_33
	ld	e, a
BB8_33:
	ld	(ix - 26), e
	ld	bc, 0
	push	bc
	pop	de
	ld	e, (ix - 7)
	ld	(ix - 23), de
	push	af
	ld	a, iyl
	ld	(ix - 17), a
	pop	af
	ld	c, iyl
	ld	(ix - 29), bc
	ld	a, l
	xor	a, 56
	bit	0, h
	jr	nz, BB8_35
	ld	l, a
BB8_35:
	ld	iy, _mg_table+384
	sla	l
	ld	bc, 0
	ld	c, l
	lea	hl, iy
	add	hl, bc
	ld	de, (hl)
	ld	hl, (ix - 11)
	ld	hl, (hl)
	or	a, a
	sbc.sis	hl, de
	ld	(ix - 32), hl
	ld	hl, _eg_table+384
	add	hl, bc
	ld	bc, (hl)
	ld	hl, (ix - 20)
	ld	hl, (hl)
	or	a, a
	sbc.sis	hl, bc
	ld	a, (ix - 26)
	add	a, a
	ld	bc, 0
	ld	c, a
	add	iy, bc
	ld	de, (iy)
	ld	iy, (ix - 32)
	add.sis	iy, de
	ld	e, iyl
	ld	d, iyh
	ld	iy, (ix - 11)
	ld	(iy), e
	ld	(iy + 1), d
	ld	iy, _eg_table+384
	add	iy, bc
	ld	de, (iy)
	add.sis	hl, de
	ld	iy, (ix - 20)
	ld	(iy), l
	ld	(iy + 1), h
	ld	de, (ix + 6)
	push	de
	pop	iy
	ld	bc, (ix - 29)
	add	iy, bc
	ld	a, (iy)
	push	de
	pop	hl
	ld	bc, (ix - 23)
	add	hl, bc
	ld	(hl), a
	ld	(iy), 0
	ld	l, (ix - 7)
	push	hl
	ld	l, (ix - 17)
	push	hl
	ld	l, (ix - 3)
	push	hl
	push	de
	call	_plist_move
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	a, (ix - 8)
BB8_36:
	bit	2, a
	ld	l, (ix - 4)
	jp	nz, BB8_43
	ld	hl, (ix + 12)
	ld	l, (hl)
	ld	a, l
	or	a, a
	ld	iy, (ix + 6)
	ld	de, 0
	jp	z, BB8_56
	ld	(ix - 7), l
	ld	a, l
	and	a, 7
	ld	(ix - 8), a
	ld	l, a
	dec	l
	ld	a, (ix - 39)
	ld	e, a
	ld	(ix - 3), de
	or	a, a
	jr	z, BB8_40
	ld	a, (ix - 41)
	ld	(ix - 40), a
BB8_40:
	ld	de, 0
	push	de
	pop	bc
	ld	c, l
	push	bc
	pop	hl
	ld	(ix - 11), hl
	ld	c, 7
	call	__ishl
	push	hl
	pop	bc
	ld	(ix - 17), bc
	ld	hl, _mg_table
	add	hl, bc
	ld	c, 1
	ld	a, (ix - 40)
	add	a, a
	ld	e, a
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 20), hl
	ld	hl, (ix - 3)
	call	__ishl
	push	hl
	pop	bc
	lea	hl, iy
	add	hl, bc
	ld	(ix - 23), hl
	ld	bc, 436
	add	hl, bc
	ld	iy, (hl)
	ld	bc, (ix - 20)
	add.sis	iy, bc
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	hl, _eg_table
	ld	bc, (ix - 17)
	add	hl, bc
	add	hl, de
	ld	de, (hl)
	ld	bc, 440
	ld	iy, (ix - 23)
	add	iy, bc
	ld	hl, (iy)
	add.sis	hl, de
	ld	de, (ix - 3)
	ld	(iy), l
	ld	(iy + 1), h
	ld	iy, _phase_weight
	ld	bc, (ix - 11)
	add	iy, bc
	ld	hl, (ix + 6)
	ld	bc, 444
	add	hl, bc
	ld	a, (hl)
	add	a, (iy)
	ld	iy, (ix + 6)
	ld	(hl), a
	ld	a, (ix - 8)
	cp	a, 3
	jr	nz, BB8_42
	lea	hl, iy
	add	hl, de
	ld	bc, 418
	add	hl, bc
	inc	(hl)
	ld	hl, (ix + 12)
	ld	a, (hl)
	ld	(ix - 7), a
BB8_42:
	lea	hl, iy
	ld	bc, (ix - 14)
	add	hl, bc
	ld	a, (ix - 7)
	ld	(hl), a
	ld	(ix - 7), de
	ld	(ix - 3), bc
	ld	a, (ix - 4)
	jp	BB8_55
BB8_43:
	ld	a, (ix - 3)
	or	a, a
	ld	iy, (ix + 6)
	lea	bc, iy
	jr	z, BB8_45
	ld	a, -16
	jr	BB8_46
BB8_45:
	ld	a, 16
BB8_46:
	ld	iy, _mg_table
	add	a, l
	ld	e, a
	ld	hl, (ix + 12)
	ld	l, (hl)
	ld	a, l
	or	a, a
	jr	nz, BB8_48
	push	bc
	pop	iy
	or	a, a
	sbc	hl, hl
	ld	l, (ix - 39)
	ld	(ix - 7), hl
	xor	a, a
	jp	BB8_54
BB8_48:
	ld	(ix - 20), l
	ld	a, l
	and	a, 7
	ld	(ix - 8), a
	dec	a
	ld	(ix - 3), a
	ld	a, e
	srl	a
	and	a, 56
	ld	l, a
	ld	(ix - 4), e
	ld	a, e
	and	a, 7
	ld	c, a
	ld	a, l
	add	a, c
	ld	h, a
	ld	de, 0
	ld	c, (ix - 39)
	ld	e, c
	ld	(ix - 7), de
	xor	a, 56
	ld	l, a
	ld	a, c
	or	a, a
	ld	a, h
	jr	z, BB8_50
	ld	a, l
BB8_50:
	ld	de, 0
	push	de
	pop	hl
	ld	l, (ix - 3)
	ld	(ix - 11), hl
	ld	c, 7
	call	__ishl
	ld	(ix - 3), hl
	ld	bc, (ix - 3)
	add	iy, bc
	ld	c, 1
	add	a, a
	ld	e, a
	ld	(ix - 14), de
	add	iy, de
	ld	de, (iy)
	ld	hl, (ix - 7)
	call	__ishl
	push	hl
	pop	bc
	ld	hl, (ix + 6)
	add	hl, bc
	ld	(ix - 17), hl
	ld	bc, 436
	add	hl, bc
	ld	iy, (hl)
	add.sis	iy, de
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	hl, _eg_table
	ld	de, (ix - 3)
	add	hl, de
	ld	de, (ix - 14)
	add	hl, de
	ld	de, (hl)
	ld	bc, 440
	ld	iy, (ix - 17)
	add	iy, bc
	ld	bc, (ix + 6)
	ld	hl, (iy)
	add.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	iy, _phase_weight
	ld	de, (ix - 11)
	add	iy, de
	push	bc
	pop	hl
	ld	de, 444
	add	hl, de
	ld	a, (hl)
	add	a, (iy)
	ld	(hl), a
	ld	a, (ix - 8)
	cp	a, 3
	jr	nz, BB8_52
	push	bc
	pop	iy
	push	bc
	pop	hl
	ld	de, (ix - 7)
	add	hl, de
	ld	de, 418
	add	hl, de
	inc	(hl)
	ld	hl, (ix + 12)
	ld	a, (hl)
	jr	BB8_53
BB8_52:
	push	bc
	pop	iy
	ld	a, (ix - 20)
BB8_53:
	ld	e, (ix - 4)
BB8_54:
	ld	bc, 0
	ld	c, e
	lea	hl, iy
	ld	(ix - 3), bc
	add	hl, bc
	ld	(hl), a
	ld	a, e
BB8_55:
	ld	de, 416
	ld	iy, (ix + 6)
	ld	bc, (ix - 7)
	add	iy, bc
	add	iy, de
	ld	de, 0
	ld	e, (iy)
	push	bc
	pop	hl
	ld	c, 4
	call	__ishl
	push	hl
	pop	bc
	ld	hl, (ix + 6)
	add	hl, bc
	add	hl, de
	ld	de, 256
	add	hl, de
	ld	(hl), a
	ld	a, (iy)
	ld	de, 288
	ld	hl, (ix + 6)
	ld	bc, (ix - 3)
	add	hl, bc
	add	hl, de
	ld	(hl), a
	inc	(iy)
	ld	iy, (ix + 6)
BB8_56:
	ld	hl, (ix + 12)
	ex	de, hl
	lea	hl, iy
	push	de
	pop	iy
	ld	a, (iy + 1)
	ld	bc, 423
	push	hl
	pop	de
	add	hl, bc
	ld	(hl), a
	ld	iy, (ix + 12)
	ld	a, (iy + 2)
	inc	bc
	push	de
	pop	hl
	add	hl, bc
	ld	(hl), a
	ld	iy, (ix + 12)
	ld	a, (iy + 3)
	inc	bc
	push	de
	pop	hl
	add	hl, bc
	ld	(hl), a
	ld	iy, (ix + 12)
	ld	iy, (iy + 4)
	inc	bc
	push	de
	pop	hl
	add	hl, bc
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	iy, (ix + 12)
	ld	iy, (iy + 6)
	ld	bc, 428
	push	de
	pop	hl
	add	hl, bc
	ld	(hl), iy
	ld	hl, (ix + 12)
	push	hl
	pop	iy
	ld	iy, (iy + 9)
	push	de
	pop	hl
	push	de
	pop	bc
	ld	de, 431
	add	hl, de
	ld	(hl), iy
	ld	iy, (ix + 12)
	ld	iy, (iy + 12)
	ld	de, 434
	push	bc
	pop	hl
	add	hl, de
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_book_init
_book_init:
	ld	hl, -27
	call	__frameset
	xor	a, a
	ld	bc, 0
	ld	l, 5
	ld	iy, _.str.56
	ld	de, _.str.1.57
	ld	(_num_segments), a
	ld	(_total_entries), bc
	ld	(_total_entries+3), a
	ld	(_book_ready), a
	ld	a, l
	ld	(_detected_tier), a
	push	de
	push	iy
	call	_ti_Open
	ld	e, a
	pop	hl
	pop	hl
	or	a, a
	jr	nz, BB9_2
	ld	e, 0
	jp	BB9_23
BB9_2:
	push	de
	ld	(ix - 12), de
	call	_ti_GetDataPtr
	pop	de
	ld	de, 2400
	add	hl, de
	ld	(_poly_randoms), hl
	ld	hl, (ix - 12)
	push	hl
	call	_ti_Close
	pop	hl
	ld	hl, _.str.8.61
	push	hl
	call	_appvar_exists
	pop	hl
	or	a, a
	jr	nz, BB9_8
	ld	hl, _.str.10.64
	push	hl
	call	_appvar_exists
	pop	hl
	or	a, a
	jr	nz, BB9_9
	ld	hl, _.str.12.65
	push	hl
	call	_appvar_exists
	pop	hl
	or	a, a
	jr	nz, BB9_10
	ld	hl, _.str.14.66
	push	hl
	call	_appvar_exists
	pop	hl
	or	a, a
	jr	nz, BB9_11
	ld	hl, _.str.16.67
	push	hl
	call	_appvar_exists
	pop	hl
	or	a, a
	ld	e, 0
	jp	z, BB9_21
	ld	iy, _.str.11
	ld	d, 4
	jr	BB9_13
BB9_8:
	ld	iy, _.str.3
	ld	e, 0
	ld	d, e
	jr	BB9_13
BB9_9:
	ld	iy, _.str.5
	ld	d, 1
	jr	BB9_12
BB9_10:
	ld	iy, _.str.7
	ld	d, 2
	jr	BB9_12
BB9_11:
	ld	iy, _.str.9
	ld	d, 3
BB9_12:
	ld	e, 0
BB9_13:
	ld	c, 10
	ld	l, -10
	ld	(ix - 12), hl
	ld	a, (iy)
	ld	(ix - 9), a
	ld	a, (iy + 1)
	ld	(ix - 8), a
	ld	a, (iy + 2)
	ld	(ix - 7), a
	ld	a, (iy + 3)
	ld	(ix - 6), a
	ld	iy, _total_entries
	lea	iy, iy + 3
	ld	h, 1
BB9_14:
	ld	a, (_num_segments)
	ld	l, a
	ld	a, h
	cp	a, 100
	jp	nc, BB9_20
	ld	a, l
	cp	a, 40
	jp	nc, BB9_20
	ld	(ix - 13), h
	ld	b, (ix - 13)
	ld	(ix - 14), d
	call	__bdivu
	ld	hl, (ix - 12)
	ld	h, a
	or	a, 48
	ld	(ix - 5), a
	ld	(ix - 12), hl
	mlt	hl
	ld	a, l
	add	a, (ix - 13)
	or	a, 48
	ld	(ix - 4), a
	ld	(ix - 3), 0
	ld	hl, _.str.1.57
	push	hl
	pea	ix - 9
	ld	(ix - 17), iy
	call	_ti_Open
	ld	d, (ix - 14)
	ld	e, 0
	ld	iyl, a
	pop	hl
	pop	hl
	or	a, a
	jp	z, BB9_20
	push	iy
	ld	(ix - 23), iy
	call	_ti_GetDataPtr
	pop	de
	ld	iy, 0
	lea	de, iy
	push	hl
	pop	iy
	ld	e, (iy)
	ld	(ix - 20), de
	ld	d, 0
	ld	bc, 0
	ld	c, (iy + 1)
	ld	a, d
	ld	l, 8
	call	__lshl
	push	bc
	pop	hl
	ld	e, a
	ld	bc, (ix - 20)
	ld	a, d
	call	__ladd
	ld	(ix - 20), hl
	ld	bc, 0
	ld	c, (iy + 2)
	ld	l, 16
	call	__lshl
	ld	hl, (ix - 20)
	call	__ladd
	ld	(ix - 20), hl
	ld	bc, 0
	ld	(ix - 27), iy
	ld	c, (iy + 3)
	ld	a, d
	ld	l, 24
	call	__lshl
	ld	hl, (ix - 20)
	call	__ladd
	ld	(ix - 20), hl
	ld	(ix - 24), e
	ld	hl, (ix - 23)
	push	hl
	call	_ti_Close
	pop	hl
	ld	hl, (ix - 20)
	ld	e, (ix - 24)
	ld	d, e
	call	__lcmpzero
	jr	z, BB9_19
	ld	iy, (ix - 27)
	lea	hl, iy + 4
	ld	(ix - 27), hl
	ld	a, (_num_segments)
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	(ix - 23), hl
	ld	bc, 7
	call	__imulu
	push	hl
	pop	bc
	ld	iy, _segments
	add	iy, bc
	ld	hl, (ix - 27)
	ld	(iy), hl
	ld	bc, (ix - 20)
	ld	(iy + 3), bc
	ld	(iy + 6), d
	ld	hl, (_total_entries)
	ld	iy, (ix - 17)
	ld	e, (iy)
	ld	a, d
	call	__ladd
	ld	a, e
	ld	(_total_entries), hl
	ld	(_total_entries+3), a
	ld	hl, (ix - 23)
	inc	l
	ld	a, l
	ld	(_num_segments), a
BB9_19:
	ld	h, (ix - 13)
	inc	h
	ld	e, 0
	ld	d, (ix - 14)
	ld	c, 10
	ld	iy, (ix - 17)
	jp	BB9_14
BB9_20:
	ld	a, d
	ld	(_detected_tier), a
BB9_21:
	ld	a, (_num_segments)
	or	a, a
	jr	z, BB9_23
	ld	a, 1
	ld	(_book_ready), a
	ld	e, a
BB9_23:
	ld	a, e
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_appvar_exists
_appvar_exists:
	ld	hl, -1
	call	__frameset
	ld	hl, (ix + 6)
	ld	de, _.str.1.57
	xor	a, a
	ld	(ix - 1), a
	push	de
	push	hl
	call	_ti_Open
	ld	l, a
	pop	de
	pop	de
	or	a, a
	jr	z, BB10_2
	ld	a, 1
	ld	(ix - 1), a
	push	hl
	call	_ti_Close
	pop	hl
BB10_2:
	ld	a, (ix - 1)
	inc	sp
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_book_probe
_book_probe:
	ld	hl, -189
	call	__frameset
	ld	h, 0
	ld	de, 0
	ld	a, (_book_ready)
	bit	0, a
	jp	z, BB11_61
	ld	bc, -180
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	ld	bc, -137
	lea	hl, ix
	add	hl, bc
	push	ix
	ld	bc, -189
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	iy, (ix + 6)
	ld.sis	hl, 0
	push	ix
	ld	bc, -146
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	hl, 56
	push	ix
	ld	bc, -155
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	bc, -134
	lea	hl, ix
	add	hl, bc
	push	ix
	ld	bc, -183
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	hl, (_poly_randoms)
	push	ix
	ld	bc, -149
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	bc, 8
	push	de
	pop	hl
	ld	(ix - 3), bc
	push	ix
	ld	bc, -140
	add	ix, bc
	ld	(ix), hl
	pop	ix
	push	ix
	ld	bc, -143
	add	ix, bc
	ld	(ix), hl
	pop	ix
	push	ix
	ld	bc, -186
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	bc, (ix - 3)
BB11_2:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jp	z, BB11_12
	ld	(ix - 3), bc
	ld	bc, -158
	lea	hl, ix
	add	hl, bc
	ld	(hl), de
	ld	de, 0
	ld	bc, (ix - 3)
BB11_4:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jp	z, BB11_11
	ld	(ix - 3), bc
	ld	bc, -152
	lea	hl, ix
	add	hl, bc
	ld	(hl), iy
	add	iy, de
	ld	l, (iy)
	ld	a, l
	or	a, a
	ld	bc, (ix - 3)
	jr	nz, BB11_7
	push	bc
	pop	hl
	ld	(ix - 3), bc
	ld	bc, -152
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	jp	BB11_10
BB11_7:
	push	de
	pop	bc
	ld	a, l
	add	a, a
	and	a, 14
	add	a, -2
	ld	e, a
	ld	a, l
	cp	a, 0
	call	pe, __setflag
	ld	l, 1
	jp	p, BB11_9
	ld	l, 0
BB11_9:
	ld	a, e
	add	a, l
	ld	de, -155
	lea	hl, ix
	add	hl, de
	ld	hl, (hl)
	ld	de, -161
	lea	iy, ix
	add	iy, de
	ld	(iy), bc
	add	hl, bc
	ex	de, hl
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	c, 6
	call	__ishl
	push	hl
	pop	iy
	ex	de, hl
	ld	bc, 255
	call	__iand
	push	hl
	pop	de
	add	iy, de
	lea	hl, iy
	ld	c, 3
	call	__ishl
	push	hl
	pop	de
	ld	(ix - 3), bc
	ld	bc, -149
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	add	iy, de
	ld	hl, (iy)
	ld	de, (iy + 3)
	ld	bc, (ix - 3)
	ld	bc, (iy + 6)
	ld	(ix - 3), de
	ld	de, -146
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -143
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -140
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, (ix - 3)
	call	__llxor
	ld	(ix - 3), bc
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	push	ix
	ld	bc, -143
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	bc, (ix - 3)
	ld	(ix - 3), de
	push	ix
	ld	de, -146
	add	ix, de
	ld	(ix), bc
	pop	ix
	pop	hl
	pop	hl
	pop	hl
	ld	de, (ix - 3)
	ld	bc, -161
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
	ld	bc, 8
	ld	(ix - 3), bc
	push	ix
	ld	bc, -152
	add	ix, bc
	ld	iy, (ix)
	pop	ix
BB11_10:
	ld	bc, (ix - 3)
	inc	de
	jp	BB11_4
BB11_11:
	ld	(ix - 3), bc
	ld	bc, -158
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
	inc	de
	lea	iy, iy + 16
	push	ix
	ld	bc, -152
	add	ix, bc
	ld	(ix), iy
	pop	ix
	ld	bc, (ix - 3)
	push	bc
	pop	iy
	ld	bc, 248
	ld	(ix - 3), de
	push	ix
	ld	de, -155
	add	ix, de
	ld	hl, (ix)
	pop	ix
	add	hl, bc
	lea	bc, iy
	ld	de, -152
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	ix
	ld	de, -155
	add	ix, de
	ld	(ix), hl
	pop	ix
	ld	de, (ix - 3)
	jp	BB11_2
BB11_12:
	ld	de, 423
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	ld	bc, -152
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	and	a, d
	bit	0, a
	jr	nz, BB11_14
	ld	bc, -152
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	jp	BB11_15
BB11_14:
	ld	de, 6144
	ld	bc, -149
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	add	iy, de
	ld	hl, (iy)
	lea	bc, iy
	lea	iy, iy + 3
	ld	de, (iy)
	push	bc
	pop	iy
	lea	iy, iy + 6
	ld	bc, (iy)
	ld	(ix - 3), de
	ld	de, -146
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -143
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -140
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, (ix - 3)
	call	__llxor
	ld	(ix - 3), bc
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	push	ix
	ld	bc, -143
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	bc, (ix - 3)
	ld	(ix - 3), de
	push	ix
	ld	de, -146
	add	ix, de
	ld	(ix), bc
	pop	ix
	pop	hl
	pop	hl
	pop	hl
	ld	bc, -152
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	ld	de, (ix - 3)
BB11_15:
	bit	1, a
	jp	z, BB11_17
	ld	de, 6152
	ld	bc, -149
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	add	iy, de
	ld	hl, (iy)
	lea	bc, iy
	lea	iy, iy + 3
	ld	de, (iy)
	push	bc
	pop	iy
	lea	iy, iy + 6
	ld	bc, (iy)
	ld	(ix - 3), de
	ld	de, -146
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -143
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -140
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, (ix - 3)
	call	__llxor
	ld	(ix - 3), bc
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	push	ix
	ld	bc, -143
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	bc, (ix - 3)
	ld	(ix - 3), de
	push	ix
	ld	de, -146
	add	ix, de
	ld	(ix), bc
	pop	ix
	pop	hl
	pop	hl
	pop	hl
	ld	de, (ix - 3)
BB11_17:
	bit	2, a
	jp	z, BB11_19
	ld	de, 6160
	ld	bc, -149
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	add	iy, de
	ld	hl, (iy)
	lea	bc, iy
	lea	iy, iy + 3
	ld	de, (iy)
	push	bc
	pop	iy
	lea	iy, iy + 6
	ld	bc, (iy)
	ld	(ix - 3), de
	ld	de, -146
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -143
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -140
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, (ix - 3)
	call	__llxor
	ld	(ix - 3), bc
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	push	ix
	ld	bc, -143
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	bc, (ix - 3)
	ld	(ix - 3), de
	push	ix
	ld	de, -146
	add	ix, de
	ld	(ix), bc
	pop	ix
	pop	hl
	pop	hl
	pop	hl
	ld	de, (ix - 3)
BB11_19:
	bit	3, a
	jr	nz, BB11_21
	ld	iy, (ix + 6)
	jp	BB11_22
BB11_21:
	ld	de, 6168
	ld	bc, -149
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	add	iy, de
	ld	hl, (iy)
	lea	bc, iy
	lea	iy, iy + 3
	ld	de, (iy)
	push	bc
	pop	iy
	lea	iy, iy + 6
	ld	bc, (iy)
	ld	(ix - 3), de
	ld	de, -146
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -143
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -140
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, (ix - 3)
	call	__llxor
	ld	(ix - 3), bc
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	push	ix
	ld	bc, -143
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	bc, (ix - 3)
	ld	(ix - 3), de
	push	ix
	ld	de, -146
	add	ix, de
	ld	(ix), bc
	pop	ix
	pop	hl
	pop	hl
	pop	hl
	ld	iy, (ix + 6)
	ld	de, (ix - 3)
BB11_22:
	ld	de, 424
	lea	hl, iy
	add	hl, de
	ld	l, (hl)
	ld	a, l
	cp	a, -1
	ld	de, 422
	jr	nz, BB11_24
	lea	hl, iy
	add	hl, de
	jp	BB11_39
BB11_24:
	ld	a, l
	and	a, 7
	push	ix
	ld	bc, -152
	add	ix, bc
	ld	(ix), a
	pop	ix
	ld	a, l
	ld	b, 4
	call	__bshru
	ld	c, a
	lea	hl, iy
	add	hl, de
	ld	l, (hl)
	ld	a, l
	or	a, a
	ld	de, -158
	lea	iy, ix
	push	af
	add	iy, de
	pop	af
	ld	(iy), l
	jr	z, BB11_26
	ld	e, 0
	jr	BB11_27
BB11_26:
	ld	e, -1
BB11_27:
	ld	a, 1
	ld	(ix - 3), bc
	ld	bc, -152
	lea	hl, ix
	add	hl, bc
	ld	d, (hl)
	ld	bc, (ix - 3)
	bit	0, e
	jr	nz, BB11_29
	ld	a, -1
BB11_29:
	add	a, c
	bit	0, e
	ld	hl, 1
	jr	nz, BB11_31
	ld	hl, 129
BB11_31:
	ld	bc, -155
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	or	a, a
	sbc	hl, hl
	push	hl
	pop	iy
	ld	iyl, d
	ld	l, a
	ld	c, 4
	call	__ishl
	ld	a, d
	or	a, a
	ld	d, 0
	ld	c, d
	jr	z, BB11_36
	push	ix
	ld	bc, -161
	add	ix, bc
	ld	(ix), iy
	pop	ix
	dec	iy
	push	hl
	pop	de
	add	iy, de
	lea	de, iy
	ld	iy, (ix + 6)
	add	iy, de
	ld	e, (iy)
	ld	(ix - 3), de
	ld	de, -155
	lea	iy, ix
	add	iy, de
	ld	bc, (iy)
	ld	a, c
	ld	de, (ix - 3)
	cp	a, e
	jr	z, BB11_34
	ld	c, 0
	jr	BB11_35
BB11_34:
	ld	c, 1
BB11_35:
	ld	de, -152
	lea	iy, ix
	add	iy, de
	ld	a, (iy)
	cp	a, 7
	ld	de, -161
	lea	iy, ix
	push	af
	add	iy, de
	pop	af
	ld	iy, (iy)
	jr	z, BB11_37
BB11_36:
	lea	de, iy
	inc	de
	add	hl, de
	ex	de, hl
	ld	hl, (ix + 6)
	add	hl, de
	ld	l, (hl)
	ld	(ix - 3), bc
	push	ix
	ld	bc, -155
	add	ix, bc
	ld	de, (ix)
	pop	ix
	ld	a, e
	cp	a, l
	ld	bc, (ix - 3)
	jr	z, BB11_40
BB11_37:
	bit	0, c
	jr	nz, BB11_40
	ld	bc, -158
	lea	hl, ix
	add	hl, bc
BB11_39:
	ld	a, (hl)
	jp	BB11_41
BB11_40:
	ld	de, 772
	add	iy, de
	ld	c, d
	lea	hl, iy
	call	__ishl
	push	hl
	pop	de
	ld	(ix - 3), bc
	ld	bc, -149
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	add	iy, de
	ld	hl, (iy)
	ld	de, (iy + 3)
	ld	bc, (ix - 3)
	ld	bc, (iy + 6)
	ld	(ix - 3), de
	ld	de, -146
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -143
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -140
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, (ix - 3)
	call	__llxor
	ld	(ix - 3), bc
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	push	ix
	ld	bc, -143
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	bc, (ix - 3)
	ld	(ix - 3), de
	push	ix
	ld	de, -146
	add	ix, de
	ld	(ix), bc
	pop	ix
	pop	hl
	pop	hl
	pop	hl
	ld	bc, -158
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	ld	de, (ix - 3)
BB11_41:
	or	a, a
	jp	nz, BB11_43
	ld	de, 6240
	ld	bc, -149
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	add	iy, de
	ld	hl, (iy)
	lea	bc, iy
	lea	iy, iy + 3
	ld	de, (iy)
	push	bc
	pop	iy
	lea	iy, iy + 6
	ld	bc, (iy)
	ld	(ix - 3), de
	ld	de, -146
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -143
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -140
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, (ix - 3)
	call	__llxor
	ld	(ix - 3), bc
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	push	ix
	ld	bc, -143
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	bc, (ix - 3)
	ld	(ix - 3), de
	push	ix
	ld	de, -146
	add	ix, de
	ld	(ix), bc
	pop	ix
	pop	hl
	pop	hl
	pop	hl
	ld	iy, 0
	ld	de, (ix - 3)
	jr	BB11_44
BB11_43:
	ld	iy, 0
BB11_44:
	ld	a, (_num_segments)
	ld	de, 0
	ld	e, a
BB11_45:
	ld	bc, 7
	lea	hl, iy
	or	a, a
	sbc	hl, de
	jp	z, BB11_60
	ld	(ix - 3), bc
	ld	bc, -167
	lea	hl, ix
	add	hl, bc
	ld	(hl), de
	push	ix
	ld	de, -170
	add	ix, de
	ld	(ix), iy
	pop	ix
	lea	hl, iy
	ld	bc, (ix - 3)
	call	__imulu
	push	hl
	pop	de
	ld	hl, _segments
	push	hl
	pop	iy
	add	iy, de
	ld	hl, (iy + 3)
	push	ix
	ld	de, -155
	add	ix, de
	ld	(ix), iy
	pop	ix
	ld	a, (iy + 6)
	ld	de, -173
	lea	iy, ix
	add	iy, de
	ld	(iy), hl
	push	ix
	dec	de
	add	ix, de
	ld	(ix), a
	pop	ix
	ld	iy, 0
	push	hl
	pop	bc
	ld	h, 0
	ld	d, h
BB11_47:
	lea	hl, iy
	ld	e, d
	call	__lcmpu
	ld	(ix - 3), bc
	push	ix
	ld	bc, -152
	push	af
	add	ix, bc
	pop	af
	ld	(ix), d
	pop	ix
	ld	bc, (ix - 3)
	jp	nc, BB11_57
	ld	(ix - 3), de
	ld	de, -158
	lea	hl, ix
	add	hl, de
	ld	(hl), bc
	push	bc
	pop	hl
	push	ix
	ld	bc, -177
	add	ix, bc
	ld	(ix), a
	pop	ix
	ld	de, (ix - 3)
	ld	e, a
	lea	bc, iy
	ld	a, d
	call	__lsub
	push	hl
	pop	bc
	ld	a, e
	ld	l, 1
	call	__lshru
	push	bc
	pop	hl
	ld	e, a
	push	ix
	ld	bc, -149
	add	ix, bc
	ld	(ix), iy
	pop	ix
	lea	bc, iy
	ld	a, d
	call	__ladd
	push	hl
	pop	bc
	ld	(ix - 3), de
	ld	de, -164
	lea	iy, ix
	add	iy, de
	ld	(iy), bc
	ld	de, (ix - 3)
	ld	(ix - 3), bc
	push	ix
	ld	bc, -161
	add	ix, bc
	ld	(ix), e
	pop	ix
	push	ix
	ld	bc, -155
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	ld	iy, (hl)
	ld	bc, (ix - 3)
	push	bc
	pop	hl
	ld	c, 4
	call	__ishl
	push	hl
	pop	de
	add	iy, de
	push	iy
	call	_read_be64
	pop	iy
	ld	(ix - 3), bc
	ld	bc, -146
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, -143
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, (ix - 3)
	call	__llcmpu
	pop	hl
	pop	hl
	pop	hl
	ccf
	sbc	a, a
	ld	d, a
	inc	d
	ld	(ix - 3), bc
	ld	bc, -164
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	bc, -161
	lea	iy, ix
	add	iy, bc
	ld	e, (iy)
	ld	bc, (ix - 3)
	ld	bc, 1
	ld	iyh, b
	ld	a, iyh
	call	__ladd
	push	hl
	pop	iy
	bit	0, d
	jr	nz, BB11_50
	ld	(ix - 3), de
	ld	de, -164
	lea	hl, ix
	add	hl, de
	ld	bc, (hl)
	push	ix
	ld	de, -158
	add	ix, de
	ld	(ix), bc
	pop	ix
	ld	de, (ix - 3)
BB11_50:
	bit	0, d
	ld	bc, -177
	lea	hl, ix
	push	af
	add	hl, bc
	pop	af
	ld	a, (hl)
	jr	nz, BB11_52
	ld	bc, -161
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
BB11_52:
	bit	0, d
	ld	(ix - 3), de
	ld	de, -149
	lea	hl, ix
	push	af
	add	hl, de
	pop	af
	ld	bc, (hl)
	ld	de, (ix - 3)
	jr	nz, BB11_54
	push	bc
	pop	iy
BB11_54:
	bit	0, d
	jr	nz, BB11_56
	ld	bc, -152
	lea	hl, ix
	add	hl, bc
	ld	e, (hl)
BB11_56:
	ld	d, e
	ld	(ix - 3), de
	ld	de, -158
	lea	hl, ix
	add	hl, de
	ld	bc, (hl)
	ld	de, (ix - 3)
	jp	BB11_47
BB11_57:
	lea	hl, iy
	ld	e, d
	ld	(ix - 3), de
	push	ix
	ld	de, -173
	add	ix, de
	ld	bc, (ix)
	pop	ix
	push	ix
	dec	de
	add	ix, de
	ld	a, (ix)
	pop	ix
	ld	de, (ix - 3)
	call	__lcmpu
	jr	nc, BB11_59
	ld	de, -149
	lea	hl, ix
	add	hl, de
	ld	(hl), iy
	ld	de, -155
	lea	iy, ix
	add	iy, de
	ld	hl, (iy)
	ld	iy, (hl)
	ld	de, -149
	lea	hl, ix
	add	hl, de
	ld	hl, (hl)
	ld	c, 4
	call	__ishl
	push	hl
	pop	de
	add	iy, de
	push	iy
	call	_read_be64
	pop	iy
	ld	(ix - 3), bc
	ld	bc, -146
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, -143
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, -149
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	bc, (ix - 3)
	call	__llcmpu
	pop	hl
	pop	hl
	pop	hl
	jr	z, BB11_63
BB11_59:
	ld	bc, -170
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	inc	iy
	push	ix
	ld	bc, -167
	add	ix, bc
	ld	de, (ix)
	pop	ix
	jp	BB11_45
BB11_60:
	ld	h, 0
BB11_61:
	ld	a, h
BB11_62:
	ld	sp, ix
	pop	ix
	ret
BB11_63:
	ld	de, -170
	lea	hl, ix
	add	hl, de
	ld	hl, (hl)
	ld	bc, 255
	call	__iand
	push	hl
	pop	de
	ld	h, b
	ld	a, h
	ld	(ix - 3), de
	ld	de, -167
	lea	hl, ix
	add	hl, de
	ld	bc, (hl)
	ld	de, (ix - 3)
BB11_64:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jp	nc, BB11_74
	cp	a, 32
	jp	nc, BB11_74
	ld	bc, -164
	lea	hl, ix
	add	hl, bc
	ld	(hl), de
	ex	de, hl
	ld	bc, 7
	call	__imulu
	push	hl
	pop	de
	lea	hl, iy
	ld	iy, _segments
	add	iy, de
	ld	de, (iy)
	ld	(ix - 3), bc
	push	ix
	ld	bc, -170
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	de, (iy + 3)
	push	ix
	ld	bc, -155
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	d, (iy + 6)
	push	hl
	pop	iy
	or	a, a
	sbc	hl, hl
	push	ix
	ld	bc, -158
	add	ix, bc
	ld	(ix), a
	pop	ix
	ld	l, a
	ld	bc, (ix - 3)
	ld	c, 2
	call	__ishl
	ld	(ix - 3), bc
	push	ix
	ld	bc, -161
	add	ix, bc
	ld	(ix), hl
	pop	ix
BB11_67:
	ld	bc, (ix - 3)
	lea	hl, iy
	push	ix
	ld	bc, -152
	add	ix, bc
	ld	e, (ix)
	pop	ix
	ld	(ix - 3), de
	push	ix
	ld	de, -155
	add	ix, de
	ld	bc, (ix)
	pop	ix
	ld	de, (ix - 3)
	ld	a, d
	call	__lcmpu
	jp	nc, BB11_71
	ld	bc, -174
	lea	hl, ix
	add	hl, bc
	ld	(hl), d
	push	ix
	ld	bc, -161
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	ld	de, 128
	or	a, a
	sbc	hl, de
	jp	z, BB11_72
	lea	hl, iy
	ld	c, 4
	call	__ishl
	push	hl
	pop	de
	ld	(ix - 3), bc
	push	ix
	ld	bc, -170
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	add	hl, de
	push	ix
	ld	de, -173
	add	ix, de
	ld	(ix), hl
	pop	ix
	push	hl
	ld	de, -149
	lea	hl, ix
	add	hl, de
	ld	(hl), iy
	ld	bc, (ix - 3)
	call	_read_be64
	pop	iy
	ld	(ix - 3), bc
	ld	bc, -146
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, -143
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, (ix - 3)
	call	__llcmpu
	pop	hl
	pop	hl
	pop	hl
	ld	(ix - 3), bc
	ld	bc, -180
	lea	hl, ix
	push	af
	add	hl, bc
	pop	af
	ld	hl, (hl)
	ld	bc, (ix - 3)
	jp	nz, BB11_90
	ld	de, -173
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	ld	l, (iy + 8)
	ld	c, l
	ld	b, h
	ld	h, c
	ld	l, b
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	ld	e, (iy + 9)
	ld	d, b
	add.sis	hl, de
	ld	(ix - 3), bc
	ld	bc, -161
	lea	iy, ix
	add	iy, bc
	ld	de, (iy)
	push	ix
	ld	bc, -183
	add	ix, bc
	ld	iy, (ix)
	pop	ix
	add	iy, de
	push	ix
	ld	de, -177
	add	ix, de
	ld	(ix), iy
	pop	ix
	ld	(iy), l
	ld	(iy + 1), h
	ld	bc, (ix - 3)
	ld	h, b
	ld	de, -173
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	ld	l, (iy + 10)
	ld	h, l
	ld	l, b
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	ld	e, (iy + 11)
	ld	(ix - 3), de
	ld	de, -180
	lea	iy, ix
	add	iy, de
	ld	(iy), bc
	ld	de, (ix - 3)
	ld	d, b
	add.sis	hl, de
	push	ix
	ld	bc, -177
	add	ix, bc
	ld	iy, (ix)
	pop	ix
	ld	(iy + 2), l
	ld	(iy + 3), h
	ld	bc, -149
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	bc, -152
	lea	iy, ix
	add	iy, bc
	ld	e, (iy)
	ld	bc, 1
	ld	(ix - 3), bc
	push	ix
	ld	bc, -180
	add	ix, bc
	ld	iy, (ix)
	pop	ix
	ld	a, iyh
	ld	bc, (ix - 3)
	call	__ladd
	push	hl
	pop	iy
	ld	(ix - 3), bc
	push	ix
	ld	bc, -152
	add	ix, bc
	ld	(ix), e
	pop	ix
	push	ix
	ld	bc, -158
	add	ix, bc
	ld	a, (ix)
	pop	ix
	inc	a
	push	ix
	add	ix, bc
	ld	(ix), a
	pop	ix
	ld	de, 4
	push	ix
	ld	bc, -161
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	add	hl, de
	push	ix
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	bc, -174
	lea	hl, ix
	add	hl, bc
	ld	d, (hl)
	jp	BB11_67
BB11_71:
	ld	bc, -180
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	de, 0
	push	de
	pop	iy
	push	ix
	ld	de, -167
	add	ix, de
	ld	bc, (ix)
	pop	ix
	push	ix
	ld	de, -158
	add	ix, de
	ld	a, (ix)
	jr	BB11_73
BB11_72:
	ld	a, 32
	ld	bc, -180
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	de, 0
	push	de
	pop	iy
	push	ix
	ld	de, -167
	add	ix, de
	ld	bc, (ix)
BB11_73:
	pop	ix
	ld	(ix - 3), bc
	push	ix
	ld	bc, -164
	add	ix, bc
	ld	de, (ix)
	pop	ix
	ld	bc, (ix - 3)
	inc	de
	ld	(ix - 3), bc
	push	ix
	ld	bc, -152
	add	ix, bc
	ld	(ix), h
	pop	ix
	ld	bc, (ix - 3)
	jp	BB11_64
BB11_74:
	ld	bc, -180
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	iy, 0
BB11_75:
	ld	e, a
	or	a, a
	jp	z, BB11_61
	ld	bc, 0
	ld	c, e
	lea	de, iy
	ld	(ix - 3), de
	ld	de, -183
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	lea	iy, iy + 2
	push	ix
	ld	de, -155
	add	ix, de
	ld	(ix), bc
	pop	ix
	push	ix
	ld	de, -149
	add	ix, de
	ld	(ix), bc
	pop	ix
	ld	de, (ix - 3)
	push	ix
	ld	bc, -152
	add	ix, bc
	ld	(ix), de
	pop	ix
	push	ix
	ld	bc, -180
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	e, h
	xor	a, a
BB11_77:
	ld	bc, -149
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB11_79
	ld	hl, (iy)
	ld	bc, 0
	ld	c, l
	ld	b, h
	ld	(ix - 3), bc
	ld	bc, -152
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	bc, (ix - 3)
	call	__ladd
	ld	(ix - 3), bc
	push	ix
	ld	bc, -152
	add	ix, bc
	ld	(ix), hl
	pop	ix
	lea	iy, iy + 4
	push	ix
	ld	bc, -149
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	dec	hl
	push	ix
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	bc, (ix - 3)
	jr	BB11_77
BB11_79:
	ld	bc, -152
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	call	__lcmpzero
	jr	nz, BB11_81
BB11_80:
	ld	bc, -180
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	jp	BB11_61
BB11_81:
	ld	hl, (_book_random_seed)
	ld	bc, -158
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	ld	bc, -149
	lea	hl, ix
	add	hl, bc
	ld	(hl), e
	ld	a, (_book_random_seed+3)
	ld	hl, 32
	push	hl
	ld	bc, -140
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	push	ix
	ld	bc, -143
	add	ix, bc
	ld	de, (ix)
	pop	ix
	ld	(ix - 3), de
	push	ix
	ld	de, -146
	add	ix, de
	ld	bc, (ix)
	pop	ix
	ld	de, (ix - 3)
	call	__llshru
	pop	iy
	ld	(ix - 3), bc
	ld	bc, -146
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, -143
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, (ix - 3)
	call	__llxor
	push	hl
	pop	bc
	pop	hl
	pop	hl
	pop	hl
	ld	d, e
	ld	(ix - 3), bc
	ld	bc, -158
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	e, a
	ld	a, d
	ld	bc, (ix - 3)
	call	__lxor
	push	hl
	pop	iy
	ld	d, e
	ld	l, 16
	lea	bc, iy
	ld	a, d
	call	__lshru
	push	bc
	pop	hl
	ld	e, a
	lea	bc, iy
	ld	a, d
	call	__lxor
	ld	bc, 6135611
	ld	a, 4
	call	__lmulu
	push	hl
	pop	iy
	ld	d, e
	lea	bc, iy
	ld	a, d
	ld	l, 16
	call	__lshru
	push	bc
	pop	hl
	ld	e, a
	lea	bc, iy
	ld	a, d
	call	__lxor
	ld	(ix - 3), de
	ld	de, -152
	lea	iy, ix
	add	iy, de
	ld	bc, (iy)
	push	ix
	ld	de, -149
	add	ix, de
	ld	a, (ix)
	pop	ix
	ld	de, (ix - 3)
	call	__lremu
	ld	(ix - 3), bc
	push	ix
	ld	bc, -149
	add	ix, bc
	ld	(ix), hl
	pop	ix
	push	ix
	ld	bc, -152
	add	ix, bc
	ld	(ix), e
	pop	ix
	push	ix
	ld	bc, -183
	add	ix, bc
	ld	iy, (ix)
	pop	ix
	lea	hl, iy + 2
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	ld	bc, -155
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
	ld	bc, (ix - 3)
	push	de
	pop	bc
	ld	(ix - 3), de
	push	ix
	ld	de, -180
	add	ix, de
	ld	hl, (ix)
	pop	ix
	push	ix
	ld	de, -143
	add	ix, de
	ld	(ix), h
	pop	ix
	push	bc
	pop	hl
	ld	de, (ix - 3)
BB11_82:
	ld	bc, -146
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	push	ix
	ld	bc, -186
	push	af
	add	ix, bc
	pop	af
	ld	hl, (ix)
	pop	ix
	jp	z, BB11_86
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	de, (iy)
	ld	bc, 0
	ld	c, e
	ld	b, d
	xor	a, a
	ld	(ix - 3), bc
	ld	bc, -143
	lea	iy, ix
	add	iy, bc
	ld	e, (iy)
	ld	bc, (ix - 3)
	call	__ladd
	push	hl
	pop	bc
	ld	a, e
	ld	(ix - 3), bc
	push	ix
	ld	bc, -149
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	push	ix
	ld	bc, -152
	add	ix, bc
	ld	e, (ix)
	pop	ix
	ld	bc, (ix - 3)
	ld	(ix - 3), de
	push	ix
	ld	de, -186
	add	ix, de
	ld	(ix), bc
	pop	ix
	push	ix
	ld	de, -143
	add	ix, de
	ld	(ix), a
	pop	ix
	ld	de, (ix - 3)
	call	__lcmpu
	jr	nc, BB11_85
	ld	bc, -140
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	ld	hl, (iy - 2)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	ld	bc, -189
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	push	hl
	call	_poly_move_to_engine
	pop	hl
	pop	hl
	pop	hl
	ld	bc, -189
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	ld	a, (iy)
	cp	a, b
	jp	nz, BB11_89
BB11_85:
	ld	bc, -140
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	lea	iy, iy + 4
	push	ix
	add	ix, bc
	ld	(ix), iy
	pop	ix
	ld	bc, -146
	lea	iy, ix
	add	iy, bc
	ld	hl, (iy)
	dec	hl
	push	ix
	ld	bc, -155
	add	ix, bc
	ld	de, (ix)
	pop	ix
	jp	BB11_82
BB11_86:
	inc	de
BB11_87:
	dec	de
	push	de
	pop	hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB11_80
	ld	bc, -183
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	lea	hl, iy + 4
	push	ix
	ld	bc, -140
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	hl, (iy)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	ld	bc, -189
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	push	hl
	ld	bc, -155
	lea	hl, ix
	add	hl, bc
	ld	(hl), de
	call	_poly_move_to_engine
	ld	bc, -155
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
	pop	hl
	pop	hl
	pop	hl
	ld	bc, -189
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	ld	a, (iy)
	cp	a, b
	ld	bc, -140
	lea	iy, ix
	push	af
	add	iy, bc
	pop	af
	ld	hl, (iy)
	push	ix
	ld	bc, -183
	push	af
	add	ix, bc
	pop	af
	ld	(ix), hl
	pop	ix
	jr	z, BB11_87
BB11_89:
	ld	bc, -189
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	ld	hl, (iy + 1)
	ld	de, (ix + 9)
	push	de
	pop	iy
	ld	(iy), a
	ld	(iy + 1), l
	ld	(iy + 2), h
	ld	a, 1
	jp	BB11_62
BB11_90:
	ld	de, 0
	push	de
	pop	iy
	push	ix
	ld	bc, -158
	add	ix, bc
	ld	a, (ix)
	pop	ix
	jp	BB11_75
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_read_be64
_read_be64:
	ld	hl, -9
	call	__frameset
	ld	iy, (ix + 6)
	ld	de, 0
	push	de
	pop	hl
	ld	l, (iy)
	ld.sis	bc, 0
	ld	iy, 56
	push	iy
	call	__llshl
	ld	(ix - 3), hl
	ld	(ix - 6), de
	ld	(ix - 9), bc
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	iy, (ix + 6)
	ld	l, (iy + 1)
	ld	de, 48
	push	de
	ld	de, 0
	ld.sis	bc, 0
	call	__llshl
	pop	iy
	ld	iy, (ix - 9)
	push	iy
	ld	iy, (ix - 6)
	push	iy
	ld	iy, (ix - 3)
	push	iy
	call	__lladd
	ld	(ix - 3), hl
	ld	(ix - 6), de
	ld	(ix - 9), bc
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	iy, (ix + 6)
	ld	l, (iy + 2)
	ld	de, 40
	push	de
	ld	de, 0
	ld.sis	bc, 0
	call	__llshl
	pop	iy
	push	bc
	push	de
	push	hl
	ld	hl, (ix - 3)
	ld	de, (ix - 6)
	ld	bc, (ix - 9)
	call	__lladd
	ld	(ix - 3), hl
	ld	(ix - 6), de
	ld	(ix - 9), bc
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	iy, (ix + 6)
	ld	l, (iy + 3)
	ld	de, 32
	push	de
	ld	de, 0
	ld.sis	bc, 0
	call	__llshl
	pop	iy
	push	bc
	push	de
	push	hl
	ld	hl, (ix - 3)
	ld	de, (ix - 6)
	ld	bc, (ix - 9)
	call	__lladd
	ld	(ix - 3), hl
	ld	(ix - 6), de
	ld	(ix - 9), bc
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	iy, (ix + 6)
	ld	l, (iy + 4)
	ld	de, 24
	push	de
	ld	de, 0
	ld.sis	bc, 0
	call	__llshl
	pop	iy
	push	bc
	push	de
	push	hl
	ld	hl, (ix - 3)
	ld	de, (ix - 6)
	ld	bc, (ix - 9)
	call	__lladd
	ld	(ix - 3), hl
	ld	(ix - 6), de
	ld	(ix - 9), bc
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	iy, (ix + 6)
	ld	l, (iy + 5)
	ld	de, 16
	push	de
	ld	de, 0
	ld.sis	bc, 0
	call	__llshl
	pop	iy
	push	bc
	push	de
	push	hl
	ld	hl, (ix - 3)
	ld	de, (ix - 6)
	ld	bc, (ix - 9)
	call	__lladd
	ld	(ix - 3), hl
	ld	(ix - 6), de
	ld	(ix - 9), bc
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	iy, (ix + 6)
	ld	l, (iy + 6)
	ld	de, 8
	push	de
	ld	de, 0
	ld.sis	bc, 0
	call	__llshl
	pop	iy
	push	bc
	push	de
	push	hl
	ld	hl, (ix - 3)
	ld	de, (ix - 6)
	ld	bc, (ix - 9)
	call	__llor
	ld	(ix - 3), hl
	ld	(ix - 6), de
	pop	iy
	pop	iy
	pop	iy
	ld	de, 0
	ld	iy, (ix + 6)
	ld	e, (iy + 7)
	or	a, a
	sbc	hl, hl
	push	hl
	push	hl
	push	de
	ld	hl, (ix - 3)
	ld	de, (ix - 6)
	call	__llor
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_poly_move_to_engine
_poly_move_to_engine:
	ld	hl, -811
	call	__frameset
	ld	bc, -790
	lea	iy, ix
	add	iy, bc
	ld	de, (ix + 12)
	ld	c, 6
	ld	(ix - 3), bc
	ld	bc, -796
	lea	hl, ix
	add	hl, bc
	ld	(hl), iy
	lea	hl, iy + 16
	ld	bc, -793
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	ld	a, e
	and	a, 7
	ld	bc, -798
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	ld	l, e
	ld	h, d
	ld	bc, (ix - 3)
	call	__sshru
	ld.sis	bc, 7
	call	__sand
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	ld	c, 12
	ld	l, e
	ld	h, d
	call	__sshru
	ld	a, l
	and	a, 7
	ld	(ix - 3), bc
	ld	bc, -797
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	ld	a, e
	ld	bc, (ix - 3)
	ld	b, 3
	call	__bshru
	cpl
	and	a, 7
	ld	(ix - 3), de
	push	ix
	ld	de, -801
	add	ix, de
	ld	(ix), a
	pop	ix
	ld	c, 5
	ld	de, (ix - 3)
	ld	l, e
	ld	h, d
	call	__sshru
	ld	a, l
	and	a, 112
	add	a, iyl
	xor	a, 112
	ld	e, a
	ld	bc, 0
	ld	c, e
	ld	hl, (ix + 9)
	add	hl, bc
	ld	a, (hl)
	and	a, 7
	cp	a, 6
	jr	nz, BB13_4
	ld	(ix - 3), de
	ld	de, -801
	lea	hl, ix
	add	hl, de
	ld	c, (hl)
	ld	b, 4
	push	ix
	ld	de, -804
	add	ix, de
	ld	(ix), iy
	pop	ix
	ld	a, iyl
	cp	a, b
	ld	de, -798
	lea	iy, ix
	push	af
	add	iy, de
	pop	af
	ld	l, (iy)
	ld	de, (ix - 3)
	jr	nz, BB13_6
	ld	a, l
	cp	a, 7
	jr	nz, BB13_6
	ld	a, c
	call	__bshl
	add	a, 6
	ld	(ix - 3), bc
	ld	bc, -798
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	jr	BB13_5
BB13_4:
	ld	bc, -801
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	ld	b, 4
	call	__bshl
	ld	(ix - 3), bc
	ld	bc, -798
	lea	iy, ix
	add	iy, bc
	add	a, (iy)
	push	ix
	add	ix, bc
	ld	(ix), a
	pop	ix
BB13_5:
	ld	bc, (ix - 3)
	jr	BB13_11
BB13_6:
	ld	a, c
	call	__bshl
	ld	h, a
	ld	(ix - 3), de
	ld	de, -804
	lea	iy, ix
	add	iy, de
	ld	bc, (iy)
	ld	a, c
	cp	a, 4
	ld	de, (ix - 3)
	jr	nz, BB13_9
	ld	a, l
	or	a, a
	jr	nz, BB13_9
	ld	a, h
	add	a, 2
	jr	BB13_10
BB13_9:
	ld	a, h
	add	a, l
BB13_10:
	ld	bc, -798
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
BB13_11:
	ld	bc, -796
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	lea	hl, iy
	ld	bc, -807
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	ld	bc, -793
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	push	hl
	push	de
	ld	hl, (ix + 9)
	push	hl
	call	_generate_moves_from
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	push	hl
	pop	de
	ld	bc, -797
	lea	iy, ix
	add	iy, bc
	ld	e, (iy)
	push	ix
	ld	bc, -810
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	l, a
	ld	bc, 3
	call	__imulu
	push	ix
	ld	de, -796
	add	ix, de
	ld	(ix), hl
	pop	ix
	ld	de, 0
BB13_12:
	ld	(ix - 3), bc
	ld	bc, -796
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	or	a, a
	sbc	hl, de
	ld	bc, (ix - 3)
	jp	z, BB13_20
	ld	(ix - 3), bc
	ld	bc, -793
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	push	ix
	ld	bc, -804
	add	ix, bc
	ld	(ix), de
	pop	ix
	add	iy, de
	ld	a, (iy + 1)
	push	ix
	ld	de, -798
	add	ix, de
	ld	l, (ix)
	pop	ix
	cp	a, l
	ld	bc, (ix - 3)
	jp	nz, BB13_19
	ld	de, -801
	lea	hl, ix
	add	hl, de
	ld	(hl), iy
	ld	l, (iy + 2)
	ld	de, -797
	lea	iy, ix
	add	iy, de
	ld	a, (iy)
	or	a, a
	jr	nz, BB13_16
	bit	3, l
	ld	de, -801
	lea	hl, ix
	push	af
	add	hl, de
	pop	af
	ld	iy, (hl)
	jr	z, BB13_18
	jp	BB13_19
BB13_16:
	bit	3, l
	ld	de, -801
	lea	iy, ix
	push	af
	add	iy, de
	pop	af
	ld	iy, (iy)
	jp	z, BB13_19
	ld	a, l
	and	a, 48
	ld	hl, _poly_move_to_engine.promo_flags
	ld	(ix - 3), bc
	ld	bc, -810
	lea	iy, ix
	add	iy, bc
	ld	de, (iy)
	add	hl, de
	ld	l, (hl)
	cp	a, l
	ld	bc, (ix - 3)
	jp	nz, BB13_19
BB13_18:
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	bc, -801
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	bc, -807
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, (ix + 9)
	push	hl
	call	_board_make
	pop	hl
	pop	hl
	pop	hl
	ld	iy, (ix + 9)
	lea	hl, iy
	ld	de, 422
	add	hl, de
	ld	c, (hl)
	ld	a, c
	xor	a, d
	ld	de, 0
	ld	e, a
	lea	hl, iy
	add	hl, de
	ld	de, 420
	add	hl, de
	ld	a, (hl)
	ld	l, c
	push	hl
	ld	l, a
	push	hl
	push	iy
	call	_is_square_attacked
	ld	bc, -811
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	pop	hl
	pop	hl
	pop	hl
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	bc, -801
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	bc, -807
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, (ix + 9)
	push	hl
	call	_board_unmake
	ld	bc, 3
	pop	hl
	pop	hl
	pop	hl
	ld	de, -811
	lea	hl, ix
	add	hl, de
	ld	a, (hl)
	or	a, a
	jr	z, BB13_22
BB13_19:
	ld	de, -804
	lea	hl, ix
	add	hl, de
	ld	hl, (hl)
	add	hl, bc
	ex	de, hl
	jp	BB13_12
BB13_20:
	ld	iy, (ix + 6)
	ld	(iy), -1
	ld	(iy + 1), -1
	ld	(iy + 2), 0
BB13_21:
	lea	hl, iy
	ld	sp, ix
	pop	ix
	ret
BB13_22:
	ld	bc, -793
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	push	ix
	ld	bc, -804
	add	ix, bc
	ld	de, (ix)
	pop	ix
	add	iy, de
	ld	a, (iy)
	ld	hl, (ix + 6)
	push	hl
	pop	de
	ld	(hl), a
	ld	a, (iy + 1)
	lea	hl, iy
	push	de
	pop	iy
	ld	(iy + 1), a
	push	hl
	pop	iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	jr	BB13_21
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_book_get_info
_book_get_info:
	call	__frameset0
	ld	hl, (ix + 6)
	ld	de, (ix + 9)
	ld	iy, (ix + 12)
	ld	a, (_book_ready)
	and	a, 1
	ld	(hl), a
	ld	a, (_num_segments)
	ex	de, hl
	ld	(hl), a
	ld	hl, (_total_entries)
	ld	a, (_total_entries+3)
	ld	(iy), hl
	ld	(iy + 3), a
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_book_close
_book_close:
	xor	a, a
	sbc	hl, hl
	ld	(_book_ready), a
	ld	(_num_segments), a
	ld	(_total_entries), hl
	ld	(_total_entries+3), a
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_book_get_tier_name
_book_get_tier_name:
	ld	a, (_detected_tier)
	cp	a, 5
	jr	nc, BB16_2
	ld	iy, _switch.table.book_get_tier_name
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	bc, 3
	call	__imulu
	push	hl
	pop	de
	add	iy, de
	ld	hl, (iy)
	ret
BB16_2:
	ld	hl, _.str.7.63
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_init
_engine_init:
	call	__frameset0
	ld	iy, (ix + 6)
	lea	hl, iy
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	nz, BB17_2
	ld	hl, 0
	ld	(_engine_hooks), hl
	jr	BB17_3
BB17_2:
	ld	hl, _engine_hooks
	ld	a, (iy)
	ld	(hl), a
	ld	a, (iy + 1)
	ld	(_engine_hooks+1), a
	ld	a, (iy + 2)
	ld	(_engine_hooks+2), a
BB17_3:
	call	_search_init
	ld	hl, _engine_board
	push	hl
	call	_board_init
	pop	hl
	pop	ix
	jp	_book_init
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_new_game
_engine_new_game:
	call	_search_init
	ld	hl, _engine_board
	push	hl
	call	_board_startpos
	pop	hl
	ld	hl, (_engine_board+431)
	push	hl
	call	_search_history_push
	pop	hl
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_set_position
_engine_set_position:
	call	__frameset0
	ld	iy, (ix + 6)
	ld	a, (iy + 64)
	ld	e, (iy + 65)
	ld	c, (iy + 66)
	ld	d, (iy + 67)
	ld	b, (iy + 68)
	ld	hl, (iy + 69)
	push	hl
	ld	l, b
	push	hl
	ld	l, d
	push	hl
	ld	l, c
	push	hl
	ld	l, e
	push	hl
	ld	l, a
	push	hl
	push	iy
	ld	hl, _engine_board
	push	hl
	call	_board_set_from_ui
	ld	hl, 24
	add	hl, sp
	ld	sp, hl
	ld.sis	hl, 0
	ld	e, l
	ld	d, h
	ld	hl, _pos_history_count
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	hl, _pos_history_irreversible
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	hl, (_engine_board+431)
	ld	(ix + 6), hl
	pop	ix
	jp	_search_history_push
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_get_position
_engine_get_position:
	ld	hl, -9
	call	__frameset
	ld	iy, (ix + 6)
	ld	hl, _engine_board
	ld	(ix - 3), hl
	ld	de, 0
	ld	bc, 8
	ld	(ix - 6), iy
BB20_1:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jr	z, BB20_10
	ld	(ix - 9), de
	ld	bc, 0
BB20_3:
	push	bc
	pop	hl
	ld	de, 8
	or	a, a
	sbc	hl, de
	jr	z, BB20_9
	ld	iy, (ix - 3)
	add	iy, bc
	ld	l, (iy)
	ld	a, l
	and	a, 7
	ld	h, a
	neg
	ld	iyl, a
	ld	a, l
	cp	a, 0
	call	pe, __setflag
	jp	m, BB20_6
	ex	de, hl
	ld	iyl, d
	ex	de, hl
BB20_6:
	ld	a, l
	or	a, a
	ld	a, 0
	jr	z, BB20_8
	ld	a, iyl
BB20_8:
	ld	iy, (ix - 6)
	add	iy, bc
	ld	(iy), a
	inc	bc
	jr	BB20_3
BB20_9:
	ld	de, (ix - 9)
	inc	de
	ld	iy, (ix - 3)
	lea	iy, iy + 16
	ld	(ix - 3), iy
	ld	iy, (ix - 6)
	lea	iy, iy + 8
	ld	(ix - 6), iy
	ld	bc, 8
	jr	BB20_1
BB20_10:
	ld	a, (_engine_board+422)
	or	a, a
	ld	h, -1
	ld	a, 1
	jr	z, BB20_12
	ld	a, h
BB20_12:
	ld	iy, (ix + 6)
	ld	(iy + 64), a
	ld	a, (_engine_board+423)
	ld	(iy + 65), a
	ld	a, (_engine_board+424)
	ld	l, a
	cp	a, -1
	jr	z, BB20_14
	ld	c, 0
	jr	BB20_15
BB20_14:
	ld	c, -1
BB20_15:
	ld	a, l
	ld	b, 4
	call	__bshru
	ld	e, a
	ld	a, l
	and	a, 7
	bit	0, c
	ld	l, h
	jr	nz, BB20_17
	ld	l, e
BB20_17:
	bit	0, c
	jr	nz, BB20_19
	ld	h, a
BB20_19:
	ld	iy, (ix + 6)
	ld	(iy + 66), l
	ld	(iy + 67), h
	ld	a, (_engine_board+425)
	ld	(iy + 68), a
	ld	hl, _engine_board+426
	ld	hl, (hl)
	ld	(iy + 69), l
	ld	(iy + 70), h
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_get_moves_from
_engine_get_moves_from:
	ld	hl, -807
	call	__frameset
	ld	de, -790
	lea	iy, ix
	add	iy, de
	ld	c, (ix + 9)
	ld	b, 4
	xor	a, a
	dec	de
	lea	hl, ix
	add	hl, de
	ld	(hl), a
	lea	hl, iy + 16
	lea	de, iy
	ld	(ix - 3), bc
	ld	bc, -794
	lea	iy, ix
	add	iy, bc
	ld	(iy), de
	ld	a, (ix + 6)
	ld	bc, (ix - 3)
	call	__bshl
	add	a, c
	ld	c, a
	push	ix
	ld	de, -797
	add	ix, de
	ld	(ix), hl
	pop	ix
	push	hl
	push	bc
	ld	hl, _engine_board
	push	hl
	call	_generate_moves_from
	ld	iy, 0
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
BB21_1:
	push	bc
	pop	hl
	lea	de, iy
	or	a, a
	sbc	hl, de
	jp	z, BB21_6
	ld	de, -791
	lea	hl, ix
	add	hl, de
	ld	a, (hl)
	ld	l, (ix + 15)
	cp	a, l
	jp	nc, BB21_6
	ld	de, -803
	lea	hl, ix
	add	hl, de
	ld	(hl), bc
	lea	de, iy
	lea	bc, iy
	ld	(ix - 3), bc
	ld	bc, -797
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	add	iy, de
	push	hl
	push	hl
	ld	bc, (ix - 3)
	push	ix
	ld	de, -800
	add	ix, de
	ld	(ix), bc
	pop	ix
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	a, (iy)
	push	de
	pop	hl
	ld	(hl), a
	ld	a, (iy + 1)
	lea	hl, iy
	push	de
	pop	iy
	ld	(iy + 1), a
	push	hl
	pop	iy
	ld	bc, -806
	lea	hl, ix
	add	hl, bc
	ld	(hl), iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	push	ix
	ld	bc, -794
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	call	_board_make
	pop	hl
	pop	hl
	pop	hl
	call	_board_is_legal
	or	a, a
	jp	z, BB21_5
	or	a, a
	sbc	hl, hl
	ld	de, -791
	lea	iy, ix
	add	iy, de
	ld	a, (iy)
	ld	l, a
	inc	a
	push	ix
	add	ix, de
	ld	(ix), a
	pop	ix
	ld	bc, 5
	call	__imulu
	push	hl
	pop	de
	ld	hl, (ix + 12)
	add	hl, de
	ld	(ix - 3), bc
	push	ix
	ld	bc, -800
	add	ix, bc
	ld	de, (ix)
	pop	ix
	push	ix
	ld	bc, -797
	add	ix, bc
	ld	iy, (ix)
	pop	ix
	add	iy, de
	ld	e, (iy)
	ld	bc, (ix - 3)
	ld	c, (iy + 1)
	ld	a, (iy + 2)
	ld	(ix - 3), bc
	ld	bc, -807
	lea	iy, ix
	add	iy, bc
	ld	(iy), a
	ld	a, e
	ld	bc, (ix - 3)
	ld	b, 4
	call	__bshru
	ld	d, a
	ld	a, e
	and	a, 7
	ld	e, a
	ld	a, c
	call	__bshru
	ld	b, a
	ld	a, c
	and	a, 7
	push	hl
	pop	iy
	ld	(iy), d
	ld	(iy + 1), e
	ld	(iy + 2), b
	ld	(iy + 3), a
	ld	bc, -807
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	ld	(iy + 4), a
BB21_5:
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	bc, -806
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
	push	de
	pop	hl
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	bc, -794
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
	ld	de, 3
	ld	bc, -800
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	add	iy, de
	push	ix
	ld	de, -803
	add	ix, de
	ld	bc, (ix)
	pop	ix
	jp	BB21_1
BB21_6:
	ld	bc, -791
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_board_is_legal
_board_is_legal:
	ld	iy, _engine_board
	ld	a, (_engine_board+422)
	ld	e, a
	xor	a, 1
	ld	bc, 0
	ld	c, a
	ld	hl, _engine_board+420
	add	hl, bc
	ld	a, (hl)
	push	de
	ld	l, a
	push	hl
	push	iy
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jr	z, BB22_2
	ld	a, 0
	ret
BB22_2:
	ld	a, 1
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_get_all_moves
_engine_get_all_moves:
	ld	hl, -807
	call	__frameset
	ld	bc, -790
	lea	iy, ix
	add	iy, bc
	ld	hl, _engine_board
	xor	a, a
	push	ix
	dec	bc
	add	ix, bc
	ld	(ix), a
	pop	ix
	lea	de, iy + 16
	lea	bc, iy
	ld	(ix - 3), de
	ld	de, -794
	lea	iy, ix
	add	iy, de
	ld	(iy), bc
	ld	bc, 0
	push	bc
	ld	de, (ix - 3)
	push	ix
	ld	bc, -797
	add	ix, bc
	ld	(ix), de
	pop	ix
	push	de
	push	hl
	call	_generate_moves
	ld	iy, 0
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
BB23_1:
	push	bc
	pop	hl
	lea	de, iy
	or	a, a
	sbc	hl, de
	jp	z, BB23_6
	ld	de, -791
	lea	hl, ix
	add	hl, de
	ld	a, (hl)
	ld	l, (ix + 9)
	cp	a, l
	jp	nc, BB23_6
	ld	de, -803
	lea	hl, ix
	add	hl, de
	ld	(hl), bc
	lea	de, iy
	lea	bc, iy
	ld	(ix - 3), bc
	ld	bc, -797
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	add	iy, de
	push	hl
	push	hl
	ld	bc, (ix - 3)
	push	ix
	ld	de, -800
	add	ix, de
	ld	(ix), bc
	pop	ix
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	a, (iy)
	push	de
	pop	hl
	ld	(hl), a
	ld	a, (iy + 1)
	lea	hl, iy
	push	de
	pop	iy
	ld	(iy + 1), a
	push	hl
	pop	iy
	ld	bc, -806
	lea	hl, ix
	add	hl, bc
	ld	(hl), iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	push	ix
	ld	bc, -794
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	call	_board_make
	pop	hl
	pop	hl
	pop	hl
	call	_board_is_legal
	or	a, a
	jp	z, BB23_5
	or	a, a
	sbc	hl, hl
	ld	de, -791
	lea	iy, ix
	add	iy, de
	ld	a, (iy)
	ld	l, a
	inc	a
	push	ix
	add	ix, de
	ld	(ix), a
	pop	ix
	ld	bc, 5
	call	__imulu
	push	hl
	pop	de
	ld	hl, (ix + 6)
	add	hl, de
	ld	(ix - 3), bc
	push	ix
	ld	bc, -800
	add	ix, bc
	ld	de, (ix)
	pop	ix
	push	ix
	ld	bc, -797
	add	ix, bc
	ld	iy, (ix)
	pop	ix
	add	iy, de
	ld	e, (iy)
	ld	bc, (ix - 3)
	ld	c, (iy + 1)
	ld	a, (iy + 2)
	ld	(ix - 3), bc
	ld	bc, -807
	lea	iy, ix
	add	iy, bc
	ld	(iy), a
	ld	a, e
	ld	bc, (ix - 3)
	ld	b, 4
	call	__bshru
	ld	d, a
	ld	a, e
	and	a, 7
	ld	e, a
	ld	a, c
	call	__bshru
	ld	b, a
	ld	a, c
	and	a, 7
	push	hl
	pop	iy
	ld	(iy), d
	ld	(iy + 1), e
	ld	(iy + 2), b
	ld	(iy + 3), a
	ld	bc, -807
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	ld	(iy + 4), a
BB23_5:
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	bc, -806
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
	push	de
	pop	hl
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	bc, -794
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
	ld	de, 3
	ld	bc, -800
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	add	iy, de
	push	ix
	ld	de, -803
	add	ix, de
	ld	bc, (ix)
	pop	ix
	jp	BB23_1
BB23_6:
	ld	bc, -791
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_is_legal_move
_engine_is_legal_move:
	ld	hl, -799
	call	__frameset
	ld	b, 4
	xor	a, a
	ld	de, -794
	lea	hl, ix
	add	hl, de
	ld	(hl), a
	lea	hl, ix - 22
	ld	de, -798
	lea	iy, ix
	add	iy, de
	ld	(iy), hl
	ld	de, -790
	lea	hl, ix
	add	hl, de
	ld	a, (ix + 6)
	ld	e, (ix + 7)
	ld	c, (ix + 8)
	ld	d, (ix + 9)
	ld	iyl, d
	ld	d, (ix + 10)
	ld	(ix - 3), bc
	push	ix
	ld	bc, -799
	add	ix, bc
	ld	(ix), d
	pop	ix
	ld	bc, (ix - 3)
	call	__bshl
	add	a, e
	ld	e, a
	ld	a, c
	call	__bshl
	add	a, iyl
	ld	(ix - 3), bc
	push	ix
	ld	bc, -795
	add	ix, bc
	ld	(ix), a
	pop	ix
	push	ix
	ld	bc, -793
	add	ix, bc
	ld	(ix), hl
	pop	ix
	push	hl
	push	de
	ld	hl, _engine_board
	push	hl
	ld	bc, (ix - 3)
	call	_generate_moves_from
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	bc, 3
	call	__imulu
	ld	bc, 0
	push	hl
	pop	de
BB24_1:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jp	z, BB24_6
	ld	(ix - 3), de
	ld	de, -793
	lea	hl, ix
	add	hl, de
	ld	iy, (hl)
	add	iy, bc
	ld	a, (iy + 1)
	push	ix
	ld	de, -795
	add	ix, de
	ld	l, (ix)
	pop	ix
	cp	a, l
	ld	de, (ix - 3)
	jr	nz, BB24_4
	ld	a, (iy + 2)
	ld	(ix - 3), bc
	ld	bc, -799
	lea	hl, ix
	add	hl, bc
	xor	a, (hl)
	and	a, 56
	or	a, a
	ld	bc, (ix - 3)
	jr	z, BB24_5
BB24_4:
	push	bc
	pop	hl
	ld	bc, 3
	add	hl, bc
	push	hl
	pop	bc
	jr	BB24_1
BB24_5:
	ld	de, -793
	lea	hl, ix
	add	hl, de
	ld	hl, (hl)
	add	hl, bc
	ld	bc, -793
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	bc, -798
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	call	_board_make
	pop	hl
	pop	hl
	pop	hl
	call	_board_is_legal
	ld	bc, -794
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	push	ix
	inc	bc
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	bc, -798
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
BB24_6:
	ld	bc, -794
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_get_move_effects
_engine_get_move_effects:
	call	__frameset0
	ld	iy, (ix + 12)
	ld	e, 0
	ld	(iy), e
	ld	(iy + 5), e
	ld	l, (ix + 10)
	bit	1, l
	jp	z, BB25_7
	ld	(iy), 1
	ld	a, (ix + 6)
	ld	(iy + 1), a
	ld	(iy + 3), a
	ld	c, (ix + 9)
	ld	a, (ix + 7)
	cp	a, c
	sbc	a, a
	bit	0, a
	jr	z, BB25_3
	ld	e, 7
BB25_3:
	bit	0, a
	jr	nz, BB25_5
	ld	a, 3
	jr	BB25_6
BB25_5:
	ld	a, 5
BB25_6:
	ld	(iy + 2), e
	ld	(iy + 4), a
BB25_7:
	bit	2, l
	jr	z, BB25_9
	ld	(iy + 5), 1
	ld	a, (ix + 6)
	ld	(iy + 6), a
	ld	a, (ix + 9)
	ld	(iy + 7), a
BB25_9:
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_make_move
_engine_make_move:
	ld	hl, -810
	call	__frameset
	ld	de, -790
	lea	iy, ix
	add	iy, de
	ld	b, 4
	lea	hl, iy + 16
	push	ix
	ld	de, -804
	add	ix, de
	ld	(ix), iy
	pop	ix
	lea	de, iy
	ld	(ix - 3), bc
	ld	bc, -800
	lea	iy, ix
	add	iy, bc
	ld	(iy), de
	ld	a, (ix + 6)
	ld	e, (ix + 7)
	ld	bc, (ix - 3)
	ld	c, (ix + 8)
	ld	d, (ix + 9)
	ld	iyl, d
	ld	d, (ix + 10)
	ld	(ix - 3), bc
	push	ix
	ld	bc, -796
	add	ix, bc
	ld	(ix), d
	pop	ix
	ld	bc, (ix - 3)
	call	__bshl
	add	a, e
	ld	e, a
	ld	a, c
	call	__bshl
	add	a, iyl
	ld	(ix - 3), bc
	push	ix
	ld	bc, -797
	add	ix, bc
	ld	(ix), a
	pop	ix
	push	ix
	ld	bc, -793
	add	ix, bc
	ld	(ix), hl
	pop	ix
	push	hl
	push	de
	ld	hl, _engine_board
	push	hl
	ld	bc, (ix - 3)
	call	_generate_moves_from
	ld	iy, 0
	ld	e, a
	pop	hl
	pop	hl
	pop	hl
	ld	bc, -796
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	and	a, 48
	push	ix
	ld	bc, -801
	add	ix, bc
	ld	(ix), a
	pop	ix
	or	a, a
	sbc	hl, hl
	ld	l, e
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
BB26_1:
	push	bc
	pop	hl
	lea	de, iy
	or	a, a
	sbc	hl, de
	jp	z, BB26_8
	lea	de, iy
	lea	hl, iy
	ld	(ix - 3), bc
	ld	bc, -793
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	add	iy, de
	push	ix
	ld	de, -796
	add	ix, de
	ld	(ix), iy
	pop	ix
	ld	a, (iy + 1)
	push	hl
	pop	iy
	dec	de
	lea	hl, ix
	add	hl, de
	ld	l, (hl)
	cp	a, l
	ld	bc, (ix - 3)
	jp	nz, BB26_7
	lea	de, iy
	ld	(ix - 3), bc
	ld	bc, -807
	lea	hl, ix
	add	hl, bc
	ld	(hl), iy
	ld	bc, -793
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	add	iy, de
	ld	l, (iy + 2)
	ld	de, -807
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	ld	a, l
	and	a, 48
	bit	3, l
	ld	bc, (ix - 3)
	jr	z, BB26_5
	ld	de, -801
	lea	hl, ix
	add	hl, de
	ld	l, (hl)
	cp	a, l
	jp	nz, BB26_7
BB26_5:
	ld	de, -810
	lea	hl, ix
	add	hl, de
	ld	(hl), bc
	push	hl
	push	hl
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	bc, -796
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy)
	push	de
	pop	hl
	ld	(hl), a
	ld	a, (iy + 1)
	lea	hl, iy
	push	de
	pop	iy
	ld	(iy + 1), a
	push	hl
	pop	iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	ld	bc, -800
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	call	_board_make
	pop	hl
	pop	hl
	pop	hl
	call	_board_is_legal
	or	a, a
	jr	nz, BB26_10
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	bc, -796
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
	push	de
	pop	hl
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	bc, -800
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
	ld	de, -807
	lea	hl, ix
	add	hl, de
	ld	iy, (hl)
	push	ix
	ld	de, -810
	add	ix, de
	ld	bc, (ix)
	pop	ix
BB26_7:
	ld	de, 3
	add	iy, de
	jp	BB26_1
BB26_8:
	xor	a, a
BB26_9:
	ld	sp, ix
	pop	ix
	ret
BB26_10:
	ld	bc, -804
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	ld	a, (iy + 14)
	and	a, 7
	cp	a, 1
	jr	z, BB26_12
	ld	a, (iy + 15)
	and	a, 1
	bit	0, a
	jr	z, BB26_13
BB26_12:
	ld	hl, _pos_history_count
	ld	hl, (hl)
	ld	iy, _pos_history_irreversible
	ld	(iy), l
	ld	(iy + 1), h
BB26_13:
	ld	hl, (_engine_board+431)
	push	hl
	call	_search_history_push
	pop	hl
	call	_compute_status
	jr	BB26_9
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_compute_status
_compute_status:
	ld	hl, -806
	call	__frameset
	ld	iy, 0
	ld	a, (_engine_board+425)
	cp	a, 100
	jr	c, BB27_2
	ld	b, 4
	jp	BB27_22
BB27_2:
	ld	de, -796
	lea	hl, ix
	add	hl, de
	ld	(hl), iy
	ld	b, 6
	ld	a, (_engine_board+416)
	ld	c, a
	ld	a, (_engine_board+417)
	ld	de, -793
	lea	iy, ix
	add	iy, de
	ld	(iy), a
	ld	a, c
	cp	a, 1
	jr	nz, BB27_4
	ld	de, -793
	lea	hl, ix
	add	hl, de
	ld	a, (hl)
	cp	a, 1
	jp	z, BB27_22
BB27_4:
	ld	a, c
	cp	a, 1
	jp	nz, BB27_9
	ld	de, -793
	lea	hl, ix
	add	hl, de
	ld	a, (hl)
	cp	a, 2
	jp	nz, BB27_9
	or	a, a
	sbc	hl, hl
	ex	de, hl
BB27_7:
	ld	(ix - 3), bc
	ld	bc, -802
	lea	hl, ix
	add	hl, bc
	ld	(hl), de
	ex	de, hl
	ld	de, 2
	or	a, a
	sbc	hl, de
	ld	bc, (ix - 3)
	jr	z, BB27_9
	ld	hl, _engine_board+272
	ld	(ix - 3), bc
	ld	bc, -802
	lea	iy, ix
	add	iy, bc
	ld	de, (iy)
	add	hl, de
	push	ix
	ld	bc, -805
	add	ix, bc
	ld	(ix), hl
	pop	ix
	or	a, a
	sbc	hl, hl
	push	ix
	ld	bc, -799
	add	ix, bc
	ld	(ix), hl
	pop	ix
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	bc, (ix - 3)
	ld	a, c
	ld	(ix - 3), de
	push	ix
	ld	de, -805
	add	ix, de
	ld	iy, (ix)
	pop	ix
	ld	l, (iy)
	ld	de, -799
	lea	iy, ix
	add	iy, de
	ld	(iy), hl
	ld	hl, _engine_board
	ld	iyl, b
	push	ix
	add	ix, de
	ld	bc, (ix)
	pop	ix
	add	hl, bc
	ld	b, iyl
	ld	c, a
	ld	a, (hl)
	and	a, 6
	ld	de, (ix - 3)
	inc	de
	cp	a, 2
	jp	nz, BB27_7
	jp	BB27_22
BB27_9:
	ld	a, c
	cp	a, 2
	jr	nz, BB27_14
	ld	de, -793
	lea	hl, ix
	add	hl, de
	ld	a, (hl)
	cp	a, 1
	jr	nz, BB27_14
	ld	iy, _engine_board+256
BB27_12:
	ld	de, -796
	lea	hl, ix
	add	hl, de
	ld	hl, (hl)
	ld	de, 2
	or	a, a
	sbc	hl, de
	jr	z, BB27_14
	lea	hl, iy
	ld	(ix - 3), bc
	ld	bc, -796
	lea	iy, ix
	add	iy, bc
	ld	de, (iy)
	add	hl, de
	ld	de, 0
	ld	e, (hl)
	ld	hl, _engine_board
	ld	iy, _engine_board+256
	add	hl, de
	ld	a, (hl)
	and	a, 6
	ld	de, -796
	lea	hl, ix
	add	hl, de
	ld	hl, (hl)
	inc	hl
	push	ix
	add	ix, de
	ld	(ix), hl
	pop	ix
	cp	a, 2
	ld	bc, (ix - 3)
	jr	nz, BB27_12
	jp	BB27_22
BB27_14:
	ld	bc, -790
	lea	iy, ix
	add	iy, bc
	lea	hl, iy + 16
	push	ix
	ld	bc, -793
	add	ix, bc
	ld	(ix), hl
	pop	ix
	lea	hl, iy
	ld	bc, -796
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	ld	a, (_engine_board+422)
	ld	de, 0
	ld	e, a
	ld	hl, _engine_board+420
	add	hl, de
	ld	l, (hl)
	xor	a, 1
	ld	e, a
	push	de
	push	hl
	ld	hl, _engine_board
	push	hl
	call	_is_square_attacked
	ld	bc, -799
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	push	hl
	ld	bc, -793
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	push	hl
	ld	hl, _engine_board
	push	hl
	call	_generate_moves
	pop	hl
	pop	hl
	pop	hl
	ld	de, 0
	ld	e, a
	inc	de
BB27_15:
	dec	de
	push	de
	pop	hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB27_19
	ld	bc, -793
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	lea	hl, iy + 3
	ld	bc, -805
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	bc, -793
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	bc, -796
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	ld	bc, -802
	lea	hl, ix
	add	hl, bc
	ld	(hl), de
	call	_board_make
	pop	hl
	pop	hl
	pop	hl
	call	_board_is_legal
	ld	bc, -806
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	push	ix
	ld	bc, -793
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	bc, -796
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	call	_board_unmake
	ld	bc, -802
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
	pop	hl
	pop	hl
	pop	hl
	ld	bc, -806
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	or	a, a
	inc	bc
	lea	iy, ix
	push	af
	add	iy, bc
	pop	af
	ld	hl, (iy)
	push	ix
	ld	bc, -793
	push	af
	add	ix, bc
	pop	af
	ld	(ix), hl
	pop	ix
	jp	z, BB27_15
	ld	bc, -799
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	or	a, a
	jr	nz, BB27_21
	ld	b, 0
	jr	BB27_22
BB27_19:
	ld	de, -799
	lea	hl, ix
	add	hl, de
	ld	a, (hl)
	or	a, a
	ld	b, 3
	jr	z, BB27_22
	ld	b, 2
	jr	BB27_22
BB27_21:
	ld	b, 1
BB27_22:
	ld	a, b
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_set_max_nodes
_engine_set_max_nodes:
	call	__frameset0
	ld	hl, (ix + 6)
	ld	a, (ix + 9)
	ld	(_engine_max_nodes), hl
	ld	(_engine_max_nodes+3), a
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_set_use_book
_engine_set_use_book:
	call	__frameset0
	ld	a, (ix + 6)
	ld	(_engine_use_book), a
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_set_book_max_ply
_engine_set_book_max_ply:
	call	__frameset0
	ld	a, (ix + 6)
	ld	(_engine_book_max_ply), a
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_set_eval_noise
_engine_set_eval_noise:
	call	__frameset0
	ld	hl, (ix + 6)
	ld	(_engine_eval_noise), hl
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_set_move_variance
_engine_set_move_variance:
	call	__frameset0
	ld	hl, (ix + 6)
	ld	(_engine_move_variance), hl
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_think
_engine_think:
	ld	hl, -32
	call	__frameset
	ld	de, _engine_board
	ld	a, (_engine_use_book)
	or	a, a
	jr	z, BB33_4
	ld	a, (_engine_book_max_ply)
	ld	l, a
	ld	h, 0
	ld	a, l
	or	a, a
	jr	z, BB33_3
	ld	iy, _engine_board+426
	ld	bc, (iy)
	or	a, a
	sbc.sis	hl, bc
	jr	c, BB33_4
BB33_3:
	pea	ix - 21
	push	de
	call	_book_probe
	ld	de, _engine_board
	pop	hl
	pop	hl
	or	a, a
	jr	nz, BB33_7
BB33_4:
	ld	l, (ix + 9)
	ld	c, (ix + 15)
	xor	a, a
	ld	(_last_was_book), a
	ld	(ix - 18), l
	ld	hl, (ix + 12)
	ld	(ix - 17), hl
	ld	(ix - 14), c
	ld	hl, (_engine_max_nodes)
	ld	a, (_engine_max_nodes+3)
	ld	(ix - 13), hl
	ld	(ix - 10), a
	ld	hl, (_engine_hooks)
	ld	(ix - 9), hl
	ld	hl, (_engine_eval_noise)
	ld	(ix - 6), hl
	ld	hl, (_engine_move_variance)
	ld	(ix - 3), hl
	pea	ix - 18
	push	de
	pea	ix - 32
	call	_search_go
	pop	hl
	pop	hl
	pop	hl
	ld	e, (ix - 32)
	ld	a, e
	cp	a, -1
	jr	nz, BB33_6
	ld	iy, (ix + 6)
	ld	(iy), -1
	or	a, a
	sbc	hl, hl
	ld	(iy + 1), hl
	ld	(iy + 4), h
	jr	BB33_9
BB33_6:
	ld	l, (ix - 31)
	ld	c, (ix - 30)
	jr	BB33_8
BB33_7:
	ld	a, 1
	ld	(_last_was_book), a
	ld	e, (ix - 21)
	ld	l, (ix - 20)
	ld	c, (ix - 19)
BB33_8:
	ld	a, e
	ld	b, 4
	call	__bshru
	ld	iy, (ix + 6)
	ld	(iy), a
	ld	a, e
	and	a, 7
	ld	(iy + 1), a
	ld	a, l
	call	__bshru
	ld	(iy + 2), a
	ld	a, l
	and	a, 7
	ld	(iy + 3), a
	ld	(iy + 4), c
BB33_9:
	lea	hl, iy
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_bench
_engine_bench:
	ld	hl, -29
	call	__frameset
	ld	a, (ix + 9)
	ld	bc, (ix + 12)
	ld	l, (ix + 15)
	ld	de, 0
	ld	iy, _engine_board
	ld	(ix - 18), a
	ld	(ix - 17), bc
	ld	(ix - 14), l
	ld	(ix - 13), de
	ld	(ix - 10), d
	ld	hl, (_engine_hooks)
	ld	(ix - 9), hl
	ld	(ix - 6), de
	ld	(ix - 3), de
	pea	ix - 18
	push	iy
	pea	ix - 29
	call	_search_go
	pop	hl
	pop	hl
	pop	hl
	ld	a, (ix - 23)
	ld	hl, (ix - 22)
	ld	e, (ix - 19)
	ld	iy, (ix + 6)
	ld	(iy), hl
	ld	(iy + 3), e
	ld	(iy + 4), a
	lea	hl, iy
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_get_status
_engine_get_status:
	jp	_compute_status
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_in_check
_engine_in_check:
	ld	bc, _engine_board
	ld	a, (_engine_board+422)
	ld	de, 0
	ld	e, a
	ld	hl, _engine_board+420
	add	hl, de
	ld	l, (hl)
	xor	a, 1
	ld	e, a
	push	de
	push	hl
	push	bc
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_get_book_info
_engine_get_book_info:
	call	__frameset0
	ld	iy, (ix + 6)
	ld	a, (_book_ready)
	and	a, 1
	ld	(iy), a
	ld	a, (_num_segments)
	ld	(iy + 1), a
	ld	hl, (_total_entries)
	ld	a, (_total_entries+3)
	ld	(iy + 2), hl
	ld	(iy + 5), a
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_last_move_was_book
_engine_last_move_was_book:
	ld	a, (_last_was_book)
	and	a, 1
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_cleanup
_engine_cleanup:
	xor	a, a
	sbc	hl, hl
	ld	(_book_ready), a
	ld	(_num_segments), a
	ld	(_total_entries), hl
	ld	(_total_entries+3), a
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_evaluate
_evaluate:
	ld	hl, -70
	call	__frameset
	ld	bc, (ix + 6)
	xor	a, a
	ld	(ix - 32), a
	ld	de, 436
	push	bc
	pop	hl
	add	hl, de
	ld	iy, (hl)
	ld	a, iyh
	ld	l, a
	rlc	l
	sbc	hl, hl
	push	hl
	pop	de
	ld	d, a
	ld	e, iyl
	ld	iy, 438
	push	bc
	pop	hl
	lea	bc, iy
	add	hl, bc
	ld	iy, (hl)
	ld	a, iyh
	ld	l, a
	rlc	l
	sbc	hl, hl
	push	hl
	pop	bc
	ld	b, a
	ld	c, iyl
	ex	de, hl
	or	a, a
	sbc	hl, bc
	ld	(ix - 22), hl
	ld	de, 440
	ld	iy, (ix + 6)
	lea	hl, iy
	add	hl, de
	ld	bc, (hl)
	ld	a, b
	ld	l, a
	rlc	l
	sbc	hl, hl
	push	hl
	pop	de
	ld	d, a
	ld	e, c
	ld	bc, 442
	lea	hl, iy
	add	hl, bc
	ld	iy, (hl)
	ld	a, iyh
	ld	l, a
	rlc	l
	sbc	hl, hl
	push	hl
	pop	bc
	ld	b, a
	ld	c, iyl
	ex	de, hl
	or	a, a
	sbc	hl, bc
	push	hl
	pop	iy
	ld	de, 418
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	ld	bc, (ix - 22)
	cp	a, 2
	ccf
	sbc	a, a
	push	bc
	pop	hl
	ld	de, 19
	add	hl, de
	ld	(ix - 25), iy
	ld	de, 58
	add	iy, de
	ld	(ix - 19), iy
	bit	0, a
	jr	nz, BB40_2
	ld	de, (ix - 25)
	ld	(ix - 19), de
BB40_2:
	bit	0, a
	jr	nz, BB40_4
	push	bc
	pop	hl
BB40_4:
	ld	de, 419
	ld	iy, (ix + 6)
	add	iy, de
	ld	a, (iy)
	cp	a, 2
	ccf
	sbc	a, a
	push	hl
	pop	iy
	ld	de, -19
	add	hl, de
	ld	(ix - 22), hl
	ld	bc, (ix - 19)
	push	bc
	pop	hl
	ld	de, -58
	add	hl, de
	bit	0, a
	jr	nz, BB40_6
	push	bc
	pop	hl
BB40_6:
	ld	(ix - 19), hl
	bit	0, a
	jr	nz, BB40_8
	ld	(ix - 22), iy
BB40_8:
	ld	de, 422
	ld	iy, (ix + 6)
	lea	hl, iy
	add	hl, de
	ld	a, (hl)
	or	a, a
	ld	(ix - 35), hl
	jr	z, BB40_10
	ld	a, 0
	jr	BB40_11
BB40_10:
	ld	a, -1
BB40_11:
	bit	0, a
	jr	nz, BB40_13
	ld	de, -9
	jr	BB40_14
BB40_13:
	ld	de, 9
BB40_14:
	ld	bc, 3
	ld	iyl, 2
	ld	hl, (ix - 19)
	add	hl, de
	ld	(ix - 19), hl
	bit	0, a
	jr	nz, BB40_16
	ld	de, -10
	jr	BB40_17
BB40_16:
	ld	de, 10
BB40_17:
	ld	hl, (ix - 22)
	add	hl, de
	ld	(ix - 22), hl
	ld	de, 428
	ld	hl, (ix + 6)
	add	hl, de
	ld	de, (hl)
	push	de
	pop	hl
	call	__iand
	ld	(ix - 28), hl
	ld	c, iyl
	call	__ishl
	ld	bc, 151
	call	__imulu
	push	hl
	pop	bc
	ld	iy, _pawn_cache
	add	iy, bc
	ld	hl, (iy)
	push	de
	pop	bc
	or	a, a
	sbc	hl, de
	jp	z, BB40_115
	ld	(ix - 25), iy
	ld	de, 151
	add	iy, de
	ld	hl, (iy)
	or	a, a
	sbc	hl, bc
	jp	z, BB40_115
	ld	de, 302
	ld	iy, (ix - 25)
	add	iy, de
	ld	hl, (iy)
	or	a, a
	sbc	hl, bc
	jp	z, BB40_115
	ld	de, 453
	ld	iy, (ix - 25)
	add	iy, de
	ld	hl, (iy)
	or	a, a
	sbc	hl, bc
	jp	z, BB40_115
	ld	hl, _pawn_cache_victim
	ld.sis	de, 0
	ld	(ix - 38), de
	lea	de, ix - 8
	ld	(ix - 62), de
	lea	de, ix - 16
	ld	(ix - 59), de
	ld	de, (ix - 28)
	add	hl, de
	ld	a, (hl)
	ld	de, 0
	ld	e, a
	inc	a
	and	a, 3
	ld	(hl), a
	ld	bc, 151
	ld	(ix - 28), de
	ex	de, hl
	call	__imulu
	push	hl
	pop	de
	ld	iy, (ix - 25)
	add	iy, de
	lea	hl, iy + 7
	ld	(iy + 7), b
	ld	iy, (ix + 6)
	push	hl
	pop	de
	inc	de
	ld	bc, 143
	ldir
	ld	bc, 0
	xor	a, a
	ld	(ix - 41), a
BB40_22:
	lea	hl, iy
	ld	de, 416
	add	hl, de
	ld	de, 0
	ld	e, (hl)
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jp	nc, BB40_30
	lea	hl, iy
	ld	(ix - 44), bc
	add	hl, bc
	ld	de, 256
	add	hl, de
	ld	c, (hl)
	ld	de, 0
	ld	e, c
	lea	hl, iy
	add	hl, de
	ld	a, (hl)
	and	a, 7
	cp	a, 1
	jp	nz, BB40_29
	ld	a, c
	ld	iy, 0
	ld	b, 4
	call	__bshru
	ld	(ix - 31), c
	ld	c, a
	ld	a, (ix - 31)
	and	a, 7
	lea	de, iy
	ld	l, (ix - 41)
	ld	e, l
	inc	l
	ld	(ix - 41), l
	ld	hl, (ix - 62)
	add	hl, de
	ld	e, (ix - 31)
	ld	(hl), e
	ld.sis	hl, 1
	call	__sshl
	ld	(ix - 47), hl
	lea	de, iy
	ld	e, a
	ld	hl, (ix - 28)
	ld	bc, 151
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix - 25)
	add	iy, bc
	ld	c, (ix - 31)
	add	iy, de
	ld	a, (iy + 7)
	ld	hl, (ix - 47)
	or	a, l
	ld	(iy + 7), a
	ld	a, c
	add	a, -17
	ld	l, a
	and	a, -120
	or	a, a
	jr	nz, BB40_26
	ld	de, 0
	ld	e, l
	ld	hl, (ix - 28)
	ld	bc, 151
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix - 25)
	add	iy, bc
	ld	c, (ix - 31)
	add	iy, de
	set	0, (iy + 23)
BB40_26:
	ld	a, c
	add	a, -15
	ld	l, a
	and	a, -120
	or	a, a
	jr	nz, BB40_28
	ld	de, 0
	ld	e, l
	ld	hl, (ix - 28)
	ld	bc, 151
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix - 25)
	add	iy, bc
	add	iy, de
	set	0, (iy + 23)
BB40_28:
	ld	iy, (ix + 6)
BB40_29:
	ld	bc, (ix - 44)
	inc	bc
	jp	BB40_22
BB40_30:
	or	a, a
	sbc	hl, hl
	ld	(ix - 31), hl
	xor	a, a
	ld	(ix - 44), a
BB40_31:
	ld	bc, (ix + 6)
	push	bc
	pop	hl
	ld	de, 417
	add	hl, de
	ld	iy, 0
	lea	de, iy
	ld	e, (hl)
	ld	hl, (ix - 31)
	or	a, a
	sbc	hl, de
	jp	nc, BB40_38
	push	bc
	pop	hl
	ld	de, (ix - 31)
	add	hl, de
	ld	de, 272
	add	hl, de
	ld	a, (hl)
	lea	de, iy
	ld	(ix - 47), a
	ld	e, a
	push	bc
	pop	hl
	add	hl, de
	ld	a, (hl)
	and	a, 7
	cp	a, 1
	jp	nz, BB40_37
	ld	l, (ix - 47)
	ld	a, l
	ld	b, 4
	call	__bshru
	ld	c, a
	ld	a, l
	ld	b, l
	and	a, 7
	lea	de, iy
	ld	l, (ix - 44)
	ld	e, l
	inc	l
	ld	(ix - 44), l
	ld	hl, (ix - 59)
	add	hl, de
	ld	(hl), b
	ld.sis	hl, 1
	call	__sshl
	ld	(ix - 50), hl
	lea	de, iy
	ld	e, a
	ld	hl, (ix - 28)
	ld	bc, 151
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix - 25)
	add	iy, bc
	add	iy, de
	ld	a, (iy + 15)
	ld	hl, (ix - 50)
	or	a, l
	ld	(iy + 15), a
	ld	e, (ix - 47)
	ld	a, e
	add	a, 17
	ld	l, a
	and	a, -120
	or	a, a
	ld	a, e
	jr	nz, BB40_35
	ld	de, 0
	ld	e, l
	ld	hl, (ix - 28)
	ld	bc, 151
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix - 25)
	add	iy, bc
	add	iy, de
	set	1, (iy + 23)
BB40_35:
	add	a, 15
	ld	l, a
	and	a, -120
	or	a, a
	jr	nz, BB40_37
	ld	de, 0
	ld	e, l
	ld	hl, (ix - 28)
	ld	bc, 151
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix - 25)
	add	iy, bc
	add	iy, de
	set	1, (iy + 23)
BB40_37:
	ld	hl, (ix - 31)
	inc	hl
	ld	(ix - 31), hl
	jp	BB40_31
BB40_38:
	ld	iy, 0
	push	af
	ld	a, (ix - 41)
	ld	iyl, a
	pop	af
	or	a, a
	sbc	hl, hl
	push	hl
	pop	bc
	ld	(ix - 31), hl
BB40_39:
	lea	hl, iy
	or	a, a
	sbc	hl, bc
	jp	z, BB40_77
	ld	(ix - 53), iy
	ld	hl, (ix - 62)
	ld	(ix - 56), bc
	add	hl, bc
	ld	l, (hl)
	ld	a, l
	ld	b, 4
	call	__bshru
	ld	e, a
	ld	(ix - 41), e
	ld	(ix - 65), l
	ld	a, l
	and	a, 7
	ld	c, a
	ld	a, 5
	sub	a, e
	ld	(ix - 66), a
	ld	de, 0
	ld	(ix - 50), c
	ld	e, c
	ld	hl, (ix - 28)
	ld	bc, 151
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix - 25)
	add	iy, bc
	ld	(ix - 47), de
	add	iy, de
	ld	b, (iy + 7)
	ld	hl, 1
	ld	c, (ix - 41)
	call	__ishl
	ld	(ix - 41), hl
	ld	a, l
	cpl
	and	a, b
	or	a, a
	ld	a, -1
	jr	z, BB40_42
	ld	a, 0
BB40_42:
	ld	hl, (ix - 31)
	ld.sis	de, -12
	add.sis	hl, de
	ld	de, (ix - 38)
	ld	iyl, e
	ld	iyh, d
	ld.sis	de, -3
	add.sis	iy, de
	bit	0, a
	jr	nz, BB40_44
	ld	e, iyl
	ld	d, iyh
	ld	(ix - 38), de
BB40_44:
	bit	0, a
	jp	nz, BB40_46
	ld	(ix - 31), hl
BB40_46:
	ld	a, (ix - 50)
	or	a, a
	ld	e, 0
	jr	z, BB40_48
	ld	hl, (ix - 28)
	ld	bc, 151
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix - 25)
	add	iy, bc
	ld	de, (ix - 47)
	add	iy, de
	ld	e, (iy + 6)
	ld	a, (ix - 50)
	cp	a, 7
	ld	a, 1
	jr	z, BB40_49
BB40_48:
	ld	hl, (ix - 28)
	ld	bc, 151
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix - 25)
	add	iy, bc
	ld	bc, (ix - 47)
	add	iy, bc
	ld	a, (iy + 8)
	or	a, e
	ld	e, a
	xor	a, a
BB40_49:
	ld	(ix - 67), a
	ld	a, e
	or	a, a
	ld	a, -1
	jr	z, BB40_51
	ld	a, 0
BB40_51:
	ld	hl, (ix - 31)
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	ld.sis	de, -12
	add.sis	iy, de
	ld	bc, (ix - 38)
	ld	l, c
	ld	h, b
	ld.sis	de, -17
	add.sis	hl, de
	bit	0, a
	jr	nz, BB40_53
	ld	l, c
	ld	h, b
BB40_53:
	ld	(ix - 38), hl
	bit	0, a
	ld	d, (ix - 65)
	jr	nz, BB40_55
	ld	hl, (ix - 31)
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
BB40_55:
	ld	(ix - 31), iy
	ld	a, d
	add	a, 17
	ld	e, a
	ld	a, d
	add	a, 15
	ld	iyl, a
	ld	a, e
	and	a, -120
	or	a, a
	ld	c, 0
	jr	nz, BB40_58
	ld	bc, 0
	ld	c, e
	ld	hl, (ix + 6)
	add	hl, bc
	ld	a, (hl)
	cp	a, 1
	ld	c, 1
	jr	z, BB40_58
	ld	c, 0
BB40_58:
	ld	a, iyl
	and	a, -120
	or	a, a
	jr	nz, BB40_62
	ld	de, 0
	ld	e, iyl
	ld	iy, (ix + 6)
	lea	hl, iy
	add	hl, de
	ld	a, (hl)
	cp	a, 1
	ld	l, 1
	jr	z, BB40_61
	ld	l, c
BB40_61:
	ld	iy, (ix - 53)
	ld	bc, (ix - 56)
	ld	d, (ix - 65)
	jr	BB40_63
BB40_62:
	ld	l, c
	ld	iy, (ix - 53)
	ld	bc, (ix - 56)
BB40_63:
	ld	a, d
	and	a, -32
	bit	0, l
	jp	z, BB40_66
	cp	a, 96
	jp	z, BB40_66
	or	a, a
	sbc	hl, hl
	ld	l, (ix - 66)
	ld	c, 1
	call	__ishl
	ld	bc, (ix - 56)
	push	hl
	pop	de
	ld	hl, _connected_bonus_eg
	add	hl, de
	ld	iy, (ix - 53)
	ld	hl, (hl)
	ld	(ix - 70), hl
	ld	(ix - 65), hl
	ld	de, (ix - 31)
	ld	hl, (ix - 65)
	add.sis	hl, de
	ld	(ix - 65), hl
	ld	de, (ix - 38)
	ld	hl, (ix - 70)
	add.sis	hl, de
	ld	(ix - 38), hl
	ld	hl, (ix - 65)
	ld	(ix - 31), hl
BB40_66:
	ld	hl, (ix - 41)
	cp	a, 96
	jp	z, BB40_73
	ld	de, 255
	add	hl, de
	ld	(ix - 41), hl
	ld	hl, (ix - 28)
	ld	bc, 151
	call	__imulu
	push	hl
	pop	de
	ld	hl, (ix - 41)
	ld	iy, (ix - 25)
	add	iy, de
	ld	de, (ix - 47)
	add	iy, de
	ld	a, l
	and	a, (iy + 15)
	or	a, a
	jp	nz, BB40_74
	ld	a, (ix - 50)
	or	a, a
	jr	z, BB40_71
	ld	hl, (ix - 28)
	ld	bc, 151
	call	__imulu
	push	hl
	pop	de
	ld	hl, (ix - 41)
	ld	iy, (ix - 25)
	add	iy, de
	ld	de, (ix - 47)
	add	iy, de
	ld	a, l
	and	a, (iy + 14)
	or	a, a
	jp	nz, BB40_74
	bit	0, (ix - 67)
	jr	nz, BB40_72
BB40_71:
	ld	hl, (ix - 28)
	ld	bc, 151
	call	__imulu
	push	de
	pop	bc
	push	hl
	pop	de
	ld	iy, (ix - 25)
	add	iy, de
	add	iy, bc
	ld	hl, (ix - 41)
	ld	a, l
	and	a, (iy + 16)
	or	a, a
	jp	nz, BB40_74
BB40_72:
	or	a, a
	sbc	hl, hl
	ld	l, (ix - 66)
	ld	c, 1
	call	__ishl
	push	hl
	pop	de
	ld	hl, _passed_mg
	add	hl, de
	ld	hl, (hl)
	ld	bc, (ix - 31)
	add.sis	hl, bc
	ld	(ix - 31), hl
	ld	hl, _passed_eg
	add	hl, de
	ld	hl, (hl)
	ld	de, (ix - 38)
	add.sis	hl, de
	ld	(ix - 38), hl
	jp	BB40_75
BB40_73:
	ld	hl, (ix - 38)
	ld	(ix - 38), hl
	ld	hl, (ix - 31)
	ld	(ix - 31), hl
	jp	BB40_76
BB40_74:
	ld	hl, (ix - 38)
	ld	(ix - 38), hl
	ld	hl, (ix - 31)
	ld	(ix - 31), hl
BB40_75:
	ld	iy, (ix - 53)
	ld	bc, (ix - 56)
BB40_76:
	inc	bc
	jp	BB40_39
BB40_77:
	ld	de, 0
	ld	e, (ix - 44)
	or	a, a
	sbc	hl, hl
	push	hl
	pop	bc
	ld	iy, (ix - 25)
BB40_78:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jp	z, BB40_114
	ld	(ix - 50), de
	ld	hl, (ix - 59)
	ld	(ix - 53), bc
	add	hl, bc
	ld	l, (hl)
	ld	a, l
	ld	b, 4
	call	__bshru
	ld	e, a
	ld	(ix - 56), e
	ld	(ix - 41), l
	ld	a, l
	and	a, 7
	ld	c, a
	ld	a, e
	add	a, -2
	ld	(ix - 62), a
	or	a, a
	sbc	hl, hl
	ex	de, hl
	ld	(ix - 47), c
	ld	e, c
	ld	hl, (ix - 28)
	ld	bc, 151
	call	__imulu
	push	hl
	pop	bc
	add	iy, bc
	ld	(ix - 44), de
	add	iy, de
	ld	d, (iy + 15)
	ld	hl, 1
	ld	c, (ix - 56)
	call	__ishl
	ld	a, l
	cpl
	and	a, d
	or	a, a
	ld	a, -1
	jr	z, BB40_81
	ld	a, 0
BB40_81:
	ld	hl, (ix - 31)
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	ld.sis	de, 12
	add.sis	iy, de
	ld	bc, (ix - 38)
	ld	l, c
	ld	h, b
	ld.sis	de, 3
	add.sis	hl, de
	bit	0, a
	jr	nz, BB40_83
	ld	c, l
	ld	b, h
BB40_83:
	ld	(ix - 38), bc
	bit	0, a
	jr	nz, BB40_85
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	ld	(ix - 31), hl
BB40_85:
	ld	a, (ix - 47)
	or	a, a
	ld	d, 0
	jr	z, BB40_87
	ld	hl, (ix - 28)
	ld	bc, 151
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix - 25)
	add	iy, bc
	ld	de, (ix - 44)
	add	iy, de
	ld	d, (iy + 14)
	ld	a, (ix - 47)
	cp	a, 7
	ld	a, 1
	jr	z, BB40_88
BB40_87:
	ld	hl, (ix - 28)
	ld	bc, 151
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix - 25)
	add	iy, bc
	ld	bc, (ix - 44)
	add	iy, bc
	ld	a, (iy + 16)
	or	a, d
	ld	d, a
	xor	a, a
BB40_88:
	ld	(ix - 65), a
	ld	a, d
	or	a, a
	ld	a, -1
	jr	z, BB40_90
	ld	a, 0
BB40_90:
	ld	hl, (ix - 31)
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	ld.sis	de, 12
	add.sis	iy, de
	ld	bc, (ix - 38)
	ld	l, c
	ld	h, b
	ld.sis	de, 17
	add.sis	hl, de
	bit	0, a
	jr	nz, BB40_92
	ld	l, c
	ld	h, b
BB40_92:
	ld	(ix - 38), hl
	bit	0, a
	jr	nz, BB40_94
	ld	hl, (ix - 31)
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
BB40_94:
	ld	(ix - 31), iy
	ld	l, (ix - 41)
	ld	a, l
	add	a, -17
	ld	c, a
	ld	a, l
	add	a, -15
	ld	iyl, a
	ld	a, c
	and	a, -120
	or	a, a
	ld	b, 0
	jr	nz, BB40_97
	ld	de, 0
	ld	e, c
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	cp	a, -127
	ld	b, 1
	jr	z, BB40_97
	ld	b, 0
BB40_97:
	ld	a, iyl
	and	a, -120
	or	a, a
	jr	nz, BB40_99
	ld	de, 0
	ld	e, iyl
	ld	iy, (ix + 6)
	lea	hl, iy
	add	hl, de
	ld	a, (hl)
	cp	a, -127
	ld	a, 1
	jr	z, BB40_100
BB40_99:
	ld	a, b
BB40_100:
	ld	iy, (ix - 25)
	ld	de, (ix - 50)
	ld	bc, (ix - 53)
	bit	0, a
	jr	z, BB40_103
	ld	a, (ix - 41)
	cp	a, 32
	jr	c, BB40_103
	or	a, a
	sbc	hl, hl
	ld	l, (ix - 62)
	ld	c, 1
	call	__ishl
	push	hl
	pop	de
	ld	hl, _connected_bonus_eg
	add	hl, de
	ld	bc, (hl)
	ld	hl, (ix - 31)
	or	a, a
	sbc.sis	hl, bc
	ld	(ix - 31), hl
	ld	hl, (ix - 38)
	or	a, a
	sbc.sis	hl, bc
	ld	bc, (ix - 53)
	ld	de, (ix - 50)
	ld	(ix - 38), hl
BB40_103:
	ld	a, (ix - 41)
	cp	a, 32
	jp	c, BB40_110
	ld	hl, -2
	ld	c, (ix - 56)
	call	__ishl
	push	hl
	pop	de
	ld	hl, (ix - 28)
	ld	bc, 151
	call	__imulu
	push	hl
	pop	bc
	add	iy, bc
	ld	bc, (ix - 44)
	add	iy, bc
	ld	a, e
	and	a, (iy + 7)
	or	a, a
	jp	nz, BB40_111
	ld	a, (ix - 47)
	or	a, a
	jr	z, BB40_108
	ld	hl, (ix - 28)
	ld	bc, 151
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix - 25)
	add	iy, bc
	ld	bc, (ix - 44)
	add	iy, bc
	ld	a, e
	and	a, (iy + 6)
	or	a, a
	jp	nz, BB40_111
	bit	0, (ix - 65)
	jr	nz, BB40_109
BB40_108:
	ld	hl, (ix - 28)
	ld	bc, 151
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix - 25)
	add	iy, bc
	ld	bc, (ix - 44)
	add	iy, bc
	ld	a, e
	and	a, (iy + 8)
	or	a, a
	jp	nz, BB40_111
BB40_109:
	or	a, a
	sbc	hl, hl
	ld	l, (ix - 62)
	ld	c, 1
	call	__ishl
	push	hl
	pop	de
	ld	hl, _passed_mg
	add	hl, de
	ld	bc, (hl)
	ld	hl, (ix - 31)
	or	a, a
	sbc.sis	hl, bc
	ld	(ix - 31), hl
	ld	hl, _passed_eg
	add	hl, de
	ld	de, (hl)
	ld	hl, (ix - 38)
	or	a, a
	sbc.sis	hl, de
	ld	(ix - 38), hl
	jp	BB40_112
BB40_110:
	ld	hl, (ix - 38)
	ld	(ix - 38), hl
	ld	hl, (ix - 31)
	ld	(ix - 31), hl
	jp	BB40_113
BB40_111:
	ld	hl, (ix - 38)
	ld	(ix - 38), hl
	ld	hl, (ix - 31)
	ld	(ix - 31), hl
BB40_112:
	ld	iy, (ix - 25)
	ld	de, (ix - 50)
	ld	bc, (ix - 53)
BB40_113:
	inc	bc
	jp	BB40_78
BB40_114:
	ld	bc, 151
	ld	hl, (ix - 28)
	call	__imulu
	push	hl
	pop	de
	add	iy, de
	ld	hl, (ix - 31)
	ld	(iy + 3), l
	ld	(iy + 4), h
	ld	hl, (ix - 38)
	ld	(iy + 5), l
	ld	(iy + 6), h
	ld	hl, (ix + 6)
	ld	de, 428
	add	hl, de
	ld	hl, (hl)
	ld	(iy), hl
BB40_115:
	lea	hl, iy + 7
	ld	(ix - 47), hl
	lea	hl, iy + 15
	ld	(ix - 50), hl
	ld	de, (iy + 3)
	ld	a, d
	ld	l, a
	rlc	l
	sbc	hl, hl
	push	hl
	pop	bc
	ld	b, a
	ld	c, e
	ld	hl, (ix - 22)
	add	hl, bc
	ld	(ix - 22), hl
	ld	(ix - 41), iy
	ld	de, (iy + 5)
	ld	a, d
	ld	l, a
	rlc	l
	sbc	hl, hl
	push	hl
	pop	bc
	ld	b, a
	ld	c, e
	ld	hl, (ix - 19)
	add	hl, bc
	ld	(ix - 19), hl
	ld	iy, (ix + 6)
	lea	hl, iy
	ld	de, 416
	add	hl, de
	ld	de, 256
	add	iy, de
	ld	bc, 0
	push	bc
	pop	de
	ld	e, (hl)
	ld	(ix - 31), de
	ex	de, hl
	ld	(ix - 38), iy
BB40_116:
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB40_125
	ld	(ix - 25), hl
	ld	(ix - 28), iy
	ld	l, (iy)
	push	bc
	pop	de
	ld	e, l
	ld	iy, (ix + 6)
	add	iy, de
	ld	a, (iy)
	and	a, 7
	cp	a, 4
	jr	nz, BB40_124
	ld	a, l
	and	a, 7
	ld	c, a
	ld	iy, (ix - 47)
	add	iy, bc
	ld	a, (iy)
	or	a, a
	jr	nz, BB40_123
	ld	iy, (ix - 50)
	add	iy, bc
	ld	a, (iy)
	or	a, a
	jr	nz, BB40_121
	ld	iy, (ix - 22)
	ld	de, 38
	add	iy, de
	ld	(ix - 22), iy
	ld	iy, (ix - 19)
	ld	de, 24
	jr	BB40_122
BB40_121:
	ld	iy, (ix - 22)
	ld	de, 23
	add	iy, de
	ld	(ix - 22), iy
	ld	iy, (ix - 19)
	ld	de, 11
BB40_122:
	add	iy, de
	ld	(ix - 19), iy
BB40_123:
	ld	bc, 0
BB40_124:
	ld	hl, (ix - 25)
	ld	iy, (ix - 28)
	inc	iy
	dec	hl
	jr	BB40_116
BB40_125:
	ld	iy, (ix + 6)
	lea	hl, iy
	ld	de, 417
	add	hl, de
	ld	c, (hl)
	lea	hl, iy
	ld	de, 272
	add	hl, de
	ld	(ix - 25), hl
	push	bc
	pop	de
	ld	(ix - 28), bc
BB40_126:
	push	de
	pop	hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB40_134
	ld	(ix - 44), de
	ld	bc, 0
	ld	hl, (ix - 25)
	ld	l, (hl)
	push	bc
	pop	de
	ld	e, l
	add	iy, de
	ld	a, (iy)
	and	a, 7
	cp	a, 4
	jr	nz, BB40_133
	ld	a, l
	and	a, 7
	ld	c, a
	ld	iy, (ix - 50)
	add	iy, bc
	ld	a, (iy)
	or	a, a
	jr	nz, BB40_133
	ld	iy, (ix - 47)
	add	iy, bc
	ld	a, (iy)
	or	a, a
	jr	nz, BB40_131
	ld	iy, (ix - 22)
	ld	de, -38
	add	iy, de
	ld	(ix - 22), iy
	ld	iy, (ix - 19)
	ld	de, -24
	jr	BB40_132
BB40_131:
	ld	iy, (ix - 22)
	ld	de, -23
	add	iy, de
	ld	(ix - 22), iy
	ld	iy, (ix - 19)
	ld	de, -11
BB40_132:
	add	iy, de
	ld	(ix - 19), iy
BB40_133:
	ld	iy, (ix + 6)
	ld	de, (ix - 44)
	ld	hl, (ix - 25)
	inc	hl
	ld	(ix - 25), hl
	dec	de
	jr	BB40_126
BB40_134:
	lea	de, iy
	ld	iy, (ix - 41)
	lea	hl, iy + 23
	push	de
	pop	iy
	ld	(ix - 41), hl
	or	a, a
	sbc	hl, hl
BB40_135:
	push	hl
	pop	de
	ld	bc, (ix - 31)
	or	a, a
	sbc	hl, bc
	jp	z, BB40_160
	ld	hl, (ix - 38)
	add	hl, de
	ld	a, (hl)
	ld	bc, 0
	ld	(ix - 44), a
	ld	c, a
	lea	hl, iy
	add	hl, bc
	ld	a, (hl)
	and	a, 7
	cp	a, 2
	ld	(ix - 25), de
	jr	nz, BB40_143
	ld	de, 0
	ld	c, d
	ld	(ix - 47), c
BB40_138:
	push	de
	pop	hl
	ld	bc, 8
	or	a, a
	sbc	hl, bc
	jp	z, BB40_152
	ld	hl, _atk_knight_offsets
	add	hl, de
	ld	a, (hl)
	add	a, (ix - 44)
	ld	l, a
	and	a, -120
	or	a, a
	jr	nz, BB40_142
	ld	bc, 0
	ld	c, l
	lea	hl, iy
	add	hl, bc
	ld	a, (hl)
	cp	a, 1
	call	pe, __setflag
	jp	p, BB40_142
	ld	hl, (ix - 41)
	add	hl, bc
	ld	a, (hl)
	srl	a
	cpl
	and	a, 1
	add	a, (ix - 47)
	ld	(ix - 47), a
BB40_142:
	inc	de
	jr	BB40_138
BB40_143:
	cp	a, 3
	ld	hl, 0
	ld	c, h
	ld	de, (ix - 28)
	jp	nz, BB40_159
BB40_144:
	ld	iyl, c
	push	hl
	pop	bc
	ld	de, 4
	or	a, a
	sbc	hl, de
	jr	z, BB40_155
	ld	hl, _bishop_offsets
	ld	(ix - 50), bc
	add	hl, bc
	ld	l, (hl)
	ld	a, (ix - 44)
	ld	(ix - 47), l
	add	a, l
	ld	b, a
	ld	c, iyl
	ld	iy, (ix + 6)
BB40_146:
	ld	de, 0
	ld	e, b
	lea	hl, iy
	add	hl, de
	ld	h, (hl)
	ld	a, h
	or	a, a
	jr	nz, BB40_148
	ld	hl, (ix - 41)
	add	hl, de
	ld	a, (hl)
	srl	a
	cpl
	and	a, 1
	add	a, c
	ld	c, a
	ld	a, b
	add	a, (ix - 47)
	ld	b, a
	jr	BB40_146
BB40_148:
	ld	a, b
	and	a, -120
	or	a, a
	jr	nz, BB40_151
	ld	a, h
	cp	a, 0
	call	pe, __setflag
	jp	p, BB40_151
	ld	hl, (ix - 41)
	add	hl, de
	ld	a, (hl)
	srl	a
	cpl
	and	a, 1
	add	a, c
	ld	c, a
BB40_151:
	ld	hl, (ix - 50)
	inc	hl
	jr	BB40_144
BB40_152:
	ld	a, (ix - 47)
	cp	a, 8
	jr	c, BB40_154
	ld	a, 8
BB40_154:
	add	a, a
	ld	de, 0
	ld	e, a
	ld	hl, _knight_mob_mg
	add	hl, de
	ld	iy, _knight_mob_eg
	jr	BB40_158
BB40_155:
	ld	a, iyl
	cp	a, 13
	jr	c, BB40_157
	ld	c, 13
	ld	a, c
BB40_157:
	add	a, a
	ld	de, 0
	ld	e, a
	ld	hl, _bishop_mob_mg
	add	hl, de
	ld	iy, _bishop_mob_eg
BB40_158:
	add	iy, de
	ld	de, (hl)
	ld	a, d
	ld	l, a
	rlc	l
	sbc	hl, hl
	push	hl
	pop	bc
	ld	b, a
	ld	c, e
	ld	hl, (ix - 22)
	add	hl, bc
	ld	(ix - 22), hl
	ld	de, (iy)
	ld	a, d
	ld	l, a
	rlc	l
	sbc	hl, hl
	push	hl
	pop	bc
	ld	b, a
	ld	c, e
	ld	hl, (ix - 19)
	add	hl, bc
	ld	(ix - 19), hl
	ld	iy, (ix + 6)
BB40_159:
	ld	hl, (ix - 25)
	inc	hl
	jp	BB40_135
BB40_160:
	or	a, a
	sbc	hl, hl
	push	hl
	pop	bc
	ld	de, (ix - 28)
BB40_161:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jp	z, BB40_186
	lea	hl, iy
	add	hl, bc
	ld	de, 272
	add	hl, de
	ld	a, (hl)
	ld	de, 0
	ld	(ix - 31), a
	ld	e, a
	lea	hl, iy
	add	hl, de
	ld	a, (hl)
	and	a, 7
	cp	a, 2
	ld	(ix - 25), bc
	jr	nz, BB40_169
	ld	de, 0
	ld	c, d
	ld	(ix - 38), c
BB40_164:
	push	de
	pop	hl
	ld	bc, 8
	or	a, a
	sbc	hl, bc
	jp	z, BB40_178
	ld	hl, _atk_knight_offsets
	add	hl, de
	ld	a, (hl)
	add	a, (ix - 31)
	ld	b, a
	and	a, -120
	or	a, a
	jr	nz, BB40_168
	or	a, a
	sbc	hl, hl
	ld	l, b
	push	hl
	pop	bc
	lea	hl, iy
	add	hl, bc
	ld	a, (hl)
	cp	a, 0
	call	pe, __setflag
	jp	m, BB40_168
	ld	hl, (ix - 41)
	add	hl, bc
	ld	a, (hl)
	cpl
	and	a, 1
	add	a, (ix - 38)
	ld	(ix - 38), a
BB40_168:
	inc	de
	jr	BB40_164
BB40_169:
	cp	a, 3
	ld	hl, 0
	ld	c, h
	ld	de, (ix - 28)
	jp	nz, BB40_185
BB40_170:
	ld	iyl, c
	push	hl
	pop	bc
	ld	de, 4
	or	a, a
	sbc	hl, de
	jr	z, BB40_181
	ld	hl, _bishop_offsets
	ld	(ix - 44), bc
	add	hl, bc
	ld	l, (hl)
	ld	a, (ix - 31)
	ld	(ix - 38), l
	add	a, l
	ld	b, a
	ld	c, iyl
	ld	iy, (ix + 6)
BB40_172:
	ld	de, 0
	ld	e, b
	lea	hl, iy
	add	hl, de
	ld	h, (hl)
	ld	a, h
	or	a, a
	jr	nz, BB40_174
	ld	hl, (ix - 41)
	add	hl, de
	ld	a, (hl)
	cpl
	and	a, 1
	add	a, c
	ld	c, a
	ld	a, b
	add	a, (ix - 38)
	ld	b, a
	jr	BB40_172
BB40_174:
	ld	a, b
	and	a, -120
	or	a, a
	jr	nz, BB40_177
	ld	a, h
	cp	a, 0
	call	pe, __setflag
	jp	m, BB40_177
	ld	hl, (ix - 41)
	add	hl, de
	ld	a, (hl)
	cpl
	and	a, 1
	add	a, c
	ld	c, a
BB40_177:
	ld	hl, (ix - 44)
	inc	hl
	jr	BB40_170
BB40_178:
	ld	a, (ix - 38)
	cp	a, 8
	jr	c, BB40_180
	ld	c, 8
	ld	a, c
BB40_180:
	add	a, a
	ld	de, 0
	ld	e, a
	ld	hl, _knight_mob_mg
	add	hl, de
	ld	iy, _knight_mob_eg
	jr	BB40_184
BB40_181:
	ld	a, iyl
	cp	a, 13
	jr	c, BB40_183
	ld	c, 13
	ld	a, c
BB40_183:
	add	a, a
	ld	de, 0
	ld	e, a
	ld	hl, _bishop_mob_mg
	add	hl, de
	ld	iy, _bishop_mob_eg
BB40_184:
	add	iy, de
	ld	de, (hl)
	ld	a, d
	ld	l, a
	rlc	l
	sbc	hl, hl
	push	hl
	pop	bc
	ld	b, a
	ld	c, e
	ld	hl, (ix - 22)
	or	a, a
	sbc	hl, bc
	ld	(ix - 22), hl
	ld	de, (iy)
	ld	a, d
	ld	l, a
	rlc	l
	sbc	hl, hl
	push	hl
	pop	bc
	ld	b, a
	ld	c, e
	ld	hl, (ix - 19)
	or	a, a
	sbc	hl, bc
	ld	(ix - 19), hl
	ld	iy, (ix + 6)
	ld	de, (ix - 28)
BB40_185:
	ld	bc, (ix - 25)
	inc	bc
	jp	BB40_161
BB40_186:
	ld	de, 420
	lea	hl, iy
	add	hl, de
	ld	h, (hl)
	ld	a, h
	cp	a, 16
	lea	bc, iy
	ld	iyh, 0
	jr	c, BB40_195
	ld	a, h
	and	a, 7
	ld	c, a
	ld	a, h
	add	a, -16
	and	a, -16
	add	a, c
	ld	e, a
	ld	iyl, 1
	ld	b, -1
	ld	iyh, 0
BB40_188:
	ld	a, c
	add	a, b
	ld	h, a
	ld	a, b
	cp	a, 2
	jr	z, BB40_194
	ld	a, h
	cp	a, 8
	jr	nc, BB40_193
	ld	(ix - 25), e
	ld	a, e
	add	a, b
	ld	de, 0
	ld	e, a
	ld	hl, (ix + 6)
	add	hl, de
	ld	e, d
	ld	a, (hl)
	cp	a, 1
	ex	de, hl
	ld	d, iyl
	ex	de, hl
	jr	z, BB40_192
	ld	h, e
BB40_192:
	ld	a, iyh
	add	a, h
	ld	iyh, a
	ld	e, (ix - 25)
BB40_193:
	inc	b
	jr	BB40_188
BB40_194:
	ld	bc, (ix + 6)
BB40_195:
	ld	de, 421
	push	bc
	pop	hl
	add	hl, de
	ld	h, (hl)
	ld	a, h
	cp	a, 112
	jr	nc, BB40_203
	ld	a, h
	and	a, 7
	ld	c, a
	ld	a, h
	add	a, 16
	and	a, -16
	add	a, c
	ld	h, a
	ld	e, 1
	ld	iyl, 0
	ld	l, -1
BB40_197:
	ld	a, c
	add	a, l
	ld	b, a
	ld	a, l
	cp	a, 2
	jr	z, BB40_203
	ld	a, b
	cp	a, 8
	jr	nc, BB40_202
	ld	(ix - 25), h
	ld	a, h
	ld	(ix - 28), l
	add	a, l
	ld	b, iyl
	ld	iyl, e
	ld	de, 0
	ld	e, a
	ld	hl, (ix + 6)
	add	hl, de
	ld	e, iyl
	ld	iyl, b
	ld	a, (hl)
	cp	a, -127
	ld	d, e
	jr	z, BB40_201
	ld	d, iyl
BB40_201:
	ld	a, (ix - 32)
	add	a, d
	ld	(ix - 32), a
	ld	l, (ix - 28)
	ld	h, (ix - 25)
BB40_202:
	inc	l
	jr	BB40_197
BB40_203:
	ld	bc, 6
	or	a, a
	sbc	hl, hl
	push	hl
	pop	de
	ex	de, hl
	ld	e, iyh
	ex	de, hl
	ld	e, (ix - 32)
	sbc	hl, de
	call	__imulu
	ld	de, (ix - 22)
	add	hl, de
	ld	de, 444
	ld	bc, (ix + 6)
	push	bc
	pop	iy
	add	iy, de
	ld	a, (iy)
	cp	a, 24
	jr	c, BB40_205
	ld	a, 24
BB40_205:
	ld	bc, 0
	ld	c, a
	call	__imulu
	push	hl
	pop	iy
	ld	hl, 24
	or	a, a
	sbc	hl, bc
	ld	bc, (ix - 19)
	call	__imulu
	push	hl
	pop	de
	add	iy, de
	lea	hl, iy
	ld	bc, 24
	call	__idivs
	push	hl
	pop	de
	ld	hl, (ix - 35)
	ld	a, (hl)
	push	de
	pop	hl
	call	__ineg
	or	a, a
	jr	z, BB40_207
	ex	de, hl
BB40_207:
	ex	de, hl
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_generate_moves
_generate_moves:
	ld	hl, -16
	call	__frameset
	ld	iy, (ix + 6)
	xor	a, a
	ld	de, 422
	lea	hl, iy
	add	hl, de
	ld	l, (hl)
	ld	(ix - 6), l
	ld	de, 0
	ld	e, l
	lea	hl, iy
	add	hl, de
	ld	bc, 416
	add	hl, bc
	ld	(ix - 3), hl
	ld	c, 4
	ex	de, hl
	call	__ishl
	push	hl
	pop	de
	add	iy, de
	ld	(ix - 9), iy
	ld	l, (ix + 12)
	ld	(ix - 12), hl
	ld	l, (ix - 6)
	ld	(ix - 15), hl
	ld	bc, 0
BB41_1:
	ld	de, 0
	ld	hl, (ix - 3)
	ld	e, (hl)
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jr	nc, BB41_3
	ld	hl, (ix - 9)
	add	hl, bc
	ld	de, 256
	add	hl, de
	ld	l, (hl)
	ex	de, hl
	ld	iyl, e
	ex	de, hl
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	(ix - 6), bc
	ld	bc, 3
	call	__imulu
	push	hl
	pop	de
	ld	hl, (ix + 9)
	add	hl, de
	ld	de, (ix - 12)
	push	de
	push	hl
	ld	hl, (ix - 15)
	push	hl
	ex	de, hl
	ld	e, iyl
	ex	de, hl
	push	hl
	ld	hl, (ix + 6)
	push	hl
	ld	(ix - 16), a
	call	_gen_piece_moves
	ld	bc, (ix - 6)
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	add	a, (ix - 16)
	inc	bc
	jr	BB41_1
BB41_3:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_gen_piece_moves
_gen_piece_moves:
	ld	hl, -15
	call	__frameset
	ld	iy, (ix + 6)
	ld	bc, 0
	push	bc
	pop	de
	ld	e, (ix + 9)
	ld	(ix - 5), de
	add	iy, de
	ld	a, (iy)
	and	a, 7
	ld	c, a
	dec	bc
	ld	de, 6
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jr	c, BB42_2
	ld	b, 0
	jp	BB42_107
BB42_2:
	xor	a, a
	ld	(ix - 9), a
	ld	a, (ix + 12)
	ld	l, (ix + 18)
	ex	de, hl
	ld	iyl, e
	ex	de, hl
	ld	l, 1
	ld	(ix - 6), l
	ld	hl, JTI42_0
	add	hl, bc
	add	hl, bc
	add	hl, bc
	ld	hl, (hl)
	jp	(hl)
BB42_3:
	or	a, a
	ld	c, (ix + 9)
	jp	z, BB42_41
	ld	a, 0
	jp	BB42_42
BB42_5:
	xor	a, a
	ld	(ix - 9), a
	ld	iy, (ix + 6)
	ld	de, 0
BB42_6:
	push	de
	pop	hl
	ld	bc, 8
	or	a, a
	sbc	hl, bc
	jp	z, BB42_106
	ld	hl, _atk_knight_offsets
	ld	(ix - 5), de
	add	hl, de
	ld	a, (hl)
	add	a, (ix + 9)
	ld	d, a
	and	a, -120
	or	a, a
	jr	nz, BB42_14
	ld	bc, 0
	ld	c, d
	add	iy, bc
	ld	l, (iy)
	ld	a, l
	or	a, a
	jr	nz, BB42_10
	ld	a, (ix + 18)
	cp	a, 1
	ld	a, 0
	jr	nz, BB42_12
	jr	BB42_13
BB42_10:
	ld	a, l
	ld	b, 7
	call	__bshru
	ld	l, a
	ld	a, (ix + 18)
	cp	a, 2
	jr	z, BB42_13
	ld	a, l
	ld	l, (ix + 12)
	cp	a, l
	ld	a, 1
	jr	z, BB42_13
BB42_12:
	or	a, a
	sbc	hl, hl
	ld	e, (ix - 9)
	ld	l, e
	inc	e
	ld	(ix - 9), e
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix + 15)
	add	iy, bc
	ld	l, (ix + 9)
	ld	(iy), l
	ld	(iy + 1), d
	ld	(iy + 2), a
BB42_13:
	ld	iy, (ix + 6)
BB42_14:
	ld	de, (ix - 5)
	inc	de
	jr	BB42_6
BB42_15:
	ex	de, hl
	ld	e, iyl
	ex	de, hl
	push	hl
	ld	hl, (ix + 15)
	push	hl
	ld	hl, _bishop_offsets
	jr	BB42_17
BB42_16:
	ex	de, hl
	ld	e, iyl
	ex	de, hl
	push	hl
	ld	hl, (ix + 15)
	push	hl
	ld	hl, _rook_offsets
BB42_17:
	push	hl
	ld	l, a
	push	hl
	ld	l, (ix + 9)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_gen_sliding_moves
	ld	b, a
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	jp	BB42_107
BB42_18:
	ex	de, hl
	ld	e, iyl
	ex	de, hl
	push	hl
	ld	hl, (ix + 15)
	push	hl
	ld	hl, _bishop_offsets
	push	hl
	ld	l, a
	push	hl
	ld	l, (ix + 9)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_gen_sliding_moves
	ld	(ix - 5), a
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	bc, 3
	call	__imulu
	push	hl
	pop	de
	ld	iy, (ix + 15)
	add	iy, de
	ld	l, (ix + 18)
	push	hl
	push	iy
	ld	hl, _rook_offsets
	push	hl
	ld	l, (ix + 12)
	push	hl
	ld	l, (ix + 9)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_gen_sliding_moves
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	add	a, (ix - 5)
	ld	b, a
	jp	BB42_107
BB42_19:
	ld	a, 114
	ld	(ix - 10), a
	ld	b, 0
	ld	(ix - 9), b
	ld	iy, (ix + 6)
	ld	de, 0
BB42_20:
	push	de
	pop	hl
	ld	bc, 8
	or	a, a
	sbc	hl, bc
	jr	z, BB42_29
	ld	hl, _atk_ray_offsets
	add	hl, de
	ld	a, (hl)
	add	a, (ix + 9)
	ld	c, a
	and	a, -120
	or	a, a
	jr	nz, BB42_28
	ld	(ix - 5), de
	ld	de, 0
	ld	e, c
	add	iy, de
	ld	l, (iy)
	ld	a, l
	or	a, a
	jr	nz, BB42_24
	ld	a, (ix + 18)
	cp	a, 1
	ld	a, 0
	jr	nz, BB42_26
	jr	BB42_27
BB42_24:
	ld	a, l
	ld	b, 7
	call	__bshru
	ld	l, a
	ld	a, (ix + 18)
	cp	a, 2
	jr	z, BB42_27
	ld	a, l
	ld	l, (ix + 12)
	cp	a, l
	ld	a, 1
	jr	z, BB42_27
BB42_26:
	or	a, a
	sbc	hl, hl
	ld	e, (ix - 9)
	ld	l, e
	inc	e
	ld	(ix - 9), e
	ld	(ix - 11), c
	ld	bc, 3
	call	__imulu
	ld	c, (ix + 9)
	push	hl
	pop	de
	ld	iy, (ix + 15)
	add	iy, de
	ld	(iy), c
	ld	l, (ix - 11)
	ld	(iy + 1), l
	ld	(iy + 2), a
BB42_27:
	ld	iy, (ix + 6)
	ld	de, (ix - 5)
BB42_28:
	inc	de
	jp	BB42_20
BB42_29:
	ld	a, (ix + 18)
	cp	a, 1
	jp	z, BB42_106
	ld	a, (ix + 9)
	cp	a, 116
	jp	nz, BB42_60
	ld	a, (ix + 12)
	or	a, a
	jp	nz, BB42_60
	ld	bc, 423
	lea	de, iy
	add	iy, bc
	ld	l, (iy)
	ld	a, l
	and	a, 3
	or	a, a
	jp	z, BB42_106
	ld	(ix - 5), l
	ld	hl, 1
	push	hl
	ld	hl, 116
	push	hl
	push	de
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	nz, BB42_106
	ld	e, (ix - 5)
	ld	a, e
	and	a, 1
	bit	0, a
	ld	b, (ix - 9)
	ld	iy, (ix + 6)
	jp	z, BB42_88
	ld	a, (iy + 119)
	cp	a, 4
	jp	nz, BB42_88
	ld	a, (iy + 117)
	or	a, a
	jp	nz, BB42_88
	ld	a, (iy + 118)
	or	a, a
	jp	nz, BB42_88
	ld	hl, 1
	push	hl
	ld	hl, 117
	push	hl
	push	iy
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	nz, BB42_87
	ld	hl, 1
	push	hl
	ld	hl, 118
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	nz, BB42_87
	or	a, a
	sbc	hl, hl
	ld	a, (ix - 9)
	ld	l, a
	inc	a
	ld	bc, 3
	call	__imulu
	ld	b, a
	push	hl
	pop	de
	ld	iy, (ix + 15)
	add	iy, de
	ld	(iy), 116
	ld	(iy + 1), 118
	ld	(iy + 2), 2
	ld	hl, (ix + 6)
	push	hl
	pop	iy
	ld	de, 423
	add	iy, de
	ld	e, (iy)
	push	hl
	pop	iy
	jp	BB42_88
BB42_41:
	ld	a, -1
BB42_42:
	bit	0, a
	jr	nz, BB42_44
	ld	b, 16
	jr	BB42_45
BB42_44:
	ld	b, -16
BB42_45:
	ld	(ix - 10), b
	ld	b, 0
	bit	0, a
	jr	nz, BB42_47
	ld	iy, 1
	ld	(ix - 14), iy
	jr	BB42_48
BB42_47:
	ld	hl, 6
	ld	(ix - 14), hl
BB42_48:
	bit	0, a
	jr	nz, BB42_50
	ld	a, 7
	ld	b, a
BB42_50:
	ld	(ix - 11), b
	ld	a, c
	ld	b, 4
	call	__bshru
	ld	l, a
	ld	a, (ix + 18)
	cp	a, 1
	jr	nz, BB42_52
	ld	b, 0
	ld	de, 0
	jp	BB42_74
BB42_52:
	ld	(ix - 15), l
	ld	bc, 255
	ld	iy, 0
	push	af
	ld	a, (ix - 10)
	ld	iyl, a
	pop	af
	ld	de, (ix - 5)
	add	iy, de
	lea	hl, iy
	call	__iand
	push	hl
	pop	de
	lea	hl, iy
	ld	a, l
	and	a, -120
	or	a, a
	jp	nz, BB42_71
	ld	iy, (ix + 6)
	add	iy, de
	ld	a, (iy)
	or	a, a
	jp	nz, BB42_71
	ld	b, l
	ld	c, 4
	ex	de, hl
	call	__ishru
	ld	iy, (ix + 15)
	ld	c, (ix + 9)
	ld	(iy), c
	ld	a, l
	ld	l, (ix - 11)
	cp	a, l
	jr	nz, BB42_56
	ld	a, 8
	ld	(ix - 9), a
	ld	(iy + 3), c
	ld	(iy + 4), b
	ld	(iy + 5), 24
	ld	(iy + 6), c
	ld	(iy + 7), b
	ld	(iy + 8), 40
	ld	(iy + 9), c
	ld	(iy + 10), b
	ld	(iy + 11), 56
	ld	a, 4
	ld	(ix - 6), a
BB42_56:
	ld	(iy + 1), b
	ld	a, (ix - 9)
	ld	(iy + 2), a
	ld	hl, (ix - 14)
	ld	a, l
	ld	l, (ix - 15)
	cp	a, l
	ld	de, 0
	jp	nz, BB42_72
	ld	a, (ix - 10)
	add	a, b
	ld	l, a
	and	a, -120
	or	a, a
	jp	nz, BB42_72
	ld	e, l
	ld	iy, (ix + 6)
	add	iy, de
	ld	a, (iy)
	or	a, a
	ld	b, (ix - 6)
	jp	nz, BB42_73
	ld	(ix - 5), l
	or	a, a
	sbc	hl, hl
	ld	l, b
	inc	b
	ld	a, b
	ld	bc, 3
	call	__imulu
	ld	b, a
	ld	c, (ix + 9)
	push	hl
	pop	de
	ld	iy, (ix + 15)
	add	iy, de
	ld	(iy), c
	ld	a, (ix - 5)
	ld	(iy + 1), a
	ld	(iy + 2), 64
	jp	BB42_73
BB42_60:
	ld	a, (ix + 9)
	cp	a, 4
	jp	nz, BB42_106
	ld	a, (ix + 12)
	cp	a, 1
	jp	nz, BB42_106
	ld	bc, 423
	lea	de, iy
	add	iy, bc
	ld	l, (iy)
	ld	a, l
	and	a, 12
	or	a, a
	jp	z, BB42_106
	ld	(ix - 5), l
	or	a, a
	sbc	hl, hl
	push	hl
	ld	hl, 4
	push	hl
	push	de
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	nz, BB42_106
	ld	e, (ix - 5)
	bit	2, e
	ld	b, (ix - 9)
	ld	iy, (ix + 6)
	jp	z, BB42_97
	ld	a, (iy + 7)
	cp	a, -124
	jp	nz, BB42_97
	ld	a, (iy + 5)
	or	a, a
	jp	nz, BB42_97
	ld	a, (iy + 6)
	or	a, a
	jp	nz, BB42_97
	or	a, a
	sbc	hl, hl
	push	hl
	ld	hl, 5
	push	hl
	push	iy
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	nz, BB42_96
	or	a, a
	sbc	hl, hl
	push	hl
	ld	hl, 6
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	nz, BB42_96
	or	a, a
	sbc	hl, hl
	ld	a, (ix - 9)
	ld	l, a
	inc	a
	ld	bc, 3
	call	__imulu
	ld	b, a
	push	hl
	pop	de
	ld	iy, (ix + 15)
	add	iy, de
	ld	(iy), 4
	ld	(iy + 1), 6
	ld	(iy + 2), 2
	ld	hl, (ix + 6)
	push	hl
	pop	iy
	ld	de, 423
	add	iy, de
	ld	e, (iy)
	push	hl
	pop	iy
	jp	BB42_97
BB42_71:
	ld	b, 0
	ld	c, (ix + 9)
	jr	BB42_73
BB42_72:
	ld	b, (ix - 6)
BB42_73:
	ld	a, (ix + 18)
	cp	a, 2
	ld	de, 0
	jp	z, BB42_107
BB42_74:
	lea	hl, ix - 2
	ld	(ix - 9), hl
	ld	l, (ix - 10)
	ld	a, l
	dec	a
	ld	(ix - 2), a
	inc	l
	ld	(ix - 1), l
	push	de
	pop	iy
BB42_75:
	ld	de, 2
	lea	hl, iy
	or	a, a
	sbc	hl, de
	jp	z, BB42_107
	ld	hl, (ix - 9)
	lea	de, iy
	ld	(ix - 5), de
	add	hl, de
	ld	a, (hl)
	add	a, c
	ld	e, a
	and	a, -120
	or	a, a
	jp	nz, BB42_86
	ld	d, b
	ld	bc, 0
	ld	c, e
	ld	iy, (ix + 6)
	add	iy, bc
	ld	c, (iy)
	ld	a, c
	ld	b, 7
	call	__bshru
	ld	l, a
	ld	a, c
	or	a, a
	jr	z, BB42_79
	ld	a, l
	ld	l, (ix + 12)
	cp	a, l
	jr	nz, BB42_82
BB42_79:
	ld	iy, (ix + 6)
	ld	bc, 424
	add	iy, bc
	ld	l, (iy)
	ld	a, e
	cp	a, l
	jr	nz, BB42_81
	or	a, a
	sbc	hl, hl
	ld	l, d
	inc	d
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix + 15)
	add	iy, bc
	ld	b, d
	ld	c, (ix + 9)
	ld	(iy), c
	ld	(iy + 1), e
	ld	(iy + 2), 5
	jp	BB42_86
BB42_81:
	ld	c, (ix + 9)
	jp	BB42_85
BB42_82:
	ld	a, e
	ld	b, 4
	call	__bshru
	ld	c, d
	inc	d
	or	a, a
	sbc	hl, hl
	ld	(ix - 6), c
	ld	l, c
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix + 15)
	add	iy, bc
	ld	c, (ix + 9)
	ld	(iy), c
	ld	(iy + 1), e
	ld	l, (ix - 11)
	cp	a, l
	jp	nz, BB42_84
	ld	(iy + 2), 9
	ld	a, (ix - 6)
	add	a, 2
	ld	(ix - 10), a
	or	a, a
	sbc	hl, hl
	ld	l, d
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	hl, (ix + 15)
	push	hl
	pop	iy
	add	iy, bc
	ld	a, (ix + 9)
	ld	(iy), a
	ld	(iy + 1), e
	ld	(iy + 2), 25
	ld	d, (ix - 6)
	ld	a, d
	add	a, 3
	ld	(ix - 14), a
	or	a, a
	sbc	hl, hl
	ld	l, (ix - 10)
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix + 15)
	add	iy, bc
	ld	a, (ix + 9)
	ld	(iy), a
	ld	(iy + 1), e
	ld	(iy + 2), 41
	ld	a, d
	add	a, 4
	or	a, a
	sbc	hl, hl
	ld	l, (ix - 14)
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix + 15)
	add	iy, bc
	ld	b, a
	ld	c, (ix + 9)
	ld	(iy), c
	ld	(iy + 1), e
	ld	(iy + 2), 57
	jr	BB42_86
BB42_84:
	ld	(iy + 2), 1
BB42_85:
	ld	b, d
BB42_86:
	ld	iy, (ix - 5)
	inc	iy
	jp	BB42_75
BB42_87:
	ld	iy, (ix + 6)
	ld	b, (ix - 9)
	ld	e, (ix - 5)
BB42_88:
	bit	1, e
	jp	z, BB42_107
	ld	a, (iy + 112)
	cp	a, 4
	jp	nz, BB42_107
	ld	a, (iy + 115)
	or	a, a
	jp	nz, BB42_107
	ld	a, (iy + 114)
	or	a, a
	jp	nz, BB42_107
	ld	a, (iy + 113)
	or	a, a
	jp	nz, BB42_107
	ld	(ix - 9), b
	ld	hl, 1
	push	hl
	ld	hl, 115
	push	hl
	push	iy
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	nz, BB42_106
	ld	hl, 1
	push	hl
	ld	hl, 114
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	nz, BB42_106
	or	a, a
	sbc	hl, hl
	ld	a, (ix - 9)
	ld	l, a
	ld	bc, 3
	call	__imulu
	push	hl
	pop	de
	ld	hl, (ix + 15)
	add	hl, de
	push	hl
	pop	de
	ld	(hl), 116
	jr	BB42_105
BB42_96:
	ld	iy, (ix + 6)
	ld	b, (ix - 9)
	ld	e, (ix - 5)
BB42_97:
	bit	3, e
	jr	z, BB42_107
	ld	a, (iy)
	cp	a, -124
	jr	nz, BB42_107
	ld	a, (iy + 3)
	or	a, a
	jr	nz, BB42_107
	ld	a, (iy + 2)
	or	a, a
	jr	nz, BB42_107
	ld	(ix - 9), b
	ld	a, (iy + 1)
	or	a, a
	jr	nz, BB42_106
	or	a, a
	sbc	hl, hl
	push	hl
	ld	hl, 3
	push	hl
	push	iy
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jr	nz, BB42_106
	or	a, a
	sbc	hl, hl
	push	hl
	ld	hl, 2
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jr	nz, BB42_106
	or	a, a
	sbc	hl, hl
	ld	a, (ix - 9)
	ld	l, a
	ld	bc, 3
	call	__imulu
	push	hl
	pop	de
	ld	hl, (ix + 15)
	add	hl, de
	push	hl
	pop	de
	ld	(hl), 4
	ld	l, 2
	ld	(ix - 10), l
BB42_105:
	ld	b, a
	inc	b
	push	de
	pop	iy
	ld	a, (ix - 10)
	ld	(iy + 1), a
	ld	(iy + 2), 2
	jr	BB42_107
BB42_106:
	ld	b, (ix - 9)
BB42_107:
	ld	a, b
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits
	section	.rodata,"a",@progbits
	private	JTI42_0
JTI42_0:
	dl	BB42_3
	dl	BB42_5
	dl	BB42_15
	dl	BB42_16
	dl	BB42_18
	dl	BB42_19

	section	.text,"ax",@progbits
	private	_gen_sliding_moves
_gen_sliding_moves:
	ld	hl, -4
	call	__frameset
	xor	a, a
	ld	bc, 0
BB43_1:
	ld	de, 4
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jp	z, BB43_13
	ld	(ix - 1), a
	ld	hl, (ix + 15)
	ld	(ix - 4), bc
	add	hl, bc
	ld	e, (hl)
	ld	a, e
	add	a, (ix + 9)
BB43_3:
	ld	d, a
	or	a, a
	sbc	hl, hl
	push	hl
	pop	bc
	ld	c, d
	ld	iy, (ix + 6)
	add	iy, bc
	ld	c, (iy)
	ld	a, c
	or	a, a
	jr	nz, BB43_7
	ld	a, (ix + 21)
	cp	a, 1
	jr	z, BB43_6
	ld	a, (ix - 1)
	ld	l, a
	inc	a
	ld	(ix - 1), a
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix + 18)
	add	iy, bc
	ld	a, (ix + 9)
	ld	(iy), a
	ld	(iy + 1), d
	ld	(iy + 2), 0
BB43_6:
	ld	a, d
	add	a, e
	jr	BB43_3
BB43_7:
	ld	a, d
	and	a, -120
	or	a, a
	jr	nz, BB43_9
	ld	a, c
	ld	b, 7
	call	__bshru
	ld	e, a
	ld	a, (ix + 21)
	cp	a, 2
	jr	nz, BB43_11
BB43_9:
	ld	a, (ix - 1)
BB43_10:
	ld	bc, (ix - 4)
	inc	bc
	jr	BB43_1
BB43_11:
	ld	a, e
	ld	e, (ix + 12)
	cp	a, e
	ld	a, (ix - 1)
	jr	z, BB43_10
	ld	l, a
	inc	a
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	hl, (ix + 18)
	add	hl, bc
	push	hl
	pop	bc
	ld	e, a
	ld	a, (ix + 9)
	ld	(hl), a
	ld	a, e
	push	bc
	pop	iy
	ld	(iy + 1), d
	ld	(iy + 2), 1
	jr	BB43_10
BB43_13:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_is_square_attacked
_is_square_attacked:
	ld	hl, -4
	call	__frameset
	ld	l, 0
	ld	de, 0
	ld	a, (ix + 12)
	or	a, a
	ld	(ix - 1), l
	jr	z, BB44_2
	ld	a, -128
	ld	(ix - 1), a
BB44_2:
	ld	iy, 16
BB44_3:
	ld	bc, 8
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jr	z, BB44_9
	ld	hl, _atk_knight_offsets
	add	hl, de
	ld	a, (hl)
	add	a, (ix + 9)
	ld	l, a
	ld	bc, 0
	and	a, -120
	or	a, a
	jr	nz, BB44_8
	ld	c, l
	ld	hl, (ix + 6)
	add	hl, bc
	ld	l, (hl)
	ld	a, l
	or	a, a
	jr	z, BB44_8
	ld	a, l
	and	a, -128
	ld	h, a
	ld	a, l
	and	a, 7
	ld	l, a
	ld	a, h
	ld	c, (ix - 1)
	cp	a, c
	jr	nz, BB44_8
	ld	a, l
	cp	a, 2
	jp	z, BB44_38
BB44_8:
	inc	de
	jr	BB44_3
BB44_9:
	ld	a, (ix + 12)
	or	a, a
	jr	z, BB44_11
	ld	iy, -16
BB44_11:
	ld	e, (ix - 1)
	inc	e
	ld	bc, 0
	ld	c, (ix + 9)
	add	iy, bc
	lea	hl, iy
	ld	bc, 255
	add	hl, bc
	ld	a, l
	and	a, -120
	or	a, a
	jr	nz, BB44_13
	ld	bc, 255
	call	__iand
	push	hl
	pop	bc
	ld	hl, (ix + 6)
	add	hl, bc
	ld	bc, 255
	ld	a, (hl)
	cp	a, e
	jp	z, BB44_38
BB44_13:
	inc	iy
	ld	a, iyl
	and	a, -120
	or	a, a
	jr	nz, BB44_15
	lea	hl, iy
	call	__iand
	push	hl
	pop	bc
	ld	hl, (ix + 6)
	add	hl, bc
	ld	a, (hl)
	cp	a, e
	jp	z, BB44_38
BB44_15:
	ld	de, 0
	ld	iy, (ix + 6)
BB44_16:
	ld	bc, 8
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jr	z, BB44_22
	ld	hl, _atk_ray_offsets
	add	hl, de
	ld	a, (hl)
	add	a, (ix + 9)
	ld	l, a
	and	a, -120
	or	a, a
	jr	nz, BB44_21
	ld	bc, 0
	ld	c, l
	lea	hl, iy
	add	hl, bc
	ld	h, (hl)
	ld	a, h
	and	a, -128
	ld	c, a
	ld	a, h
	and	a, 7
	ld	l, a
	ld	a, h
	or	a, a
	jr	z, BB44_21
	ld	a, c
	ld	c, (ix - 1)
	cp	a, c
	jr	nz, BB44_21
	ld	a, l
	cp	a, 6
	jp	z, BB44_38
BB44_21:
	inc	de
	jr	BB44_16
BB44_22:
	ld	bc, 4
	ld	de, 0
	ld	iy, 0
BB44_23:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jr	z, BB44_31
	ld	hl, _bishop_offsets
	ld	(ix - 4), de
	add	hl, de
	ld	c, (hl)
	ld	a, c
	add	a, (ix + 9)
	ld	d, a
BB44_25:
	ld	b, d
	lea	de, iy
	ld	e, b
	ld	hl, (ix + 6)
	add	hl, de
	ld	l, (hl)
	ld	a, b
	add	a, c
	ld	d, a
	ld	a, l
	or	a, a
	jr	z, BB44_25
	ld	a, b
	and	a, -120
	ld	h, a
	ld	a, l
	and	a, -128
	ld	c, a
	ld	a, h
	or	a, a
	jr	nz, BB44_30
	ld	a, c
	ld	c, (ix - 1)
	cp	a, c
	jr	nz, BB44_30
	ld	a, l
	and	a, 7
	cp	a, 3
	jr	z, BB44_38
	cp	a, 5
	jr	z, BB44_38
BB44_30:
	ld	de, (ix - 4)
	inc	de
	ld	bc, 4
	jr	BB44_23
BB44_31:
	ld	de, 0
BB44_32:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jr	z, BB44_39
	ld	hl, _rook_offsets
	ld	(ix - 4), de
	add	hl, de
	ld	b, (hl)
	ld	a, b
	add	a, (ix + 9)
	ld	d, a
	ld	iy, 0
BB44_34:
	ld	c, d
	lea	de, iy
	ld	e, c
	ld	hl, (ix + 6)
	add	hl, de
	ld	l, (hl)
	ld	a, c
	add	a, b
	ld	d, a
	ld	a, l
	or	a, a
	jr	z, BB44_34
	ld	a, c
	and	a, -120
	ld	d, a
	ld	a, l
	and	a, -128
	ld	h, a
	ld	a, l
	and	a, 6
	ld	l, a
	ld	iy, (ix - 4)
	inc	iy
	ld	a, d
	lea	de, iy
	or	a, a
	ld	bc, 4
	jr	nz, BB44_32
	ld	a, h
	ld	c, (ix - 1)
	cp	a, c
	ld	bc, 4
	jr	nz, BB44_32
	ld	a, l
	cp	a, 4
	jr	nz, BB44_32
BB44_38:
	ld	a, 1
	jr	BB44_40
BB44_39:
	xor	a, a
BB44_40:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_generate_moves_from
_generate_moves_from:
	call	__frameset0
	ld	hl, (ix + 6)
	ld	b, 7
	ld	de, 0
	ld	e, (ix + 9)
	push	hl
	pop	iy
	add	iy, de
	ld	c, (iy)
	push	hl
	pop	iy
	ld	de, 422
	add	hl, de
	ld	d, (hl)
	ld	a, c
	call	__bshru
	ld	e, a
	ld	a, c
	or	a, a
	jr	z, BB45_3
	ld	a, e
	cp	a, d
	ld	a, 0
	jr	nz, BB45_4
	ld	hl, (ix + 12)
	ld	bc, 0
	push	bc
	push	hl
	ld	l, d
	push	hl
	ld	l, (ix + 9)
	push	hl
	push	iy
	call	_gen_piece_moves
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	jr	BB45_4
BB45_3:
	xor	a, a
BB45_4:
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_search_history_push
_search_history_push:
	call	__frameset0
	ld	iy, _pos_history_count
	ld	de, (iy)
	ld.sis	bc, 512
	ld	l, e
	ld	h, d
	or	a, a
	sbc.sis	hl, bc
	jr	nc, BB46_2
	or	a, a
	sbc	hl, hl
	ld	l, e
	ld	h, d
	inc.sis	de
	ld	(iy), e
	ld	(iy + 1), d
	ld	bc, 3
	call	__imulu
	push	hl
	pop	de
	ld	iy, _pos_history
	add	iy, de
	ld	hl, (ix + 6)
	ld	(iy), hl
BB46_2:
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_search_history_pop
_search_history_pop:
	ld	iy, _pos_history_count
	ld	hl, (iy)
	add.sis	hl, bc
	or	a, a
	sbc.sis	hl, bc
	jr	z, BB47_2
	dec.sis	hl
	ld	(iy), l
	ld	(iy + 1), h
BB47_2:
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_search_history_clear
_search_history_clear:
	ld.sis	bc, 0
	ld	iy, _pos_history_count
	ld	de, _pos_history_irreversible
	ld	(iy), c
	ld	(iy + 1), b
	ex	de, hl
	ld	(hl), c
	inc	hl
	ld	(hl), b
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_search_history_set_irreversible
_search_history_set_irreversible:
	ld	hl, _pos_history_count
	ld	iy, _pos_history_irreversible
	ld	hl, (hl)
	ld	(iy), l
	ld	(iy + 1), h
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_search_init
_search_init:
	ld	hl, -6
	call	__frameset
	ld	hl, _tt
	xor	a, a
	ld.sis	iy, 0
	ld	de, _history
	ld	(ix - 3), de
	ld	(_tt), a
	push	hl
	pop	de
	inc	de
	ld	bc, 32767
	ldir
	ld	hl, _pos_history_count
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	hl, _pos_history_irreversible
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	hl, _move_sp
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	de, 384
	ld	iy, 0
BB50_1:
	lea	hl, iy
	or	a, a
	sbc	hl, de
	jr	z, BB50_3
	lea	bc, iy
	lea	hl, iy
	ld	iy, _killers+2
	add	iy, bc
	ld	(iy - 2), -1
	ld	(iy - 1), -1
	ld	(iy), 0
	ld	(iy + 1), -1
	ld	(iy + 2), -1
	ld	(iy + 3), 0
	push	hl
	pop	iy
	ld	bc, 6
	add	iy, bc
	jr	BB50_1
BB50_3:
	ld	bc, 0
BB50_4:
	push	bc
	pop	hl
	ld	de, 2
	or	a, a
	sbc	hl, de
	jr	z, BB50_9
	ld	(ix - 6), bc
	ld	iy, 0
BB50_6:
	lea	hl, iy
	ld	de, 256
	or	a, a
	sbc	hl, de
	jr	z, BB50_8
	lea	bc, iy
	ld	hl, (ix - 3)
	add	hl, bc
	ld.sis	bc, 0
	ld	(hl), c
	inc	hl
	ld	(hl), b
	ld	bc, 2
	add	iy, bc
	jr	BB50_6
BB50_8:
	ld	bc, (ix - 6)
	inc	bc
	ld	hl, (ix - 3)
	ld	de, 256
	add	hl, de
	ld	(ix - 3), hl
	jr	BB50_4
BB50_9:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_search_go
_search_go:
	ld	hl, -29
	call	__frameset
	ld	iy, (ix + 12)
	or	a, a
	sbc	hl, hl
	ld	c, h
	ld	b, -1
	ld	de, _move_sp
	ld	(_search_nodes), hl
	ld	a, c
	ld	(_search_nodes+3), a
	ld	(_search_stopped), a
	ld	a, b
	ld	(_search_best_root_move), a
	ld	(_search_best_root_move+1), a
	ld	a, c
	ld	(_search_best_root_move+2), a
	ex	de, hl
	ld.sis	de, 0
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	bc, (iy + 9)
	ld	(_search_time_fn), bc
	ld	hl, (iy + 1)
	ld	d, (iy + 4)
	ld	(ix - 3), hl
	ld	e, d
	call	__lcmpzero
	ld	(ix - 23), a
	jr	z, BB51_3
	push	bc
	pop	hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	push	bc
	pop	iy
	jr	z, BB51_4
	call	__indcall
	push	hl
	pop	bc
	ld	a, e
	ld	hl, (ix + 12)
	push	hl
	pop	iy
	ld	hl, (iy + 1)
	ld	d, (iy + 4)
	ld	(ix - 3), hl
	ld	e, d
	call	__ladd
	ld	a, e
	ld	bc, (_search_time_fn)
	ld	(ix - 6), bc
	jr	BB51_5
BB51_3:
	ld	(ix - 6), bc
	or	a, a
	sbc	hl, hl
	jr	BB51_5
BB51_4:
	ld	(ix - 6), iy
	or	a, a
	sbc	hl, hl
	xor	a, a
BB51_5:
	ld	bc, 57005
	ld	(_search_deadline), hl
	ld	(_search_deadline+3), a
	ld	iy, (ix + 12)
	ld	hl, (iy + 5)
	ld	a, (iy + 8)
	ld	(_search_max_nodes), hl
	ld	(_search_max_nodes+3), a
	ld	hl, (ix - 3)
	ld	(_search_node_deadline), hl
	ld	a, d
	ld	(_search_node_deadline+3), a
	ld	hl, (iy + 12)
	ld	(_search_eval_noise), hl
	ld	hl, (iy + 15)
	ld	(_search_move_variance), hl
	ld	de, 431
	ld	hl, (ix + 9)
	add	hl, de
	ld	hl, (hl)
	call	__ixor
	xor	a, a
	ld	(_search_rng_state), hl
	ld	(_search_rng_state+3), a
	ld	hl, (ix - 6)
	push	hl
	pop	de
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	iy, _search_rng_state
	lea	hl, iy + 3
	ld	(ix - 12), hl
	jr	z, BB51_7
	ex	de, hl
	call	__indcallhl
	push	hl
	pop	bc
	ld	a, e
	ld	hl, (_search_rng_state)
	ld	iy, (ix - 12)
	ld	e, (iy)
	call	__lxor
	ld	a, e
	ld	(_search_rng_state), hl
	ld	(_search_rng_state+3), a
BB51_7:
	ld	c, 1
	ld	hl, (ix + 12)
	ld	l, (hl)
	ld	a, l
	or	a, a
	jr	nz, BB51_11
	ld	hl, (ix + 12)
	ex	de, hl
	ld	a, c
	push	de
	pop	iy
	ld	hl, (iy + 1)
	ld	e, (iy + 4)
	call	__lcmpzero
	jr	nz, BB51_10
	ld	hl, (ix + 12)
	ex	de, hl
	push	de
	pop	iy
	ld	hl, (iy + 5)
	ld	e, (iy + 8)
	call	__lcmpzero
	ld	l, c
	jr	z, BB51_11
BB51_10:
	ld	l, 63
BB51_11:
	ld	(ix - 3), l
	ld	hl, _root_scores
	ld	(ix - 19), hl
	ld	hl, _root_moves
	ld	(ix - 22), hl
	ld	iy, (ix + 6)
	ld	(iy), -1
	ld	(iy + 1), -1
	lea	hl, iy + 2
	ld	(iy + 2), 0
	ld	iyl, c
	push	hl
	pop	de
	inc	de
	ld	bc, 8
	ldir
	ld	a, (ix - 3)
	ld	d, iyl
	ld	e, -1
	ld	iyl, 0
	ld	bc, 0
	ld	(ix - 9), bc
BB51_12:
	cp	a, d
	call	pe, __setflag
	jp	m, BB51_38
	ld	a, -1
	ld	(_search_best_root_move), a
	ld	(_search_best_root_move+1), a
	inc	a
	ld	(_search_best_root_move+2), a
	ld	(_root_count_pending), a
	ld	hl, (ix + 6)
	ld	c, (hl)
	ld	a, d
	cp	a, 2
	call	pe, __setflag
	ld	l, e
	jp	m, BB51_15
	ex	de, hl
	ld	e, iyl
	ex	de, hl
BB51_15:
	ld	(ix - 26), c
	ld	a, c
	cp	a, -1
	jr	z, BB51_17
	ld	e, iyl
BB51_17:
	ld	a, l
	or	a, e
	ld	hl, (ix - 9)
	push	hl
	pop	iy
	ld	bc, -25
	add	iy, bc
	ld	bc, 25
	add	hl, bc
	bit	0, a
	ld	bc, 30000
	jr	nz, BB51_19
	push	hl
	pop	bc
BB51_19:
	ld	(ix - 15), bc
	bit	0, a
	ld	hl, -30000
	ld	(ix - 6), hl
	jr	nz, BB51_21
	ld	(ix - 6), iy
BB51_21:
	or	a, a
	sbc	hl, hl
	push	hl
	ld	bc, 1
	push	bc
	push	hl
	ld	hl, (ix - 15)
	push	hl
	ld	hl, (ix - 6)
	push	hl
	ld	(ix - 16), d
	ld	l, d
	push	hl
	ld	hl, (ix + 9)
	push	hl
	call	_negamax
	push	hl
	pop	de
	ld	hl, 21
	add	hl, sp
	ld	sp, hl
	ld	a, (_search_stopped)
	or	a, a
	jr	nz, BB51_25
	ld	hl, (ix - 6)
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB51_24
	push	de
	pop	hl
	ld	bc, (ix - 15)
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	jp	m, BB51_25
BB51_24:
	ld	a, -1
	ld	(_search_best_root_move), a
	ld	(_search_best_root_move+1), a
	inc	a
	ld	(_search_best_root_move+2), a
	ld	(_root_count_pending), a
	or	a, a
	sbc	hl, hl
	push	hl
	ld	de, 1
	push	de
	push	hl
	ld	hl, 30000
	push	hl
	ld	hl, -30000
	push	hl
	ld	l, (ix - 16)
	push	hl
	ld	hl, (ix + 9)
	push	hl
	call	_negamax
	push	hl
	pop	de
	ld	hl, 21
	add	hl, sp
	ld	sp, hl
BB51_25:
	ld	a, (_search_stopped)
	or	a, a
	jp	nz, BB51_30
	ld	a, (_search_best_root_move)
	cp	a, -1
	jp	z, BB51_36
	ld	hl, _search_best_root_move
	ld	a, (hl)
	ld	iy, (ix + 6)
	ld	(iy), a
	ld	a, (_search_best_root_move+1)
	ld	(iy + 1), a
	ld	a, (_search_best_root_move+2)
	ld	(iy + 2), a
	ld	(iy + 3), de
	ld	a, (ix - 16)
	ld	(iy + 6), a
	ld	hl, (_search_nodes)
	ld	a, (_search_nodes+3)
	ld	(iy + 7), hl
	ld	(iy + 10), a
	ld	a, (_root_count_pending)
	ld	(_root_count), a
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	bc, _root_scores
	ld	(ix - 6), bc
	ld	bc, _root_scores_pending
	ld	(ix - 9), bc
	ld	bc, _root_moves_pending
	ld	(ix - 15), bc
	ld	bc, _root_moves
BB51_28:
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB51_35
	ld	iy, (ix - 15)
	ld	a, (iy)
	ld	(ix - 26), de
	lea	de, iy
	push	bc
	pop	iy
	ld	(iy), a
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	bc
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	bc
	pop	iy
	ld	(ix - 29), iy
	ld	(iy + 2), a
	ld	iy, (ix - 9)
	ld	bc, (iy)
	ld	iy, (ix - 6)
	ld	(iy), c
	ld	(iy + 1), b
	ld	iy, (ix - 29)
	lea	iy, iy + 3
	lea	bc, iy
	push	de
	pop	iy
	ld	de, (ix - 26)
	lea	iy, iy + 3
	ld	(ix - 15), iy
	ld	iy, (ix - 9)
	lea	iy, iy + 2
	ld	(ix - 9), iy
	ld	iy, (ix - 6)
	lea	iy, iy + 2
	ld	(ix - 6), iy
	dec	hl
	jr	BB51_28
BB51_30:
	ld	e, (ix - 26)
	ld	a, e
	cp	a, -1
	ld	iy, (ix + 6)
	lea	hl, iy
	ld	bc, 0
	jr	nz, BB51_39
	ld	a, (_search_best_root_move)
	ld	l, a
	ld	a, (_search_deadline+3)
	ld	e, a
	ld	a, l
	cp	a, -1
	jp	nz, BB51_62
	ld	hl, (_search_deadline)
	ld	iy, (_search_time_fn)
	call	__lcmpzero
	jp	z, BB51_63
	lea	hl, iy
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB51_63
	call	__indcall
	ld	bc, 5000
	ld	d, 0
	ld	a, d
	call	__ladd
	ld	bc, 0
	ld	a, e
	ld	(_search_deadline), hl
	ld	(_search_deadline+3), a
	ld	a, d
	ld	(_search_stopped), a
	ld	d, (ix - 16)
	dec	d
	jr	BB51_37
BB51_35:
	ld	(ix - 9), de
BB51_36:
	ld	bc, 0
	ld	d, (ix - 16)
BB51_37:
	ld	a, (ix - 3)
	ld	e, -1
	ld	h, 0
	ex	de, hl
	ld	iyl, d
	ex	de, hl
	inc	d
	jp	BB51_12
BB51_38:
	ld	iy, (ix + 6)
	ld	e, (iy)
BB51_39:
	ld	a, (_search_best_root_move)
	ld	l, a
	ld	a, e
	cp	a, -1
	jr	nz, BB51_42
	ld	a, l
	cp	a, -1
	jr	z, BB51_42
	ld	hl, _search_best_root_move
	ld	a, (hl)
	ld	(iy), a
	ld	a, (_search_best_root_move+1)
	ld	(iy + 1), a
	ld	a, (_search_best_root_move+2)
	ld	(iy + 2), a
	ld	(iy + 3), bc
	ld	(iy + 6), 0
	ld	hl, (_search_nodes)
	ld	a, (_search_nodes+3)
	ld	(iy + 7), hl
	ld	(iy + 10), a
BB51_42:
	ld	bc, (_search_move_variance)
	ld	a, (_root_count)
	push	bc
	pop	hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB51_65
	cp	a, 2
	jp	c, BB51_65
	ld.sis	hl, -30000
	ld	(ix - 3), hl
	or	a, a
	sbc	hl, hl
	ex	de, hl
	ld	e, a
	ld	(ix - 6), de
	ld	iy, _root_scores
	xor	a, a
BB51_45:
	push	de
	pop	hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB51_49
	ld	(ix - 15), de
	ld	de, (iy)
	ld	hl, (ix - 3)
	ld	(ix - 9), de
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	jp	m, BB51_48
	ld	hl, (ix - 3)
	ld	(ix - 9), hl
BB51_48:
	lea	iy, iy + 2
	ld	de, (ix - 15)
	dec	de
	ld	hl, (ix - 9)
	ld	(ix - 3), hl
	jp	BB51_45
BB51_49:
	ld	hl, (ix - 3)
	or	a, a
	sbc.sis	hl, bc
	ld	(ix - 3), hl
	ld	bc, (ix - 6)
	ld	iy, _root_scores
	ld	de, (ix - 3)
BB51_50:
	push	bc
	pop	hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB51_54
	ld	hl, (iy)
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	ld	l, 1
	jp	p, BB51_53
	ld	l, 0
BB51_53:
	add	a, l
	lea	iy, iy + 2
	dec	bc
	jp	BB51_50
BB51_54:
	cp	a, 2
	ld	iy, (ix + 6)
	jp	c, BB51_65
	ld	iy, (_search_rng_state)
	ld	(ix - 9), a
	ld	hl, (ix - 12)
	ld	d, (hl)
	ld	l, 13
	lea	bc, iy
	ld	a, d
	call	__lshl
	push	bc
	pop	hl
	ld	e, a
	lea	bc, iy
	ld	a, d
	call	__lxor
	push	hl
	pop	iy
	ld	d, e
	ld	l, 17
	lea	bc, iy
	ld	a, d
	call	__lshru
	push	bc
	pop	hl
	ld	e, a
	lea	bc, iy
	ld	a, d
	call	__lxor
	push	hl
	pop	iy
	ld	d, e
	ld	l, 5
	lea	bc, iy
	ld	a, d
	call	__lshl
	push	bc
	pop	hl
	ld	e, a
	lea	bc, iy
	ld	iy, (ix + 6)
	ld	a, d
	call	__lxor
	ld	(_search_rng_state), hl
	ld	a, e
	ld	(_search_rng_state+3), a
	ld	bc, 0
	ld	c, (ix - 9)
	xor	a, a
	call	__lremu
	ld	(ix - 9), hl
	ld	hl, (ix - 6)
BB51_56:
	push	hl
	pop	bc
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB51_65
	ld	hl, (ix - 19)
	ld	hl, (hl)
	ld	(ix - 6), hl
	ld	de, (ix - 3)
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	jp	p, BB51_59
	lea	de, iy
	jr	BB51_61
BB51_59:
	or	a, a
	sbc	hl, hl
	ld	a, (ix - 23)
	ld	l, a
	ld	de, (ix - 9)
	sbc	hl, de
	jr	z, BB51_64
	lea	de, iy
	inc	a
	ld	(ix - 23), a
BB51_61:
	push	bc
	pop	hl
	ld	iy, (ix - 22)
	lea	iy, iy + 3
	ld	(ix - 22), iy
	ld	iy, (ix - 19)
	lea	iy, iy + 2
	ld	(ix - 19), iy
	dec	hl
	push	de
	pop	iy
	jp	BB51_56
BB51_62:
	ld	e, -1
	jp	BB51_39
BB51_63:
	ld	e, -1
	ld	iy, (ix + 6)
	lea	hl, iy
	jp	BB51_39
BB51_64:
	ld	de, (ix - 22)
	push	de
	pop	hl
	ld	a, (hl)
	ld	(iy), a
	push	de
	pop	iy
	ld	a, (iy + 1)
	ld	iy, (ix + 6)
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	ld	iy, (ix + 6)
	ld	(iy + 2), a
	ld	de, (ix - 6)
	ld	a, d
	ld	l, a
	rlc	l
	sbc	hl, hl
	ld	h, a
	ld	l, e
	ld	(iy + 3), hl
BB51_65:
	lea	hl, iy
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_negamax
_negamax:
	ld	hl, -169
	call	__frameset
	ld	d, 0
	ld	iy, 0
	ld	a, (_search_stopped)
	or	a, a
	jp	nz, BB52_17
	ld	iy, _search_nodes
	ld	bc, 1
	ld	hl, (_search_nodes)
	lea	iy, iy + 3
	ld	e, (iy)
	ld	a, d
	call	__ladd
	ld	a, e
	ld	(_search_nodes), hl
	ld	(_search_nodes+3), a
	call	_check_time
	ld	a, (_search_stopped)
	or	a, a
	jp	nz, BB52_16
	ld	bc, (ix + 6)
	ld	iy, _pos_history_count
	ld	a, (ix + 18)
	or	a, a
	ld	de, 431
	jp	nz, BB52_8
	ld	a, (ix + 9)
	cp	a, 1
	call	pe, __setflag
	jp	m, BB52_11
	push	bc
	pop	hl
	add	hl, de
	ld	iy, (hl)
BB52_5:
	lea	hl, ix - 11
	ld	(ix - 69), hl
	or	a, a
	sbc	hl, hl
	ld	l, (ix + 18)
	ld	(ix - 54), hl
	ld	(ix - 11), -1
	ld	(ix - 10), -1
	ld	(ix - 9), h
	ld	de, 434
	push	bc
	pop	hl
	add	hl, de
	ld	(ix - 57), hl
	ld	hl, (hl)
	pea	ix - 16
	pea	ix - 15
	pea	ix - 8
	pea	ix - 14
	push	hl
	push	iy
	call	_tt_probe
	ld	de, (ix + 6)
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	z, BB52_25
	ld	iy, (ix - 14)
	lea	hl, iy
	ld	de, 28937
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB52_20
	lea	hl, iy
	ld	de, (ix - 54)
	or	a, a
	sbc	hl, de
	push	hl
	pop	de
	ld	(ix - 14), de
	jp	BB52_23
BB52_8:
	push	bc
	pop	hl
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 54), hl
	ld	iy, (iy)
	ld.sis	bc, 3
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	or	a, a
	sbc.sis	hl, bc
	jr	nc, BB52_13
BB52_9:
	ld	de, 425
	ld	bc, (ix + 6)
	push	bc
	pop	hl
	add	hl, de
	ld	a, (hl)
	cp	a, 100
	jp	nc, BB52_16
	ld	a, (ix + 9)
	cp	a, 1
	call	pe, __setflag
	jp	p, BB52_18
BB52_11:
	or	a, a
	sbc	hl, hl
	push	hl
	ld	l, (ix + 18)
	push	hl
	ld	hl, (ix + 15)
	push	hl
	ld	hl, (ix + 12)
	push	hl
	push	bc
	call	_quiescence
	push	hl
	pop	iy
	pop	hl
	pop	hl
	pop	hl
	pop	hl
BB52_12:
	pop	hl
	jr	BB52_17
BB52_13:
	ld	hl, _pos_history_irreversible
	ld	bc, 0
	push	bc
	pop	de
	ld	e, iyl
	ld	d, iyh
	ld	hl, (hl)
	ld	c, l
	ld	b, h
	ld	(ix - 57), bc
	push	de
	pop	hl
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	iy, _pos_history
	add	iy, bc
	lea	hl, iy - 9
	ld	(ix - 60), hl
	dec	de
BB52_14:
	ld	hl, -2
	push	hl
	pop	bc
	ex	de, hl
	add	hl, bc
	push	hl
	pop	de
	ld	bc, (ix - 57)
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	jp	m, BB52_9
	ld	bc, (ix - 60)
	push	bc
	pop	iy
	lea	hl, iy - 6
	ld	(ix - 63), hl
	push	bc
	pop	hl
	ld	hl, (hl)
	ld	bc, (ix - 54)
	or	a, a
	sbc	hl, bc
	ld	hl, (ix - 63)
	ld	(ix - 60), hl
	jr	nz, BB52_14
BB52_16:
	ld	iy, 0
BB52_17:
	lea	hl, iy
	ld	sp, ix
	pop	ix
	ret
BB52_18:
	ld	a, (ix + 18)
	cp	a, 64
	ld	iy, (ix - 54)
	jp	c, BB52_5
	push	bc
	jp	BB52_141
BB52_20:
	lea	hl, iy
	ld	de, -28936
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB52_22
	ld	de, (ix - 54)
	add	iy, de
	ld	(ix - 14), iy
BB52_22:
	lea	de, iy
BB52_23:
	ld	l, (ix + 9)
	ld	a, (ix - 15)
	cp	a, l
	call	pe, __setflag
	jp	p, BB52_33
BB52_24:
	ld	hl, (ix - 8)
	add.sis	hl, bc
	or	a, a
	sbc.sis	hl, bc
	push	hl
	ld	hl, (ix - 69)
	push	hl
	call	nz, _tt_unpack_move
	pop	hl
	pop	hl
	ld	hl, (ix + 6)
	ex	de, hl
BB52_25:
	lea	hl, ix - 48
	ld	(ix - 82), hl
	push	hl
	push	de
	call	_compute_legal_info
	pop	hl
	pop	hl
	ld	h, (ix + 24)
	ld	e, (ix - 48)
	ld	a, h
	cp	a, 2
	sbc	a, a
	ld	l, a
	ld	(ix - 60), e
	ld	a, e
	or	a, a
	jr	nz, BB52_27
	ld	e, 0
	jr	BB52_28
BB52_27:
	ld	e, -1
BB52_28:
	ld	c, (ix + 9)
	ld	a, l
	and	a, e
	and	a, 1
	ld	l, a
	add	a, h
	ld	e, a
	ld	(ix - 91), de
	ld	a, l
	add	a, c
	ld	e, a
	ld	a, (ix + 18)
	or	a, a
	ld	hl, 0
	push	hl
	pop	bc
	ld	(ix - 70), e
	jp	z, BB52_46
	ld	a, (ix - 60)
	or	a, a
	push	hl
	pop	bc
	jp	nz, BB52_46
	ld	a, e
	cp	a, 3
	call	pe, __setflag
	push	hl
	pop	bc
	jp	p, BB52_46
	ld	a, e
	cp	a, 1
	jr	z, BB52_41
	ld	hl, 500
	jr	BB52_42
BB52_33:
	ld	a, (ix - 16)
	cp	a, 1
	jr	nz, BB52_35
	push	de
	jp	BB52_134
BB52_35:
	cp	a, 3
	jr	nz, BB52_38
	ex	de, hl
	ld	de, (ix + 15)
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB52_24
BB52_37:
	ld	iy, (ix + 15)
	jp	BB52_17
BB52_38:
	cp	a, 2
	jp	nz, BB52_24
	ld	hl, (ix + 12)
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB52_24
	ld	iy, (ix + 12)
	jp	BB52_17
BB52_41:
	ld	hl, 200
BB52_42:
	ld	(ix - 63), hl
	ld	hl, (ix + 6)
	push	hl
	call	_evaluate
	pop	de
	ld	de, (ix - 63)
	add	hl, de
	ex	de, hl
	ld	hl, (ix + 12)
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB52_44
	ld	bc, 0
	jr	BB52_45
BB52_44:
	ld	bc, 1
BB52_45:
	ld	e, (ix - 70)
BB52_46:
	ld	(ix - 88), bc
	ld	a, (ix + 18)
	or	a, a
	jr	z, BB52_50
	ld	a, (ix + 21)
	or	a, a
	jr	z, BB52_50
	ld	a, (ix - 60)
	or	a, a
	jr	nz, BB52_50
	ld	a, e
	cp	a, 3
	call	pe, __setflag
	jp	p, BB52_142
BB52_50:
	ld	iy, _killers
	ld	hl, -30000
	ld	(ix - 57), hl
	lea	hl, ix - 32
	ld	(ix - 85), hl
	lea	hl, ix - 35
	ld	(ix - 73), hl
	lea	hl, ix - 51
	ld	(ix - 79), hl
	ld	(ix - 35), -1
	ld	(ix - 34), -1
	ld	(ix - 33), 0
	ld	a, e
	dec	a
	ld	(ix - 63), a
	ld	d, (ix + 18)
	inc	d
	ld	hl, (ix + 15)
	call	__ineg
	ld	(ix - 94), hl
	ld	a, e
	add	a, -2
	ld	l, a
	ld	(ix - 121), hl
	ld	bc, 6
	ld	hl, (ix - 54)
	call	__imulu
	push	hl
	pop	bc
	add	iy, bc
	ld	(ix - 112), iy
	lea	hl, iy + 3
	ld	(ix - 127), hl
	ld	a, e
	rlc	a
	sbc	hl, hl
	ld	l, e
	push	hl
	pop	bc
	call	__imulu
	ld	(ix - 118), hl
	ld	c, (ix + 18)
	ld	l, d
	ld	(ix - 97), hl
	ld	a, (ix - 63)
	ld	l, a
	ld	(ix - 100), hl
	ld	iy, _search_rng_state
	lea	hl, iy + 3
	ld	(ix - 109), hl
	ld	l, d
	ld	(ix - 124), hl
	ld	(ix - 3), bc
	ld	bc, -130
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	ld	l, a
	push	ix
	ld	bc, -133
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	l, d
	ld	(ix - 103), hl
	ld	l, a
	ld	(ix - 106), hl
	ld	l, d
	ld	(ix - 115), hl
	ld	e, a
	ld	a, 2
	ld	(ix - 76), a
	xor	a, a
	ld	l, a
	ld	(ix - 66), l
	ld	(ix - 63), l
	ld	iy, (ix + 6)
	ld	hl, (ix + 12)
BB52_51:
	ld	bc, (ix - 3)
	bit	0, a
	jp	nz, BB52_131
	ld	a, (ix - 66)
	cp	a, 2
	jp	nc, BB52_131
	ld	(ix - 3), bc
	push	ix
	ld	bc, -157
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	bc, (ix - 3)
	push	ix
	ld	de, -151
	add	ix, de
	ld	(ix), bc
	pop	ix
	push	ix
	ld	bc, -145
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	a, (ix - 66)
	or	a, a
	ld	a, 1
	ld	l, a
	jr	z, BB52_55
	ld	a, 2
	ld	l, a
BB52_55:
	push	hl
	ld	hl, _raw_moves_buf
	push	hl
	push	iy
	call	_generate_moves
	ld	l, a
	ld	de, -139
	lea	iy, ix
	add	iy, de
	ld	(iy), hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, _move_sp
	ld	bc, (hl)
	ld	de, 0
	push	de
	pop	iy
	ld	iyl, c
	ld	iyh, b
	ld	(ix - 3), bc
	ld	bc, -139
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	e, l
	lea	hl, iy
	push	ix
	ld	bc, -136
	add	ix, bc
	ld	(ix), de
	pop	ix
	add	hl, de
	push	ix
	ld	bc, -148
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	de, 2049
	or	a, a
	sbc	hl, de
	ld	bc, (ix - 3)
	jp	nc, BB52_140
	ld	de, -160
	lea	hl, ix
	add	hl, de
	ld	(hl), bc
	lea	hl, iy
	ld	bc, 5
	call	__imulu
	push	hl
	pop	de
	ld	hl, _move_pool
	push	hl
	pop	iy
	add	iy, de
	ld	de, -136
	lea	hl, ix
	add	hl, de
	ld	hl, (hl)
	ld	de, _raw_moves_buf
	ld	(ix - 3), bc
	push	ix
	ld	bc, -142
	add	ix, bc
	ld	(ix), iy
	pop	ix
	push	ix
	ld	bc, -154
	add	ix, bc
	ld	(ix), iy
	pop	ix
	ld	bc, (ix - 3)
BB52_57:
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB52_59
	push	de
	pop	iy
	ld	a, (iy)
	lea	bc, iy
	ld	de, -154
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	ld	(iy), a
	lea	de, iy
	push	bc
	pop	iy
	ld	a, (iy + 1)
	push	de
	pop	iy
	ld	(iy + 1), a
	push	bc
	pop	iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	ld.sis	de, 0
	ld	(iy + 3), e
	ld	(iy + 4), d
	lea	iy, iy + 5
	push	ix
	ld	de, -154
	add	ix, de
	ld	(ix), iy
	pop	ix
	push	bc
	pop	iy
	lea	iy, iy + 3
	lea	de, iy
	dec	hl
	jr	BB52_57
BB52_59:
	ld	hl, _move_sp
	ld	bc, -148
	lea	iy, ix
	add	iy, bc
	ld	de, (iy)
	ld	(hl), e
	inc	hl
	ld	(hl), d
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	hl, (ix - 69)
	ld	a, (hl)
	ld	(iy), a
	ld	a, (ix - 10)
	ld	(iy + 1), a
	ld	a, (ix - 9)
	ld	(iy + 2), a
	ld	l, (ix + 18)
	push	hl
	ld	bc, -139
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	push	hl
	ld	bc, -142
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_score_moves
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	bc, -142
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	bc, -148
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	ld	e, 0
	ld	iyl, e
	ld	a, (ix - 63)
	ld	bc, -154
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	ld	bc, (ix - 57)
	ld	(ix - 3), bc
	push	ix
	ld	bc, -136
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	ld	bc, (ix - 3)
BB52_60:
	ld	(ix - 3), bc
	push	ix
	ld	bc, -136
	add	ix, bc
	ld	(ix), hl
	pop	ix
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	bc, (ix - 3)
	jp	z, BB52_118
	ld	de, -163
	lea	hl, ix
	add	hl, de
	ld	(hl), bc
	push	ix
	ld	bc, -166
	add	ix, bc
	ld	(ix), iy
	pop	ix
	push	iy
	ld	bc, -139
	lea	iy, ix
	add	iy, bc
	ld	hl, (iy)
	push	hl
	ld	bc, -142
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	push	hl
	call	_pick_move
	pop	hl
	pop	hl
	pop	hl
	ld	bc, -148
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	ld	a, (iy)
	ld	hl, (ix - 79)
	ld	(hl), a
	ld	a, (iy + 1)
	ld	(ix - 50), a
	ld	a, (iy + 2)
	ld	(ix - 49), a
	push	hl
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	a, (iy)
	push	de
	pop	hl
	ld	(hl), a
	ld	a, (iy + 1)
	lea	hl, iy
	push	de
	pop	iy
	ld	(iy + 1), a
	push	hl
	pop	iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 82)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_is_evasion_candidate
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jr	nz, BB52_64
BB52_62:
	ld	bc, -166
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
BB52_63:
	inc	e
	ld	bc, -148
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	lea	iy, iy + 5
	push	ix
	add	ix, bc
	ld	(ix), iy
	pop	ix
	push	de
	pop	iy
	push	ix
	ld	de, -136
	add	ix, de
	ld	hl, (ix)
	pop	ix
	dec	hl
	push	ix
	ld	de, -163
	add	ix, de
	ld	bc, (ix)
	pop	ix
	ld	e, 0
	jp	BB52_60
BB52_64:
	ld	hl, (ix - 88)
	bit	0, l
	jr	z, BB52_67
	ld	bc, -154
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	or	a, a
	jr	z, BB52_67
	ld	a, (ix - 49)
	and	a, 9
	or	a, a
	jr	z, BB52_62
BB52_67:
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	hl, (ix - 79)
	ld	a, (hl)
	ld	(iy), a
	ld	a, (ix - 50)
	ld	(iy + 1), a
	ld	a, (ix - 49)
	ld	(iy + 2), a
	ld	hl, (ix - 82)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_move_needs_legality_check
	ld	(ix - 57), a
	pop	hl
	pop	hl
	pop	hl
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	bc, -148
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
	push	de
	pop	hl
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 85)
	ld	(iy + 3), hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_make
	pop	hl
	pop	hl
	pop	hl
	ld	a, (ix - 57)
	or	a, a
	jr	z, BB52_70
	ld	hl, (ix + 6)
	push	hl
	call	_board_is_legal.25
	pop	hl
	or	a, a
	jr	nz, BB52_70
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	hl, (ix - 79)
	ld	a, (hl)
	ld	(iy), a
	ld	a, (ix - 50)
	ld	(iy + 1), a
	ld	a, (ix - 49)
	ld	(iy + 2), a
	ld	hl, (ix - 85)
	ld	(iy + 3), hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
	jp	BB52_62
BB52_70:
	ld	bc, -154
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	inc	a
	ld	(ix - 63), a
	ld	a, (_search_best_root_move)
	ld	l, a
	ld	a, (ix + 18)
	or	a, a
	jr	nz, BB52_73
	ld	a, l
	cp	a, -1
	jr	nz, BB52_73
	ld	hl, (ix - 79)
	ld	a, (hl)
	ld	hl, _search_best_root_move
	ld	(hl), a
	ld	a, (ix - 50)
	ld	(_search_best_root_move+1), a
	ld	a, (ix - 49)
	ld	(_search_best_root_move+2), a
BB52_73:
	ld	hl, (ix + 6)
	ld	de, 431
	add	hl, de
	ld	hl, (hl)
	push	hl
	call	_search_history_push
	pop	hl
	ld	a, (ix + 18)
	or	a, a
	ld	a, -1
	jr	z, BB52_75
	ld	a, 0
BB52_75:
	ld	de, (_search_move_variance)
	push	de
	pop	hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	l, -1
	jr	nz, BB52_77
	ld	l, 0
BB52_77:
	and	a, l
	bit	0, a
	ld	iy, (ix + 6)
	jr	nz, BB52_79
	ld	de, 0
BB52_79:
	ld	(ix - 3), de
	ld	de, -145
	lea	hl, ix
	add	hl, de
	ld	bc, (hl)
	push	bc
	pop	hl
	ld	de, (ix - 3)
	or	a, a
	sbc	hl, de
	push	hl
	pop	de
	ld	(ix - 3), bc
	push	ix
	ld	bc, -154
	add	ix, bc
	ld	a, (ix)
	pop	ix
	or	a, a
	ld	bc, (ix - 3)
	jr	nz, BB52_82
	push	bc
	pop	hl
	call	__ineg
	ld	de, (ix - 91)
	push	de
	ld	de, 1
	push	de
	ld	de, (ix - 97)
	push	de
	push	hl
	ld	hl, (ix - 94)
	push	hl
	ld	hl, (ix - 100)
	push	hl
	push	iy
BB52_81:
	call	_negamax
	ld	iy, 21
	add	iy, sp
	ld	sp, iy
	call	__ineg
	push	hl
	pop	bc
	xor	a, a
	jp	BB52_97
BB52_82:
	ld	a, (ix - 60)
	or	a, a
	ld	(ix - 57), de
	jp	nz, BB52_89
	ld	a, (ix - 63)
	cp	a, 5
	jp	c, BB52_89
	ld	a, (ix - 70)
	cp	a, 3
	call	pe, __setflag
	jp	m, BB52_89
	ld	a, (ix - 49)
	and	a, 9
	or	a, a
	jp	nz, BB52_89
	ld	bc, -145
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	call	__ineg
	push	ix
	ld	bc, -154
	add	ix, bc
	ld	(ix), hl
	pop	ix
	push	ix
	ld	bc, -145
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	call	__inot
	push	hl
	pop	bc
	ex	de, hl
	call	__ineg
	ld	de, (ix - 91)
	push	de
	ld	de, 1
	push	de
	ld	de, (ix - 124)
	push	de
	push	hl
	push	bc
	ld	hl, (ix - 121)
	push	hl
	push	iy
	call	_negamax
	ld	iy, 21
	add	iy, sp
	ld	sp, iy
	call	__ineg
	push	hl
	pop	de
	ld	bc, -145
	lea	iy, ix
	add	iy, bc
	ld	hl, (iy)
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB52_117
	ld	a, (_search_stopped)
	or	a, a
	jp	nz, BB52_117
	ld	hl, (ix - 91)
	push	hl
	ld	hl, 1
	push	hl
	ld	bc, -130
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	push	hl
	ld	bc, -154
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	push	hl
	ld	hl, (ix - 94)
	push	hl
	ld	bc, -133
	jp	BB52_93
BB52_89:
	ld	bc, -145
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	call	__ineg
	push	ix
	ld	bc, -154
	add	ix, bc
	ld	(ix), hl
	pop	ix
	push	ix
	ld	bc, -145
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	call	__inot
	push	de
	pop	bc
	push	hl
	pop	de
	push	bc
	pop	hl
	call	__ineg
	ld	bc, (ix - 91)
	push	bc
	ld	bc, 1
	push	bc
	ld	bc, (ix - 103)
	push	bc
	push	hl
	push	de
	ld	hl, (ix - 106)
	push	hl
	push	iy
	call	_negamax
	ld	iy, 21
	add	iy, sp
	ld	sp, iy
	call	__ineg
	push	hl
	pop	bc
	ld	de, -145
	lea	iy, ix
	add	iy, de
	ld	hl, (iy)
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	jp	p, BB52_94
	push	bc
	pop	hl
	ld	de, (ix + 15)
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB52_94
	ld	a, (_search_stopped)
	or	a, a
	jr	nz, BB52_94
	ld	hl, (ix - 91)
	push	hl
	ld	hl, 1
	push	hl
	ld	hl, (ix - 115)
	push	hl
	ld	bc, -154
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	push	hl
	ld	hl, (ix - 94)
	push	hl
	ld	bc, -157
BB52_93:
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	jp	BB52_81
BB52_94:
	ld	hl, (ix - 57)
	or	a, a
	sbc	hl, bc
BB52_95:
	call	pe, __setflag
	ld	a, -1
	jp	p, BB52_97
	ld	a, 0
BB52_97:
	ld	iy, _pos_history_count
	ld	de, -154
	lea	hl, ix
	add	hl, de
	ld	(hl), a
	ld	(ix - 57), bc
	ld	hl, (iy)
	add.sis	hl, bc
	or	a, a
	sbc.sis	hl, bc
	jr	z, BB52_99
	dec.sis	hl
	ld	(iy), l
	ld	(iy + 1), h
BB52_99:
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	hl, (ix - 79)
	ld	a, (hl)
	ld	(iy), a
	ld	a, (ix - 50)
	ld	(iy + 1), a
	ld	a, (ix - 49)
	ld	(iy + 2), a
	ld	hl, (ix - 85)
	ld	(iy + 3), hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
	ld	a, (_search_stopped)
	or	a, a
	jp	nz, BB52_147
	ld	a, (ix + 18)
	or	a, a
	jp	nz, BB52_103
	ld	de, (_search_eval_noise)
	push	de
	pop	hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB52_103
	ld	iy, (_search_rng_state)
	ld	hl, (ix - 109)
	push	ix
	ld	bc, -169
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	d, (hl)
	lea	bc, iy
	ld	a, d
	ld	l, 13
	call	__lshl
	push	bc
	pop	hl
	ld	e, a
	lea	bc, iy
	ld	a, d
	call	__lxor
	push	hl
	pop	iy
	ld	d, e
	lea	bc, iy
	ld	a, d
	ld	l, 17
	call	__lshru
	push	bc
	pop	hl
	ld	e, a
	lea	bc, iy
	ld	a, d
	call	__lxor
	push	hl
	pop	iy
	ld	d, e
	lea	bc, iy
	ld	a, d
	ld	l, 5
	call	__lshl
	push	bc
	pop	hl
	ld	e, a
	lea	bc, iy
	ld	a, d
	call	__lxor
	push	hl
	pop	iy
	ld	(_search_rng_state), iy
	ld	a, e
	ld	(_search_rng_state+3), a
	ld	(ix - 3), de
	push	ix
	ld	de, -169
	add	ix, de
	ld	hl, (ix)
	pop	ix
	ld	c, 1
	call	__ishl
	push	hl
	pop	bc
	inc	bc
	xor	a, a
	lea	hl, iy
	ld	de, (ix - 3)
	call	__lremu
	push	hl
	pop	de
	ld	hl, (ix - 57)
	ld	(ix - 3), de
	ld	de, -169
	lea	iy, ix
	add	iy, de
	ld	bc, (iy)
	or	a, a
	sbc	hl, bc
	ld	de, (ix - 3)
	add	hl, de
	ld	(ix - 57), hl
	ld	de, -151
	lea	hl, ix
	add	hl, de
	ld	bc, (hl)
	push	ix
	ld	bc, -163
	add	ix, bc
	ld	iy, (ix)
	pop	ix
	jr	BB52_104
BB52_103:
	ld	de, -151
	lea	hl, ix
	add	hl, de
	ld	bc, (hl)
	ld	bc, -163
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
BB52_104:
	ld	a, (ix + 18)
	or	a, a
	jr	nz, BB52_109
	ld	hl, (_search_move_variance)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB52_109
	ld	a, (_root_count_pending)
	cp	a, 16
	jr	nc, BB52_109
	ld	bc, -154
	lea	hl, ix
	add	hl, bc
	bit	0, (hl)
	jr	nz, BB52_109
	ld	de, 0
	ld	e, a
	push	de
	pop	hl
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	iy, _root_moves_pending
	add	iy, bc
	ld	hl, (ix - 79)
	ld	l, (hl)
	ld	(iy), l
	ld	l, (ix - 50)
	ld	(iy + 1), l
	ld	l, (ix - 49)
	ld	(iy + 2), l
	ld	bc, -163
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	ex	de, hl
	ld	c, 1
	call	__ishl
	push	ix
	ld	de, -151
	add	ix, de
	ld	bc, (ix)
	pop	ix
	push	hl
	pop	de
	ld	hl, _root_scores_pending
	add	hl, de
	ld	de, (ix - 57)
	ld	(hl), e
	inc	hl
	ld	(hl), d
	inc	a
	ld	(_root_count_pending), a
BB52_109:
	lea	hl, iy
	ld	de, (ix - 57)
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB52_115
	ld	hl, (ix - 79)
	ld	a, (hl)
	ld	hl, (ix - 73)
	ld	(hl), a
	ld	a, (ix - 50)
	ld	(ix - 34), a
	ld	a, (ix - 49)
	ld	(ix - 33), a
	ld	a, (ix + 18)
	or	a, a
	ld	bc, -166
	lea	hl, ix
	push	af
	add	hl, bc
	pop	af
	ld	de, (hl)
	jr	nz, BB52_112
	ld	hl, (ix - 79)
	ld	a, (hl)
	ld	hl, _search_best_root_move
	ld	(hl), a
	ld	a, (ix - 50)
	ld	(_search_best_root_move+1), a
	ld	a, (ix - 49)
	ld	(_search_best_root_move+2), a
BB52_112:
	ld	bc, -145
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	bc, (ix - 57)
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	jp	p, BB52_116
	push	bc
	pop	iy
	push	bc
	pop	hl
	ld	bc, (ix + 15)
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	jp	p, BB52_120
	ld	a, 1
	ld	(ix - 76), a
	ld	a, (ix - 63)
	ld	bc, -154
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	push	ix
	ld	bc, -163
	add	ix, bc
	ld	(ix), iy
	pop	ix
	push	ix
	ld	bc, -145
	add	ix, bc
	ld	(ix), iy
	pop	ix
	jp	BB52_63
BB52_115:
	ld	a, (ix - 63)
	ld	bc, -154
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	ld	bc, -166
	lea	iy, ix
	add	iy, bc
	ld	de, (iy)
	jp	BB52_63
BB52_116:
	ld	a, (ix - 63)
	ld	(ix - 3), de
	ld	de, -154
	lea	hl, ix
	add	hl, de
	ld	(hl), a
	ld	de, -163
	lea	iy, ix
	add	iy, de
	ld	(iy), bc
	ld	de, (ix - 3)
	jp	BB52_63
BB52_117:
	ld	hl, (ix - 57)
	push	de
	pop	bc
	or	a, a
	sbc	hl, de
	jp	BB52_95
BB52_118:
	ld	a, e
	ld	de, -154
	lea	hl, ix
	add	hl, de
	ld	l, (hl)
	ld	(ix - 63), l
	ld	(ix - 57), bc
	ld	de, -145
	lea	iy, ix
	add	iy, de
	ld	hl, (iy)
	push	ix
	ld	de, -151
	add	ix, de
	ld	bc, (ix)
	pop	ix
BB52_119:
	ld	iy, _move_sp
	ld	(ix - 3), bc
	push	ix
	ld	bc, -160
	add	ix, bc
	ld	de, (ix)
	pop	ix
	ld	(iy), e
	ld	(iy + 1), d
	ld	e, (ix - 66)
	inc	e
	ld	(ix - 66), e
	ld	bc, -157
	lea	iy, ix
	add	iy, bc
	ld	de, (iy)
	ld	iy, (ix + 6)
	jp	BB52_51
BB52_120:
	ld	d, (ix - 49)
	ld	a, d
	and	a, 1
	bit	0, a
	ld	bc, (ix + 6)
	jp	nz, BB52_130
	ld	e, (ix - 51)
	ld	a, (ix - 50)
	ld	(ix - 76), a
	ld	hl, (ix - 112)
	ld	l, (hl)
	ld	(ix - 3), bc
	ld	bc, -136
	lea	iy, ix
	add	iy, bc
	ld	(iy), e
	ld	a, e
	cp	a, l
	ld	bc, (ix - 3)
	jr	nz, BB52_124
	ld	iy, (ix - 112)
	ld	e, (iy + 1)
	ld	a, (ix - 76)
	cp	a, e
	jr	nz, BB52_124
	ld	iy, (ix - 112)
	ld	e, (iy + 2)
	ld	a, d
	cp	a, e
	jr	z, BB52_125
BB52_124:
	ld	iy, (ix - 112)
	ld	a, (iy)
	ld	hl, (ix - 127)
	ld	(hl), a
	ld	a, (iy + 1)
	ld	(iy + 4), a
	ld	a, (iy + 2)
	ld	(iy + 5), a
	ld	(ix - 3), bc
	ld	bc, -136
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	ld	(iy), a
	ld	a, (ix - 76)
	ld	(iy + 1), a
	ld	(iy + 2), d
	ld	bc, (ix - 3)
BB52_125:
	push	bc
	pop	iy
	ld	de, 422
	add	iy, de
	ld	de, 0
	push	de
	pop	hl
	ld	l, (iy)
	ld	e, (ix - 76)
	ld	c, 8
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _history
	push	hl
	pop	iy
	add	iy, bc
	ex	de, hl
	ld	c, 1
	call	__ishl
	push	hl
	pop	de
	add	iy, de
	ld	(ix - 76), iy
	ld	bc, (iy)
	ld	a, b
	ld	l, a
	rlc	l
	sbc	hl, hl
	push	hl
	pop	de
	ld	d, a
	ld	e, c
	ld	iy, (ix - 118)
	lea	hl, iy
	push	de
	pop	bc
	call	__imulu
	ld	bc, -16384
	call	__idivs
	push	hl
	pop	bc
	add	iy, de
	add	iy, bc
	lea	hl, iy
	ld	de, 4000
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB52_127
	ld	iy, 4000
BB52_127:
	lea	hl, iy
	ld	de, -3999
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB52_129
	ld	iy, -4000
BB52_129:
	ld	hl, (ix - 76)
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
BB52_130:
	ld	a, 3
	ld	(ix - 76), a
	ld	a, 1
	ld	hl, (ix - 57)
	ld	de, -151
	lea	iy, ix
	add	iy, de
	ld	bc, (iy)
	jp	BB52_119
BB52_131:
	ld	a, (ix - 63)
	or	a, a
	jr	nz, BB52_135
	ld	iy, (ix - 54)
	ld	de, -29000
	add	iy, de
	ld	a, (ix - 60)
	or	a, a
	ld	hl, 0
	jp	nz, BB52_17
	push	hl
BB52_134:
	pop	iy
	jp	BB52_17
BB52_135:
	ld	bc, (ix - 57)
	push	bc
	pop	hl
	ld	de, -28936
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	ld	hl, (ix - 54)
	jp	m, BB52_137
	or	a, a
	sbc	hl, hl
BB52_137:
	call	__ineg
	push	hl
	pop	de
	push	bc
	pop	hl
	ld	bc, 28937
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	jp	p, BB52_139
	ld	(ix - 54), de
BB52_139:
	ld	de, (ix - 57)
	ld	hl, (ix - 54)
	add	hl, de
	ld	(ix - 54), hl
	lea	hl, iy
	ld	de, 431
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 63), hl
	ld	de, 434
	add	iy, de
	ld	hl, (iy)
	ld	(ix - 60), hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	hl, (ix - 73)
	ld	a, (hl)
	ld	(iy), a
	ld	a, (ix - 34)
	ld	(iy + 1), a
	ld	a, (ix - 33)
	ld	(iy + 2), a
	call	_tt_pack_move
	ld	e, l
	ld	d, h
	pop	hl
	ld	hl, (ix - 63)
	ld	bc, 4095
	call	__iand
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _tt
	add	iy, bc
	ld	hl, (ix - 60)
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, (ix - 54)
	ld	(iy + 2), l
	ld	(iy + 3), h
	ld	(iy + 4), e
	ld	(iy + 5), d
	ld	a, (ix - 70)
	ld	(iy + 6), a
	ld	a, (ix - 76)
	ld	(iy + 7), a
	ld	iy, (ix - 57)
	jp	BB52_17
BB52_140:
	ld	hl, (ix + 6)
	push	hl
BB52_141:
	call	_evaluate
	push	hl
	pop	iy
	jp	BB52_12
BB52_142:
	ld	iy, (ix + 6)
	lea	hl, iy
	ld	de, 422
	add	hl, de
	ld	a, (hl)
	ld	de, 0
	ld	(ix - 66), a
	ld	e, a
	ld	bc, 416
	lea	hl, iy
	add	hl, de
	add	hl, bc
	ld	iy, 0
	push	af
	ld	a, (hl)
	ld	iyl, a
	pop	af
	ld	c, 4
	ex	de, hl
	call	__ishl
	ld	de, 256
	add	hl, de
	ld	(ix - 63), hl
BB52_143:
	lea	hl, iy
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	e, (ix - 70)
	jp	z, BB52_50
	ld	bc, (ix + 6)
	push	bc
	pop	hl
	ld	de, (ix - 63)
	add	hl, de
	ld	de, 0
	ld	e, (hl)
	push	bc
	pop	hl
	add	hl, de
	ld	a, (hl)
	and	a, 7
	cp	a, 1
	jr	z, BB52_146
	cp	a, 6
	jr	nz, BB52_148
BB52_146:
	ld	hl, (ix - 63)
	inc	hl
	ld	(ix - 63), hl
	dec	iy
	jr	BB52_143
BB52_147:
	ld	hl, _move_sp
	ld	bc, -160
	lea	iy, ix
	add	iy, bc
	ld	de, (iy)
	ld	(hl), e
	inc	hl
	ld	(hl), d
	jp	BB52_16
BB52_148:
	ld	de, 424
	ld	iy, (ix + 6)
	lea	bc, iy
	push	bc
	pop	hl
	add	hl, de
	ld	(ix - 73), hl
	ld	a, (hl)
	ld	(ix - 76), a
	push	bc
	pop	hl
	ld	de, 431
	add	hl, de
	ld	(ix - 63), hl
	ld	hl, (hl)
	ld	iy, (ix - 57)
	ld	de, (iy)
	ld	(ix - 79), de
	ld	a, (ix - 66)
	xor	a, 1
	push	bc
	pop	iy
	ld	de, 422
	add	iy, de
	ld	(ix - 94), iy
	ld	(iy), a
	ld	bc, (_zobrist_side)
	ld	(ix - 85), hl
	call	__ixor
	ld	(ix - 66), hl
	ld	iy, (ix - 63)
	ld	(iy), hl
	ld	hl, _lock_side
	ld	hl, (hl)
	ld	bc, (ix - 79)
	call	__sxor
	ld	a, (ix - 76)
	ld	iy, (ix - 57)
	ld	(iy), l
	ld	(iy + 1), h
	cp	a, -1
	jp	z, BB52_150
	and	a, 7
	ld	iyl, a
	ld	b, 2
	call	__bshl
	ld	de, 0
	ld	e, a
	ld	(ix - 97), hl
	ld	hl, _zobrist_ep_file
	add	hl, de
	ld	bc, (hl)
	ld	hl, (ix - 66)
	call	__ixor
	push	hl
	pop	bc
	ld	(ix - 66), bc
	ld	hl, (ix - 63)
	ld	(hl), bc
	ld	a, iyl
	add	a, a
	ld	e, a
	ld	hl, _lock_ep_file
	add	hl, de
	ld	hl, (hl)
	ld	bc, (ix - 97)
	call	__sxor
	ld	de, (ix + 6)
	push	de
	pop	iy
	ld	bc, 434
	add	iy, bc
	ld	(iy), l
	ld	(iy + 1), h
BB52_150:
	ld	hl, (ix - 73)
	ld	(hl), -1
	ld	hl, (ix - 66)
	push	hl
	call	_search_history_push
	pop	hl
	ld	a, (ix - 70)
	add	a, -3
	ld	iyl, a
	ld	bc, (ix + 15)
	push	bc
	pop	hl
	call	__ineg
	push	hl
	pop	de
	ld	hl, 1
	or	a, a
	sbc	hl, bc
	ld	a, (ix + 18)
	inc	a
	ld	bc, (ix - 91)
	push	bc
	ld	bc, 0
	push	bc
	ld	c, a
	push	bc
	push	hl
	push	de
	push	iy
	ld	hl, (ix + 6)
	push	hl
	call	_negamax
	push	hl
	pop	de
	ld	hl, 21
	add	hl, sp
	ld	sp, hl
	ld	iy, _pos_history_count
	ld	hl, (iy)
	add.sis	hl, bc
	or	a, a
	sbc.sis	hl, bc
	jr	z, BB52_152
	dec.sis	hl
	ld	(iy), l
	ld	(iy + 1), h
BB52_152:
	ld	hl, (ix - 94)
	ld	a, (hl)
	xor	a, 1
	ld	(hl), a
	ld	hl, (ix - 63)
	ld	bc, (ix - 85)
	ld	(hl), bc
	ld	hl, (ix - 57)
	ld	bc, (ix - 79)
	ld	(hl), c
	inc	hl
	ld	(hl), b
	ld	hl, (ix - 73)
	ld	a, (ix - 76)
	ld	(hl), a
	ld	a, (_search_stopped)
	or	a, a
	jp	nz, BB52_16
	ex	de, hl
	call	__ineg
	ld	de, (ix + 15)
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	ld	e, (ix - 70)
	jp	p, BB52_37
	jp	BB52_50
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_check_time
_check_time:
	ld	hl, -3
	call	__frameset
	ld	iy, (_search_time_fn)
	ld	a, (_search_deadline+3)
	lea	hl, iy
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB53_5
	ld	hl, (_search_deadline)
	ld	e, a
	call	__lcmpzero
	jr	z, BB53_5
	ld	a, (_search_nodes)
	or	a, a
	jr	nz, BB53_5
	call	__indcall
	ld	bc, (_search_deadline)
	ld	a, (_search_deadline+3)
	call	__lcmpu
	jr	c, BB53_5
	ld	a, 1
	ld	(_search_stopped), a
BB53_5:
	ld	bc, (_search_max_nodes)
	ld	a, (_search_max_nodes+3)
	ld	iyl, a
	ld	hl, (_search_nodes)
	ld	(ix - 3), hl
	ld	a, (_search_nodes+3)
	ld	d, a
	push	bc
	pop	hl
	ld	e, iyl
	call	__lcmpzero
	jr	z, BB53_8
	ld	hl, (ix - 3)
	ld	e, d
	ld	a, iyl
	call	__lcmpu
	jr	c, BB53_8
	ld	a, 1
	ld	(_search_stopped), a
BB53_8:
	ld	bc, (_search_node_deadline)
	ld	a, (_search_node_deadline+3)
	push	bc
	pop	hl
	ld	e, a
	call	__lcmpzero
	jr	z, BB53_11
	ld	hl, (ix - 3)
	ld	e, d
	call	__lcmpu
	jr	c, BB53_11
	ld	a, 1
	ld	(_search_stopped), a
BB53_11:
	pop	hl
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_quiescence
_quiescence:
	ld	hl, -74
	call	__frameset
	or	a, a
	sbc	hl, hl
	ld	a, (_search_stopped)
	or	a, a
	jp	nz, BB54_63
	ld	iy, _search_nodes
	ld	bc, 1
	ld	hl, (_search_nodes)
	lea	iy, iy + 3
	ld	e, (iy)
	ld	iyl, b
	ld	a, iyl
	call	__ladd
	ld	a, e
	ld	(_search_nodes), hl
	ld	(_search_nodes+3), a
	call	_check_time
	ld	a, (_search_stopped)
	or	a, a
	jp	nz, BB54_62
	ld	hl, (ix + 6)
	ld	a, (ix + 15)
	cp	a, 64
	jr	nc, BB54_4
	ld	a, (ix + 18)
	cp	a, 8
	jr	c, BB54_5
BB54_4:
	push	hl
	call	_evaluate
	pop	de
	jp	BB54_63
BB54_5:
	lea	de, ix - 16
	ld	(ix - 38), de
	lea	de, ix - 29
	ld	(ix - 41), de
	push	de
	push	hl
	call	_compute_legal_info
	pop	hl
	pop	hl
	ld	a, (ix - 29)
	or	a, a
	jp	nz, BB54_12
	ld	hl, _raw_moves_buf
	ld	(ix - 35), hl
	ld	hl, (ix + 6)
	push	hl
	call	_evaluate
	push	hl
	pop	iy
	pop	hl
	lea	hl, iy
	ld	de, (ix + 12)
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	ex	de, hl
	jp	p, BB54_63
	ld	de, (ix + 9)
	push	de
	pop	hl
	lea	bc, iy
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	jp	m, BB54_9
	push	de
	pop	bc
BB54_9:
	ld	de, 1100
	add	iy, de
	lea	hl, iy
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	jp	m, BB54_58
	ld	(ix - 44), bc
	ld	hl, 1
	push	hl
	ld	hl, _raw_moves_buf
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_generate_moves
	ld	iyl, a
	pop	hl
	pop	hl
	pop	hl
	ld	hl, _move_sp
	ld	de, (hl)
	or	a, a
	sbc	hl, hl
	push	hl
	pop	bc
	ld	(ix - 53), de
	ld	c, e
	ld	b, d
	ex	de, hl
	ld	(ix - 62), iy
	ld	e, iyl
	push	bc
	pop	hl
	ld	(ix - 47), de
	add	hl, de
	ld	de, 2049
	ld	(ix - 50), hl
	or	a, a
	sbc	hl, de
	jp	c, BB54_29
	ld	hl, (ix - 44)
	jp	BB54_63
BB54_12:
	or	a, a
	sbc	hl, hl
	push	hl
	ld	hl, _raw_moves_buf
	ld	(ix - 35), hl
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_generate_moves
	ld	c, a
	pop	hl
	pop	hl
	pop	hl
	ld	hl, _move_sp
	ld	hl, (hl)
	ld	de, 0
	push	de
	pop	iy
	ld	(ix - 59), hl
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	ld	(ix - 44), de
	ld	(ix - 50), bc
	ld	e, c
	lea	hl, iy
	add	hl, de
	ld	bc, 2049
	ld	(ix - 56), hl
	or	a, a
	sbc	hl, bc
	jr	c, BB54_14
	ld	hl, (ix + 6)
	jp	BB54_4
BB54_14:
	lea	hl, ix - 32
	ld	(ix - 62), hl
	ld	hl, (ix - 44)
	ld	l, (ix + 15)
	ld	(ix - 44), hl
	ld	bc, 5
	lea	hl, iy
	call	__imulu
	push	hl
	pop	bc
	ld	iy, _move_pool
	add	iy, bc
	push	de
	pop	hl
	ld	(ix - 53), iy
	lea	bc, iy
	ld	(ix - 47), de
BB54_15:
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB54_17
	ld	iy, (ix - 35)
	ld	a, (iy)
	lea	de, iy
	push	bc
	pop	iy
	ld	(iy), a
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	bc
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	bc
	pop	iy
	ld	(iy + 2), a
	ld.sis	bc, 0
	ld	(iy + 3), c
	ld	(iy + 4), b
	lea	iy, iy + 5
	lea	bc, iy
	push	de
	pop	iy
	lea	iy, iy + 3
	ld	(ix - 35), iy
	dec	hl
	jr	BB54_15
BB54_17:
	ld	hl, _move_sp
	ld	bc, (ix - 56)
	ld	(hl), c
	inc	hl
	ld	(hl), b
	ld	(ix - 32), -1
	ld	(ix - 31), -1
	ld	(ix - 30), 0
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	hl, (ix - 62)
	ld	a, (hl)
	ld	(iy), a
	ld	a, (ix - 31)
	ld	(iy + 1), a
	ld	a, (ix - 30)
	ld	(iy + 2), a
	ld	l, (ix + 15)
	push	hl
	ld	hl, (ix - 50)
	push	hl
	ld	hl, (ix - 53)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_score_moves
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (ix + 12)
	call	__ineg
	ld	(ix - 68), hl
	ld	e, (ix + 15)
	inc	e
	ld	a, (ix + 18)
	inc	a
	ld	l, a
	ld	(ix - 71), hl
	ld	l, e
	ld	(ix - 74), hl
	ld	hl, (ix - 47)
	ld	iy, (ix - 53)
	ld	e, 0
	ld	a, e
	ld	bc, (ix + 9)
BB54_18:
	ld	(ix - 47), hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB54_28
	ld	(ix - 65), a
	ld	(ix - 62), bc
	ld	(ix - 56), de
	push	de
	ld	hl, (ix - 50)
	push	hl
	ld	hl, (ix - 53)
	push	hl
	ld	(ix - 35), iy
	call	_pick_move
	pop	hl
	pop	hl
	pop	hl
	push	hl
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	iy, (ix - 35)
	ld	a, (iy)
	push	de
	pop	hl
	ld	(hl), a
	ld	a, (iy + 1)
	lea	hl, iy
	push	de
	pop	iy
	ld	(iy + 1), a
	push	hl
	pop	iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 41)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_is_evasion_candidate
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	z, BB54_22
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	de, (ix - 35)
	push	de
	pop	hl
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 38)
	ld	(iy + 3), hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_make
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_is_legal.25
	pop	hl
	or	a, a
	jr	nz, BB54_24
	push	hl
	push	hl
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	iy, (ix - 35)
	ld	a, (iy)
	push	de
	pop	hl
	ld	(hl), a
	ld	a, (iy + 1)
	lea	hl, iy
	push	de
	pop	iy
	ld	(iy + 1), a
	push	hl
	pop	iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 38)
	ld	(iy + 3), hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
BB54_22:
	ld	bc, (ix - 62)
	ld	a, (ix - 65)
BB54_23:
	ld	de, (ix - 56)
	inc	e
	ld	iy, (ix - 35)
	lea	iy, iy + 5
	ld	hl, (ix - 47)
	dec	hl
	jp	BB54_18
BB54_24:
	ld	hl, (ix - 62)
	call	__ineg
	ld	de, (ix - 71)
	push	de
	ld	de, (ix - 74)
	push	de
	push	hl
	ld	hl, (ix - 68)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_quiescence
	pop	de
	pop	de
	pop	de
	pop	de
	pop	de
	call	__ineg
	ld	(ix - 65), hl
	push	hl
	push	hl
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	iy, (ix - 35)
	ld	a, (iy)
	push	de
	pop	hl
	ld	(hl), a
	ld	a, (iy + 1)
	lea	hl, iy
	push	de
	pop	iy
	ld	(iy + 1), a
	push	hl
	pop	iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 38)
	ld	(iy + 3), hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
	ld	a, (_search_stopped)
	or	a, a
	jp	nz, BB54_59
	ld	bc, (ix - 62)
	push	bc
	pop	hl
	ld	de, (ix - 65)
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	ld	a, 1
	jp	p, BB54_23
	ld	bc, (ix - 65)
	push	bc
	pop	hl
	ld	de, (ix + 12)
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	ld	a, 1
	jp	m, BB54_23
	ld	hl, _move_sp
	ld	de, (ix - 59)
	ld	(hl), e
	inc	hl
	ld	(hl), d
	jp	BB54_65
BB54_28:
	ld	hl, _move_sp
	ld	de, (ix - 59)
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	hl, (ix - 44)
	ld	de, -29000
	add	hl, de
	or	a, a
	jp	nz, BB54_58
	jp	BB54_63
BB54_29:
	ld	iy, 5
	ld	(ix - 56), bc
	push	bc
	pop	hl
	lea	bc, iy
	call	__imulu
	push	hl
	pop	bc
	ld	hl, _move_pool
	push	hl
	pop	iy
	add	iy, bc
	ld	hl, (ix - 47)
	ld	(ix - 59), iy
	lea	bc, iy
BB54_30:
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB54_32
	ld	iy, (ix - 35)
	ld	a, (iy)
	lea	de, iy
	push	bc
	pop	iy
	ld	(iy), a
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	bc
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	bc
	pop	iy
	ld	(iy + 2), a
	ld.sis	bc, 0
	ld	(iy + 3), c
	ld	(iy + 4), b
	lea	iy, iy + 5
	lea	bc, iy
	push	de
	pop	iy
	lea	iy, iy + 3
	ld	(ix - 35), iy
	dec	hl
	jr	BB54_30
BB54_32:
	ld	hl, _move_sp
	ld	bc, (ix - 50)
	ld	(hl), c
	inc	hl
	ld	(hl), b
	ld	hl, (ix - 56)
	ld	bc, 5
	call	__imulu
	push	hl
	pop	bc
	ld	hl, _move_pool
	push	hl
	pop	iy
	add	iy, bc
	lea	hl, iy + 3
	ld	(ix - 35), hl
	ld	hl, (ix - 47)
	ld	de, (ix + 12)
	ld	bc, (ix - 44)
BB54_33:
	ld	(ix - 50), hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB54_48
	ld	iy, (ix - 35)
	ld	e, (iy - 1)
	ld	a, e
	and	a, 1
	bit	0, a
	ld.sis	hl, 10000
	jr	z, BB54_42
	ld	bc, 0
	ld	iy, (ix - 35)
	ld	c, (iy - 2)
	ld	hl, (ix + 6)
	add	hl, bc
	ld	a, (hl)
	and	a, 7
	ld	d, a
	bit	2, e
	jr	z, BB54_37
	ld	d, 1
BB54_37:
	ld	a, d
	or	a, a
	ld.sis	hl, 10000
	jr	z, BB54_42
	ld	a, d
	cp	a, 7
	ld.sis	hl, 10000
	jr	z, BB54_42
	ld	bc, 0
	ld	iy, (ix - 35)
	ld	c, (iy - 3)
	ld	hl, (ix + 6)
	add	hl, bc
	ld	a, (hl)
	and	a, 7
	ld	c, a
	or	a, a
	ld.sis	hl, 10000
	jr	z, BB54_42
	ld	a, c
	cp	a, 7
	ld.sis	hl, 10000
	jr	z, BB54_42
	or	a, a
	sbc	hl, hl
	ld	l, d
	ld	iy, 0
	ld	iyl, c
	dec	hl
	ld	bc, 6
	call	__imulu
	push	hl
	pop	bc
	ld	hl, _mvv_lva
	add	hl, bc
	lea	bc, iy
	add	hl, bc
	push	hl
	pop	iy
	ld	h, 0
	ld	l, (iy - 1)
	ld.sis	bc, 10000
	add.sis	hl, bc
BB54_42:
	bit	3, e
	jr	z, BB54_47
	ld	a, e
	and	a, 48
	or	a, a
	jr	nz, BB54_45
	ld.sis	de, 5000
	jr	BB54_46
BB54_45:
	ld.sis	de, 1000
BB54_46:
	add.sis	hl, de
BB54_47:
	ld	de, (ix + 12)
	ld	bc, (ix - 44)
	ld	iy, (ix - 35)
	ld	(iy), l
	ld	(iy + 1), h
	lea	iy, iy + 5
	ld	(ix - 35), iy
	ld	hl, (ix - 50)
	dec	hl
	jp	BB54_33
BB54_48:
	ex	de, hl
	call	__ineg
	ld	(ix - 50), hl
	ld	a, (ix + 15)
	inc	a
	ld	l, (ix + 18)
	inc	l
	ld	(ix - 65), hl
	ld	l, a
	ld	(ix - 68), hl
	ld	hl, (ix - 59)
	ld	(ix - 35), hl
	ld	e, 0
	ld	iy, _move_sp
BB54_49:
	ld	hl, (ix - 47)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB54_57
	ld	(ix - 44), bc
	ld	(ix - 56), de
	push	de
	ld	hl, (ix - 62)
	push	hl
	ld	hl, (ix - 59)
	push	hl
	call	_pick_move
	pop	hl
	pop	hl
	pop	hl
	push	hl
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	iy, (ix - 35)
	ld	a, (iy)
	push	de
	pop	hl
	ld	(hl), a
	ld	a, (iy + 1)
	lea	hl, iy
	push	de
	pop	iy
	ld	(iy + 1), a
	push	hl
	pop	iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 41)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_move_needs_legality_check
	ld	(ix - 71), a
	pop	hl
	pop	hl
	pop	hl
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	hl, (ix - 35)
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	ld	iy, (ix - 35)
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	ld	iy, (ix - 35)
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 38)
	ld	(iy + 3), hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_make
	pop	hl
	pop	hl
	pop	hl
	ld	a, (ix - 71)
	or	a, a
	jr	z, BB54_53
	ld	hl, (ix + 6)
	push	hl
	call	_board_is_legal.25
	pop	hl
	or	a, a
	jr	nz, BB54_53
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	de, (ix - 35)
	push	de
	pop	hl
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 38)
	ld	(iy + 3), hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
	ld	iy, _move_sp
	ld	bc, (ix - 44)
	jp	BB54_56
BB54_53:
	ld	hl, (ix - 44)
	call	__ineg
	ld	de, (ix - 65)
	push	de
	ld	de, (ix - 68)
	push	de
	push	hl
	ld	hl, (ix - 50)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_quiescence
	pop	de
	pop	de
	pop	de
	pop	de
	pop	de
	call	__ineg
	ld	(ix - 71), hl
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	de, (ix - 35)
	push	de
	pop	hl
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 38)
	ld	(iy + 3), hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
	ld	a, (_search_stopped)
	or	a, a
	jr	nz, BB54_60
	ld	bc, (ix - 44)
	push	bc
	pop	hl
	ld	de, (ix - 71)
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	ld	iy, _move_sp
	jp	p, BB54_56
	ld	bc, (ix - 71)
	push	bc
	pop	hl
	ld	de, (ix + 12)
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB54_64
BB54_56:
	ld	de, (ix - 56)
	inc	e
	lea	hl, iy
	ld	iy, (ix - 35)
	lea	iy, iy + 5
	ld	(ix - 35), iy
	push	hl
	pop	iy
	ld	hl, (ix - 47)
	dec	hl
	ld	(ix - 47), hl
	jp	BB54_49
BB54_57:
	ld	hl, (ix - 53)
	ld	(iy), l
	ld	(iy + 1), h
BB54_58:
	push	bc
	pop	hl
	jr	BB54_63
BB54_59:
	ld	hl, _move_sp
	ld	de, (ix - 59)
	jr	BB54_61
BB54_60:
	ld	hl, _move_sp
	ld	de, (ix - 53)
BB54_61:
	ld	(hl), e
	inc	hl
	ld	(hl), d
BB54_62:
	or	a, a
	sbc	hl, hl
BB54_63:
	ld	sp, ix
	pop	ix
	ret
BB54_64:
	ld	hl, (ix - 53)
	ld	(iy), l
	ld	(iy + 1), h
BB54_65:
	ld	hl, (ix + 12)
	jr	BB54_63
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_compute_legal_info
_compute_legal_info:
	ld	hl, -12
	call	__frameset
	ld	iy, (ix + 6)
	xor	a, a
	ld	(ix - 2), a
	ld	de, 422
	lea	hl, iy
	add	hl, de
	ld	a, (hl)
	ld	de, 0
	ld	e, a
	ld	bc, 420
	lea	hl, iy
	add	hl, de
	add	hl, bc
	ld	(ix - 5), a
	cp	a, b
	jr	z, BB55_2
	ld	a, -128
	ld	(ix - 2), a
BB55_2:
	ld	a, (hl)
	ld	(ix - 1), a
	ld	iy, (ix + 9)
	ld	(iy), 0
	ld	(iy + 1), 0
	ld	(iy + 4), 0
	ld	de, 8
	or	a, a
	sbc	hl, hl
	push	hl
	pop	bc
	ld	iy, 0
BB55_3:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jr	z, BB55_9
	ld	hl, _atk_knight_offsets
	ld	(ix - 8), bc
	add	hl, bc
	ld	a, (hl)
	add	a, (ix - 1)
	ld	c, a
	and	a, -120
	or	a, a
	jr	nz, BB55_8
	lea	de, iy
	ld	e, c
	ld	hl, (ix + 6)
	add	hl, de
	ld	de, 8
	ld	l, (hl)
	ld	a, l
	or	a, a
	jr	z, BB55_8
	ld	a, l
	and	a, -128
	ld	e, a
	ld	a, l
	and	a, 7
	ld	l, a
	ld	a, e
	ld	e, (ix - 2)
	cp	a, e
	ld	de, 8
	jr	nz, BB55_8
	ld	a, l
	cp	a, 2
	push	bc
	ld	hl, (ix + 9)
	push	hl
	call	z, _add_checker
	pop	hl
	pop	hl
	ld	iy, 0
	ld	de, 8
BB55_8:
	ld	bc, (ix - 8)
	inc	bc
	jr	BB55_3
BB55_9:
	ld	a, (ix - 5)
	cp	a, 1
	ld	a, 16
	jr	z, BB55_11
	ld	a, -16
BB55_11:
	ld	l, (ix - 2)
	inc	l
	ld	(ix - 8), l
	add	a, (ix - 1)
	ld	c, a
	ld	(ix - 5), bc
	dec	c
	ld	a, c
	and	a, -120
	or	a, a
	jr	nz, BB55_13
	lea	de, iy
	ld	e, c
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	ld	l, (ix - 8)
	cp	a, l
	push	bc
	ld	hl, (ix + 9)
	push	hl
	call	z, _add_checker
	pop	hl
	pop	hl
	ld	iy, 0
	ld	de, 8
BB55_13:
	ld	bc, (ix - 5)
	inc	c
	ld	a, c
	and	a, -120
	or	a, a
	jr	nz, BB55_15
	lea	de, iy
	ld	e, c
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	ld	l, (ix - 8)
	cp	a, l
	push	bc
	ld	hl, (ix + 9)
	push	hl
	call	z, _add_checker
	pop	hl
	pop	hl
	ld	de, 8
BB55_15:
	ld	bc, 0
BB55_16:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jr	z, BB55_22
	ld	hl, _atk_ray_offsets
	ld	(ix - 5), bc
	add	hl, bc
	ld	a, (hl)
	add	a, (ix - 1)
	ld	iyl, a
	and	a, -120
	or	a, a
	jr	nz, BB55_21
	ld	de, 0
	ld	e, iyl
	ld	hl, (ix + 6)
	add	hl, de
	ld	c, (hl)
	ld	a, c
	and	a, -128
	ld	e, a
	ld	a, c
	and	a, 7
	ld	d, a
	ld	a, c
	or	a, a
	jr	z, BB55_21
	ld	a, e
	ld	l, (ix - 2)
	cp	a, l
	jr	nz, BB55_21
	ld	a, d
	cp	a, 6
	push	iy
	ld	hl, (ix + 9)
	push	hl
	call	z, _add_checker
	pop	hl
	pop	hl
BB55_21:
	ld	bc, (ix - 5)
	inc	bc
	ld	de, 8
	jr	BB55_16
BB55_22:
	ld	bc, 0
BB55_23:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jp	z, BB55_44
	ld	hl, _atk_ray_offsets
	add	hl, bc
	ld	e, (hl)
	ld	(ix - 5), bc
	ld	a, c
	dec	a
	ld	(ix - 8), a
	and	a, 63
	ld	b, a
	ld	a, 45
	call	__bshru
	and	a, 1
	ld	(ix - 12), a
	ld	b, (ix - 1)
BB55_25:
	ld	a, b
	add	a, e
	ld	iyl, a
	ld	a, e
	add	a, b
	ld	d, a
	ld	bc, 0
	ld	c, d
	ld	hl, (ix + 6)
	add	hl, bc
	ld	h, (hl)
	ld	a, h
	or	a, a
	ld	b, iyl
	jr	z, BB55_25
	ld	a, d
	and	a, -120
	or	a, a
	jp	nz, BB55_43
	ld	a, h
	and	a, -128
	ld	l, (ix - 2)
	cp	a, l
	jr	nz, BB55_29
	lea	de, iy
	ld	c, -1
	jr	BB55_34
BB55_29:
	ld	b, iyl
BB55_30:
	ld	a, b
	add	a, e
	ld	l, a
	ld	(ix - 11), hl
	ld	a, e
	add	a, b
	ld	d, a
	ld	bc, 0
	ld	c, d
	ld	hl, (ix + 6)
	add	hl, bc
	ld	h, (hl)
	ld	a, h
	or	a, a
	ld	bc, (ix - 11)
	ld	b, c
	jr	z, BB55_30
	ld	a, d
	and	a, -120
	ld	d, a
	ld	a, h
	and	a, -128
	ld	c, a
	ld	a, d
	or	a, a
	ld	de, (ix - 11)
	jr	nz, BB55_43
	ld	a, c
	ld	l, (ix - 2)
	cp	a, l
	jr	nz, BB55_43
	ld	c, iyl
BB55_34:
	ld	a, (ix - 8)
	cp	a, 6
	jr	nc, BB55_37
	bit	0, (ix - 12)
	jr	z, BB55_37
	ld	a, h
	and	a, 6
	cp	a, 4
	jr	z, BB55_39
	jr	BB55_43
BB55_37:
	ld	a, h
	and	a, 7
	cp	a, 3
	jr	z, BB55_39
	cp	a, 5
	jr	nz, BB55_43
BB55_39:
	ld	a, c
	cp	a, -1
	jr	nz, BB55_41
	push	de
	ld	hl, (ix + 9)
	push	hl
	call	_add_checker
	pop	hl
	pop	hl
	jr	BB55_43
BB55_41:
	ld	iy, (ix + 9)
	ld	a, (iy + 4)
	cp	a, 8
	jr	nc, BB55_43
	ld	de, 0
	ld	e, a
	inc	a
	ld	iy, (ix + 9)
	ld	(iy + 4), a
	add	iy, de
	ld	(iy + 5), c
BB55_43:
	ld	bc, (ix - 5)
	inc	bc
	ld	de, 8
	jp	BB55_23
BB55_44:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_score_moves
_score_moves:
	ld	hl, -15
	call	__frameset
	ld	a, (ix + 12)
	ld	iy, _killers
	ld	l, (ix + 19)
	ld	(ix - 10), l
	ld	l, (ix + 20)
	ld	(ix - 11), l
	or	a, a
	sbc	hl, hl
	ld	l, (ix + 15)
	ld	bc, 6
	call	__imulu
	push	hl
	pop	de
	add	iy, de
	ld	(ix - 9), iy
	ld	bc, 0
	ld	c, a
	ld	iy, (ix + 9)
	lea	iy, iy + 3
BB56_1:
	push	bc
	pop	hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB56_28
	ld	e, (iy - 3)
	ld	h, (iy - 2)
	ld	d, (iy - 1)
	ld	a, e
	ld	l, (ix + 18)
	cp	a, l
	jr	nz, BB56_6
	ld	a, h
	ld	l, (ix - 10)
	cp	a, l
	jr	nz, BB56_6
	ld	a, d
	xor	a, (ix - 11)
	and	a, 56
	or	a, a
	jr	nz, BB56_6
	ld.sis	hl, 30000
	ld	(iy), l
	ld	(iy + 1), h
	jp	BB56_27
BB56_6:
	ld	a, d
	and	a, 1
	bit	0, a
	ld	(ix - 3), bc
	ld	(ix - 6), iy
	jp	nz, BB56_15
	ld	(ix - 12), h
	ld	a, (ix + 15)
	cp	a, 64
	jp	nc, BB56_14
	ld	hl, (ix - 9)
	ld	l, (hl)
	ld	a, e
	cp	a, l
	jp	nz, BB56_11
	ld	iy, (ix - 9)
	ld	l, (iy + 1)
	ld	a, (ix - 12)
	cp	a, l
	jp	nz, BB56_11
	ld	iy, (ix - 9)
	ld	l, (iy + 2)
	ld	a, d
	cp	a, l
	ld.sis	hl, 9000
	jp	z, BB56_22
BB56_11:
	ld	iy, (ix - 9)
	ld	l, (iy + 3)
	ld	a, e
	cp	a, l
	jp	nz, BB56_14
	ld	iy, (ix - 9)
	ld	l, (iy + 4)
	ld	a, (ix - 12)
	cp	a, l
	jp	nz, BB56_14
	ld	iy, (ix - 9)
	ld	l, (iy + 5)
	ld	a, d
	cp	a, l
	ld.sis	hl, 8000
	jp	z, BB56_22
BB56_14:
	ld	iy, (ix + 6)
	ld	a, d
	ld	de, 422
	add	iy, de
	ld	de, 0
	push	de
	pop	hl
	ld	l, (iy)
	ld	e, (ix - 12)
	ld	c, 8
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _history
	add	iy, bc
	ex	de, hl
	ld	c, 1
	call	__ishl
	push	hl
	pop	de
	add	iy, de
	ld	d, a
	ld	hl, (iy)
	jp	BB56_22
BB56_15:
	ld	(ix - 15), e
	ld	(ix - 12), d
	ld	de, 0
	ld	e, h
	ld	hl, (ix + 6)
	add	hl, de
	ld	d, (ix - 12)
	ld	a, (hl)
	and	a, 7
	ld	c, a
	bit	2, d
	jr	z, BB56_17
	ld	c, 1
BB56_17:
	ld	a, c
	or	a, a
	ld.sis	hl, 10000
	ld	e, (ix - 15)
	jp	z, BB56_22
	ld	a, c
	cp	a, 7
	ld.sis	hl, 10000
	jp	z, BB56_22
	ld	a, e
	ld	de, 0
	ld	e, a
	ld	hl, (ix + 6)
	add	hl, de
	ld	d, (ix - 12)
	ld	a, (hl)
	and	a, 7
	ld	e, a
	or	a, a
	ld.sis	hl, 10000
	jp	z, BB56_22
	ld	a, e
	cp	a, 7
	ld.sis	hl, 10000
	jr	z, BB56_22
	or	a, a
	sbc	hl, hl
	ld	l, c
	ld	bc, 0
	ld	c, e
	ld	(ix - 15), bc
	dec	hl
	ld	bc, 6
	call	__imulu
	push	hl
	pop	de
	ld	iy, _mvv_lva
	add	iy, de
	ld	de, (ix - 15)
	add	iy, de
	ld	h, b
	ld	l, (iy - 1)
	ld.sis	de, 10000
	add.sis	hl, de
	ld	d, (ix - 12)
BB56_22:
	ld	iy, (ix - 6)
	ld	(iy), l
	ld	(iy + 1), h
	bit	3, d
	ld	bc, (ix - 3)
	jr	z, BB56_27
	ld	a, d
	and	a, 48
	or	a, a
	jr	nz, BB56_25
	ld.sis	de, 5000
	jr	BB56_26
BB56_25:
	ld.sis	de, 1000
BB56_26:
	add.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
BB56_27:
	lea	iy, iy + 5
	dec	bc
	jp	BB56_1
BB56_28:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_pick_move
_pick_move:
	ld	hl, -14
	call	__frameset
	lea	hl, ix - 5
	ld	(ix - 8), hl
	or	a, a
	sbc	hl, hl
	ld	l, (ix + 12)
	ld	bc, 5
	ld	(ix - 14), hl
	call	__imulu
	push	hl
	pop	de
	ld	iy, (ix + 6)
	add	iy, de
	ld	de, (iy + 3)
	ld	a, (ix + 12)
	inc	a
	or	a, a
	sbc	hl, hl
	ld	l, a
	call	__imulu
	push	hl
	pop	bc
	ld	l, (ix + 9)
	ld	iy, (ix + 6)
	add	iy, bc
	lea	iy, iy + 3
	ld	h, (ix + 12)
BB57_1:
	cp	a, l
	jr	nc, BB57_7
	ld	(ix - 11), h
	ld	bc, (iy)
	ld	l, e
	ld	h, d
	or	a, a
	sbc.sis	hl, bc
	call	pe, __setflag
	ld	l, a
	jp	m, BB57_4
	ld	l, (ix - 11)
BB57_4:
	ld	(ix - 11), l
	ld	l, e
	ld	h, d
	or	a, a
	sbc.sis	hl, bc
	call	pe, __setflag
	jp	m, BB57_6
	ld	c, e
	ld	b, d
BB57_6:
	lea	iy, iy + 5
	inc	a
	ld	h, (ix - 11)
	ld	e, c
	ld	d, b
	ld	l, (ix + 9)
	jr	BB57_1
BB57_7:
	ld	a, h
	ld	l, (ix + 12)
	cp	a, l
	jr	z, BB57_9
	ld	bc, 5
	ld	a, h
	ld	hl, (ix - 14)
	call	__imulu
	push	hl
	pop	de
	ld	iy, (ix + 6)
	lea	hl, iy
	add	hl, de
	push	hl
	pop	bc
	ld	(ix - 11), bc
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	(ix - 14), hl
	ld	de, (ix - 8)
	push	bc
	pop	hl
	ld	bc, 5
	ldir
	ld	hl, (ix - 14)
	ld	bc, 5
	call	__imulu
	push	hl
	pop	de
	add	iy, de
	ld	de, (ix - 11)
	lea	hl, iy
	ldir
	lea	de, iy
	ld	hl, (ix - 8)
	ld	bc, 5
	ldir
BB57_9:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_is_evasion_candidate
_is_evasion_candidate:
	ld	hl, -5
	call	__frameset
	ld	iy, (ix + 9)
	ld	e, 1
	or	a, a
	sbc	hl, hl
	ld	a, (iy)
	or	a, a
	jr	z, BB58_5
	ld	(ix - 3), hl
	ld	hl, (ix + 6)
	ld	a, (ix + 12)
	ld	bc, 0
	ld	c, a
	add	hl, bc
	ld	a, (hl)
	and	a, 7
	cp	a, 6
	jr	nz, BB58_3
BB58_2:
	ld	e, 1
	jr	BB58_5
BB58_3:
	ld	a, (iy + 1)
	cp	a, 2
	jr	c, BB58_6
BB58_4:
	ld	e, 0
BB58_5:
	ld	a, e
	ld	sp, ix
	pop	ix
	ret
BB58_6:
	ld	l, (iy + 2)
	ld	e, (ix + 13)
	ld	a, e
	cp	a, l
	jr	z, BB58_2
	bit	2, (ix + 14)
	jr	z, BB58_12
	ld	d, l
	ld	hl, (ix + 6)
	ld	bc, 422
	add	hl, bc
	ld	a, (hl)
	or	a, a
	jr	z, BB58_10
	ld	a, -16
	jr	BB58_11
BB58_10:
	ld	a, 16
BB58_11:
	ld	l, d
	add	a, e
	cp	a, l
	jr	z, BB58_2
BB58_12:
	ld	(ix - 4), l
	ld	(ix - 5), e
	ld	de, 0
	push	de
	pop	bc
	ld	c, l
	ld	iy, (ix + 6)
	lea	hl, iy
	add	hl, bc
	ld	a, (hl)
	and	a, 7
	add	a, -3
	cp	a, 3
	jr	nc, BB58_4
	lea	hl, iy
	ld	bc, 422
	add	hl, bc
	ld	e, (hl)
	ld	bc, 420
	add	iy, de
	add	iy, bc
	ld	a, (iy)
	ld	de, 8
BB58_14:
	ld	bc, (ix - 3)
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jr	z, BB58_4
	ld	hl, _atk_ray_offsets
	add	hl, bc
	ld	l, (hl)
	ld	c, a
	ld	h, a
BB58_16:
	ld	a, l
	add	a, h
	and	a, -120
	or	a, a
	jr	nz, BB58_18
	ld	a, h
	add	a, l
	ld	h, a
	ld	a, (ix - 4)
	cp	a, h
	jr	nz, BB58_16
	jr	BB58_19
BB58_18:
	ld	hl, (ix - 3)
	inc	hl
	ld	(ix - 3), hl
	ld	a, c
	jr	BB58_14
BB58_19:
	ld	a, (ix - 4)
	sub	a, l
	ld	h, a
BB58_20:
	ld	e, c
	ld	a, e
	add	a, l
	ld	c, a
	ld	a, h
	cp	a, e
	jp	z, BB58_4
	ld	a, (ix - 5)
	cp	a, c
	jr	nz, BB58_20
	jp	BB58_2
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_move_needs_legality_check
_move_needs_legality_check:
	call	__frameset0
	ld	iy, (ix + 9)
	ld	d, 0
	ld	e, 1
	ld	a, (iy)
	or	a, a
	jr	nz, BB59_7
	bit	2, (ix + 14)
	jr	nz, BB59_7
	ld	hl, (ix + 6)
	ld	a, (ix + 12)
	ld	bc, 0
	ld	c, a
	add	hl, bc
	ld	a, (hl)
	and	a, 7
	cp	a, 6
	jr	z, BB59_7
	or	a, a
	sbc	hl, hl
	ld	l, (iy + 4)
	lea	iy, iy + 5
	ld	c, (ix + 12)
BB59_4:
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB59_6
	dec	hl
	ld	a, (iy)
	inc	iy
	cp	a, c
	jr	nz, BB59_4
	jr	BB59_7
BB59_6:
	ld	e, d
BB59_7:
	ld	a, e
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_board_is_legal.25
_board_is_legal.25:
	call	__frameset0
	ld	bc, (ix + 6)
	ld	de, 422
	push	bc
	pop	hl
	add	hl, de
	ld	l, (hl)
	ld	a, l
	xor	a, d
	ld	de, 0
	ld	e, a
	push	bc
	pop	iy
	add	iy, de
	ld	de, 420
	add	iy, de
	ld	a, (iy)
	push	hl
	ld	l, a
	push	hl
	push	bc
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jr	z, BB60_2
	ld	a, 0
	jr	BB60_3
BB60_2:
	ld	a, 1
BB60_3:
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_add_checker
_add_checker:
	call	__frameset0
	ld	iy, (ix + 6)
	ld	a, (iy + 1)
	cp	a, 2
	jr	nc, BB61_2
	ld	l, (ix + 9)
	ld	de, 0
	ld	e, a
	lea	bc, iy
	add	iy, de
	ld	(iy + 2), l
	push	bc
	pop	iy
BB61_2:
	inc	a
	ld	(iy + 1), a
	ld	(iy), 1
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_search_get_root_candidates
_search_get_root_candidates:
	ld	hl, -12
	call	__frameset
	ld	hl, (ix + 6)
	ld	(ix - 3), hl
	ld	hl, (ix + 9)
	ld	(ix - 12), hl
	ld	hl, (ix + 12)
	ld	de, _root_scores
	ld	(ix - 9), de
	ld	de, _root_moves
	ld	a, (_root_count)
	ld	(hl), a
	or	a, a
	sbc	hl, hl
	ld	l, a
BB62_1:
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB62_3
	push	de
	pop	iy
	ld	a, (iy)
	ld	(ix - 6), iy
	ld	iy, (ix - 3)
	ld	(iy), a
	lea	de, iy
	ld	iy, (ix - 6)
	ld	a, (iy + 1)
	push	de
	pop	iy
	ld	(iy + 1), a
	ld	iy, (ix - 6)
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(ix - 3), iy
	ld	(iy + 2), a
	ld	iy, (ix - 9)
	ld	de, (iy)
	ld	bc, (ix - 12)
	push	bc
	pop	iy
	ld	(iy), e
	ld	(iy + 1), d
	ld	iy, (ix - 3)
	lea	iy, iy + 3
	ld	(ix - 3), iy
	ld	iy, (ix - 6)
	lea	iy, iy + 3
	lea	de, iy
	ld	iy, (ix - 9)
	lea	iy, iy + 2
	ld	(ix - 9), iy
	push	bc
	pop	iy
	lea	iy, iy + 2
	ld	(ix - 12), iy
	dec	hl
	jr	BB62_1
BB62_3:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_tt_clear
_tt_clear:
	ld	hl, _tt
	xor	a, a
	ld	(_tt), a
	push	hl
	pop	de
	inc	de
	ld	bc, 32767
	ldir
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_tt_probe
_tt_probe:
	ld	hl, -6
	call	__frameset
	ld	hl, (ix + 6)
	ld	bc, 4095
	ld	iy, _tt
	call	__iand
	push	hl
	pop	de
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	add	iy, bc
	ld	(ix - 3), iy
	ld	a, (iy + 7)
	or	a, a
	jr	nz, BB64_2
	xor	a, a
	jp	BB64_4
BB64_2:
	ld	iy, (ix + 9)
	ld	c, 3
	push	de
	pop	hl
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _tt
	add	hl, bc
	ld	hl, (hl)
	lea	bc, iy
	or	a, a
	sbc.sis	hl, bc
	ld	a, 0
	jr	nz, BB64_4
	ld	a, 1
	ld	c, 3
	ex	de, hl
	call	__ishl
	push	hl
	pop	de
	ld	hl, _tt
	push	hl
	pop	iy
	add	iy, de
	ld	(ix - 6), iy
	ld	de, (iy + 2)
	ld	c, d
	ld	l, c
	rlc	l
	sbc	hl, hl
	ld	h, c
	ld	l, e
	ld	iy, (ix + 12)
	ld	(iy), hl
	ld	iy, (ix - 6)
	ld	de, (iy + 4)
	ld	hl, (ix + 15)
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	l, (iy + 6)
	ld	iy, (ix + 18)
	ld	(iy), l
	ld	iy, (ix - 3)
	ld	l, (iy + 7)
	ld	iy, (ix + 21)
	ld	(iy), l
BB64_4:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_tt_store
_tt_store:
	call	__frameset0
	ld	hl, (ix + 6)
	ld	a, (ix + 18)
	ld	e, (ix + 21)
	ld	bc, 4095
	ld	iy, _tt
	call	__iand
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	add	iy, bc
	ld	hl, (ix + 9)
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, (ix + 12)
	ld	(iy + 2), l
	ld	(iy + 3), h
	ld	hl, (ix + 15)
	ld	(iy + 4), l
	ld	(iy + 5), h
	ld	(iy + 6), a
	ld	(iy + 7), e
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_tt_pack_move
_tt_pack_move:
	call	__frameset0
	ld	l, (ix + 6)
	ld	a, l
	srl	a
	and	a, 56
	ld	e, a
	ld	a, l
	and	a, 7
	ld	l, a
	ld	a, e
	add	a, l
	ld	e, a
	ld	l, (ix + 7)
	ld	a, l
	srl	a
	and	a, 56
	ld	c, a
	ld	a, l
	and	a, 7
	ld	l, a
	ld	a, c
	add	a, l
	ld	l, a
	ld	d, 0
	ld	h, d
	ld	c, 6
	call	__sshl
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	add.sis	iy, de
	ld	a, (ix + 8)
	bit	3, a
	jr	z, BB66_2
	ld	b, 4
	ld.sis	de, 4096
	call	__bshru
	and	a, 3
	ld	l, a
	ld	h, e
	ld	c, 13
	call	__sshl
	ld	c, l
	ld	b, h
	add.sis	iy, bc
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	ld	c, e
	ld	b, d
	call	__sor
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
BB66_2:
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_tt_unpack_move
_tt_unpack_move:
	call	__frameset0
	ld	de, (ix + 6)
	ld	iy, (ix + 9)
	ld	c, 6
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	call	__sshru
	ld	a, iyl
	add	a, a
	and	a, 112
	ld	c, a
	ld	a, iyl
	and	a, 7
	ld	b, a
	ld	a, c
	add	a, b
	push	de
	pop	iy
	ld	(iy), a
	ld	a, l
	add	a, a
	and	a, 112
	ld	c, a
	ld	a, l
	and	a, 7
	ld	l, a
	ld	a, c
	add	a, l
	ld	(iy + 1), a
	ld	iy, (ix + 9)
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	ld.sis	bc, 4096
	call	__sand
	ld	e, l
	ld	d, h
	ld	c, 9
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	call	__sshru
	ld	a, l
	and	a, 48
	add	a, 8
	ld	l, e
	ld	h, d
	ld	e, 0
	add.sis	hl, bc
	or	a, a
	sbc.sis	hl, bc
	jr	z, BB67_2
	ld	e, a
BB67_2:
	ld	hl, (ix + 6)
	push	hl
	pop	iy
	ld	(iy + 2), e
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_zobrist_is_initialized
_zobrist_is_initialized:
	ld	a, (_zobrist_initialized)
	and	a, 1
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_zobrist_init
_zobrist_init:
	ld	hl, -12
	call	__frameset
	ld	hl, (ix + 6)
	ld	a, (ix + 9)
	ld	bc, 0
	ld	e, a
	call	__lcmpzero
	jr	z, BB69_2
	ld	d, 0
	jr	BB69_3
BB69_2:
	ld	d, 1
BB69_3:
	bit	0, d
	jr	z, BB69_5
	ld	hl, 3430008
BB69_5:
	ld	iyl, 1
	bit	0, d
	jr	z, BB69_7
	ld	a, 18
BB69_7:
	ld	de, _zobrist_piece
	ld	(ix - 3), de
	ld	de, _lock_piece
	ld	(ix - 6), de
	ld	(_prng_state), hl
	ld	(_prng_state+3), a
	ld	a, iyl
	ld	(_zobrist_initialized), a
	ld	de, 12
	push	bc
	pop	iy
BB69_8:
	lea	hl, iy
	or	a, a
	sbc	hl, de
	push	bc
	pop	hl
	jr	z, BB69_12
BB69_9:
	ld	(ix - 9), hl
	ld	de, 256
	or	a, a
	sbc	hl, de
	jr	z, BB69_11
	ld	(ix - 12), iy
	call	_prng_next
	ld	a, e
	ld	bc, (ix - 9)
	push	bc
	pop	de
	ld	iy, (ix - 3)
	add	iy, de
	ld	(iy), hl
	push	bc
	pop	hl
	ld	(iy + 3), a
	ld	iy, (ix - 12)
	ld	bc, 0
	ld	de, 4
	add	hl, de
	jr	BB69_9
BB69_11:
	inc	iy
	ld	hl, (ix - 3)
	ld	de, 256
	add	hl, de
	ld	(ix - 3), hl
	ld	de, 12
	jr	BB69_8
BB69_12:
	ld	de, 64
	push	bc
	pop	iy
BB69_13:
	lea	hl, iy
	or	a, a
	sbc	hl, de
	jr	z, BB69_15
	ld	(ix - 3), iy
	call	_prng_next
	ld	bc, (ix - 3)
	ld	iy, _zobrist_castle
	add	iy, bc
	ld	(iy), hl
	ld	(iy + 3), e
	ld	iy, (ix - 3)
	ld	bc, 0
	ld	de, 4
	add	iy, de
	ld	de, 64
	jr	BB69_13
BB69_15:
	ld	(ix - 3), bc
BB69_16:
	call	_prng_next
	push	hl
	pop	iy
	ld	hl, (ix - 3)
	ld	bc, 32
	or	a, a
	sbc	hl, bc
	jr	z, BB69_18
	ld	hl, (ix - 3)
	ld	(ix - 9), hl
	ld	(ix - 12), iy
	ld	iy, _zobrist_ep_file
	ld	bc, (ix - 9)
	add	iy, bc
	ld	bc, (ix - 12)
	ld	(iy), bc
	ld	(iy + 3), e
	ld	de, 4
	add	hl, de
	ld	(ix - 3), hl
	jr	BB69_16
BB69_18:
	ld	(_zobrist_side), iy
	ld	a, e
	ld	(_zobrist_side+3), a
	ld	de, 0
	ld	(ix - 3), de
	ld	bc, 12
BB69_19:
	ld	hl, (ix - 3)
	or	a, a
	sbc	hl, bc
	push	de
	pop	hl
	jr	z, BB69_23
BB69_20:
	push	bc
	pop	iy
	ld	(ix - 9), hl
	ld	bc, 128
	or	a, a
	sbc	hl, bc
	jr	z, BB69_22
	call	_prng_next16
	ld	bc, (ix - 9)
	push	bc
	pop	de
	ld	iy, (ix - 6)
	add	iy, de
	ld	(iy), l
	ld	(iy + 1), h
	push	bc
	pop	hl
	ld	de, 0
	ld	bc, 2
	add	hl, bc
	ld	bc, 12
	jr	BB69_20
BB69_22:
	ld	hl, (ix - 3)
	inc	hl
	ld	(ix - 3), hl
	ld	hl, (ix - 6)
	ld	bc, 128
	add	hl, bc
	ld	(ix - 6), hl
	lea	bc, iy
	jr	BB69_19
BB69_23:
	push	de
	pop	iy
BB69_24:
	lea	hl, iy
	ld	bc, 32
	or	a, a
	sbc	hl, bc
	jr	z, BB69_26
	ld	(ix - 3), iy
	call	_prng_next16
	ld	de, (ix - 3)
	ld	iy, _lock_castle
	add	iy, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	iy, (ix - 3)
	ld	de, 0
	ld	bc, 2
	add	iy, bc
	jr	BB69_24
BB69_26:
	ld	(ix - 3), de
BB69_27:
	call	_prng_next16
	ld	e, l
	ld	d, h
	ld	iy, (ix - 3)
	lea	hl, iy
	ld	bc, 16
	or	a, a
	sbc	hl, bc
	jr	z, BB69_29
	lea	bc, iy
	ld	hl, _lock_ep_file
	add	hl, bc
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	de, 2
	add	iy, de
	ld	(ix - 3), iy
	jr	BB69_27
BB69_29:
	ld	hl, _lock_side
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_prng_next
_prng_next:
	ld	iy, _prng_state
	ld	bc, (_prng_state)
	lea	hl, iy + 3
	ld	d, (hl)
	ld	l, 13
	push	bc
	pop	iy
	ld	a, d
	call	__lshl
	push	bc
	pop	hl
	ld	e, a
	lea	bc, iy
	ld	a, d
	call	__lxor
	push	hl
	pop	iy
	ld	d, e
	ld	l, 17
	lea	bc, iy
	ld	a, d
	call	__lshru
	push	bc
	pop	hl
	ld	e, a
	lea	bc, iy
	ld	a, d
	call	__lxor
	push	hl
	pop	iy
	ld	d, e
	ld	l, 5
	lea	bc, iy
	ld	a, d
	call	__lshl
	push	bc
	pop	hl
	ld	e, a
	lea	bc, iy
	ld	a, d
	call	__lxor
	ld	(_prng_state), hl
	ld	a, e
	ld	(_prng_state+3), a
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_prng_next16
_prng_next16:
	call	_prng_next
	push	hl
	pop	bc
	ld	a, e
	ld	l, 16
	call	__lshru
	ld	l, c
	ld	h, b
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_main
_main:
	ld	hl, -59
	call	__frameset
	call	_gfx_Begin
	ld	hl, 1
	push	hl
	call	_gfx_SetDraw
	pop	hl
	ld.sis	hl, 4228
	ld	iy, -1900032
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 31606
	ld	iy, -1900030
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 23084
	ld	iy, -1900028
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 31696
	ld	iy, -1900026
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 24360
	ld	iy, -1900024
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 26445
	ld	iy, -1900022
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 22151
	ld	iy, -1900020
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 31677
	ld	iy, -1900018
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 2115
	ld	e, l
	ld	d, h
	ld	hl, -1900016
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld.sis	hl, 8457
	ld	iy, -1900014
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 6655
	ld	iy, -1900012
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 28539
	ld	iy, -1900010
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 8732
	ld	iy, -1900008
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, -1900006
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld.sis	hl, 6343
	ld	iy, -1900004
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 5285
	ld	iy, -1900002
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 13004
	ld	iy, -1900000
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 11050
	ld	iy, -1899998
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 27879
	ld	iy, -1899996
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 19026
	ld	iy, -1899994
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, _.str.1.57
	push	hl
	ld	hl, _.str.56
	push	hl
	call	_ti_Open
	ld	e, a
	pop	hl
	pop	hl
	or	a, a
	jr	nz, BB72_4
	or	a, a
	sbc	hl, hl
	push	hl
	call	_gfx_FillScreen
	pop	hl
	ld	hl, 11
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 110
	push	hl
	ld	hl, 76
	push	hl
	ld	hl, _.str.2.58
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 125
	push	hl
	ld	hl, 76
	push	hl
	ld	hl, _.str.3.59
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	call	_gfx_SwapDraw
BB72_2:
	call	_kb_AnyKey
	or	a, a
	jp	nz, BB72_41
	call	_kb_Scan
	jr	BB72_2
BB72_4:
	ld	hl, _piece_spr_data+22
	ld	(ix - 26), hl
	ld	hl, _piece_spr_data+2
	ld	(ix - 29), hl
	lea	hl, ix - 20
	ld	(ix - 59), hl
	push	de
	ld	(ix - 23), de
	call	_ti_GetDataPtr
	pop	de
	ld	(_sprite_data), hl
	ld	hl, (ix - 23)
	push	hl
	call	_ti_Close
	pop	hl
	ld	hl, (_sprite_data)
	ld	(ix - 23), hl
	ld	bc, 6
	ld	de, 0
	push	de
	pop	iy
BB72_5:
	lea	hl, iy
	or	a, a
	sbc	hl, bc
	jp	z, BB72_42
	ld	(ix - 32), iy
	lea	hl, iy
	ld	c, 1
	call	__ishl
	ld	(ix - 53), hl
	ld	hl, (ix - 26)
	ld	(ix - 35), hl
	ld	hl, (ix - 29)
	ld	(ix - 38), hl
	push	de
	pop	iy
BB72_7:
	lea	hl, iy
	ld	bc, 2
	or	a, a
	sbc	hl, bc
	jp	z, BB72_40
	lea	hl, iy
	ld	de, (ix - 53)
	add	hl, de
	ex	de, hl
	ld	(ix - 56), iy
	lea	hl, iy
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	a, 7
	ld	(ix - 50), a
	jr	z, BB72_10
	ld	a, 8
	ld	(ix - 50), a
BB72_10:
	ex	de, hl
	ld	bc, 402
	call	__imulu
	push	hl
	pop	de
	ld	iy, _piece_spr_data
	add	iy, de
	ld	(iy), 20
	ld	(iy + 1), 20
	ld	hl, (ix - 23)
	ld	(ix - 41), hl
	ld	hl, (ix - 38)
	ld	(ix - 44), hl
	ld	de, 0
	push	de
	pop	hl
	ld	iy, (ix - 32)
BB72_11:
	ld	(ix - 47), hl
	ld	bc, 20
	or	a, a
	sbc	hl, bc
	jr	z, BB72_18
BB72_12:
	push	de
	pop	hl
	ld	bc, 20
	or	a, a
	sbc	hl, bc
	jr	z, BB72_17
	ld	iy, (ix - 41)
	add	iy, de
	ld	a, (iy)
	cp	a, 1
	ld	l, (ix - 50)
	jr	z, BB72_16
	cp	a, 2
	ld	l, 9
	jr	z, BB72_16
	ld	l, 0
BB72_16:
	ld	iy, (ix - 44)
	add	iy, de
	ld	(iy), l
	inc	de
	ld	iy, (ix - 32)
	jr	BB72_12
BB72_17:
	ld	hl, (ix - 47)
	inc	hl
	lea	de, iy
	ld	iy, (ix - 44)
	lea	iy, iy + 20
	ld	(ix - 44), iy
	ld	iy, (ix - 41)
	lea	iy, iy + 20
	ld	(ix - 41), iy
	push	de
	pop	iy
	ld	de, 0
	jr	BB72_11
BB72_18:
	ld	hl, (ix - 23)
	ld	(ix - 41), hl
	ld	hl, (ix - 35)
	ld	(ix - 44), hl
	push	de
	pop	iy
BB72_19:
	lea	hl, iy
	ld	bc, 20
	or	a, a
	sbc	hl, bc
	jp	z, BB72_39
	lea	hl, iy
	inc	hl
	ld	(ix - 50), hl
BB72_21:
	push	de
	pop	hl
	ld	bc, 20
	or	a, a
	sbc	hl, bc
	jp	z, BB72_38
	ld	(ix - 47), iy
	ld	iy, (ix - 41)
	add	iy, de
	ld	a, (iy)
	cp	a, 1
	jr	nz, BB72_37
	ld	hl, (ix - 47)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	a, 1
	ld	c, a
	jr	z, BB72_27
	ld	a, (iy - 20)
	or	a, a
	ld	a, -1
	jr	z, BB72_26
	ld	a, 0
BB72_26:
	ld	hl, (ix - 47)
	ld	bc, 19
	or	a, a
	sbc	hl, bc
	ld	c, a
	ld	a, 1
	ld	b, a
	jr	z, BB72_31
BB72_27:
	ld	l, (iy + 20)
	ld	a, l
	or	a, a
	ld	a, -1
	ld	b, a
	jr	z, BB72_29
	ld	a, 0
	ld	b, a
BB72_29:
	bit	0, c
	jr	nz, BB72_31
	ld	a, l
	or	a, a
	jr	nz, BB72_37
BB72_31:
	ld	iy, (ix - 44)
	add	iy, de
	ld	(iy - 20), 9
	bit	0, c
	jr	z, BB72_34
	ld	hl, (ix - 47)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB72_34
	ld	iy, (ix - 44)
	add	iy, de
	ld	(iy - 40), 9
BB72_34:
	bit	0, b
	jr	z, BB72_37
	ld	hl, (ix - 47)
	ld	bc, 19
	or	a, a
	sbc	hl, bc
	jr	z, BB72_37
	ld	iy, (ix - 44)
	add	iy, de
	ld	(iy), 9
BB72_37:
	inc	de
	ld	iy, (ix - 47)
	jp	BB72_21
BB72_38:
	ld	iy, (ix - 44)
	lea	iy, iy + 20
	ld	(ix - 44), iy
	ld	iy, (ix - 41)
	lea	iy, iy + 20
	ld	(ix - 41), iy
	ld	iy, (ix - 50)
	ld	de, 0
	jp	BB72_19
BB72_39:
	ld	iy, (ix - 56)
	inc	iy
	ld	hl, 402
	push	hl
	pop	bc
	ld	hl, (ix - 38)
	add	hl, bc
	ld	(ix - 38), hl
	ld	hl, (ix - 35)
	add	hl, bc
	ld	(ix - 35), hl
	jp	BB72_7
BB72_40:
	ld	iy, (ix - 32)
	inc	iy
	ld	hl, (ix - 29)
	ld	bc, 804
	add	hl, bc
	ld	(ix - 29), hl
	ld	hl, (ix - 23)
	ld	bc, 400
	add	hl, bc
	ld	(ix - 23), hl
	ld	hl, (ix - 26)
	ld	bc, 804
	add	hl, bc
	ld	(ix - 26), hl
	ld	bc, 6
	jp	BB72_5
BB72_41:
	call	_gfx_End
	ld	hl, 1
	jp	BB72_321
BB72_42:
	call	_clock
	push	hl
	call	_srand
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	(_state), hl
	inc	l
	xor	a, a
	ld	(_menu_cursor), a
	ld	a, l
	ld	(_running), a
BB72_43:
	call	_clock
	ld	(ix - 23), hl
	ld	(ix - 26), e
	call	_kb_Scan
	ld	hl, -720878
	push	de
	ld	e, (hl)
	inc	hl
	ld	d, (hl)
	ld	l, e
	ld	h, d
	pop	de
	ld	(ix - 32), hl
	ld	a, l
	ld	(_cur_g1), a
	ld	hl, -720868
	push	de
	ld	e, (hl)
	inc	hl
	ld	d, (hl)
	ld	l, e
	ld	h, d
	pop	de
	ld	(ix - 29), hl
	ld	a, l
	ld	(_cur_g6), a
	ld	hl, -720866
	push	de
	ld	e, (hl)
	inc	hl
	ld	d, (hl)
	ld	iyl, e
	ld	iyh, d
	pop	de
	ld	a, iyl
	ld	(_cur_g7), a
	ld	de, (_state)
	push	de
	pop	hl
	ld	bc, 6
	or	a, a
	sbc	hl, bc
	jp	nc, BB72_311
	ld	hl, JTI72_0
	add	hl, de
	add	hl, de
	add	hl, de
	ld	hl, (hl)
	jp	(hl)
BB72_45:
	ld	a, (_prev_g7)
	cpl
	and	a, iyl
	ld	c, a
	ld	a, (_prev_g6)
	cpl
	ld	hl, (ix - 29)
	and	a, l
	ld	e, a
	ld	a, (_prev_g1)
	cpl
	ld	l, a
	ld	a, c
	and	a, 1
	ld	h, a
	ld	a, (_menu_cursor)
	ld	d, a
	xor	a, 1
	ld	b, a
	ld	a, h
	and	a, b
	ld	h, a
	or	a, d
	ld	d, a
	bit	3, c
	ld	a, -1
	jr	nz, BB72_47
	ld	a, 0
BB72_47:
	and	a, d
	ld	b, a
	xor	a, 1
	and	a, d
	ld	c, a
	bit	0, h
	jr	nz, BB72_49
	bit	0, b
	jr	z, BB72_50
BB72_49:
	ld	a, c
	and	a, 1
	ld	(_menu_cursor), a
BB72_50:
	ld	b, e
	ld	a, e
	and	a, 1
	ld	h, a
	ld	de, (ix - 32)
	ld	a, e
	and	a, 32
	and	a, l
	bit	0, h
	jp	nz, BB72_144
	or	a, a
	jp	nz, BB72_144
	bit	6, b
	jp	nz, BB72_177
	ld	hl, 13
	push	hl
	call	_gfx_FillScreen
	pop	hl
	ld	hl, 3
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 7
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, _.str.6.60
	push	hl
	call	_gfx_GetStringWidth
	push	hl
	pop	de
	pop	hl
	ld	hl, 320
	or	a, a
	sbc	hl, de
	ld	de, 2
	push	de
	pop	bc
	call	__idivs
	ld	de, 40
	push	de
	push	hl
	ld	hl, _.str.6.60
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 9
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 160
	push	hl
	ld	hl, 72
	push	hl
	ld	hl, 80
	push	hl
	call	_gfx_HorizLine_NoClip
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 2
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	push	hl
	pop	iy
	ld	(ix - 29), hl
BB72_54:
	lea	hl, iy
	ld	de, 6
	or	a, a
	sbc	hl, de
	jp	z, BB72_178
	ld	(ix - 32), iy
	lea	de, iy
	ld	hl, ___const.draw_menu.items
	add	hl, de
	ld	hl, (hl)
	push	hl
	call	_gfx_GetStringWidth
	push	hl
	pop	de
	pop	hl
	ld	bc, (ix - 29)
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB72_57
	push	bc
	pop	de
BB72_57:
	ld	bc, 3
	ld	iy, (ix - 32)
	add	iy, bc
	ld	(ix - 29), de
	jr	BB72_54
BB72_58:
	ld	a, (_prev_g7)
	cpl
	and	a, iyl
	ld	e, a
	ld	a, (_prev_g6)
	cpl
	ld	hl, (ix - 29)
	and	a, l
	ld	(ix - 29), a
	ld	a, (_prev_g1)
	cpl
	ld	(ix - 35), a
	ld	(ix - 38), e
	ld	a, e
	and	a, 1
	ld	hl, (_color_cursor)
	push	hl
	pop	iy
	ld	de, 2
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	ld	e, -1
	ld	l, e
	jp	m, BB72_60
	ld	l, 0
BB72_60:
	and	a, l
	ld	d, a
	ld	l, d
	ld	bc, 1
	call	__iand
	push	hl
	pop	bc
	add	iy, bc
	bit	3, (ix - 38)
	ld	a, e
	jr	nz, BB72_62
	ld	a, 0
BB72_62:
	ld	(ix - 38), iy
	lea	hl, iy
	ld	bc, 1
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	ld	l, e
	jp	p, BB72_64
	ld	l, 0
BB72_64:
	and	a, l
	bit	0, d
	jr	nz, BB72_66
	bit	0, a
	jr	z, BB72_67
BB72_66:
	ld	l, a
	ld	c, 23
	call	__ishl
	push	hl
	pop	iy
	add	iy, iy
	sbc	hl, hl
	push	hl
	pop	de
	ld	hl, (ix - 38)
	add	hl, de
	ld	(_color_cursor), hl
BB72_67:
	ld	c, (ix - 29)
	ld	a, c
	and	a, 1
	ld	l, a
	ld	de, (ix - 32)
	ld	a, e
	and	a, 32
	and	a, (ix - 35)
	bit	0, l
	jp	nz, BB72_161
	or	a, a
	jp	nz, BB72_161
	bit	6, c
	jp	nz, BB72_166
	ld	hl, 13
	push	hl
	call	_gfx_FillScreen
	pop	hl
	ld	hl, 2
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 7
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, _.str.36
	push	hl
	call	_gfx_GetStringWidth
	push	hl
	pop	de
	pop	hl
	ld	hl, 320
	or	a, a
	sbc	hl, de
	ld	bc, 2
	call	__idivs
	ld	de, 40
	push	de
	push	hl
	ld	hl, _.str.36
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 9
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 160
	push	hl
	ld	hl, 62
	push	hl
	ld	hl, 80
	push	hl
	call	_gfx_HorizLine_NoClip
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 2
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	push	hl
	pop	de
	push	hl
	pop	iy
BB72_71:
	push	hl
	pop	bc
	ld	de, 9
	or	a, a
	sbc	hl, de
	jp	z, BB72_167
	ld	(ix - 32), bc
	ld	hl, ___const.draw_color_select.items
	add	hl, bc
	ld	hl, (hl)
	push	hl
	ld	(ix - 29), iy
	call	_gfx_GetStringWidth
	ld	bc, (ix - 29)
	push	hl
	pop	de
	pop	hl
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB72_74
	push	bc
	pop	de
BB72_74:
	ld	bc, 3
	ld	hl, (ix - 32)
	add	hl, bc
	push	de
	pop	iy
	jr	BB72_71
BB72_75:
	ld	a, (_prev_g7)
	cpl
	and	a, iyl
	ld	e, a
	ld	a, (_prev_g6)
	cpl
	ld	hl, (ix - 29)
	and	a, l
	ld	(ix - 29), a
	ld	a, (_prev_g1)
	cpl
	ld	(ix - 35), a
	ld	(ix - 38), e
	bit	2, e
	ld	e, -1
	ld	a, e
	jr	nz, BB72_77
	ld	a, 0
BB72_77:
	ld	iy, (_promo_cursor)
	lea	hl, iy
	ld	bc, 3
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	ld	l, e
	ld	bc, 1
	jp	m, BB72_79
	ld	l, 0
BB72_79:
	and	a, l
	ld	d, a
	ld	l, d
	call	__iand
	push	hl
	pop	bc
	add	iy, bc
	bit	1, (ix - 38)
	ld	a, e
	jr	nz, BB72_81
	ld	a, 0
BB72_81:
	ld	(ix - 38), iy
	lea	hl, iy
	ld	bc, 1
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	ld	l, e
	jp	p, BB72_83
	ld	l, 0
BB72_83:
	and	a, l
	ld	l, a
	ld	c, 23
	call	__ishl
	push	hl
	pop	iy
	add	iy, iy
	sbc	hl, hl
	push	hl
	pop	bc
	ld	iy, (ix - 38)
	add	iy, bc
	bit	0, d
	jr	nz, BB72_85
	bit	0, a
	jr	z, BB72_86
BB72_85:
	lea	hl, iy
	ld	(_promo_cursor), hl
BB72_86:
	ld	c, (ix - 29)
	ld	a, c
	and	a, 1
	ld	l, a
	ld	de, (ix - 32)
	ld	a, e
	and	a, 32
	and	a, (ix - 35)
	bit	0, l
	jp	nz, BB72_141
	or	a, a
	jp	nz, BB72_141
	bit	6, c
	jp	nz, BB72_172
	call	_render_playing
	ld	hl, 14
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 60
	push	hl
	ld	hl, 140
	push	hl
	ld	hl, 90
	push	hl
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 11
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 60
	push	hl
	ld	hl, 140
	push	hl
	ld	hl, 90
	push	hl
	push	hl
	call	_gfx_Rectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 11
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, 94
	push	hl
	ld	hl, 120
	push	hl
	ld	hl, _.str.52
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (_current_turn)
	ld	de, 1
	or	a, a
	sbc	hl, de
	ld	hl, _promo_pieces_white
	ld	(ix - 35), hl
	jr	z, BB72_91
	ld	hl, _promo_pieces_black
	ld	(ix - 35), hl
BB72_91:
	ld	hl, 100
	push	hl
	pop	iy
	ld	bc, 0
BB72_92:
	push	bc
	pop	hl
	ld	de, 4
	or	a, a
	sbc	hl, de
	jp	z, BB72_310
	ld	(ix - 29), iy
	ld	de, -4
	add	iy, de
	ld	(ix - 38), iy
	ld	de, (_promo_cursor)
	ld	(ix - 32), bc
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	ld	a, 10
	ld	l, a
	jr	z, BB72_95
	ld	a, 2
	ld	l, a
BB72_95:
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 36
	push	hl
	ld	hl, 30
	push	hl
	ld	hl, 108
	push	hl
	ld	hl, (ix - 38)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (ix - 35)
	ld	de, (ix - 32)
	add	hl, de
	ld	a, (hl)
	ld	hl, 110
	push	hl
	ld	hl, (ix - 29)
	push	hl
	ld	l, a
	push	hl
	call	_draw_piece
	ld	bc, (ix - 32)
	ld	iy, (ix - 29)
	pop	hl
	pop	hl
	pop	hl
	inc	bc
	ld	de, 34
	add	iy, de
	jr	BB72_92
BB72_96:
	ld	a, (_prev_g7)
	cpl
	and	a, iyl
	ld	e, a
	ld	a, (_prev_g6)
	cpl
	ld	hl, (ix - 29)
	and	a, l
	ld	(ix - 35), a
	ld	a, (_prev_g1)
	cpl
	ld	(ix - 41), a
	ld	(ix - 29), e
	ld	a, e
	and	a, 1
	ld	iy, (_difficulty_cursor)
	lea	hl, iy
	ld	de, 4
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	ld	d, -1
	ld	l, d
	jp	m, BB72_98
	ld	l, 0
BB72_98:
	and	a, l
	ld	e, a
	ld	l, e
	ld	bc, 1
	call	__iand
	push	hl
	pop	bc
	lea	hl, iy
	add	hl, bc
	bit	3, (ix - 29)
	ld	a, d
	jr	nz, BB72_100
	ld	a, 0
BB72_100:
	ld	(ix - 29), iy
	ld	(ix - 38), hl
	ld	bc, 1
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	ld	l, d
	jp	p, BB72_102
	ld	l, 0
BB72_102:
	and	a, l
	ld	l, a
	ld	c, 23
	call	__ishl
	push	hl
	pop	iy
	add	iy, iy
	sbc	hl, hl
	push	hl
	pop	bc
	ld	iy, (ix - 38)
	add	iy, bc
	bit	0, e
	ld	bc, (ix - 29)
	jr	nz, BB72_104
	bit	0, a
	jr	z, BB72_105
BB72_104:
	ld	(_difficulty_cursor), iy
	lea	bc, iy
BB72_105:
	ld	h, (ix - 35)
	ld	a, h
	and	a, 1
	ld	l, a
	ld	de, (ix - 32)
	ld	a, e
	and	a, 32
	and	a, (ix - 41)
	bit	0, l
	jp	nz, BB72_146
	or	a, a
	jp	nz, BB72_146
	bit	6, h
	jp	nz, BB72_183
	ld	hl, 13
	push	hl
	call	_gfx_FillScreen
	pop	hl
	ld	hl, 2
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 7
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, _.str.21
	push	hl
	call	_gfx_GetStringWidth
	push	hl
	pop	de
	pop	hl
	ld	hl, 320
	or	a, a
	sbc	hl, de
	ld	bc, 2
	call	__idivs
	ld	de, 24
	push	de
	push	hl
	ld	hl, _.str.21
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 9
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 160
	push	hl
	ld	hl, 48
	push	hl
	ld	hl, 80
	push	hl
	call	_gfx_HorizLine_NoClip
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 2
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	push	hl
	pop	de
	push	hl
	pop	iy
BB72_109:
	push	hl
	pop	bc
	ld	de, 15
	or	a, a
	sbc	hl, de
	jp	z, BB72_184
	ld	(ix - 29), bc
	ld	hl, _difficulty_labels
	add	hl, bc
	ld	hl, (hl)
	push	hl
	ld	(ix - 32), iy
	call	_gfx_GetStringWidth
	ld	bc, (ix - 32)
	push	hl
	pop	de
	pop	hl
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB72_112
	push	bc
	pop	de
BB72_112:
	ld	bc, 3
	ld	hl, (ix - 29)
	add	hl, bc
	push	de
	pop	iy
	jr	BB72_109
BB72_113:
	ld	a, (_prev_g7)
	cpl
	and	a, iyl
	ld	d, a
	ld	a, (_prev_g6)
	cpl
	ld	hl, (ix - 29)
	and	a, l
	ld	e, a
	ld	a, (_prev_g1)
	cpl
	ld	hl, (ix - 32)
	and	a, l
	ld	c, a
	ld	a, (_anim_active)
	bit	0, a
	jp	z, BB72_151
	call	_clock
	ld	bc, (_anim_start)
	ld	a, (_anim_start+3)
	call	__lsub
	ld	bc, (_anim_duration)
	ld	a, (_anim_duration+3)
	ld	d, a
	call	__lcmpu
	jp	nc, BB72_162
	ld	(ix - 44), e
	ld	(ix - 41), hl
	ld	(ix - 35), bc
	ld	hl, (_board_flipped)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	a, -1
	jr	z, BB72_117
	ld	a, 0
BB72_117:
	ld	bc, (_anim_from_c)
	ld	iy, 7
	lea	hl, iy
	or	a, a
	sbc	hl, bc
	bit	0, a
	jr	nz, BB72_119
	push	hl
	pop	bc
BB72_119:
	ld	(ix - 29), bc
	ld	bc, (_anim_from_r)
	lea	hl, iy
	ld	(ix - 32), bc
	or	a, a
	sbc	hl, bc
	bit	0, a
	jr	nz, BB72_121
	ld	(ix - 32), hl
BB72_121:
	ld	(ix - 38), d
	ld	de, (_anim_to_c)
	lea	hl, iy
	or	a, a
	sbc	hl, de
	bit	0, a
	jr	nz, BB72_123
	ex	de, hl
BB72_123:
	ld	(ix - 50), de
	ld	de, (_anim_to_r)
	lea	hl, iy
	or	a, a
	sbc	hl, de
	bit	0, a
	ld	bc, (ix - 29)
	jr	nz, BB72_125
	ex	de, hl
BB72_125:
	push	bc
	pop	hl
	ld	bc, 26
	call	__imulu
	ld	(ix - 53), hl
	push	hl
	pop	iy
	ld	bc, 16
	add	iy, bc
	ld	(ix - 29), iy
	ld	hl, (ix - 32)
	ld	bc, 26
	call	__imulu
	ld	(ix - 47), hl
	push	hl
	pop	iy
	ld	bc, 16
	add	iy, bc
	ld	(ix - 32), iy
	ld	hl, (ix - 50)
	ld	bc, 26
	call	__imulu
	push	hl
	pop	iy
	ex	de, hl
	call	__imulu
	ld	(ix - 50), hl
	lea	hl, iy
	ld	de, (ix - 53)
	or	a, a
	sbc	hl, de
	push	hl
	pop	bc
	push	bc
	pop	iy
	add	iy, iy
	sbc	hl, hl
	push	hl
	pop	iy
	ld	hl, (ix - 41)
	ld	e, (ix - 44)
	ld	a, iyl
	call	__lmulu
	ld	bc, (ix - 35)
	ld	a, (ix - 38)
	call	__ldivu
	push	hl
	pop	de
	ld	hl, (ix - 29)
	add	hl, de
	ld	(ix - 29), hl
	ld	hl, (ix - 50)
	ld	de, (ix - 47)
	or	a, a
	sbc	hl, de
	push	hl
	pop	bc
	push	bc
	pop	iy
	add	iy, iy
	sbc	hl, hl
	push	hl
	pop	iy
	ld	hl, (ix - 41)
	ld	e, (ix - 44)
	ld	a, iyl
	call	__lmulu
	ld	bc, (ix - 35)
	ld	a, (ix - 38)
	call	__ldivu
	push	hl
	pop	de
	ld	hl, (ix - 32)
	add	hl, de
	ld	(ix - 32), hl
	call	_render_playing
	ld	a, (_anim_piece)
	ld	l, a
	ld	de, (ix - 32)
	push	de
	ld	de, (ix - 29)
	push	de
	push	hl
	call	_draw_piece
	jp	BB72_309
BB72_126:
	ld	a, (_prev_g6)
	cpl
	ld	hl, (ix - 29)
	and	a, l
	ld	l, a
	and	a, 1
	bit	0, a
	jp	nz, BB72_140
	ld	a, (_prev_g1)
	cpl
	and	a, 32
	ld	de, (ix - 32)
	and	a, e
	or	a, a
	jp	nz, BB72_140
	bit	6, l
	jp	nz, BB72_140
	call	_render_playing
	ld	de, (_winner)
	ld	a, (_game_over_reason)
	add	a, -2
	cp	a, 5
	ld	hl, _.str.65
	ld	(ix - 38), hl
	ld	hl, 0
	jr	nc, BB72_131
	ld	l, a
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	hl, _switch.table.main
	add	hl, bc
	ld	hl, (hl)
	ld	(ix - 38), hl
BB72_131:
	push	de
	pop	hl
	ld	bc, -1
	or	a, a
	sbc	hl, bc
	ld	bc, _.str.58
	jr	z, BB72_133
	ld	bc, _.str.59
BB72_133:
	ex	de, hl
	ld	de, 1
	or	a, a
	sbc	hl, de
	ld	hl, _.str.57
	jr	z, BB72_135
	push	bc
	pop	hl
BB72_135:
	ld	(ix - 44), hl
	ld	hl, 2
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, (ix - 44)
	push	hl
	call	_gfx_GetStringWidth
	ld	(ix - 41), hl
	pop	hl
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, (ix - 38)
	push	hl
	call	_gfx_GetStringWidth
	ld	(ix - 35), hl
	pop	hl
	ld	hl, _.str.66
	push	hl
	call	_gfx_GetStringWidth
	push	hl
	pop	bc
	pop	hl
	ld	hl, (ix - 41)
	ld	de, (ix - 35)
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	ld	de, (ix - 35)
	jp	m, BB72_137
	ld	de, (ix - 41)
BB72_137:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	ld	(ix - 47), bc
	jp	m, BB72_139
	push	de
	pop	bc
BB72_139:
	push	bc
	pop	hl
	ld	de, 24
	add	hl, de
	ld	(ix - 32), hl
	ld	hl, 206
	or	a, a
	sbc	hl, bc
	ld	de, 2
	push	de
	pop	bc
	call	__idivs
	ld	(ix - 29), hl
	ld	hl, 14
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 60
	push	hl
	ld	hl, (ix - 32)
	push	hl
	ld	hl, 90
	push	hl
	ld	hl, (ix - 29)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 9
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 60
	push	hl
	ld	hl, (ix - 32)
	push	hl
	ld	hl, 90
	push	hl
	ld	hl, (ix - 29)
	push	hl
	call	_gfx_Rectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 2
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 12
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, (ix - 32)
	ld	de, (ix - 41)
	or	a, a
	sbc	hl, de
	ld	bc, 2
	call	__idivs
	ld	de, (ix - 29)
	add	hl, de
	ld	de, 96
	push	de
	push	hl
	ld	hl, (ix - 44)
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 11
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, (ix - 32)
	ld	de, (ix - 35)
	or	a, a
	sbc	hl, de
	ld	bc, 2
	call	__idivs
	ld	de, (ix - 29)
	add	hl, de
	ld	de, 118
	push	de
	push	hl
	ld	hl, (ix - 38)
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 9
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, (ix - 32)
	ld	de, (ix - 47)
	or	a, a
	sbc	hl, de
	ld	bc, 2
	call	__idivs
	ld	de, (ix - 29)
	add	hl, de
	ld	de, 134
	push	de
	push	hl
	ld	hl, _.str.66
	jp	BB72_308
BB72_140:
	or	a, a
	sbc	hl, hl
	ld	(_state), hl
	xor	a, a
	ld	(_menu_cursor), a
	jp	BB72_311
BB72_141:
	ld	hl, (_current_turn)
	ld	de, 1
	or	a, a
	sbc	hl, de
	ld	hl, _promo_pieces_white
	jr	z, BB72_143
	ld	hl, _promo_pieces_black
BB72_143:
	lea	de, iy
	add	hl, de
	ld	a, (hl)
	ld	hl, (_promo_r)
	ld	de, (_promo_c)
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _board
	add	hl, bc
	add	hl, de
	ld	(hl), a
	ld	a, (_pending_move+4)
	and	a, 1
	ld	e, a
	ld	hl, _update_promotion.promo_flags
	lea	bc, iy
	add	hl, bc
	ld	a, (hl)
	or	a, e
	or	a, 8
	ld	(_pending_move+4), a
	push	hl
	push	hl
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	hl, _pending_move
	ld	bc, 5
	ldir
	call	_apply_engine_move
	pop	hl
	pop	hl
	or	a, a
	jp	nz, BB72_311
	jp	BB72_175
BB72_144:
	bit	0, c
	jp	z, BB72_160
	ld	a, 1
	ld	(_game_mode), a
	ld	hl, 1
	ld	(_difficulty_cursor), hl
	jp	BB72_303
BB72_146:
	ld	(ix - 29), bc
	lea	de, iy
	push	de
	pop	hl
	ld	c, 2
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _difficulty_times
	add	iy, bc
	ld	hl, (iy)
	ld	a, (iy + 3)
	ld	(_think_time_ms), hl
	ld	(_think_time_ms+3), a
	ex	de, hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	hl, 250
	jr	z, BB72_148
	ld	hl, 30000
BB72_148:
	xor	a, a
	ld	(_engine_max_nodes), hl
	ld	(_engine_max_nodes+3), a
	inc	a
	ld	(_engine_use_book), a
	ld	de, (ix - 29)
	push	de
	pop	hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	a, 3
	ld	hl, 0
	jr	z, BB72_150
	xor	a, a
BB72_150:
	ld	(_engine_book_max_ply), a
	ld	(_engine_eval_noise), hl
	ex	de, hl
	ld	bc, 3
	call	__imulu
	push	hl
	pop	de
	ld	hl, _difficulty_variance
	add	hl, de
	ld	hl, (hl)
	ld	(_engine_move_variance), hl
	ld	hl, 2
	ld	(_color_cursor), hl
	jp	BB72_303
BB72_151:
	ld	hl, (_ai_thinking)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	nz, BB72_164
	ld	a, (_screen_dirty)
	ld	l, a
	ld	a, d
	or	a, a
	jr	nz, BB72_156
	ld	a, e
	or	a, a
	jr	nz, BB72_156
	ld	a, c
	or	a, a
	jr	nz, BB72_156
	bit	0, l
	jp	z, BB72_311
BB72_156:
	ld	(ix - 41), c
	ld	bc, (_cur_r)
	ld	hl, (_cur_c)
	ld	(ix - 44), hl
	ld	hl, (_board_flipped)
	ld	a, d
	and	a, 8
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	(ix - 32), e
	ld	(ix - 35), d
	ld	(ix - 47), bc
	jp	nz, BB72_211
	or	a, a
	push	bc
	pop	hl
	ld	iy, 7
	jp	z, BB72_223
	ld	bc, (ix - 47)
	push	bc
	pop	hl
	ld	de, 1
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB72_221
	or	a, a
	sbc	hl, hl
	jp	BB72_222
BB72_160:
	xor	a, a
	ld	(_game_mode), a
BB72_161:
	call	_start_game
	jp	BB72_311
BB72_162:
	ld	a, (_anim_piece)
	ld	(ix - 32), a
	ld	bc, (_anim_to_r)
	ld	(ix - 29), bc
	ld	de, (_anim_to_c)
	ld	hl, (_has_last_move)
	ld	(ix - 35), hl
	ld	hl, (_last_from_r)
	ld	(ix - 38), hl
	ld	hl, (_last_from_c)
	ld	(ix - 41), hl
	ld	hl, (_last_to_r)
	ld	(ix - 44), hl
	ld	hl, (_last_to_c)
	ld	(ix - 47), hl
	xor	a, a
	ld	(_anim_active), a
	inc	a
	ld	(_screen_dirty), a
	push	bc
	pop	hl
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _board
	add	iy, bc
	add	iy, de
	ld	a, (ix - 32)
	ld	(iy), a
	ld	hl, (_anim_from_r)
	ld	(ix - 50), hl
	ld	(_last_from_r), hl
	ld	hl, (_anim_from_c)
	ld	(ix - 53), hl
	ld	(_last_from_c), hl
	ld	hl, (ix - 29)
	ld	(_last_to_r), hl
	ld	(ix - 32), de
	ld	(_last_to_c), de
	ld	hl, 1
	ld	(_has_last_move), hl
	ld	a, (_pending_move+4)
	ld	c, a
	bit	3, c
	jp	nz, BB72_191
BB72_163:
	push	hl
	push	hl
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	hl, _pending_move
	ld	bc, 5
	ldir
	call	_apply_engine_move
	pop	hl
	pop	hl
	jp	BB72_311
BB72_164:
	ld	de, 1
	or	a, a
	sbc	hl, de
	jp	nz, BB72_196
	ld	hl, 2
	ld	(_ai_thinking), hl
	call	_draw_playing
	jp	BB72_311
BB72_166:
	ld	hl, 1
	jp	BB72_303
BB72_167:
	ld	hl, 320
	lea	de, iy
	or	a, a
	sbc	hl, de
	ld	bc, 2
	call	__idivs
	ld	(ix - 41), hl
	ld	de, -6
	add	hl, de
	ld	(ix - 47), hl
	ld	de, 12
	add	iy, de
	ld	hl, ___const.draw_color_select.items
	ld	(ix - 32), hl
	ld	hl, 80
	ld	(ix - 35), hl
	ld	a, 78
	ld	l, a
	ld	(ix - 38), hl
	ld	bc, 0
BB72_168:
	push	bc
	pop	hl
	ld	de, 3
	or	a, a
	sbc	hl, de
	jp	z, BB72_176
	ld	(ix - 29), iy
	ld	de, (_color_cursor)
	ld	(ix - 44), bc
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	ld	hl, 11
	jr	nz, BB72_171
	ld	hl, 12
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 22
	push	hl
	ld	hl, (ix - 29)
	push	hl
	ld	hl, (ix - 38)
	push	hl
	ld	hl, (ix - 47)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 13
BB72_171:
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, (ix - 32)
	ld	bc, (hl)
	ld	hl, (ix - 35)
	push	hl
	ld	de, (ix - 41)
	push	de
	push	bc
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	bc, (ix - 44)
	inc	bc
	ld	hl, (ix - 38)
	ld	a, l
	add	a, 36
	ld	l, a
	ld	(ix - 38), hl
	ld	de, 36
	ld	hl, (ix - 35)
	add	hl, de
	ld	(ix - 35), hl
	ld	iy, (ix - 32)
	lea	iy, iy + 3
	ld	(ix - 32), iy
	ld	iy, (ix - 29)
	jp	BB72_168
BB72_172:
	ld	hl, (_current_turn)
	ld	de, 1
	or	a, a
	sbc	hl, de
	ld	a, e
	jr	z, BB72_174
	ld	a, -1
BB72_174:
	ld	hl, (_promo_from_r)
	ld	de, (_promo_from_c)
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _board
	lea	hl, iy
	add	hl, bc
	add	hl, de
	ld	(hl), a
	ld	a, (_promo_captured)
	ld	hl, (_promo_r)
	ld	de, (_promo_c)
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	lea	hl, iy
	add	hl, bc
	add	hl, de
	ld	(hl), a
	ld	hl, (_promo_saved_has_last)
	ld	(_has_last_move), hl
	ld	hl, (_promo_saved_from_r)
	ld	(_last_from_r), hl
	ld	hl, (_promo_saved_from_c)
	ld	(_last_from_c), hl
	ld	hl, (_promo_saved_to_r)
	ld	(_last_to_r), hl
	ld	hl, (_promo_saved_to_c)
	ld	(_last_to_c), hl
	scf
	sbc	hl, hl
	ld	(_sel_r), hl
	ld	(_sel_c), hl
	xor	a, a
	ld	(_legal_target_count), a
BB72_175:
	ld	hl, 3
	jp	BB72_303
BB72_176:
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 9
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, 222
	push	hl
	ld	hl, 16
	push	hl
	ld	hl, _.str.37
	jp	BB72_308
BB72_177:
	xor	a, a
	ld	(_running), a
	jp	BB72_311
BB72_178:
	ld	hl, 320
	ld	iy, (ix - 29)
	lea	de, iy
	or	a, a
	sbc	hl, de
	ld	bc, 2
	call	__idivs
	ld	(ix - 44), hl
	ld	de, -6
	add	hl, de
	ld	(ix - 50), hl
	ld	de, 12
	add	iy, de
	ld	(ix - 29), iy
	ld	iy, _.str.1.57
	ld	hl, ___const.draw_menu.items
	ld	(ix - 32), hl
	ld	hl, 95
	ld	(ix - 35), hl
	ld	a, 93
	ld	l, a
	ld	(ix - 38), hl
	ld	bc, 0
BB72_179:
	push	bc
	pop	hl
	ld	de, 2
	or	a, a
	sbc	hl, de
	jp	z, BB72_202
	ld	hl, (ix - 32)
	ld	hl, (hl)
	ld	(ix - 47), hl
	push	hl
	ld	(ix - 41), bc
	call	_gfx_GetStringWidth
	pop	hl
	ld	a, (_menu_cursor)
	ld	l, a
	ld	bc, 1
	call	__iand
	push	hl
	pop	de
	ld	hl, (ix - 41)
	or	a, a
	sbc	hl, de
	ld	hl, 11
	jr	nz, BB72_182
	ld	hl, 12
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 22
	push	hl
	ld	hl, (ix - 29)
	push	hl
	ld	hl, (ix - 38)
	push	hl
	ld	hl, (ix - 50)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 13
BB72_182:
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, (ix - 35)
	push	hl
	ld	hl, (ix - 44)
	push	hl
	ld	hl, (ix - 47)
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	bc, (ix - 41)
	inc	bc
	ld	hl, (ix - 38)
	ld	a, l
	add	a, 40
	ld	l, a
	ld	(ix - 38), hl
	ld	de, 40
	ld	hl, (ix - 35)
	add	hl, de
	ld	(ix - 35), hl
	ld	iy, (ix - 32)
	lea	iy, iy + 3
	ld	(ix - 32), iy
	ld	iy, _.str.1.57
	jp	BB72_179
BB72_183:
	or	a, a
	sbc	hl, hl
	jp	BB72_303
BB72_184:
	ld	hl, 320
	lea	de, iy
	or	a, a
	sbc	hl, de
	ld	bc, 2
	call	__idivs
	ld	(ix - 44), hl
	ld	de, -6
	add	hl, de
	ld	(ix - 56), hl
	ld	de, 12
	add	iy, de
	ld	hl, _difficulty_subtexts
	ld	(ix - 35), hl
	ld	hl, _difficulty_labels
	ld	(ix - 38), hl
	ld	hl, 74
	ld	(ix - 29), hl
	ld	a, 56
	ld	l, a
	ld	(ix - 41), hl
	ld	bc, 0
BB72_185:
	push	bc
	pop	hl
	ld	de, 5
	or	a, a
	sbc	hl, de
	ld	hl, 1
	jp	z, BB72_210
	ld	(ix - 32), iy
	ld	hl, (ix - 29)
	ld	de, -16
	add	hl, de
	ld	(ix - 50), hl
	ld	de, (_difficulty_cursor)
	ld	(ix - 47), bc
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	ld	hl, 11
	jr	nz, BB72_188
	ld	hl, 12
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 26
	push	hl
	ld	hl, (ix - 32)
	push	hl
	ld	hl, (ix - 41)
	push	hl
	ld	hl, (ix - 56)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 13
BB72_188:
	ld	(ix - 53), hl
	ld	hl, 2
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, (ix - 53)
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, (ix - 38)
	ld	hl, (hl)
	ld	de, (ix - 50)
	push	de
	ld	de, (ix - 44)
	push	de
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	de, (_difficulty_cursor)
	ld	hl, (ix - 47)
	or	a, a
	sbc	hl, de
	ld	a, 13
	ld	l, a
	jr	z, BB72_190
	ld	a, 19
	ld	l, a
BB72_190:
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, (ix - 35)
	ld	bc, (hl)
	ld	hl, (ix - 29)
	push	hl
	ld	de, (ix - 44)
	push	de
	push	bc
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	bc, (ix - 47)
	inc	bc
	ld	hl, (ix - 41)
	ld	a, l
	add	a, 30
	ld	l, a
	ld	(ix - 41), hl
	ld	de, 30
	ld	hl, (ix - 29)
	add	hl, de
	ld	(ix - 29), hl
	ld	iy, (ix - 38)
	lea	iy, iy + 3
	ld	(ix - 38), iy
	ld	iy, (ix - 35)
	lea	iy, iy + 3
	ld	(ix - 35), iy
	ld	iy, (ix - 32)
	jp	BB72_185
BB72_191:
	ld	a, (_game_mode)
	bit	0, a
	jp	z, BB72_214
	ld	de, (_player_color)
	ld	hl, (_current_turn)
	or	a, a
	sbc	hl, de
	jp	z, BB72_214
	ld	a, c
	and	a, 48
	ld	l, a
	or	a, a
	jp	nz, BB72_290
	ex	de, hl
	ld	bc, -65536
	call	__imulu
	ld	de, 65536
	or	a, a
	sbc	hl, de
	ld	a, 5
	jp	z, BB72_319
	ld	a, -5
	jp	BB72_319
BB72_196:
	ld	hl, (_think_time_ms)
	ld	a, (_think_time_ms+3)
	ld	e, a
	push	de
	push	hl
	or	a, a
	sbc	hl, hl
	push	hl
	ld	hl, (ix - 59)
	push	hl
	call	_engine_think
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	b, (ix - 20)
	ld	a, b
	cp	a, 8
	jr	nc, BB72_200
	ld	e, (ix - 19)
	ld	a, e
	cp	a, 8
	jr	nc, BB72_200
	ld	c, (ix - 18)
	ld	a, c
	cp	a, 8
	jr	nc, BB72_200
	ld	a, (ix - 17)
	cp	a, 8
	jp	c, BB72_304
BB72_200:
	call	_compute_status
	ld	l, a
	cp	a, 2
	jp	z, BB72_215
	ld	de, 0
	jp	BB72_216
BB72_202:
	push	iy
	ld	hl, _.str.8.61
	push	hl
	call	_ti_Open
	ld	c, a
	pop	de
	pop	de
	or	a, a
	ld	de, _.str.7.63
	ex	de, hl
	jr	z, BB72_204
	push	bc
	call	_ti_Close
	pop	hl
	ld	hl, _.str.9.62
BB72_204:
	ld	a, (hl)
	or	a, a
	jp	nz, BB72_307
	ld	(ix - 29), hl
	ld	hl, _.str.1.57
	push	hl
	ld	hl, _.str.10.64
	push	hl
	call	_ti_Open
	ld	c, a
	pop	de
	pop	de
	or	a, a
	jp	nz, BB72_220
	ld	hl, _.str.1.57
	push	hl
	ld	hl, _.str.12.65
	push	hl
	call	_ti_Open
	ld	c, a
	pop	de
	pop	de
	or	a, a
	jp	nz, BB72_293
	ld	hl, _.str.1.57
	push	hl
	ld	hl, _.str.14.66
	push	hl
	call	_ti_Open
	ld	c, a
	pop	de
	pop	de
	or	a, a
	jp	nz, BB72_305
	ld	hl, _.str.1.57
	push	hl
	ld	hl, _.str.16.67
	push	hl
	call	_ti_Open
	ld	c, a
	pop	de
	pop	de
	or	a, a
	ld	hl, (ix - 29)
	jp	z, BB72_307
	ld	de, _.str.17.71
	jp	BB72_306
BB72_210:
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 9
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, 222
	push	hl
	ld	hl, 12
	push	hl
	ld	hl, _.str.22
	jp	BB72_308
BB72_211:
	or	a, a
	push	bc
	pop	hl
	ld	iy, 7
	jp	z, BB72_229
	push	bc
	pop	hl
	ld	de, 7
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB72_227
	lea	hl, iy
	jp	BB72_228
BB72_214:
	ld	hl, (ix - 35)
	ld	(_promo_saved_has_last), hl
	ld	hl, (ix - 38)
	ld	(_promo_saved_from_r), hl
	ld	hl, (ix - 41)
	ld	(_promo_saved_from_c), hl
	ld	hl, (ix - 44)
	ld	(_promo_saved_to_r), hl
	ld	hl, (ix - 47)
	ld	(_promo_saved_to_c), hl
	ld	hl, (ix - 29)
	ld	(_promo_r), hl
	ld	hl, (ix - 32)
	ld	(_promo_c), hl
	ld	hl, (ix - 50)
	ld	(_promo_from_r), hl
	ld	hl, (ix - 53)
	ld	(_promo_from_c), hl
	ld	a, (_anim_captured)
	ld	(_promo_captured), a
	or	a, a
	sbc	hl, hl
	ld	(_promo_cursor), hl
	ld	hl, 4
	jp	BB72_303
BB72_215:
	ld	de, (_player_color)
BB72_216:
	ld	(_winner), de
	ld	a, l
	or	a, a
	ld	a, 3
	jr	z, BB72_218
	ld	a, l
BB72_218:
	ld	(_game_over_reason), a
	ld	hl, 5
	ld	(_state), hl
BB72_219:
	or	a, a
	sbc	hl, hl
	ld	(_ai_thinking), hl
	jp	BB72_311
BB72_220:
	ld	de, _.str.11.68
	jp	BB72_306
BB72_221:
	push	bc
	pop	hl
	dec	hl
BB72_222:
	ld	(_cur_r), hl
BB72_223:
	ld	c, (ix - 35)
	ld	a, c
	and	a, 1
	bit	0, a
	ld	b, (ix - 41)
	jr	nz, BB72_225
	push	af
	ld	a, (ix - 32)
	ld	iyl, a
	pop	af
	jr	BB72_235
BB72_225:
	ld	a, b
	push	hl
	pop	bc
	ld	de, 7
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB72_233
	lea	hl, iy
	push	af
	ld	a, (ix - 32)
	ld	iyl, a
	pop	af
	jr	BB72_234
BB72_227:
	push	bc
	pop	hl
	inc	hl
BB72_228:
	ld	(_cur_r), hl
	ld	d, (ix - 35)
BB72_229:
	ld	a, d
	and	a, 1
	bit	0, a
	jr	nz, BB72_231
	push	af
	ld	a, (ix - 32)
	ld	iyl, a
	pop	af
	ld	b, (ix - 41)
	ld	c, (ix - 35)
	jr	BB72_240
BB72_231:
	push	hl
	pop	bc
	ld	de, 1
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	ld	a, (ix - 41)
	jp	p, BB72_238
	or	a, a
	sbc	hl, hl
	push	af
	ld	a, (ix - 32)
	ld	iyl, a
	pop	af
	jr	BB72_239
BB72_233:
	inc	bc
	push	af
	ld	a, (ix - 32)
	ld	iyl, a
	pop	af
	push	bc
	pop	hl
BB72_234:
	ld	(_cur_r), hl
	ld	c, (ix - 35)
	ld	b, a
BB72_235:
	bit	1, c
	ld	de, (ix - 44)
	ld	(ix - 29), de
	ld	(ix - 38), hl
	jr	z, BB72_245
	ld	a, b
	ld	bc, (ix - 44)
	push	bc
	pop	hl
	ld	de, 1
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB72_243
	ld	bc, 0
	jr	BB72_244
BB72_238:
	dec	bc
	push	af
	ld	a, (ix - 32)
	ld	iyl, a
	pop	af
	push	bc
	pop	hl
BB72_239:
	ld	c, (ix - 35)
	ld	(_cur_r), hl
	ld	b, a
BB72_240:
	bit	1, c
	ld	de, (ix - 44)
	ld	(ix - 29), de
	ld	(ix - 38), hl
	jr	z, BB72_250
	ld	a, b
	ld	bc, (ix - 44)
	push	bc
	pop	hl
	ld	de, 7
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB72_248
	ld	bc, 7
	jr	BB72_249
BB72_243:
	dec	bc
BB72_244:
	ld	(ix - 29), bc
	ld	(_cur_c), bc
	push	af
	ld	a, (ix - 32)
	ld	iyl, a
	pop	af
	ld	hl, (ix - 38)
	ld	c, (ix - 35)
	ld	b, a
BB72_245:
	bit	2, c
	jr	z, BB72_258
	ld	iy, (ix - 29)
	lea	hl, iy
	ld	de, 7
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB72_254
	ld	hl, 7
	jr	BB72_253
BB72_248:
	inc	bc
BB72_249:
	ld	(ix - 29), bc
	ld	(_cur_c), bc
	push	af
	ld	a, (ix - 32)
	ld	iyl, a
	pop	af
	ld	hl, (ix - 38)
	ld	c, (ix - 35)
	ld	b, a
BB72_250:
	bit	2, c
	jr	z, BB72_258
	ld	iy, (ix - 29)
	lea	hl, iy
	ld	de, 1
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB72_255
	or	a, a
	sbc	hl, hl
BB72_253:
	ld	(ix - 29), hl
	jr	BB72_257
BB72_254:
	inc	iy
	jr	BB72_256
BB72_255:
	dec	iy
BB72_256:
	ld	(ix - 29), iy
BB72_257:
	push	af
	ld	a, (ix - 32)
	ld	iyl, a
	pop	af
	ld	c, (ix - 35)
	ld	hl, (ix - 29)
	ld	(_cur_c), hl
BB72_258:
	ld	a, c
	or	a, a
	jr	z, BB72_263
	ld	a, iyl
	or	a, a
	jr	nz, BB72_263
	ld	a, b
	or	a, a
	jr	nz, BB72_263
	ld	hl, (ix - 38)
	ld	bc, (ix - 47)
	or	a, a
	sbc	hl, bc
	ld	b, (ix - 41)
	jp	nz, BB72_289
	ld	hl, (ix - 29)
	ld	de, (ix - 44)
	or	a, a
	sbc	hl, de
	jp	nz, BB72_289
BB72_263:
	ld	a, iyl
	and	a, 1
	bit	0, a
	jr	nz, BB72_265
	bit	5, b
	jp	z, BB72_295
BB72_265:
	ld	iyl, b
	ld	a, 1
	ld	(_screen_dirty), a
	ld	bc, (_sel_r)
	push	bc
	pop	hl
	ld	de, 0
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB72_273
	ld	hl, (ix - 38)
	ld	c, 3
	call	__ishl
	push	hl
	pop	de
	ld	hl, _board
	add	hl, de
	ld	de, (ix - 29)
	add	hl, de
	ld	l, (hl)
	ld	a, l
	or	a, a
	ld	b, iyl
	jp	z, BB72_295
	ld	de, (_current_turn)
	ld	a, l
	cp	a, 1
	call	pe, __setflag
	ld	a, -1
	jp	p, BB72_269
	ld	a, 0
BB72_269:
	push	de
	pop	hl
	ld	bc, 1
	or	a, a
	sbc	hl, bc
	ld	b, (ix - 41)
	jr	nz, BB72_271
	bit	0, a
	jp	nz, BB72_288
BB72_271:
	ex	de, hl
	ld	de, -1
	or	a, a
	sbc	hl, de
	jp	nz, BB72_295
	bit	0, a
	jp	nz, BB72_295
	jp	BB72_288
BB72_273:
	ld	de, (_sel_c)
	ld	hl, (ix - 38)
	or	a, a
	sbc	hl, bc
	jr	nz, BB72_276
	ld	hl, (ix - 29)
	or	a, a
	sbc	hl, de
	jr	nz, BB72_276
	scf
	sbc	hl, hl
	ld	(_sel_r), hl
	ld	(_sel_c), hl
	xor	a, a
	ld	(_legal_target_count), a
	ld	b, iyl
	jp	BB72_295
BB72_276:
	ld	(ix - 44), de
	ld	(ix - 35), bc
	ld	hl, (ix - 38)
	ld	c, 3
	call	__ishl
	push	hl
	pop	de
	ld	hl, _board
	add	hl, de
	ld	de, (ix - 29)
	add	hl, de
	ld	l, (hl)
	ld	a, l
	or	a, a
	ld	b, iyl
	jr	z, BB72_283
	ld	de, (_current_turn)
	ld	a, l
	cp	a, 1
	call	pe, __setflag
	ld	a, -1
	jp	p, BB72_279
	ld	a, 0
BB72_279:
	push	de
	pop	hl
	ld	bc, 1
	or	a, a
	sbc	hl, bc
	ld	b, (ix - 41)
	jr	nz, BB72_281
	bit	0, a
	jr	nz, BB72_288
BB72_281:
	ex	de, hl
	ld	de, -1
	or	a, a
	sbc	hl, de
	jr	nz, BB72_283
	bit	0, a
	jr	z, BB72_288
BB72_283:
	ld	a, (_legal_target_count)
	ld	de, 0
	ld	e, a
	ld	iy, _legal_targets
BB72_284:
	push	de
	pop	hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB72_295
	ld	bc, 0
	ld	c, (iy + 2)
	ld	hl, (ix - 38)
	or	a, a
	sbc	hl, bc
	jr	nz, BB72_287
	ld	bc, 0
	ld	c, (iy + 3)
	ld	hl, (ix - 29)
	or	a, a
	sbc	hl, bc
	jp	z, BB72_294
BB72_287:
	lea	iy, iy + 5
	dec	de
	ld	b, (ix - 41)
	jr	BB72_284
BB72_288:
	ld	de, (ix - 38)
	ld	(_sel_r), de
	ld	bc, (ix - 29)
	ld	(_sel_c), bc
	ld	hl, 64
	push	hl
	ld	hl, _legal_targets
	push	hl
	push	bc
	push	de
	call	_engine_get_moves_from
	ld	b, (ix - 41)
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	(_legal_target_count), a
	jp	BB72_295
BB72_289:
	or	a, a
	sbc	hl, hl
	push	hl
	call	_gfx_Blit
	pop	hl
	ld	hl, (ix - 44)
	push	hl
	ld	hl, (ix - 47)
	push	hl
	call	_draw_square
	pop	hl
	pop	hl
	ld	hl, (_cur_r)
	ld	de, (_cur_c)
	push	de
	push	hl
	call	_draw_square
	pop	hl
	pop	hl
	call	_draw_cursor_border
	jp	BB72_310
BB72_290:
	ld	a, l
	cp	a, 16
	jp	nz, BB72_314
	ld	a, e
	cp	a, -1
	ld	a, 4
	jp	z, BB72_319
	ld	a, -4
	jp	BB72_319
BB72_293:
	ld	de, _.str.13.69
	jp	BB72_306
BB72_294:
	ld	de, _pending_move
	lea	hl, iy
	ld	bc, 5
	ldir
	push	hl
	push	hl
	push	hl
	ld	hl, 0
	add	hl, sp
	ld	(ix - 47), hl
	ld	de, (ix - 47)
	lea	hl, iy
	ld	bc, 5
	ldir
	ld	hl, _pending_effects
	ld	iy, (ix - 47)
	ld	(iy + 6), hl
	call	_engine_get_move_effects
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (ix - 29)
	push	hl
	ld	hl, (ix - 38)
	push	hl
	ld	hl, (ix - 44)
	push	hl
	ld	hl, (ix - 35)
	push	hl
	call	_start_move_anim
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	b, (ix - 41)
BB72_295:
	bit	6, (ix - 32)
	jr	z, BB72_298
	ld	a, 1
	ld	(_screen_dirty), a
	ld	hl, (_sel_r)
	ld	de, 0
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB72_302
	scf
	sbc	hl, hl
	ld	(_sel_r), hl
	ld	(_sel_c), hl
	xor	a, a
	ld	(_legal_target_count), a
BB72_298:
	bit	6, b
	jr	nz, BB72_302
	ld	hl, (_state)
	ld	a, (_screen_dirty)
	ld	de, 3
	or	a, a
	sbc	hl, de
	jp	nz, BB72_311
	bit	0, a
	jp	z, BB72_311
	call	_draw_playing
	xor	a, a
	ld	(_screen_dirty), a
	jp	BB72_311
BB72_302:
	ld	hl, (_current_turn)
	call	__ineg
	ld	(_winner), hl
	xor	a, a
	ld	(_game_over_reason), a
	ld	hl, 5
BB72_303:
	ld	(_state), hl
	jp	BB72_311
BB72_304:
	ld	(ix - 32), e
	ld	de, _pending_move
	ld	(ix - 38), b
	ld	(ix - 29), a
	ld	hl, (ix - 59)
	ld	(ix - 35), c
	ld	bc, 5
	ldir
	push	hl
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	lea	de, iy
	ld	hl, (ix - 59)
	ld	bc, 5
	ldir
	ld	hl, _pending_effects
	ld	(iy + 6), hl
	call	_engine_get_move_effects
	pop	hl
	pop	hl
	pop	hl
	ld	bc, 0
	push	bc
	pop	iy
	push	af
	ld	a, (ix - 38)
	ld	iyl, a
	pop	af
	push	bc
	pop	de
	ld	e, (ix - 32)
	ld	c, (ix - 35)
	or	a, a
	sbc	hl, hl
	ld	l, (ix - 29)
	push	hl
	push	bc
	push	de
	push	iy
	call	_start_move_anim
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	jp	BB72_219
BB72_305:
	ld	de, _.str.15.70
BB72_306:
	ld	(ix - 29), de
	push	bc
	call	_ti_Close
	pop	hl
	ld	hl, (ix - 29)
BB72_307:
	push	hl
	ld	hl, _.str.19
	push	hl
	ld	hl, _.str.18
	push	hl
	ld	hl, (ix - 59)
	push	hl
	call	_sprintf
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 9
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, (ix - 59)
	push	hl
	call	_gfx_GetStringWidth
	push	hl
	pop	de
	pop	hl
	ld	hl, 316
	or	a, a
	sbc	hl, de
	ld	de, 4
	push	de
	push	hl
	ld	hl, (ix - 59)
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 222
	push	hl
	ld	hl, 12
	push	hl
	ld	hl, _.str.20
BB72_308:
	push	hl
	call	_gfx_PrintStringXY
BB72_309:
	pop	hl
	pop	hl
	pop	hl
BB72_310:
	call	_gfx_SwapDraw
BB72_311:
	ld	a, (_cur_g1)
	ld	(_prev_g1), a
	ld	a, (_cur_g6)
	ld	(_prev_g6), a
	ld	a, (_cur_g7)
	ld	(_prev_g7), a
	ld	hl, (_frame_count)
	inc	hl
	ld	(_frame_count), hl
BB72_312:
	call	_clock
	ld	bc, (ix - 23)
	ld	a, (ix - 26)
	call	__lsub
	ld	bc, 546
	xor	a, a
	call	__lcmpu
	jr	c, BB72_312
	ld	a, (_running)
	bit	0, a
	jp	nz, BB72_43
	jr	BB72_320
BB72_314:
	ld	a, l
	cp	a, 32
	jr	nz, BB72_317
	ld	a, e
	cp	a, -1
	ld	a, 3
	jr	z, BB72_319
	ld	a, -3
	jr	BB72_319
BB72_317:
	ld	a, e
	cp	a, -1
	ld	a, 2
	jr	z, BB72_319
	ld	a, -2
BB72_319:
	ld	(iy), a
	jp	BB72_163
BB72_320:
	xor	a, a
	ld	(_book_ready), a
	ld	(_num_segments), a
	sbc	hl, hl
	ld	(_total_entries), hl
	ld	(_total_entries+3), a
	call	_gfx_End
	or	a, a
	sbc	hl, hl
BB72_321:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits
	section	.rodata,"a",@progbits
	private	JTI72_0
JTI72_0:
	dl	BB72_45
	dl	BB72_96
	dl	BB72_58
	dl	BB72_113
	dl	BB72_75
	dl	BB72_126

	section	.text,"ax",@progbits
	private	_start_game
_start_game:
	ld	hl, -9
	call	__frameset
	ld	hl, _board
	ld	(ix - 6), hl
	ld	hl, (_game_number)
	inc	hl
	ld	(_game_number), hl
	call	_clock
	push	hl
	pop	iy
	ld	d, e
	ld	hl, (_frame_count)
	ld	e, 0
	ld	bc, 3635633
	ld	a, -98
	call	__lmulu
	lea	bc, iy
	ld	a, d
	call	__lxor
	push	hl
	pop	iy
	ld	d, e
	ld	hl, (_game_number)
	ld	e, 0
	ld	bc, -3781011
	ld	a, 65
	call	__lmulu
	push	hl
	pop	bc
	ld	a, e
	lea	hl, iy
	ld	e, d
	call	__lxor
	ld	a, e
	ld	(_book_random_seed), hl
	ld	(_book_random_seed+3), a
	push	hl
	call	_srand
	pop	hl
	ld	hl, _ce_time_ms
	ld	(ix - 3), hl
	pea	ix - 3
	call	_engine_init
	pop	hl
	call	_engine_new_game
	ld	bc, 8
	ld	de, 0
BB73_1:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jr	z, BB73_6
	ld	(ix - 9), de
	ld	bc, 0
BB73_3:
	push	bc
	pop	hl
	ld	de, 8
	or	a, a
	sbc	hl, de
	jr	z, BB73_5
	ld	iy, (ix - 6)
	add	iy, bc
	ld	(iy), 0
	inc	bc
	jr	BB73_3
BB73_5:
	ld	de, (ix - 9)
	inc	de
	ld	iy, (ix - 6)
	lea	iy, iy + 8
	ld	(ix - 6), iy
	ld	bc, 8
	jr	BB73_1
BB73_6:
	ld	l, -4
	ld	a, l
	ld	(_board), a
	ld	e, -2
	ld	a, e
	ld	(_board+1), a
	ld	c, -3
	ld	a, c
	ld	(_board+2), a
	ld	a, -5
	ld	(_board+3), a
	dec	a
	ld	(_board+4), a
	ld	a, c
	ld	(_board+5), a
	ld	a, e
	ld	(_board+6), a
	ld	a, l
	ld	(_board+7), a
	ld	de, 0
	ld	bc, 1
BB73_7:
	push	de
	pop	iy
	ex	de, hl
	ld	de, 8
	or	a, a
	sbc	hl, de
	jr	z, BB73_9
	ld	hl, _board+8
	lea	de, iy
	add	hl, de
	ld	(hl), -1
	inc	de
	jr	BB73_7
BB73_9:
	push	bc
	pop	iy
	ld	l, 4
	ld	a, l
	ld	(_board+56), a
	ld	e, 2
	ld	a, e
	ld	(_board+57), a
	ld	h, 3
	ld	a, h
	ld	(_board+58), a
	ld	a, 5
	ld	(_board+59), a
	inc	a
	ld	(_board+60), a
	ld	a, h
	ld	(_board+61), a
	ld	a, e
	ld	(_board+62), a
	ld	a, l
	ld	(_board+63), a
	ld	bc, 0
	ld	de, 8
BB73_10:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jr	z, BB73_12
	ld	hl, _board+48
	add	hl, bc
	ld	(hl), 1
	inc	bc
	jr	BB73_10
BB73_12:
	ld	hl, 7
	ld	(_cur_r), hl
	ld	hl, 4
	ld	(_cur_c), hl
	scf
	sbc	hl, hl
	ld	(_sel_r), hl
	ld	(_sel_c), hl
	ld	(_current_turn), iy
	inc	hl
	push	hl
	pop	de
	ld	(_has_last_move), de
	ld	a, l
	ld	(_legal_target_count), a
	ld	(_ai_thinking), de
	xor	a, a
	ld	(_anim_active), a
	ld	a, l
	ld	(_game_over_reason), a
	ld	a, (_game_mode)
	bit	0, a
	jr	z, BB73_14
	ld	hl, (_color_cursor)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	nz, BB73_16
BB73_14:
	ld	(_player_color), iy
	or	a, a
	sbc	hl, hl
	ld	(_board_flipped), hl
BB73_15:
	ld	a, 1
	ld	(_screen_dirty), a
	ld	hl, 3
	ld	(_state), hl
	ld	sp, ix
	pop	ix
	ret
BB73_16:
	ld	de, 1
	or	a, a
	sbc	hl, de
	jr	nz, BB73_18
	scf
	sbc	hl, hl
	ld	(_player_color), hl
	ld	(_board_flipped), iy
	jr	BB73_22
BB73_18:
	call	_rand
	ld	iy, -1
	ld	bc, 1
	call	__iand
	push	hl
	pop	de
	bit	0, e
	jr	z, BB73_20
	push	bc
	pop	iy
BB73_20:
	ld	(_player_color), iy
	ld	a, (_game_mode)
	push	de
	pop	hl
	call	__ixor
	push	bc
	pop	iy
	ld	(_board_flipped), hl
	bit	0, a
	jr	z, BB73_15
	bit	0, e
	jr	nz, BB73_15
BB73_22:
	ld	(_ai_thinking), iy
	jr	BB73_15
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_apply_engine_move
_apply_engine_move:
	call	__frameset0
	lea	hl, ix + 6
	push	de
	push	de
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	bc, 5
	ldir
	call	_engine_make_move
	pop	hl
	pop	hl
	cp	a, 2
	jr	nz, BB74_2
	ld	a, 2
	ld	hl, (_current_turn)
	ld	(_winner), hl
	ld	(_game_over_reason), a
	call	__ineg
	ld	(_current_turn), hl
	scf
	sbc	hl, hl
	ld	(_sel_r), hl
	ld	(_sel_c), hl
	xor	a, a
	ld	(_legal_target_count), a
	ld	hl, 5
	ld	(_state), hl
	inc	a
	jr	BB74_8
BB74_2:
	ld	de, 5
	ld	bc, -1
	ld	iyl, d
	cp	a, 3
	jr	c, BB74_4
	or	a, a
	sbc	hl, hl
	ld	(_winner), hl
	ld	(_game_over_reason), a
	ld	hl, (_current_turn)
	call	__ineg
	ld	(_current_turn), hl
	ld	(_sel_r), bc
	ld	(_sel_c), bc
	ld	a, iyl
	ld	(_legal_target_count), a
	ld	(_state), de
	ld	a, 1
	jr	BB74_8
BB74_4:
	ld	hl, (_current_turn)
	call	__ineg
	push	hl
	pop	de
	ld	(_current_turn), de
	ld	(_sel_r), bc
	ld	(_sel_c), bc
	ld	a, iyl
	ld	(_legal_target_count), a
	ld	a, (_game_mode)
	bit	0, a
	jr	z, BB74_7
	ld	hl, (_player_color)
	or	a, a
	sbc	hl, de
	jr	z, BB74_7
	ld	hl, 1
	ld	(_ai_thinking), hl
BB74_7:
	ld	a, iyl
BB74_8:
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_render_playing
_render_playing:
	ld	hl, -39
	call	__frameset
	ld	hl, 25
	ld	(ix - 18), hl
	ld	hl, _.str.40
	ld	(ix - 30), hl
	ld	hl, _.str.42
	ld	(ix - 27), hl
	lea	hl, ix - 12
	ld	(ix - 33), hl
	or	a, a
	sbc	hl, hl
	push	hl
	call	_gfx_FillScreen
	pop	hl
	ld	de, 8
	or	a, a
	sbc	hl, hl
	ld	(ix - 15), hl
	ld	bc, 0
BB75_1:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jr	z, BB75_12
	ld	iy, 7
	lea	hl, iy
	or	a, a
	sbc	hl, bc
	ld	(ix - 39), hl
	or	a, a
	sbc	hl, hl
	ld	(ix - 21), hl
BB75_3:
	lea	hl, iy
	ld	de, -1
	or	a, a
	sbc	hl, de
	jr	z, BB75_11
	ld	hl, (_board_flipped)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	a, -1
	jr	z, BB75_6
	ld	a, 0
BB75_6:
	bit	0, a
	push	bc
	pop	hl
	jr	nz, BB75_8
	ld	hl, (ix - 39)
BB75_8:
	ld	(ix - 24), bc
	bit	0, a
	ld	de, (ix - 21)
	jr	nz, BB75_10
	lea	de, iy
BB75_10:
	push	de
	push	hl
	ld	(ix - 36), iy
	call	_draw_square
	ld	iy, (ix - 36)
	pop	hl
	pop	hl
	ld	hl, (ix - 21)
	inc	hl
	ld	(ix - 21), hl
	dec	iy
	ld	bc, (ix - 24)
	jr	BB75_3
BB75_11:
	inc	bc
	ld	de, 8
	jr	BB75_1
BB75_12:
	call	_draw_cursor_border
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 11
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, 26
	push	hl
	pop	iy
	ld	bc, 7
	push	bc
	pop	de
	or	a, a
	sbc	hl, hl
	ld	(ix - 21), hl
	ex	de, hl
BB75_13:
	ld	(ix - 24), hl
	ld	de, -1
	or	a, a
	sbc	hl, de
	jr	z, BB75_17
	ld	hl, (_board_flipped)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	hl, (ix - 21)
	jr	z, BB75_16
	ld	hl, (ix - 24)
BB75_16:
	ld	(ix - 39), hl
	ld	hl, 226
	push	hl
	push	iy
	ld	(ix - 36), iy
	call	_gfx_SetTextXY
	pop	hl
	pop	hl
	ld	hl, (ix - 39)
	ld	a, l
	add	a, 97
	ld	l, a
	push	hl
	call	_gfx_PrintChar
	ld	iy, (ix - 36)
	pop	hl
	ld	hl, (ix - 21)
	inc	hl
	ld	(ix - 21), hl
	ld	hl, (ix - 24)
	dec	hl
	ld	de, 26
	add	iy, de
	ld	bc, 7
	jr	BB75_13
BB75_17:
	push	bc
	pop	hl
	ld	de, -1
	or	a, a
	sbc	hl, de
	jr	z, BB75_21
	ld	hl, (_board_flipped)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	hl, (ix - 15)
	jr	z, BB75_20
	push	bc
	pop	hl
BB75_20:
	ld	(ix - 24), hl
	ld	hl, (ix - 18)
	push	hl
	ld	hl, 6
	push	hl
	ld	(ix - 21), bc
	call	_gfx_SetTextXY
	pop	hl
	pop	hl
	ld	a, 56
	ld	hl, (ix - 24)
	sub	a, l
	ld	l, a
	push	hl
	call	_gfx_PrintChar
	ld	bc, (ix - 21)
	pop	hl
	ld	hl, (ix - 15)
	inc	hl
	ld	(ix - 15), hl
	dec	bc
	ld	de, 26
	ld	hl, (ix - 18)
	add	hl, de
	ld	(ix - 18), hl
	jr	BB75_17
BB75_21:
	ld	hl, 15
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, -16
	push	hl
	ld	hl, 88
	push	hl
	or	a, a
	sbc	hl, hl
	push	hl
	ld	hl, 230
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 11
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	a, (_game_mode)
	bit	0, a
	jr	z, BB75_23
	ld	hl, (_difficulty_cursor)
	inc	hl
	push	hl
	ld	hl, _.str.39
	push	hl
	ld	hl, (ix - 33)
	push	hl
	call	_sprintf
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 6
	push	hl
	ld	hl, 234
	push	hl
	ld	hl, (ix - 33)
	jr	BB75_24
BB75_23:
	ld	hl, 6
	push	hl
	ld	hl, 234
	push	hl
	ld	hl, _.str.38
BB75_24:
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 9
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 84
	push	hl
	ld	hl, 20
	push	hl
	ld	hl, 232
	push	hl
	call	_gfx_HorizLine_NoClip
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, (_current_turn)
	ld	de, 1
	or	a, a
	sbc	hl, de
	ld	l, 7
	jr	z, BB75_26
	ld	a, 11
	ld	l, a
BB75_26:
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, (_current_turn)
	ld	de, 1
	or	a, a
	sbc	hl, de
	ld	de, _.str.33
	jr	z, BB75_28
	ld	de, _.str.34
BB75_28:
	ld	hl, 26
	push	hl
	ld	hl, 234
	push	hl
	push	de
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (_ai_thinking)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	de, 12
	jr	nz, BB75_30
	call	_engine_in_check
	or	a, a
	ld	hl, 10
	ex	de, hl
	ld	hl, _.str.41
	ld	(ix - 30), hl
	jr	z, BB75_31
BB75_30:
	push	de
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, (ix - 30)
	ld	(ix - 27), hl
BB75_31:
	ld	hl, 38
	push	hl
	ld	hl, 234
	push	hl
	ld	hl, (ix - 27)
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (_sel_r)
	ld	de, 0
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB75_33
	ld	hl, 9
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 84
	push	hl
	ld	hl, 53
	push	hl
	ld	hl, 232
	push	hl
	call	_gfx_HorizLine_NoClip
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 10
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, 60
	push	hl
	ld	hl, 234
	push	hl
	call	_gfx_SetTextXY
	pop	hl
	pop	hl
	ld	hl, _.str.43
	push	hl
	call	_gfx_PrintString
	pop	hl
	ld	a, (_sel_c)
	add	a, 97
	ld	l, a
	push	hl
	call	_gfx_PrintChar
	pop	hl
	ld	a, (_sel_r)
	ld	l, a
	ld	a, 56
	sub	a, l
	ld	l, a
	push	hl
	call	_gfx_PrintChar
	pop	hl
BB75_33:
	ld	hl, 9
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 84
	push	hl
	ld	hl, 78
	push	hl
	ld	hl, 232
	push	hl
	call	_gfx_HorizLine_NoClip
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 11
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, 84
	push	hl
	ld	hl, 232
	push	hl
	ld	hl, _.str.44
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 96
	push	hl
	ld	hl, 232
	push	hl
	ld	hl, _.str.45
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 112
	push	hl
	ld	hl, 232
	push	hl
	ld	hl, _.str.46
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 124
	push	hl
	ld	hl, 232
	push	hl
	ld	hl, _.str.47
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 140
	push	hl
	ld	hl, 232
	push	hl
	ld	hl, _.str.48
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 152
	push	hl
	ld	hl, 232
	push	hl
	ld	hl, _.str.49
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 168
	push	hl
	ld	hl, 232
	push	hl
	ld	hl, _.str.50
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 180
	push	hl
	ld	hl, 232
	push	hl
	ld	hl, _.str.51
	push	hl
	call	_gfx_PrintStringXY
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_draw_piece
_draw_piece:
	call	__frameset0
	ld	d, (ix + 6)
	ld	a, d
	or	a, a
	jr	z, BB76_5
	ld	iy, _piece_spr_data
	ld	a, d
	rlc	a
	sbc	a, a
	ld	l, a
	ld	a, d
	add	a, l
	xor	a, l
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	c, 1
	call	__ishl
	ld	bc, -2
	add	hl, bc
	ld	a, d
	cp	a, 1
	call	pe, __setflag
	jp	m, BB76_3
	ld	bc, 0
	jr	BB76_4
BB76_3:
	ld	bc, 1
BB76_4:
	add	hl, bc
	ld	bc, 402
	call	__imulu
	push	hl
	pop	bc
	add	iy, bc
	lea	bc, iy
	ld	iy, (ix + 9)
	ld	de, 3
	add	iy, de
	ld	a, (ix + 12)
	add	a, e
	ld	l, a
	push	hl
	push	iy
	push	bc
	call	_gfx_TransparentSprite_NoClip
	pop	hl
	pop	hl
	pop	hl
BB76_5:
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_draw_playing
_draw_playing:
	call	_render_playing
	jp	_gfx_SwapDraw
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_start_move_anim
_start_move_anim:
	ld	hl, -9
	call	__frameset
	ld	hl, (ix + 6)
	ld	iy, (ix + 9)
	ld	bc, (ix + 12)
	or	a, a
	sbc	hl, bc
	push	hl
	pop	de
	lea	hl, iy
	ld	bc, (ix + 15)
	or	a, a
	sbc	hl, bc
	ld	(ix - 3), hl
	push	de
	pop	hl
	push	de
	pop	iy
	add	iy, iy
	sbc	hl, hl
	push	hl
	pop	bc
	ex	de, hl
	add	hl, bc
	call	__ixor
	ld	(ix - 6), hl
	ld	hl, (ix - 3)
	push	hl
	pop	iy
	push	hl
	pop	de
	add	iy, iy
	sbc	hl, hl
	push	hl
	pop	bc
	ex	de, hl
	ld	de, (ix - 6)
	add	hl, bc
	call	__ixor
	push	hl
	pop	bc
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB78_2
	push	bc
	pop	de
BB78_2:
	ex	de, hl
	ld	bc, 50
	call	__imulu
	push	hl
	pop	bc
	ld	de, 200
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB78_4
	ld	bc, 200
BB78_4:
	ld	de, 2
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB78_6
	ld	bc, 1
BB78_6:
	ld	(ix - 9), bc
	ld	c, 3
	ld	hl, (ix + 6)
	call	__ishl
	push	hl
	pop	de
	ld	iy, _board
	add	iy, de
	ld	hl, (ix + 9)
	ex	de, hl
	add	iy, de
	ld	(ix - 3), iy
	ld	a, (iy)
	ld	(_anim_piece), a
	ld	iy, (ix + 12)
	lea	hl, iy
	call	__ishl
	push	hl
	pop	de
	ld	hl, _board
	add	hl, de
	ld	de, (ix + 15)
	add	hl, de
	ld	(ix - 6), hl
	ld	a, (hl)
	ld	(_anim_captured), a
	ld	hl, (ix + 6)
	ld	(_anim_from_r), hl
	ld	hl, (ix + 9)
	ld	(_anim_from_c), hl
	ld	(_anim_to_r), iy
	ld	(_anim_to_c), de
	ld	c, 15
	ld	hl, (ix - 9)
	call	__ishl
	ld	bc, 1000
	call	__idivu
	ld	(_anim_duration), hl
	xor	a, a
	ld	(_anim_duration+3), a
	call	_clock
	ld	a, e
	ld	(_anim_start), hl
	ld	(_anim_start+3), a
	ld	a, 1
	ld	(_anim_active), a
	ld	hl, (ix - 3)
	ld	(hl), 0
	ld	hl, (ix - 6)
	ld	(hl), 0
	ld	a, (_pending_effects+5)
	or	a, a
	jr	z, BB78_8
	ld	a, (_pending_effects+6)
	ld	de, 0
	push	de
	pop	hl
	ld	l, a
	ld	a, (_pending_effects+7)
	ld	e, a
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _board
	add	hl, bc
	add	hl, de
	ld	(hl), d
BB78_8:
	ld	a, (_pending_effects)
	or	a, a
	jr	z, BB78_10
	ld	a, (_pending_effects+1)
	ld	de, 0
	push	de
	pop	hl
	ld	l, a
	ld	a, (_pending_effects+2)
	push	de
	pop	bc
	ld	c, a
	ld	(ix - 3), bc
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _board
	lea	hl, iy
	add	hl, bc
	ld	bc, (ix - 3)
	add	hl, bc
	ld	a, (hl)
	ld	(ix - 3), a
	ld	(hl), d
	ld	a, (_pending_effects+3)
	push	de
	pop	hl
	ld	l, a
	ld	a, (_pending_effects+4)
	ld	e, a
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	add	iy, bc
	add	iy, de
	ld	a, (ix - 3)
	ld	(iy), a
BB78_10:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_draw_square
_draw_square:
	ld	hl, -15
	call	__frameset
	ld	de, 7
	ld	hl, (_board_flipped)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB79_2
	ld	a, 0
	jr	BB79_3
BB79_2:
	ld	a, -1
BB79_3:
	ex	de, hl
	ld	de, (ix + 6)
	or	a, a
	sbc	hl, de
	bit	0, a
	push	de
	pop	iy
	jr	nz, BB79_5
	push	hl
	pop	iy
BB79_5:
	ld	bc, 26
	ld	hl, 7
	ld	de, (ix + 9)
	or	a, a
	sbc	hl, de
	bit	0, a
	jr	nz, BB79_7
	ex	de, hl
BB79_7:
	ex	de, hl
	call	__imulu
	ld	(ix - 12), hl
	ld	de, 16
	add	hl, de
	ld	(ix - 3), hl
	lea	hl, iy
	call	__imulu
	ld	(ix - 15), hl
	add	hl, de
	ld	(ix - 6), hl
	ld	hl, (ix + 9)
	ld	de, (ix + 6)
	add	hl, de
	ld	bc, 1
	call	__iand
	ld	(ix - 9), hl
	ld	de, (_sel_r)
	ld	iy, (_sel_c)
	dec	bc
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	jp	m, BB79_12
	ex	de, hl
	ld	de, (ix + 6)
	or	a, a
	sbc	hl, de
	jr	nz, BB79_12
	lea	hl, iy
	ld	de, (ix + 9)
	or	a, a
	sbc	hl, de
	jr	nz, BB79_12
	ld	hl, (ix - 9)
	bit	0, l
	jr	z, BB79_23
	ld	l, 4
	jr	BB79_24
BB79_12:
	ld	hl, (_has_last_move)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	bc, (ix + 9)
	jr	z, BB79_19
	ld	hl, (_last_from_r)
	ld	de, (ix + 6)
	or	a, a
	sbc	hl, de
	jr	nz, BB79_15
	ld	hl, (_last_from_c)
	or	a, a
	sbc	hl, bc
	jr	z, BB79_17
BB79_15:
	ld	hl, (_last_to_r)
	ld	de, (ix + 6)
	or	a, a
	sbc	hl, de
	jr	nz, BB79_19
	ld	hl, (_last_to_c)
	or	a, a
	sbc	hl, bc
	jr	nz, BB79_19
BB79_17:
	ld	hl, (ix - 9)
	bit	0, l
	jr	z, BB79_22
	ld	l, 6
	jr	BB79_24
BB79_19:
	ld	hl, (ix - 9)
	bit	0, l
	jr	z, BB79_21
	ld	l, 2
	jr	BB79_24
BB79_21:
	ld	l, 1
	jr	BB79_24
BB79_22:
	ld	l, 5
	jr	BB79_24
BB79_23:
	ld	l, 3
BB79_24:
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 26
	push	hl
	push	hl
	ld	hl, (ix - 6)
	push	hl
	ld	hl, (ix - 3)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (_sel_r)
	ld	de, 0
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB79_31
	ld	hl, (ix + 9)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_is_legal_target
	ld	e, a
	pop	hl
	pop	hl
	or	a, a
	jp	z, BB79_31
	ld	hl, 16
	push	hl
	ld	(ix - 9), e
	call	_gfx_SetColor
	pop	hl
	ld	a, (ix - 9)
	cp	a, 1
	jr	nz, BB79_29
	ld	c, 3
	ld	hl, (ix + 6)
	call	__ishl
	push	hl
	pop	de
	ld	hl, _board
	add	hl, de
	ld	de, (ix + 9)
	add	hl, de
	ld	a, (hl)
	or	a, a
	jr	nz, BB79_29
	ld	de, 29
	ld	hl, (ix - 12)
	add	hl, de
	ld	de, (ix - 15)
	ld	a, e
	add	a, 29
	ld	e, a
	ld	bc, 4
	push	bc
	push	de
	push	hl
	call	_gfx_FillCircle_NoClip
	jr	BB79_30
BB79_29:
	ld	hl, 4
	push	hl
	push	hl
	ld	hl, (ix - 6)
	push	hl
	ld	hl, (ix - 3)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (ix - 12)
	ld	de, 38
	add	hl, de
	ld	(ix - 12), hl
	ld	de, 4
	push	de
	push	de
	ld	de, (ix - 6)
	push	de
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (ix - 15)
	ld	a, l
	add	a, 38
	ld	e, a
	ld	(ix - 9), de
	ld	hl, 4
	push	hl
	push	hl
	push	de
	ld	hl, (ix - 3)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 4
	push	hl
	push	hl
	ld	hl, (ix - 9)
	push	hl
	ld	hl, (ix - 12)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
BB79_30:
	pop	hl
	pop	hl
	pop	hl
BB79_31:
	ld	c, 3
	ld	hl, (ix + 6)
	call	__ishl
	push	hl
	pop	de
	ld	hl, _board
	add	hl, de
	ld	de, (ix + 9)
	add	hl, de
	ld	l, (hl)
	ld	a, l
	or	a, a
	ld	de, (ix - 6)
	push	de
	ld	de, (ix - 3)
	push	de
	push	hl
	call	nz, _draw_piece
	pop	hl
	pop	hl
	pop	hl
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_draw_cursor_border
_draw_cursor_border:
	ld	hl, -12
	call	__frameset
	ld	hl, (_board_flipped)
	ld	(ix - 9), hl
	ld	iy, (_cur_r)
	ld	hl, (_cur_c)
	ld	(ix - 3), hl
	ld	de, (_sel_r)
	ld	bc, 0
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	jp	m, BB80_5
	lea	hl, iy
	or	a, a
	sbc	hl, de
	lea	bc, iy
	ld	iy, 10
	jr	nz, BB80_3
	ld	de, (_sel_c)
	ld	hl, (ix - 3)
	or	a, a
	sbc	hl, de
	jr	z, BB80_8
BB80_3:
	ld	hl, (ix - 3)
	push	hl
	ld	(ix - 6), bc
	push	bc
	call	_is_legal_target
	pop	hl
	pop	hl
	or	a, a
	jr	z, BB80_6
	ld	iyl, 17
	jr	BB80_7
BB80_5:
	lea	bc, iy
	ld	iy, 10
	jr	BB80_8
BB80_6:
	ld	iyl, 18
BB80_7:
	ld	bc, (ix - 6)
BB80_8:
	ld	de, 7
	ld	hl, (ix - 9)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB80_10
	ld	a, 0
	jr	BB80_11
BB80_10:
	ld	a, -1
BB80_11:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	bit	0, a
	jr	nz, BB80_13
	push	hl
	pop	bc
BB80_13:
	ld	(ix - 6), bc
	ld	bc, 26
	ex	de, hl
	ld	de, (ix - 3)
	or	a, a
	sbc	hl, de
	bit	0, a
	jr	nz, BB80_15
	ex	de, hl
BB80_15:
	ex	de, hl
	call	__imulu
	ld	(ix - 9), hl
	ld	de, 16
	add	hl, de
	ld	(ix - 3), hl
	push	iy
	call	_gfx_SetColor
	pop	hl
	ld	hl, (ix - 6)
	ld	e, 26
	ld	d, l
	mlt	de
	ld	(ix - 12), de
	ld	a, e
	add	a, 16
	ld	e, a
	ld	(ix - 6), de
	ld	hl, 2
	push	hl
	ld	hl, 26
	push	hl
	push	de
	ld	hl, (ix - 3)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (ix - 12)
	ld	a, l
	add	a, 40
	ld	l, a
	ld	de, 2
	push	de
	ld	de, 26
	push	de
	push	hl
	ld	hl, (ix - 3)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 26
	push	hl
	ld	hl, 2
	push	hl
	ld	hl, (ix - 6)
	push	hl
	ld	hl, (ix - 3)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	de, 40
	ld	iy, (ix - 9)
	add	iy, de
	ld	hl, 26
	push	hl
	ld	hl, 2
	push	hl
	ld	hl, (ix - 6)
	push	hl
	push	iy
	call	_gfx_FillRectangle_NoClip
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_is_legal_target
_is_legal_target:
	call	__frameset0
	ld	e, 0
	ld	iy, _legal_targets+4
	ld	a, (_legal_target_count)
	ld	bc, 0
	ld	c, a
BB81_1:
	push	bc
	pop	hl
	ld	a, e
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB81_7
	or	a, a
	sbc	hl, hl
	ld	l, (iy - 2)
	ld	de, (ix + 6)
	sbc	hl, de
	jr	nz, BB81_4
	or	a, a
	sbc	hl, hl
	ld	l, (iy - 1)
	ld	de, (ix + 9)
	sbc	hl, de
	jr	z, BB81_5
BB81_4:
	lea	iy, iy + 5
	dec	bc
	ld	e, a
	jr	BB81_1
BB81_5:
	ld	a, (iy)
	and	a, 5
	or	a, a
	ld	a, 1
	jr	z, BB81_7
	ld	e, 2
	ld	a, e
BB81_7:
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_ce_time_ms
_ce_time_ms:
	ld	hl, -4
	call	__frameset
	call	_clock
	push	hl
	pop	iy
	ld	d, e
	ld	l, 15
	lea	bc, iy
	ld	a, d
	call	__lshru
	push	bc
	pop	hl
	ld	e, a
	ld	bc, 1000
	xor	a, a
	call	__lmulu
	ld	(ix - 3), hl
	ld	(ix - 4), e
	lea	hl, iy
	ld	e, d
	ld	bc, 32767
	call	__land
	ld	bc, 1000
	call	__lmulu
	push	hl
	pop	bc
	ld	a, e
	ld	l, 15
	call	__lshru
	push	bc
	pop	hl
	ld	e, a
	ld	bc, (ix - 3)
	ld	a, (ix - 4)
	call	__ladd
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.rodata,"a",@progbits
	private	_board_startpos.start
_board_startpos.start:
	db	""
	db	8 dup 255
	db	8 dup 0
	db	8 dup 0
	db	8 dup 0
	db	8 dup 0
	db	8 dup 1
	db	""

	section	.rodata,"a",@progbits
	private	_castling_mask
_castling_mask:
	db	""

	section	.bss,"aw",@nobits
	private	_num_segments
_num_segments:
	rb	1

	section	.bss,"aw",@nobits
	private	_total_entries
_total_entries:
	rb	4

	section	.bss,"aw",@nobits
	private	_book_ready
_book_ready:
	rb	1

	section	.bss,"aw",@nobits
	private	_detected_tier
_detected_tier:
	rb	1

	section	.bss,"aw",@nobits
	private	_poly_randoms
_poly_randoms:
	rb	3

	section	.rodata,"a",@progbits
	private	_.str.3
_.str.3:
	db	"CHBY", 0

	section	.rodata,"a",@progbits
	private	_.str.5
_.str.5:
	db	"CHBX", 0

	section	.rodata,"a",@progbits
	private	_.str.7
_.str.7:
	db	"CHBL", 0

	section	.rodata,"a",@progbits
	private	_.str.9
_.str.9:
	db	"CHBM", 0

	section	.rodata,"a",@progbits
	private	_.str.11
_.str.11:
	db	"CHBS", 0

	section	.rodata,"a",@progbits
	private	_.str.12
_.str.12:
	db	"XXL", 0

	section	.rodata,"a",@progbits
	private	_.str.13
_.str.13:
	db	"XL", 0

	section	.rodata,"a",@progbits
	private	_.str.14
_.str.14:
	db	"L", 0

	section	.rodata,"a",@progbits
	private	_.str.15
_.str.15:
	db	"M", 0

	section	.rodata,"a",@progbits
	private	_.str.16
_.str.16:
	db	"S", 0

	section	.bss,"aw",@nobits
	private	_segments
_segments:
	rb	280

	section	.rodata,"a",@progbits
	private	_poly_move_to_engine.promo_flags
_poly_move_to_engine.promo_flags:
	db	0, "0 ", 0

	section	.rodata,"a",@progbits
	private	_switch.table.book_get_tier_name
_switch.table.book_get_tier_name:
	dl	_.str.12
	dl	_.str.13
	dl	_.str.14
	dl	_.str.15
	dl	_.str.16

	section	.bss,"aw",@nobits
	private	_engine_hooks
_engine_hooks:
	rb	3

	section	.bss,"aw",@nobits
	public	_engine_board
_engine_board:
	rb	445

	section	.bss,"aw",@nobits
	private	_engine_max_nodes
_engine_max_nodes:
	rb	4

	section	.data,"aw",@progbits
	private	_engine_use_book
_engine_use_book:
	db	1

	section	.bss,"aw",@nobits
	private	_engine_book_max_ply
_engine_book_max_ply:
	rb	1

	section	.bss,"aw",@nobits
	private	_engine_eval_noise
_engine_eval_noise:
	rb	3

	section	.bss,"aw",@nobits
	private	_engine_move_variance
_engine_move_variance:
	rb	3

	section	.bss,"aw",@nobits
	private	_last_was_book
_last_was_book:
	rb	1

	section	.rodata,"a",@progbits
	public	_phase_weight
_phase_weight:
	db	0, "", 0

	section	.rodata,"a",@progbits
	public	_mg_table
_mg_table:
	dw	77
	dw	77
	dw	77
	dw	77
	dw	77
	dw	77
	dw	77
	dw	77
	dw	168
	dw	202
	dw	133
	dw	165
	dw	140
	dw	194
	dw	108
	dw	66
	dw	71
	dw	83
	dw	101
	dw	105
	dw	137
	dw	129
	dw	100
	dw	58
	dw	63
	dw	89
	dw	82
	dw	96
	dw	98
	dw	88
	dw	92
	dw	55
	dw	51
	dw	75
	dw	72
	dw	88
	dw	92
	dw	82
	dw	86
	dw	53
	dw	52
	dw	73
	dw	73
	dw	67
	dw	79
	dw	79
	dw	107
	dw	65
	dw	44
	dw	76
	dw	58
	dw	55
	dw	63
	dw	99
	dw	112
	dw	56
	dw	77
	dw	77
	dw	77
	dw	77
	dw	77
	dw	77
	dw	77
	dw	77
	dw	153
	dw	223
	dw	273
	dw	259
	dw	359
	dw	216
	dw	290
	dw	207
	dw	238
	dw	267
	dw	368
	dw	336
	dw	324
	dw	359
	dw	310
	dw	288
	dw	261
	dw	358
	dw	337
	dw	362
	dw	379
	dw	420
	dw	369
	dw	343
	dw	295
	dw	319
	dw	321
	dw	351
	dw	337
	dw	366
	dw	320
	dw	323
	dw	292
	dw	307
	dw	318
	dw	315
	dw	329
	dw	321
	dw	322
	dw	296
	dw	283
	dw	295
	dw	314
	dw	313
	dw	321
	dw	319
	dw	326
	dw	289
	dw	277
	dw	256
	dw	293
	dw	301
	dw	303
	dw	320
	dw	291
	dw	286
	dw	209
	dw	285
	dw	251
	dw	274
	dw	288
	dw	278
	dw	286
	dw	283
	dw	300
	dw	330
	dw	253
	dw	293
	dw	304
	dw	289
	dw	332
	dw	319
	dw	303
	dw	340
	dw	310
	dw	315
	dw	353
	dw	379
	dw	342
	dw	284
	dw	312
	dw	359
	dw	365
	dw	362
	dw	357
	dw	371
	dw	359
	dw	324
	dw	323
	dw	331
	dw	343
	dw	371
	dw	359
	dw	359
	dw	332
	dw	324
	dw	321
	dw	338
	dw	338
	dw	349
	dw	357
	dw	337
	dw	335
	dw	330
	dw	326
	dw	340
	dw	340
	dw	340
	dw	339
	dw	350
	dw	342
	dw	335
	dw	330
	dw	340
	dw	340
	dw	326
	dw	332
	dw	345
	dw	356
	dw	327
	dw	297
	dw	324
	dw	314
	dw	307
	dw	315
	dw	315
	dw	291
	dw	307
	dw	445
	dw	453
	dw	445
	dw	461
	dw	472
	dw	425
	dw	444
	dw	454
	dw	440
	dw	445
	dw	467
	dw	471
	dw	487
	dw	475
	dw	439
	dw	455
	dw	412
	dw	433
	dw	439
	dw	448
	dw	432
	dw	456
	dw	470
	dw	431
	dw	396
	dw	407
	dw	423
	dw	439
	dw	438
	dw	447
	dw	410
	dw	399
	dw	385
	dw	394
	dw	406
	dw	416
	dw	425
	dw	411
	dw	422
	dw	397
	dw	377
	dw	395
	dw	403
	dw	402
	dw	419
	dw	417
	dw	412
	dw	388
	dw	378
	dw	403
	dw	399
	dw	409
	dw	416
	dw	426
	dw	411
	dw	355
	dw	400
	dw	405
	dw	418
	dw	432
	dw	431
	dw	423
	dw	384
	dw	394
	dw	970
	dw	997
	dw	1026
	dw	1009
	dw	1055
	dw	1040
	dw	1039
	dw	1041
	dw	974
	dw	960
	dw	993
	dw	998
	dw	982
	dw	1053
	dw	1025
	dw	1050
	dw	985
	dw	981
	dw	1004
	dw	1005
	dw	1026
	dw	1052
	dw	1043
	dw	1053
	dw	971
	dw	971
	dw	982
	dw	982
	dw	996
	dw	1014
	dw	996
	dw	998
	dw	989
	dw	972
	dw	989
	dw	988
	dw	996
	dw	994
	dw	1000
	dw	995
	dw	984
	dw	999
	dw	987
	dw	996
	dw	993
	dw	999
	dw	1011
	dw	1002
	dw	963
	dw	990
	dw	1008
	dw	999
	dw	1005
	dw	1012
	dw	995
	dw	998
	dw	996
	dw	980
	dw	989
	dw	1007
	dw	983
	dw	973
	dw	967
	dw	949
	dw	65471
	dw	23
	dw	16
	dw	65521
	dw	65480
	dw	65502
	dw	2
	dw	13
	dw	29
	dw	65535
	dw	65516
	dw	65529
	dw	65528
	dw	65532
	dw	65498
	dw	65507
	dw	65527
	dw	24
	dw	2
	dw	65520
	dw	65516
	dw	6
	dw	22
	dw	65514
	dw	65519
	dw	65516
	dw	65524
	dw	65509
	dw	65506
	dw	65511
	dw	65513
	dw	65500
	dw	65487
	dw	65535
	dw	65509
	dw	65497
	dw	65490
	dw	65492
	dw	65503
	dw	65485
	dw	65522
	dw	65522
	dw	65514
	dw	65490
	dw	65492
	dw	65506
	dw	65521
	dw	65509
	dw	1
	dw	7
	dw	65528
	dw	65472
	dw	65493
	dw	65520
	dw	9
	dw	8
	dw	65521
	dw	36
	dw	12
	dw	65482
	dw	8
	dw	65508
	dw	24
	dw	14

	section	.rodata,"a",@progbits
	public	_eg_table
_eg_table:
	dw	105
	dw	105
	dw	105
	dw	105
	dw	105
	dw	105
	dw	105
	dw	105
	dw	303
	dw	297
	dw	280
	dw	254
	dw	268
	dw	251
	dw	288
	dw	313
	dw	209
	dw	216
	dw	199
	dw	179
	dw	167
	dw	164
	dw	196
	dw	198
	dw	140
	dw	131
	dw	119
	dw	110
	dw	102
	dw	109
	dw	123
	dw	123
	dw	119
	dw	115
	dw	101
	dw	97
	dw	97
	dw	96
	dw	108
	dw	103
	dw	109
	dw	112
	dw	98
	dw	106
	dw	105
	dw	99
	dw	103
	dw	96
	dw	119
	dw	113
	dw	113
	dw	93
	dw	119
	dw	105
	dw	107
	dw	97
	dw	105
	dw	105
	dw	105
	dw	105
	dw	105
	dw	105
	dw	105
	dw	105
	dw	241
	dw	262
	dw	289
	dw	273
	dw	270
	dw	274
	dw	235
	dw	196
	dw	276
	dw	295
	dw	276
	dw	301
	dw	293
	dw	276
	dw	277
	dw	247
	dw	277
	dw	282
	dw	314
	dw	313
	dw	302
	dw	293
	dw	283
	dw	259
	dw	285
	dw	306
	dw	327
	dw	327
	dw	327
	dw	315
	dw	312
	dw	284
	dw	284
	dw	297
	dw	320
	dw	330
	dw	320
	dw	322
	dw	307
	dw	284
	dw	278
	dw	300
	dw	302
	dw	319
	dw	314
	dw	300
	dw	282
	dw	279
	dw	258
	dw	282
	dw	292
	dw	298
	dw	301
	dw	282
	dw	278
	dw	256
	dw	272
	dw	248
	dw	278
	dw	287
	dw	279
	dw	284
	dw	249
	dw	234
	dw	291
	dw	284
	dw	294
	dw	298
	dw	299
	dw	297
	dw	288
	dw	281
	dw	298
	dw	302
	dw	313
	dw	293
	dw	303
	dw	292
	dw	302
	dw	291
	dw	308
	dw	298
	dw	306
	dw	305
	dw	304
	dw	312
	dw	306
	dw	310
	dw	303
	dw	315
	dw	318
	dw	315
	dw	320
	dw	316
	dw	309
	dw	308
	dw	300
	dw	309
	dw	319
	dw	325
	dw	313
	dw	316
	dw	303
	dw	297
	dw	293
	dw	303
	dw	314
	dw	316
	dw	319
	dw	309
	dw	299
	dw	290
	dw	291
	dw	287
	dw	299
	dw	305
	dw	310
	dw	297
	dw	290
	dw	278
	dw	282
	dw	297
	dw	282
	dw	301
	dw	297
	dw	289
	dw	301
	dw	288
	dw	575
	dw	572
	dw	581
	dw	578
	dw	574
	dw	574
	dw	570
	dw	567
	dw	573
	dw	575
	dw	575
	dw	573
	dw	558
	dw	564
	dw	570
	dw	564
	dw	569
	dw	569
	dw	569
	dw	567
	dw	566
	dw	558
	dw	556
	dw	558
	dw	566
	dw	564
	dw	575
	dw	562
	dw	563
	dw	562
	dw	560
	dw	563
	dw	564
	dw	567
	dw	570
	dw	566
	dw	556
	dw	555
	dw	552
	dw	549
	dw	557
	dw	561
	dw	556
	dw	560
	dw	554
	dw	548
	dw	552
	dw	544
	dw	555
	dw	555
	dw	561
	dw	563
	dw	551
	dw	551
	dw	549
	dw	558
	dw	551
	dw	563
	dw	564
	dw	560
	dw	556
	dw	547
	dw	566
	dw	539
	dw	986
	dw	1019
	dw	1019
	dw	1024
	dw	1024
	dw	1016
	dw	1006
	dw	1017
	dw	978
	dw	1017
	dw	1030
	dw	1039
	dw	1057
	dw	1022
	dw	1028
	dw	996
	dw	974
	dw	1002
	dw	1005
	dw	1048
	dw	1046
	dw	1033
	dw	1016
	dw	1005
	dw	999
	dw	1019
	dw	1021
	dw	1043
	dw	1056
	dw	1038
	dw	1056
	dw	1034
	dw	976
	dw	1025
	dw	1016
	dw	1046
	dw	1029
	dw	1032
	dw	1037
	dw	1020
	dw	979
	dw	967
	dw	1012
	dw	1002
	dw	1005
	dw	1014
	dw	1006
	dw	1001
	dw	972
	dw	971
	dw	964
	dw	979
	dw	979
	dw	971
	dw	957
	dw	962
	dw	961
	dw	966
	dw	972
	dw	950
	dw	990
	dw	962
	dw	974
	dw	952
	dw	65460
	dw	65500
	dw	65518
	dw	65518
	dw	65525
	dw	15
	dw	4
	dw	65519
	dw	65524
	dw	17
	dw	14
	dw	17
	dw	17
	dw	39
	dw	24
	dw	11
	dw	10
	dw	17
	dw	24
	dw	15
	dw	21
	dw	46
	dw	45
	dw	13
	dw	65528
	dw	23
	dw	25
	dw	28
	dw	27
	dw	34
	dw	27
	dw	3
	dw	65518
	dw	65532
	dw	22
	dw	25
	dw	28
	dw	24
	dw	9
	dw	65525
	dw	65516
	dw	65533
	dw	11
	dw	22
	dw	24
	dw	16
	dw	7
	dw	65527
	dw	65508
	dw	65525
	dw	4
	dw	13
	dw	14
	dw	4
	dw	65531
	dw	65519
	dw	65482
	dw	65501
	dw	65514
	dw	65525
	dw	65507
	dw	65522
	dw	65511
	dw	65492

	section	.bss,"aw",@nobits
	private	_pawn_cache
_pawn_cache:
	rb	2416

	section	.bss,"aw",@nobits
	private	_pawn_cache_victim
_pawn_cache_victim:
	rb	4

	section	.rodata,"a",@progbits
	private	_knight_mob_mg
_knight_mob_mg:
	dw	65517
	dw	65523
	dw	65530
	dw	0
	dw	6
	dw	13
	dw	16
	dw	17
	dw	19

	section	.rodata,"a",@progbits
	private	_knight_mob_eg
_knight_mob_eg:
	dw	65475
	dw	65493
	dw	65512
	dw	65534
	dw	13
	dw	26
	dw	41
	dw	45
	dw	50

	section	.rodata,"a",@progbits
	private	_bishop_offsets
_bishop_offsets:
	db	""

	section	.rodata,"a",@progbits
	private	_bishop_mob_mg
_bishop_mob_mg:
	dw	65524
	dw	65530
	dw	2
	dw	9
	dw	11
	dw	16
	dw	18
	dw	21
	dw	25
	dw	27
	dw	29
	dw	30
	dw	32
	dw	37

	section	.rodata,"a",@progbits
	private	_bishop_mob_eg
_bishop_mob_eg:
	dw	65519
	dw	65527
	dw	65535
	dw	7
	dw	12
	dw	17
	dw	23
	dw	27
	dw	32
	dw	35
	dw	37
	dw	39
	dw	41
	dw	40

	section	.rodata,"a",@progbits
	private	_connected_bonus_eg
_connected_bonus_eg:
	dw	0
	dw	9
	dw	10
	dw	16
	dw	39
	dw	65

	section	.rodata,"a",@progbits
	private	_passed_mg
_passed_mg:
	dw	0
	dw	0
	dw	0
	dw	7
	dw	43
	dw	85

	section	.rodata,"a",@progbits
	private	_passed_eg
_passed_eg:
	dw	13
	dw	27
	dw	41
	dw	67
	dw	131
	dw	229

	section	.rodata,"a",@progbits
	private	_rook_offsets
_rook_offsets:
	db	""

	section	.bss,"aw",@nobits
	private	_pos_history_count
_pos_history_count:
	rb	2

	section	.bss,"aw",@nobits
	private	_pos_history
_pos_history:
	rb	1536

	section	.bss,"aw",@nobits
	private	_pos_history_irreversible
_pos_history_irreversible:
	rb	2

	section	.bss,"aw",@nobits
	private	_move_sp
_move_sp:
	rb	2

	section	.bss,"aw",@nobits
	private	_killers
_killers:
	rb	384

	section	.bss,"aw",@nobits
	private	_history
_history:
	rb	512

	section	.bss,"aw",@nobits
	private	_search_nodes
_search_nodes:
	rb	4

	section	.bss,"aw",@nobits
	private	_search_stopped
_search_stopped:
	rb	1

	section	.bss,"aw",@nobits
	private	_search_best_root_move
_search_best_root_move:
	rb	3

	section	.bss,"aw",@nobits
	private	_search_time_fn
_search_time_fn:
	rb	3

	section	.bss,"aw",@nobits
	private	_search_deadline
_search_deadline:
	rb	4

	section	.bss,"aw",@nobits
	private	_search_max_nodes
_search_max_nodes:
	rb	4

	section	.bss,"aw",@nobits
	private	_search_node_deadline
_search_node_deadline:
	rb	4

	section	.bss,"aw",@nobits
	private	_search_eval_noise
_search_eval_noise:
	rb	3

	section	.bss,"aw",@nobits
	private	_search_move_variance
_search_move_variance:
	rb	3

	section	.bss,"aw",@nobits
	private	_search_rng_state
_search_rng_state:
	rb	4

	section	.bss,"aw",@nobits
	private	_root_count_pending
_root_count_pending:
	rb	1

	section	.bss,"aw",@nobits
	private	_root_count
_root_count:
	rb	1

	section	.bss,"aw",@nobits
	private	_root_moves
_root_moves:
	rb	48

	section	.bss,"aw",@nobits
	private	_root_moves_pending
_root_moves_pending:
	rb	48

	section	.bss,"aw",@nobits
	private	_root_scores_pending
_root_scores_pending:
	rb	32

	section	.bss,"aw",@nobits
	private	_root_scores
_root_scores:
	rb	32

	section	.bss,"aw",@nobits
	private	_raw_moves_buf
_raw_moves_buf:
	rb	768

	section	.bss,"aw",@nobits
	private	_move_pool
_move_pool:
	rb	10240

	section	.rodata,"a",@progbits
	private	_mvv_lva
_mvv_lva:
	db	"", 13, "", 10
	db	""
	db	""
	db	"#""! "
	db	"-,+*)("
	db	6 dup 0

	section	.rodata,"a",@progbits
	private	_atk_knight_offsets
_atk_knight_offsets:
	db	"!"

	section	.rodata,"a",@progbits
	private	_atk_ray_offsets
_atk_ray_offsets:
	db	""

	section	.bss,"aw",@nobits
	private	_tt
_tt:
	rb	32768

	section	.bss,"aw",@nobits
	private	_zobrist_initialized
_zobrist_initialized:
	rb	1

	section	.bss,"aw",@nobits
	private	_prng_state
_prng_state:
	rb	4

	section	.bss,"aw",@nobits
	public	_zobrist_piece
_zobrist_piece:
	rb	3072

	section	.bss,"aw",@nobits
	public	_zobrist_castle
_zobrist_castle:
	rb	64

	section	.bss,"aw",@nobits
	public	_zobrist_ep_file
_zobrist_ep_file:
	rb	32

	section	.bss,"aw",@nobits
	public	_zobrist_side
_zobrist_side:
	rb	4

	section	.bss,"aw",@nobits
	public	_lock_piece
_lock_piece:
	rb	1536

	section	.bss,"aw",@nobits
	public	_lock_castle
_lock_castle:
	rb	32

	section	.bss,"aw",@nobits
	public	_lock_ep_file
_lock_ep_file:
	rb	16

	section	.bss,"aw",@nobits
	public	_lock_side
_lock_side:
	rb	2

	section	.rodata,"a",@progbits
	private	_.str.56
_.str.56:
	db	"CHDATA", 0

	section	.rodata,"a",@progbits
	private	_.str.1.57
_.str.1.57:
	db	"r", 0

	section	.rodata,"a",@progbits
	private	_.str.2.58
_.str.2.58:
	db	"Missing CHDATA appvar", 0

	section	.rodata,"a",@progbits
	private	_.str.3.59
_.str.3.59:
	db	"Press any key to exit", 0

	section	.bss,"aw",@nobits
	private	_sprite_data
_sprite_data:
	rb	3

	section	.bss,"aw",@nobits
	private	_state
_state:
	rb	3

	section	.bss,"aw",@nobits
	private	_menu_cursor
_menu_cursor:
	rb	1

	section	.bss,"aw",@nobits
	private	_running
_running:
	rb	1

	section	.bss,"aw",@nobits
	private	_cur_g1
_cur_g1:
	rb	1

	section	.bss,"aw",@nobits
	private	_cur_g6
_cur_g6:
	rb	1

	section	.bss,"aw",@nobits
	private	_cur_g7
_cur_g7:
	rb	1

	section	.bss,"aw",@nobits
	private	_prev_g1
_prev_g1:
	rb	1

	section	.bss,"aw",@nobits
	private	_prev_g6
_prev_g6:
	rb	1

	section	.bss,"aw",@nobits
	private	_prev_g7
_prev_g7:
	rb	1

	section	.bss,"aw",@nobits
	private	_frame_count
_frame_count:
	rb	3

	section	.bss,"aw",@nobits
	private	_piece_spr_data
_piece_spr_data:
	rb	4824

	section	.bss,"aw",@nobits
	private	_game_mode
_game_mode:
	rb	1

	section	.bss,"aw",@nobits
	private	_difficulty_cursor
_difficulty_cursor:
	rb	3

	section	.bss,"aw",@nobits
	private	_game_number
_game_number:
	rb	3

	section	.bss,"aw",@nobits
	public	_book_random_seed
_book_random_seed:
	rb	4

	section	.bss,"aw",@nobits
	private	_cur_r
_cur_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_cur_c
_cur_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_sel_r
_sel_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_sel_c
_sel_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_current_turn
_current_turn:
	rb	3

	section	.bss,"aw",@nobits
	private	_has_last_move
_has_last_move:
	rb	3

	section	.bss,"aw",@nobits
	private	_legal_target_count
_legal_target_count:
	rb	1

	section	.bss,"aw",@nobits
	private	_ai_thinking
_ai_thinking:
	rb	3

	section	.bss,"aw",@nobits
	private	_anim_active
_anim_active:
	rb	1

	section	.bss,"aw",@nobits
	private	_game_over_reason
_game_over_reason:
	rb	1

	section	.bss,"aw",@nobits
	private	_color_cursor
_color_cursor:
	rb	3

	section	.bss,"aw",@nobits
	private	_player_color
_player_color:
	rb	3

	section	.bss,"aw",@nobits
	private	_board_flipped
_board_flipped:
	rb	3

	section	.bss,"aw",@nobits
	private	_screen_dirty
_screen_dirty:
	rb	1

	section	.bss,"aw",@nobits
	private	_board
_board:
	rb	64

	section	.rodata,"a",@progbits
	private	_.str.4.72
_.str.4.72:
	db	"Play vs. Human", 0

	section	.rodata,"a",@progbits
	private	_.str.5.73
_.str.5.73:
	db	"Play vs. Computer", 0

	section	.rodata,"a",@progbits
	private	___const.draw_menu.items
___const.draw_menu.items:
	dl	_.str.4.72
	dl	_.str.5.73

	section	.rodata,"a",@progbits
	private	_.str.6.60
_.str.6.60:
	db	"CHESS", 0

	section	.rodata,"a",@progbits
	private	_.str.7.63
_.str.7.63:
	db	1 dup 0

	section	.rodata,"a",@progbits
	private	_.str.8.61
_.str.8.61:
	db	"CHBY01", 0

	section	.rodata,"a",@progbits
	private	_.str.9.62
_.str.9.62:
	db	" XXL", 0

	section	.rodata,"a",@progbits
	private	_.str.10.64
_.str.10.64:
	db	"CHBX01", 0

	section	.rodata,"a",@progbits
	private	_.str.11.68
_.str.11.68:
	db	" XL", 0

	section	.rodata,"a",@progbits
	private	_.str.12.65
_.str.12.65:
	db	"CHBL01", 0

	section	.rodata,"a",@progbits
	private	_.str.13.69
_.str.13.69:
	db	" L", 0

	section	.rodata,"a",@progbits
	private	_.str.14.66
_.str.14.66:
	db	"CHBM01", 0

	section	.rodata,"a",@progbits
	private	_.str.15.70
_.str.15.70:
	db	" M", 0

	section	.rodata,"a",@progbits
	private	_.str.16.67
_.str.16.67:
	db	"CHBS01", 0

	section	.rodata,"a",@progbits
	private	_.str.17.71
_.str.17.71:
	db	" S", 0

	section	.rodata,"a",@progbits
	private	_.str.18
_.str.18:
	db	"v%s%s", 0

	section	.rodata,"a",@progbits
	private	_.str.19
_.str.19:
	db	"0.4", 0

	section	.rodata,"a",@progbits
	private	_.str.20
_.str.20:
	db	"arrows: move  enter: select  clear: quit", 0

	section	.rodata,"a",@progbits
	private	_difficulty_times
_difficulty_times:
	dd	900
	dd	4500
	dd	9000
	dd	13500
	dd	27000

	section	.bss,"aw",@nobits
	private	_think_time_ms
_think_time_ms:
	rb	4

	section	.rodata,"a",@progbits
	private	_difficulty_variance
_difficulty_variance:
	dl	30
	dl	5
	dl	3
	dl	2
	dl	0

	section	.rodata,"a",@progbits
	private	_.str.21
_.str.21:
	db	"Difficulty", 0

	section	.rodata,"a",@progbits
	private	_difficulty_labels
_difficulty_labels:
	dl	_.str.23
	dl	_.str.24
	dl	_.str.25
	dl	_.str.26
	dl	_.str.27

	section	.rodata,"a",@progbits
	private	_difficulty_subtexts
_difficulty_subtexts:
	dl	_.str.28
	dl	_.str.29
	dl	_.str.30
	dl	_.str.31
	dl	_.str.32

	section	.rodata,"a",@progbits
	private	_.str.22
_.str.22:
	db	"arrows: move  enter: select  clear: back", 0

	section	.rodata,"a",@progbits
	private	_.str.23
_.str.23:
	db	"Easy", 0

	section	.rodata,"a",@progbits
	private	_.str.24
_.str.24:
	db	"Medium", 0

	section	.rodata,"a",@progbits
	private	_.str.25
_.str.25:
	db	"Hard", 0

	section	.rodata,"a",@progbits
	private	_.str.26
_.str.26:
	db	"Expert", 0

	section	.rodata,"a",@progbits
	private	_.str.27
_.str.27:
	db	"Master", 0

	section	.rodata,"a",@progbits
	private	_.str.28
_.str.28:
	db	"~1s think time", 0

	section	.rodata,"a",@progbits
	private	_.str.29
_.str.29:
	db	"~5s think time", 0

	section	.rodata,"a",@progbits
	private	_.str.30
_.str.30:
	db	"~10s think time", 0

	section	.rodata,"a",@progbits
	private	_.str.31
_.str.31:
	db	"~15s think time", 0

	section	.rodata,"a",@progbits
	private	_.str.32
_.str.32:
	db	"~30s think time", 0

	section	.rodata,"a",@progbits
	private	_.str.33
_.str.33:
	db	"White", 0

	section	.rodata,"a",@progbits
	private	_.str.34
_.str.34:
	db	"Black", 0

	section	.rodata,"a",@progbits
	private	_.str.35
_.str.35:
	db	"Random", 0

	section	.rodata,"a",@progbits
	private	___const.draw_color_select.items
___const.draw_color_select.items:
	dl	_.str.33
	dl	_.str.34
	dl	_.str.35

	section	.rodata,"a",@progbits
	private	_.str.36
_.str.36:
	db	"Play as...", 0

	section	.rodata,"a",@progbits
	private	_.str.37
_.str.37:
	db	"arrows: move  enter: start  clear: back", 0

	section	.bss,"aw",@nobits
	private	_winner
_winner:
	rb	3

	section	.bss,"aw",@nobits
	private	_pending_move
_pending_move:
	rb	5

	section	.bss,"aw",@nobits
	private	_pending_effects
_pending_effects:
	rb	8

	section	.bss,"aw",@nobits
	private	_legal_targets
_legal_targets:
	rb	320

	section	.bss,"aw",@nobits
	private	_anim_start
_anim_start:
	rb	4

	section	.bss,"aw",@nobits
	private	_anim_duration
_anim_duration:
	rb	4

	section	.bss,"aw",@nobits
	private	_anim_from_c
_anim_from_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_anim_from_r
_anim_from_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_anim_to_c
_anim_to_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_anim_to_r
_anim_to_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_anim_piece
_anim_piece:
	rb	1

	section	.bss,"aw",@nobits
	private	_last_from_r
_last_from_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_last_from_c
_last_from_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_last_to_r
_last_to_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_last_to_c
_last_to_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_promo_saved_has_last
_promo_saved_has_last:
	rb	3

	section	.bss,"aw",@nobits
	private	_promo_saved_from_r
_promo_saved_from_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_promo_saved_from_c
_promo_saved_from_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_promo_saved_to_r
_promo_saved_to_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_promo_saved_to_c
_promo_saved_to_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_promo_r
_promo_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_promo_c
_promo_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_promo_from_r
_promo_from_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_promo_from_c
_promo_from_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_anim_captured
_anim_captured:
	rb	1

	section	.bss,"aw",@nobits
	private	_promo_captured
_promo_captured:
	rb	1

	section	.bss,"aw",@nobits
	private	_promo_cursor
_promo_cursor:
	rb	3

	section	.rodata,"a",@progbits
	private	_.str.38
_.str.38:
	db	"vs. Human", 0

	section	.rodata,"a",@progbits
	private	_.str.39
_.str.39:
	db	"vs. CPU %d", 0

	section	.rodata,"a",@progbits
	private	_.str.40
_.str.40:
	db	"Thinking", 0

	section	.rodata,"a",@progbits
	private	_.str.41
_.str.41:
	db	"CHECK!", 0

	section	.rodata,"a",@progbits
	private	_.str.42
_.str.42:
	db	"to move", 0

	section	.rodata,"a",@progbits
	private	_.str.43
_.str.43:
	db	"Sel: ", 0

	section	.rodata,"a",@progbits
	private	_.str.44
_.str.44:
	db	"D-pad", 0

	section	.rodata,"a",@progbits
	private	_.str.45
_.str.45:
	db	" Move", 0

	section	.rodata,"a",@progbits
	private	_.str.46
_.str.46:
	db	"Enter", 0

	section	.rodata,"a",@progbits
	private	_.str.47
_.str.47:
	db	" Select", 0

	section	.rodata,"a",@progbits
	private	_.str.48
_.str.48:
	db	"Clear", 0

	section	.rodata,"a",@progbits
	private	_.str.49
_.str.49:
	db	" Deselect", 0

	section	.rodata,"a",@progbits
	private	_.str.50
_.str.50:
	db	"Mode", 0

	section	.rodata,"a",@progbits
	private	_.str.51
_.str.51:
	db	" Resign", 0

	section	.rodata,"a",@progbits
	private	_update_promotion.promo_flags
_update_promotion.promo_flags:
	db	0, " 0"

	section	.rodata,"a",@progbits
	private	_promo_pieces_white
_promo_pieces_white:
	db	""

	section	.rodata,"a",@progbits
	private	_promo_pieces_black
_promo_pieces_black:
	db	""

	section	.rodata,"a",@progbits
	private	_.str.52
_.str.52:
	db	"Promote to:", 0

	section	.rodata,"a",@progbits
	private	_.str.57
_.str.57:
	db	"White wins!", 0

	section	.rodata,"a",@progbits
	private	_.str.58
_.str.58:
	db	"Black wins!", 0

	section	.rodata,"a",@progbits
	private	_.str.59
_.str.59:
	db	"Draw", 0

	section	.rodata,"a",@progbits
	private	_.str.60
_.str.60:
	db	"Checkmate", 0

	section	.rodata,"a",@progbits
	private	_.str.61
_.str.61:
	db	"Stalemate", 0

	section	.rodata,"a",@progbits
	private	_.str.62
_.str.62:
	db	"50-move rule", 0

	section	.rodata,"a",@progbits
	private	_.str.63
_.str.63:
	db	"Repetition", 0

	section	.rodata,"a",@progbits
	private	_.str.64
_.str.64:
	db	"Insufficient material", 0

	section	.rodata,"a",@progbits
	private	_.str.65
_.str.65:
	db	"Resignation", 0

	section	.rodata,"a",@progbits
	private	_.str.66
_.str.66:
	db	"Enter: menu", 0

	section	.rodata,"a",@progbits
	private	_switch.table.main
_switch.table.main:
	dl	_.str.60
	dl	_.str.61
	dl	_.str.62
	dl	_.str.63
	dl	_.str.64

	ident	"clang version 15.0.0 (https://github.com/CE-Programming/llvm-project 23b78267b5d376b232475d0805a937e54b61e0d0)"
	ident	"clang version 15.0.0 (https://github.com/CE-Programming/llvm-project 23b78267b5d376b232475d0805a937e54b61e0d0)"
	ident	"clang version 15.0.0 (https://github.com/CE-Programming/llvm-project 23b78267b5d376b232475d0805a937e54b61e0d0)"
	ident	"clang version 15.0.0 (https://github.com/CE-Programming/llvm-project 23b78267b5d376b232475d0805a937e54b61e0d0)"
	ident	"clang version 15.0.0 (https://github.com/CE-Programming/llvm-project 23b78267b5d376b232475d0805a937e54b61e0d0)"
	ident	"clang version 15.0.0 (https://github.com/CE-Programming/llvm-project 23b78267b5d376b232475d0805a937e54b61e0d0)"
	ident	"clang version 15.0.0 (https://github.com/CE-Programming/llvm-project 23b78267b5d376b232475d0805a937e54b61e0d0)"
	ident	"clang version 15.0.0 (https://github.com/CE-Programming/llvm-project 23b78267b5d376b232475d0805a937e54b61e0d0)"
	ident	"clang version 15.0.0 (https://github.com/CE-Programming/llvm-project 23b78267b5d376b232475d0805a937e54b61e0d0)"
	extern	_gfx_PrintChar
	extern	__lcmpzero
	extern	__sxor
	extern	__idivs
	extern	__idivu
	extern	_gfx_Blit
	extern	__lladd
	extern	__ineg
	extern	_sprintf
	extern	_gfx_FillScreen
	extern	__imulu
	extern	__lxor
	extern	_gfx_TransparentSprite_NoClip
	extern	_gfx_End
	extern	__bshru
	extern	__frameset0
	extern	_gfx_SetTextXY
	extern	__ldivu
	extern	__inot
	extern	_gfx_SetTextFGColor
	extern	_gfx_Begin
	extern	__sshl
	extern	__sshru
	extern	__setflag
	extern	__iand
	extern	__lmulu
	extern	_gfx_SwapDraw
	extern	__lshl
	extern	_ti_GetDataPtr
	extern	_clock
	extern	__Unwind_SjLj_Register
	extern	_srand
	extern	__llxor
	extern	__ixor
	extern	_ti_Open
	extern	_gfx_HorizLine_NoClip
	extern	__bdivu
	extern	__lremu
	extern	__indcallhl
	extern	__lsub
	extern	_gfx_FillRectangle_NoClip
	extern	__ishru
	extern	__llcmpu
	extern	__llshl
	extern	__lcmpu
	extern	__indcall
	extern	_gfx_Rectangle_NoClip
	extern	_rand
	extern	_ti_Close
	extern	__sand
	extern	_gfx_PrintString
	extern	__ishl
	extern	__ladd
	extern	__llshru
	extern	__llor
	extern	_gfx_FillCircle_NoClip
	extern	__lshru
	extern	__frameset
	extern	_kb_AnyKey
	extern	_kb_Scan
	extern	_gfx_GetStringWidth
	extern	_gfx_SetDraw
	extern	__Unwind_SjLj_Unregister
	extern	_gfx_SetColor
	extern	__bshl
	extern	__land
	extern	__sor
	extern	_gfx_PrintStringXY
	extern	_gfx_SetTextScale
