	section	.text,"ax",@progbits
	assume	adl = 1
	section	.text,"ax",@progbits
	public	_ui_to_engine_piece
_ui_to_engine_piece:
	call	__frameset0
	ld	l, (ix + 6)
	ld	e, 0
	ld	a, l
	or	a, a
	jr	z, BB0_4
	ld	a, l
	cp	a, 1
	call	pe, __setflag
	jp	m, BB0_3
	ld	e, l
	jr	BB0_4
BB0_3:
	ld	a, l
	neg
	or	a, -128
	ld	e, a
BB0_4:
	ld	a, e
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_to_ui_piece
_engine_to_ui_piece:
	call	__frameset0
	ld	e, (ix + 6)
	ld	l, 0
	ld	a, e
	and	a, 7
	ld	h, a
	neg
	ld	c, a
	ld	a, e
	cp	a, l
	call	pe, __setflag
	jp	m, BB1_2
	ld	c, h
BB1_2:
	ld	a, e
	or	a, a
	jr	z, BB1_4
	ld	l, c
BB1_4:
	ld	a, l
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_board_init
_board_init:
	ld	hl, -3
	call	__frameset
	or	a, a
	sbc	hl, hl
	ld	a, (_zobrist_initialized)
	bit	0, a
	push	hl
	push	hl
	call	z, _zobrist_init
	pop	hl
	pop	hl
	ld	iy, (ix + 6)
	ld	(iy), 0
	lea	hl, iy
	inc	hl
	ld	bc, 315
	ex	de, hl
	lea	hl, iy
	ldir
	ld	de, 160
	lea	hl, iy
	add	hl, de
	ld	(hl), -1
	ld	(ix - 3), hl
	ld	de, (ix - 3)
	inc	de
	ld	(ix - 3), de
	ld	bc, 127
	ld	de, (ix - 3)
	ldir
	ld	de, 296
	lea	hl, iy
	add	hl, de
	ld	(hl), -1
	ld	de, 292
	lea	hl, iy
	add	hl, de
	ld	(hl), -1
	inc	de
	add	iy, de
	ld	(iy), -1
	pop	hl
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_board_set_from_ui
_board_set_from_ui:
	ld	hl, -39
	call	__frameset
	ld	de, (ix + 6)
	ld	hl, (ix + 9)
	ld	(ix - 3), hl
	ld.sis	hl, 0
	ld	(ix - 9), hl
	push	de
	call	_board_init
	pop	hl
	ld	de, 8
	xor	a, a
	ld	hl, (ix + 6)
	ld	(ix - 6), hl
	ld	bc, 0
BB3_1:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jp	z, BB3_16
	ld	(ix - 15), bc
	ld	iyl, a
	ld	bc, 0
BB3_3:
	push	bc
	pop	hl
	ld	de, 8
	or	a, a
	sbc	hl, de
	jp	z, BB3_15
	ld	(ix - 12), a
	ld	a, iyl
	ld	iy, (ix - 3)
	add	iy, bc
	ld	h, (iy)
	ld	iyl, a
	ld	a, h
	or	a, a
	jp	z, BB3_14
	ld	(ix - 21), bc
	push	af
	ld	a, iyl
	ld	(ix - 18), a
	pop	af
	ld	a, h
	neg
	or	a, -128
	ld	c, a
	ld	a, h
	cp	a, 1
	call	pe, __setflag
	ld	(ix - 24), h
	ld	iy, (ix + 6)
	jp	p, BB3_7
	ld	h, c
BB3_7:
	ld	a, h
	ld	b, 7
	call	__bshru
	ld	c, a
	ld	a, h
	and	a, b
	ld	de, 0
	ld	e, c
	add	iy, de
	ld	(ix - 39), iy
	ld	de, 288
	add	iy, de
	ld	(ix - 33), iy
	ld	b, (iy)
	ld	iy, (ix - 6)
	ld	de, (ix - 21)
	add	iy, de
	ld	(iy), h
	ld	(ix - 30), a
	cp	a, 6
	jr	nz, BB3_9
	ld	hl, (ix - 39)
	ld	de, 292
	add	hl, de
	ld	a, (ix - 18)
	ld	(hl), a
BB3_9:
	or	a, a
	sbc	hl, hl
	push	hl
	pop	de
	ld	e, b
	ld	(ix - 27), c
	ld	a, c
	ld	(ix - 36), b
	ld	b, 4
	call	__bshl
	push	hl
	pop	bc
	ld	c, a
	ld	hl, (ix + 6)
	add	hl, bc
	add	hl, de
	ld	de, 128
	add	hl, de
	ld	c, (ix - 18)
	ld	(hl), c
	ld	de, 160
	add	iy, de
	ld	a, (ix - 36)
	ld	(iy), a
	inc	a
	ld	hl, (ix - 33)
	ld	(hl), a
	ld	a, (ix - 30)
	cp	a, 3
	ld	iyl, a
	jr	nz, BB3_11
	ld	de, 290
	ld	hl, (ix - 39)
	add	hl, de
	inc	(hl)
BB3_11:
	ld	a, c
	srl	a
	and	a, 56
	ld	h, a
	ld	a, c
	and	a, 7
	ld	b, a
	ld	a, h
	add	a, b
	ld	l, a
	xor	a, 56
	ld	h, a
	ld	a, (ix - 24)
	cp	a, 1
	ld	a, l
	call	pe, __setflag
	jp	p, BB3_13
	ld	a, h
BB3_13:
	dec	iyl
	ld	de, 0
	push	de
	pop	hl
	ex	de, hl
	ld	e, iyl
	ex	de, hl
	ld	(ix - 30), hl
	ld	c, 7
	call	__ishl
	ld	(ix - 24), hl
	ld	hl, _mg_table
	ld	bc, (ix - 24)
	add	hl, bc
	add	a, a
	push	de
	pop	bc
	ld	c, a
	ld	(ix - 33), bc
	add	hl, bc
	ld	hl, (hl)
	ld	(ix - 36), hl
	ld	a, (ix - 27)
	add	a, a
	ld	e, a
	ld	hl, (ix + 6)
	add	hl, de
	ld	(ix - 27), hl
	ld	bc, 306
	add	hl, bc
	ld	iy, (hl)
	ld	de, (ix - 36)
	add.sis	iy, de
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	hl, _eg_table
	ld	de, (ix - 24)
	add	hl, de
	ld	de, (ix - 33)
	add	hl, de
	ld	de, (hl)
	ld	bc, 310
	ld	iy, (ix - 27)
	add	iy, bc
	ld	hl, (iy)
	add.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, (ix - 30)
	ld	c, b
	call	__ishl
	push	hl
	pop	de
	ld	hl, _phase_weight
	add	hl, de
	ld	de, (hl)
	ld	iy, (ix + 6)
	ld	bc, 314
	add	iy, bc
	ld	hl, (iy)
	add.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
	push	af
	ld	a, (ix - 18)
	ld	iyl, a
	pop	af
	ld	bc, (ix - 21)
BB3_14:
	inc	bc
	inc	iyl
	ld	a, (ix - 12)
	jp	BB3_3
BB3_15:
	ld	bc, (ix - 15)
	inc	bc
	ld	iy, (ix - 3)
	lea	iy, iy + 8
	ld	(ix - 3), iy
	ld	iy, (ix - 6)
	lea	iy, iy + 16
	ld	(ix - 6), iy
	add	a, 16
	ld	de, 8
	jp	BB3_1
BB3_16:
	ld	a, (ix + 12)
	ld	iy, 0
	cp	a, 1
	jr	nz, BB3_18
	ld	a, 0
	jr	BB3_19
BB3_18:
	ld	a, 1
BB3_19:
	ld	de, (ix + 6)
	ld	bc, 294
	push	de
	pop	hl
	add	hl, bc
	ld	(hl), a
	inc	bc
	push	de
	pop	hl
	add	hl, bc
	ld	a, (ix + 15)
	ld	(hl), a
	ld	bc, 297
	push	de
	pop	hl
	add	hl, bc
	ld	a, (ix + 24)
	ld	(hl), a
	inc	bc
	ex	de, hl
	add	hl, bc
	ld	bc, (ix + 27)
	ld	(hl), c
	inc	hl
	ld	(hl), b
	ld	l, (ix + 18)
	ld	a, l
	cp	a, -1
	jr	z, BB3_22
	ld	a, (ix + 21)
	cp	a, -1
	jr	z, BB3_22
	ld	a, l
	ld	b, 4
	call	__bshl
	add	a, (ix + 21)
	ld	hl, (ix + 6)
	ld	de, 296
	add	hl, de
	ld	(hl), a
BB3_22:
	ld	de, 128
	lea	bc, iy
	ld	(ix - 3), bc
	xor	a, a
	ld	(ix - 6), a
BB3_23:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jp	z, BB3_31
	ld	a, c
	and	a, -120
	or	a, a
	jp	nz, BB3_30
	ld	hl, (ix + 6)
	push	bc
	pop	iy
	add	hl, bc
	ld	c, (hl)
	ld	a, c
	or	a, a
	jr	nz, BB3_27
	lea	bc, iy
	jp	BB3_30
BB3_27:
	ld	a, c
	and	a, 7
	ld	l, a
	ld	a, c
	cp	a, 0
	call	pe, __setflag
	ld	e, 6
	jp	m, BB3_29
	ld	e, 0
BB3_29:
	dec	l
	ld	a, l
	add	a, e
	lea	hl, iy
	ld	(ix - 12), hl
	ld	d, 1
	ld	c, d
	call	__ishru
	ld	bc, 56
	call	__iand
	push	hl
	pop	iy
	ld	hl, (ix - 12)
	ld	bc, 7
	call	__iand
	push	hl
	pop	bc
	add	iy, bc
	lea	de, iy
	ld	(ix - 15), de
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	(ix - 18), hl
	ld	c, 8
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _zobrist_piece
	add	iy, bc
	ex	de, hl
	ld	c, 2
	call	__ishl
	push	hl
	pop	bc
	add	iy, bc
	ld	hl, (iy)
	ld	e, (iy + 3)
	ld	bc, (ix - 3)
	ld	a, (ix - 6)
	call	__lxor
	ld	(ix - 3), hl
	ld	(ix - 6), e
	ld	hl, (ix - 18)
	ld	c, 7
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _lock_piece
	add	iy, bc
	ld	hl, (ix - 15)
	ld	c, 1
	call	__ishl
	push	hl
	pop	bc
	add	iy, bc
	ld	hl, (iy)
	ld	bc, (ix - 9)
	call	__sxor
	ld	bc, (ix - 12)
	ld	(ix - 9), hl
BB3_30:
	inc	bc
	ld	de, 128
	jp	BB3_23
BB3_31:
	or	a, a
	sbc	hl, hl
	ld	l, (ix + 15)
	ld	(ix - 12), hl
	ld	c, 2
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _zobrist_castle
	add	iy, bc
	ld	hl, (iy)
	ld	e, (iy + 3)
	ld	bc, (ix - 3)
	ld	a, (ix - 6)
	call	__lxor
	ld	(ix - 6), hl
	ld	(ix - 15), e
	ld	c, 1
	ld	hl, (ix - 12)
	ld	iy, (ix + 6)
	call	__ishl
	push	hl
	pop	de
	ld	hl, _lock_castle
	add	hl, de
	ld	hl, (hl)
	ld	bc, (ix - 9)
	call	__sxor
	ld	c, l
	ld	b, h
	lea	hl, iy
	ld	de, 296
	add	hl, de
	ld	a, (hl)
	cp	a, -1
	jr	nz, BB3_33
	push	af
	ld	a, (ix - 15)
	ld	iyl, a
	pop	af
	jp	BB3_34
BB3_33:
	and	a, 7
	ld	d, a
	ld	(ix - 3), bc
	ld	b, 2
	call	__bshl
	or	a, a
	sbc	hl, hl
	push	hl
	pop	bc
	ld	c, a
	ld	(ix - 9), bc
	ld	iy, _zobrist_ep_file
	add	iy, bc
	ld	hl, (iy)
	ld	e, (iy + 3)
	ld	bc, (ix - 6)
	ld	a, (ix - 15)
	call	__lxor
	ld	(ix - 6), hl
	ld	iyl, e
	sla	d
	ld	bc, (ix - 9)
	ld	c, d
	ld	hl, _lock_ep_file
	add	hl, bc
	ld	hl, (hl)
	ld	bc, (ix - 3)
	call	__sxor
	ld	c, l
	ld	b, h
BB3_34:
	ld	a, (ix + 12)
	cp	a, 1
	ld	(ix - 3), bc
	jp	z, BB3_36
	ld	hl, (_zobrist_side)
	ld	a, (_zobrist_side+3)
	ld	e, a
	ld	bc, (ix - 6)
	ld	a, iyl
	call	__lxor
	push	hl
	pop	iy
	ld	hl, _lock_side
	ld	hl, (hl)
	ld	bc, (ix - 3)
	call	__sxor
	ld	(ix - 3), hl
	lea	hl, iy
	jr	BB3_37
BB3_36:
	ld	e, iyl
	ld	hl, (ix - 6)
BB3_37:
	ld	iy, (ix + 6)
	ld	bc, 300
	add	iy, bc
	ld	(iy), hl
	lea	hl, iy + 3
	ld	(hl), e
	ld	de, 304
	ld	iy, (ix + 6)
	add	iy, de
	ld	hl, (ix - 3)
	ld	(iy), l
	ld	(iy + 1), h
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_board_startpos
_board_startpos:
	call	__frameset0
	ld	iy, (ix + 6)
	ld	de, _board_startpos.start
	ld	bc, 1
	push	bc
	or	a, a
	sbc	hl, hl
	push	hl
	dec	hl
	push	hl
	push	hl
	ld	hl, 15
	push	hl
	push	bc
	push	de
	push	iy
	call	_board_set_from_ui
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_board_make
_board_make:
	ld	hl, -91
	call	__frameset
	xor	a, a
	ld	(ix - 72), a
	ld	c, (ix + 9)
	ld	b, (ix + 10)
	ld	a, (ix + 11)
	ld	(ix - 4), a
	sbc	hl, hl
	push	hl
	pop	de
	ld	e, c
	ld	iy, (ix + 6)
	ld	(ix - 49), de
	add	iy, de
	ld	(ix - 55), iy
	ld	c, (iy)
	ld	iy, (ix + 6)
	ld	(ix - 13), hl
	ex	de, hl
	ld	e, b
	lea	hl, iy
	ld	(ix - 25), de
	add	hl, de
	ld	a, (hl)
	ld	(ix - 43), a
	ld	de, 294
	lea	hl, iy
	add	hl, de
	ld	(ix - 46), hl
	ld	a, (hl)
	ld	(ix - 1), a
	xor	a, d
	ld	l, a
	ld	(ix - 58), hl
	ld	a, c
	and	a, 7
	ld	(ix - 16), a
	ld	e, (ix + 9)
	ld	a, e
	srl	a
	and	a, 56
	ld	l, a
	ld	a, e
	and	a, 7
	ld	e, a
	ld	a, l
	add	a, e
	ld	(ix - 7), a
	ld	a, b
	srl	a
	and	a, 56
	ld	l, a
	ld	(ix - 22), b
	ld	a, b
	and	a, 7
	ld	e, a
	ld	a, l
	add	a, e
	ld	(ix - 10), a
	ld	(ix - 31), c
	ld	a, c
	cp	a, 0
	call	pe, __setflag
	ld	a, 6
	ld	(ix - 71), a
	ld	l, a
	jp	m, BB5_2
	ld	l, 0
BB5_2:
	ld	a, (ix - 16)
	dec	a
	ld	(ix - 28), a
	add	a, l
	ld	(ix - 19), a
	ld	a, (ix - 1)
	or	a, a
	jr	z, BB5_4
	ld	e, 0
	jr	BB5_5
BB5_4:
	ld	e, -1
BB5_5:
	ld	l, (ix - 7)
	ld	a, l
	xor	a, 56
	bit	0, e
	jr	nz, BB5_7
	ld	l, a
BB5_7:
	ld	(ix - 64), l
	ld	l, (ix - 10)
	ld	a, l
	xor	a, 56
	bit	0, e
	jr	nz, BB5_9
	ld	l, a
BB5_9:
	ld	(ix - 81), a
	ld	(ix - 52), l
	ld	hl, (ix - 13)
	ld	l, (ix - 1)
	ld	(ix - 13), hl
	ld	iy, (ix + 12)
	ld	a, (ix - 43)
	ld	(iy), a
	ld	bc, 295
	ld	de, (ix + 6)
	push	de
	pop	hl
	add	hl, bc
	ld	(ix - 37), hl
	ld	a, (hl)
	ld	(iy + 1), a
	inc	bc
	push	de
	pop	hl
	add	hl, bc
	ld	(ix - 34), hl
	ld	a, (hl)
	ld	(iy + 2), a
	inc	bc
	push	de
	pop	hl
	add	hl, bc
	ld	a, (hl)
	ld	(ix - 75), a
	ld	(iy + 3), a
	inc	bc
	ex	de, hl
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 4), l
	ld	(iy + 5), h
	ld	bc, 300
	ld	iy, (ix + 6)
	add	iy, bc
	ld	bc, (iy)
	lea	hl, iy + 3
	ld	de, (ix + 6)
	ld	a, (hl)
	ld	(ix - 67), bc
	ld	iy, (ix + 12)
	ld	(iy + 6), bc
	ld	(ix - 70), a
	ld	(iy + 9), a
	ld	bc, 304
	ex	de, hl
	add	hl, bc
	ld	(ix - 40), hl
	ld	hl, (hl)
	ld	(ix - 61), hl
	ld	(iy + 10), l
	ld	(iy + 11), h
	ld	a, (ix - 31)
	ld	(iy + 12), a
	ld	a, (ix - 4)
	ld	(iy + 13), a
	and	a, b
	ld	c, a
	ld	a, (ix - 16)
	cp	a, b
	ld	a, 0
	jr	z, BB5_13
	bit	0, c
	ld	a, 0
	jr	nz, BB5_13
	ld	a, (ix - 75)
	cp	a, -1
	jr	z, BB5_14
	inc	a
BB5_13:
	ld	hl, (ix + 6)
	ld	bc, 297
	add	hl, bc
	ld	(hl), a
BB5_14:
	or	a, a
	sbc	hl, hl
	ld	l, (ix - 19)
	ld	(ix - 19), hl
	ld	c, 8
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _zobrist_piece
	add	iy, bc
	ld	b, 2
	ld	d, (ix - 7)
	ld	a, d
	call	__bshl
	ld	bc, 0
	ld	c, a
	add	iy, bc
	ld	hl, (iy)
	ld	e, (iy + 3)
	ld	bc, (ix - 67)
	ld	a, (ix - 70)
	call	__lxor
	ld	iy, (ix + 6)
	ld	bc, 300
	add	iy, bc
	ld	(ix - 78), hl
	ld	(iy), hl
	lea	hl, iy + 3
	ld	(ix - 75), e
	ld	(hl), e
	ld	a, 7
	ld	hl, (ix - 19)
	ld	c, a
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _lock_piece
	add	hl, bc
	sla	d
	ld	iy, 0
	lea	bc, iy
	ld	c, d
	add	hl, bc
	ld	hl, (hl)
	ld	bc, (ix - 61)
	call	__sxor
	ld	c, l
	ld	b, h
	ld	hl, (ix - 40)
	ld	(ix - 70), bc
	ld	(hl), c
	inc	hl
	ld	(hl), b
	lea	hl, iy
	ld	l, (ix - 28)
	ld	(ix - 61), hl
	ld	c, a
	call	__ishl
	push	hl
	pop	bc
	ld	(ix - 67), bc
	ld	hl, _mg_table
	add	hl, bc
	ld	c, (ix - 64)
	sla	c
	lea	de, iy
	ld	e, c
	ld	(ix - 64), de
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 28), hl
	ld	hl, (ix - 13)
	ld	c, 1
	call	__ishl
	push	hl
	pop	bc
	ld	iy, (ix + 6)
	add	iy, bc
	ld	(ix - 7), iy
	ld	bc, 306
	add	iy, bc
	lea	hl, iy
	ld	hl, (hl)
	ld	bc, (ix - 28)
	or	a, a
	sbc.sis	hl, bc
	ld	(ix - 28), iy
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, _eg_table
	ld	bc, (ix - 67)
	add	hl, bc
	ld	de, (ix - 64)
	add	hl, de
	ld	de, (hl)
	ld	bc, 310
	ld	iy, (ix - 7)
	add	iy, bc
	ld	hl, (iy)
	or	a, a
	sbc.sis	hl, de
	ld	(ix - 7), iy
	ld	(iy), l
	ld	(iy + 1), h
	bit	2, (ix - 4)
	jp	nz, BB5_22
	ld	l, (ix - 43)
	ld	a, l
	or	a, a
	ld	iy, (ix + 6)
	jp	z, BB5_32
	ld	a, l
	and	a, 7
	ld	e, a
	ld	a, l
	cp	a, 0
	call	pe, __setflag
	ld	l, 6
	jp	m, BB5_18
	ld	l, 0
BB5_18:
	ld	(ix - 64), e
	dec	e
	ld	(ix - 67), e
	ld	a, e
	add	a, l
	ld	l, a
	ld	de, 0
	push	de
	pop	bc
	ld	de, (ix - 58)
	ld	c, e
	ld	(ix - 43), bc
	ld	a, e
	or	a, a
	ld	a, (ix - 10)
	jr	z, BB5_20
	ld	a, (ix - 81)
BB5_20:
	ld	(ix - 81), a
	ld	de, 0
	ld	e, l
	ld	(ix - 84), de
	ld	c, 8
	ex	de, hl
	call	__ishl
	push	hl
	pop	de
	ld	iy, _zobrist_piece
	add	iy, de
	ld	b, 2
	ld	a, (ix - 10)
	call	__bshl
	ld	de, 0
	ld	e, a
	add	iy, de
	ld	hl, (iy)
	ld	e, (iy + 3)
	ld	bc, (ix - 78)
	ld	a, (ix - 75)
	call	__lxor
	ld	bc, (ix + 6)
	push	bc
	pop	iy
	ld	bc, 300
	add	iy, bc
	ld	(iy), hl
	lea	hl, iy + 3
	ld	(hl), e
	ld	a, 7
	ld	hl, (ix - 84)
	ld	c, a
	call	__ishl
	push	hl
	pop	de
	ld	hl, _lock_piece
	add	hl, de
	ld	e, (ix - 10)
	sla	e
	ld	bc, 0
	ld	c, e
	add	hl, bc
	ld	hl, (hl)
	ld	bc, (ix - 70)
	call	__sxor
	ld	iy, (ix - 40)
	ld	(iy), l
	ld	(iy + 1), h
	ld	iy, 0
	lea	hl, iy
	ld	l, (ix - 67)
	ld	(ix - 75), hl
	ld	c, a
	call	__ishl
	push	hl
	pop	bc
	ld	(ix - 40), bc
	ld	hl, _mg_table
	add	hl, bc
	ld	a, (ix - 81)
	add	a, a
	lea	bc, iy
	ld	c, a
	ld	(ix - 67), bc
	add	hl, bc
	ld	hl, (hl)
	ld	(ix - 70), hl
	ld	hl, (ix - 43)
	ld	a, 1
	ld	c, a
	call	__ishl
	push	hl
	pop	bc
	ld	iy, (ix + 6)
	add	iy, bc
	ld	(ix - 78), iy
	ld	bc, 306
	add	iy, bc
	lea	hl, iy
	ld	hl, (hl)
	ld	bc, (ix - 70)
	or	a, a
	sbc.sis	hl, bc
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, _eg_table
	ld	bc, (ix - 40)
	add	hl, bc
	ld	bc, (ix - 67)
	add	hl, bc
	ld	de, (hl)
	ld	bc, 310
	ld	iy, (ix - 78)
	add	iy, bc
	ld	hl, (iy)
	or	a, a
	sbc.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, (ix - 75)
	ld	c, a
	call	__ishl
	push	hl
	pop	de
	ld	hl, _phase_weight
	add	hl, de
	ld	de, (hl)
	ld	hl, (ix + 6)
	push	hl
	pop	iy
	ld	bc, 314
	add	iy, bc
	ld	hl, (iy)
	or	a, a
	sbc.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	l, (ix - 22)
	push	hl
	ld	hl, (ix - 58)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_plist_remove
	ld	iy, (ix + 6)
	pop	hl
	pop	hl
	pop	hl
	ld	a, (ix - 64)
	cp	a, 3
	jp	nz, BB5_32
	lea	hl, iy
	ld	de, (ix - 43)
	add	hl, de
	ld	de, 290
	add	hl, de
	dec	(hl)
	jp	BB5_32
BB5_22:
	ld	a, (ix - 1)
	or	a, a
	ld	a, 16
	jr	z, BB5_24
	ld	a, -16
BB5_24:
	add	a, (ix - 22)
	ld	e, a
	or	a, a
	sbc	hl, hl
	push	hl
	pop	bc
	ld	c, e
	ld	iy, (ix + 6)
	lea	hl, iy
	ld	(ix - 43), bc
	add	hl, bc
	ld	c, (hl)
	ld	a, c
	or	a, a
	jp	z, BB5_31
	ld	a, e
	srl	a
	and	a, 56
	ld	l, a
	ld	(ix - 81), e
	ld	a, e
	and	a, 7
	ld	e, a
	ld	a, l
	add	a, e
	ld	d, a
	ld	a, c
	and	a, 7
	ld	e, a
	ld	(ix - 67), c
	ld	a, c
	cp	a, 0
	call	pe, __setflag
	ld	l, 6
	jp	m, BB5_27
	ld	l, 0
BB5_27:
	ld	(ix - 84), e
	dec	e
	ld	(ix - 87), e
	ld	a, e
	add	a, l
	ld	e, a
	ld	bc, 0
	ld	hl, (ix - 58)
	ld	c, l
	ld	(ix - 64), bc
	ld	a, d
	xor	a, 56
	ld	c, a
	ld	a, l
	or	a, a
	ld	a, d
	jr	z, BB5_29
	ld	a, c
BB5_29:
	ld	(ix - 88), a
	or	a, a
	sbc	hl, hl
	ld	l, e
	ld	(ix - 91), hl
	ld	c, 8
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _zobrist_piece
	add	iy, bc
	ld	b, 2
	ld	a, d
	call	__bshl
	ld	bc, 0
	ld	c, a
	add	iy, bc
	ld	hl, (iy)
	ld	e, (iy + 3)
	ld	bc, (ix - 78)
	ld	a, (ix - 75)
	call	__lxor
	ld	bc, (ix + 6)
	push	bc
	pop	iy
	ld	bc, 300
	add	iy, bc
	ld	(iy), hl
	lea	hl, iy + 3
	ld	(hl), e
	ld	a, 7
	ld	hl, (ix - 91)
	ld	c, a
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _lock_piece
	add	hl, bc
	sla	d
	ld	bc, 0
	ld	c, d
	add	hl, bc
	ld	hl, (hl)
	ld	bc, (ix - 70)
	call	__sxor
	ld	iy, (ix - 40)
	ld	(iy), l
	ld	(iy + 1), h
	ld	iy, 0
	lea	hl, iy
	ld	l, (ix - 87)
	ld	(ix - 78), hl
	ld	c, a
	call	__ishl
	push	hl
	pop	bc
	ld	(ix - 40), bc
	ld	hl, _mg_table
	add	hl, bc
	ld	a, (ix - 88)
	add	a, a
	lea	bc, iy
	ld	c, a
	ld	(ix - 70), bc
	add	hl, bc
	ld	hl, (hl)
	ld	(ix - 75), hl
	ld	hl, (ix - 64)
	ld	a, 1
	ld	c, a
	call	__ishl
	push	hl
	pop	bc
	ld	iy, (ix + 6)
	add	iy, bc
	ld	(ix - 87), iy
	ld	bc, 306
	add	iy, bc
	lea	hl, iy
	ld	hl, (hl)
	ld	bc, (ix - 75)
	or	a, a
	sbc.sis	hl, bc
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, _eg_table
	ld	bc, (ix - 40)
	add	hl, bc
	ld	bc, (ix - 70)
	add	hl, bc
	ld	de, (hl)
	ld	bc, 310
	ld	iy, (ix - 87)
	add	iy, bc
	ld	hl, (iy)
	or	a, a
	sbc.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, (ix - 78)
	ld	c, a
	call	__ishl
	push	hl
	pop	de
	ld	hl, _phase_weight
	add	hl, de
	ld	de, (hl)
	ld	hl, (ix + 6)
	push	hl
	pop	iy
	ld	bc, 314
	add	iy, bc
	ld	hl, (iy)
	or	a, a
	sbc.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	bc, (ix + 6)
	push	bc
	pop	hl
	ld	de, (ix - 43)
	add	hl, de
	ld	(hl), 0
	ld	l, (ix - 81)
	push	hl
	ld	hl, (ix - 58)
	push	hl
	push	bc
	call	_plist_remove
	ld	iy, (ix + 6)
	pop	hl
	pop	hl
	pop	hl
	ld	a, (ix - 84)
	cp	a, 3
	ld	c, (ix - 67)
	jr	nz, BB5_31
	lea	hl, iy
	ld	de, (ix - 64)
	add	hl, de
	ld	de, 290
	add	hl, de
	dec	(hl)
BB5_31:
	ld	hl, (ix + 12)
	ld	(hl), c
BB5_32:
	ld	hl, (ix - 55)
	ld	(hl), 0
	lea	hl, iy
	ld	de, (ix - 25)
	add	hl, de
	ld	a, (ix - 31)
	ld	(hl), a
	ld	l, (ix - 22)
	push	hl
	ld	a, (ix + 9)
	ld	l, a
	push	hl
	ld	l, (ix - 1)
	push	hl
	push	iy
	call	_plist_move
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	c, 8
	ld	hl, (ix - 19)
	call	__ishl
	push	hl
	pop	de
	ld	iy, _zobrist_piece
	add	iy, de
	ld	b, 2
	ld	a, (ix - 10)
	call	__bshl
	or	a, a
	sbc	hl, hl
	ex	de, hl
	ld	e, a
	add	iy, de
	ld	(ix - 43), iy
	ld	bc, (iy)
	ld	iy, (ix + 6)
	ld	de, 300
	add	iy, de
	ld	(ix - 40), iy
	ld	hl, (iy)
	lea	de, iy + 3
	ld	(ix - 31), de
	ld	iy, (ix - 31)
	ld	e, (iy)
	ld	iy, (ix - 43)
	ld	a, (iy + 3)
	call	__lxor
	ld	(ix - 64), hl
	ld	iy, (ix - 40)
	ld	(iy), hl
	ld	(ix - 67), e
	ld	hl, (ix - 31)
	ld	(hl), e
	ld	a, 7
	ld	hl, (ix - 19)
	ld	c, a
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _lock_piece
	add	hl, bc
	ld	c, (ix - 10)
	sla	c
	ld	de, 0
	ld	e, c
	ld	(ix - 58), de
	add	hl, de
	ld	(ix - 70), hl
	ld	bc, (hl)
	ld	iy, (ix + 6)
	ld	de, 304
	add	iy, de
	ld	hl, (iy)
	call	__sxor
	ld	(ix - 19), iy
	ld	(ix - 75), hl
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, (ix - 61)
	ld	c, a
	call	__ishl
	push	hl
	pop	de
	ld	(ix - 55), de
	ld	hl, _mg_table
	add	hl, de
	ld	a, (ix - 52)
	add	a, a
	ld	de, 0
	ld	e, a
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 52), hl
	ld	iy, (ix - 28)
	ld	hl, (iy)
	ld	(ix - 61), hl
	ld	bc, (ix - 52)
	add.sis	hl, bc
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, _eg_table
	ld	bc, (ix - 55)
	add	hl, bc
	ld	(ix - 52), de
	add	hl, de
	ld	de, (hl)
	ld	iy, (ix - 7)
	ld	bc, (iy)
	ld	l, c
	ld	h, b
	add.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	a, (ix - 4)
	bit	3, a
	jp	z, BB5_47
	and	a, 48
	cp	a, 16
	ld	(ix - 55), bc
	jr	nz, BB5_35
	ld	hl, 4
	ld	iy, 0
	jr	BB5_40
BB5_35:
	cp	a, 32
	ld	iy, 0
	jr	nz, BB5_37
	ld	a, 1
	ld	(ix - 72), a
	ld	hl, 3
	jr	BB5_40
BB5_37:
	cp	a, 48
	jr	nz, BB5_39
	ld	hl, 2
	jr	BB5_40
BB5_39:
	ld	hl, 5
BB5_40:
	ld	a, (ix - 1)
	or	a, a
	lea	bc, iy
	jr	z, BB5_42
	ld	bc, 128
BB5_42:
	ld	de, 255
	ld	a, l
	add	a, c
	ld	(ix - 78), a
	cp	a, d
	call	pe, __setflag
	jp	p, BB5_44
	ld	iy, 6
BB5_44:
	add	hl, de
	push	hl
	pop	bc
	ld	(ix - 81), bc
	add	iy, bc
	ld	(ix - 87), iy
	ld	iy, (ix - 43)
	ld	hl, (iy)
	ld	e, (iy + 3)
	ld	bc, (ix - 64)
	ld	a, (ix - 67)
	call	__lxor
	ld	(ix - 43), hl
	ld	d, e
	ld	hl, (ix + 6)
	push	hl
	pop	iy
	ld	bc, 300
	add	iy, bc
	ld	(ix - 84), iy
	ld	hl, (ix - 43)
	ld	(iy), hl
	lea	hl, iy + 3
	ld	(ix - 67), hl
	ld	(hl), d
	ld	hl, (ix - 70)
	ld	hl, (hl)
	ld	bc, (ix - 75)
	call	__sxor
	ld	c, l
	ld	b, h
	ld	(ix - 64), bc
	ld	hl, (ix - 19)
	ld	(hl), c
	inc	hl
	ld	(hl), b
	ld	hl, (ix - 87)
	ld	bc, 255
	call	__iand
	ld	(ix - 70), hl
	ld	c, 8
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _zobrist_piece
	add	iy, bc
	ld	b, 2
	ld	a, (ix - 10)
	call	__bshl
	ld	bc, 0
	ld	c, a
	add	iy, bc
	ld	hl, (iy)
	ld	e, (iy + 3)
	ld	bc, (ix - 43)
	ld	a, d
	call	__lxor
	ld	iy, (ix - 84)
	ld	(iy), hl
	ld	hl, (ix - 67)
	ld	(hl), e
	ld	a, 7
	ld	hl, (ix - 70)
	ld	c, a
	call	__ishl
	push	hl
	pop	de
	ld	hl, _lock_piece
	add	hl, de
	ld	de, (ix - 58)
	add	hl, de
	ld	hl, (hl)
	ld	bc, (ix - 64)
	call	__sxor
	ld	iy, (ix - 19)
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, (ix - 81)
	ld	bc, 255
	call	__iand
	ld	(ix - 10), hl
	ld	c, a
	call	__ishl
	push	hl
	pop	de
	ld	(ix - 43), de
	ld	hl, _mg_table
	add	hl, de
	ld	de, (ix - 52)
	add	hl, de
	ld	hl, (hl)
	ld	bc, (ix - 61)
	add.sis	hl, bc
	ld	iy, (ix - 28)
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, _eg_table
	ld	bc, (ix - 43)
	add	hl, bc
	add	hl, de
	ld	hl, (hl)
	ld	de, (ix - 55)
	add.sis	hl, de
	ld	iy, (ix - 7)
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, (ix - 10)
	ld	c, 1
	call	__ishl
	push	hl
	pop	de
	ld	hl, _phase_weight
	add	hl, de
	ld	de, (hl)
	ld	iy, (ix + 6)
	ld	bc, 314
	add	iy, bc
	ld	hl, (iy)
	add.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	de, (ix + 6)
	bit	0, (ix - 72)
	jr	z, BB5_46
	push	de
	pop	hl
	ld	bc, (ix - 13)
	add	hl, bc
	ld	bc, 290
	add	hl, bc
	inc	(hl)
BB5_46:
	ex	de, hl
	ld	de, (ix - 25)
	add	hl, de
	ld	a, (ix - 78)
	ld	(hl), a
	ld	a, (ix - 4)
BB5_47:
	bit	1, a
	ld	d, 16
	jp	z, BB5_64
	ld	a, (ix - 1)
	or	a, a
	jr	z, BB5_50
	ld	iyl, 0
	jr	BB5_51
BB5_50:
	ld	iyl, -1
BB5_51:
	ld	bc, (ix + 6)
	ld	a, (ix + 9)
	ld	l, (ix - 22)
	cp	a, l
	sbc	a, a
	ld	l, a
	bit	0, l
	jr	nz, BB5_53
	ld	a, -1
	jr	BB5_54
BB5_53:
	ld	a, 1
BB5_54:
	ld	e, (ix + 9)
	add	a, e
	ld	(ix - 43), a
	bit	0, l
	jr	nz, BB5_56
	ld	a, -4
	jr	BB5_57
BB5_56:
	ld	a, 3
BB5_57:
	ld	l, (ix + 9)
	add	a, l
	ld	de, 0
	ld	(ix - 52), a
	ld	e, a
	push	bc
	pop	hl
	add	hl, de
	ld	(ix - 67), hl
	ld	e, (hl)
	ld	a, e
	and	a, 7
	ld	l, a
	ld	(ix - 64), e
	ld	a, e
	cp	a, d
	call	pe, __setflag
	jp	m, BB5_59
	xor	a, a
	ld	(ix - 71), a
BB5_59:
	dec	l
	ld	a, l
	add	a, (ix - 71)
	ld	iyh, a
	ld	c, (ix - 52)
	ld	a, c
	srl	a
	and	a, 56
	ld	e, a
	ld	a, c
	and	a, 7
	ld	c, a
	ld	a, e
	add	a, c
	ld	h, a
	ld	c, (ix - 43)
	ld	a, c
	srl	a
	and	a, 56
	ld	e, a
	ld	a, c
	and	a, 7
	ld	c, a
	ld	a, e
	add	a, c
	ld	c, a
	ld	a, h
	xor	a, 56
	ld	b, iyl
	bit	0, b
	ex	de, hl
	ld	iyl, d
	ex	de, hl
	jr	nz, BB5_61
	ld	h, a
BB5_61:
	ld	(ix - 71), h
	ld	de, 0
	ld	e, (ix - 43)
	ld	(ix - 70), de
	ld	a, c
	xor	a, 56
	bit	0, b
	ld	(ix - 55), c
	jr	nz, BB5_63
	ld	c, a
BB5_63:
	ld	(ix - 72), c
	or	a, a
	sbc	hl, hl
	ex	de, hl
	ld	e, iyh
	ex	de, hl
	ld	(ix - 75), hl
	ld	c, 8
	call	__ishl
	push	hl
	pop	de
	ld	hl, _zobrist_piece
	add	hl, de
	ld	(ix - 81), hl
	ld	b, 2
	ld	a, iyl
	ld	(ix - 78), a
	call	__bshl
	ld	de, 0
	ld	e, a
	ld	(ix - 10), de
	add	hl, de
	ld	(ix - 84), hl
	ld	bc, (hl)
	ld	iy, (ix + 6)
	ld	de, 300
	add	iy, de
	ld	(ix - 58), iy
	ld	hl, (iy)
	lea	de, iy + 3
	ld	(ix - 61), de
	push	de
	pop	iy
	ld	e, (iy)
	ld	iy, (ix - 84)
	ld	a, (iy + 3)
	call	__lxor
	push	hl
	pop	bc
	ld	(ix - 84), bc
	ld	d, e
	ld	hl, (ix - 58)
	ld	(hl), bc
	ld	hl, (ix - 61)
	ld	(hl), d
	ld	b, 2
	ld	a, (ix - 55)
	call	__bshl
	ld	bc, (ix - 10)
	ld	c, a
	ld	(ix - 10), bc
	ld	iy, (ix - 81)
	add	iy, bc
	ld	hl, (iy)
	ld	e, (iy + 3)
	ld	bc, (ix - 84)
	ld	a, d
	call	__lxor
	ld	iy, (ix - 58)
	ld	(iy), hl
	ld	hl, (ix - 61)
	ld	(hl), e
	ld	c, 7
	ld	hl, (ix - 75)
	call	__ishl
	push	hl
	pop	de
	ld	iy, _lock_piece
	add	iy, de
	ld	a, (ix - 78)
	add	a, a
	ld	de, (ix - 10)
	ld	e, a
	ld	(ix - 10), de
	lea	hl, iy
	add	hl, de
	ld	bc, (hl)
	ld	hl, (ix + 6)
	ld	de, 304
	add	hl, de
	ld	(ix - 58), hl
	ld	de, (hl)
	ld	l, e
	ld	h, d
	call	__sxor
	ld	c, l
	ld	b, h
	ld	hl, (ix - 58)
	ld	(hl), c
	inc	hl
	ld	(hl), b
	ld	a, (ix - 55)
	add	a, a
	ld	de, (ix - 10)
	ld	e, a
	add	iy, de
	ld	hl, (iy)
	call	__sxor
	ld	iy, (ix - 58)
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, _mg_table+384
	ld	a, (ix - 71)
	add	a, a
	push	de
	pop	bc
	ld	c, a
	add	hl, bc
	ld	de, (hl)
	ld	hl, (ix - 28)
	ld	hl, (hl)
	or	a, a
	sbc.sis	hl, de
	ld	(ix - 10), hl
	ld	hl, _eg_table+384
	add	hl, bc
	ld	de, (hl)
	ld	hl, (ix - 7)
	ld	hl, (hl)
	or	a, a
	sbc.sis	hl, de
	ld	a, (ix - 72)
	add	a, a
	ld	c, a
	ld	iy, _mg_table+384
	add	iy, bc
	ld	de, (iy)
	ld	iy, (ix - 10)
	add.sis	iy, de
	ld	e, iyl
	ld	d, iyh
	ld	iy, (ix - 28)
	ld	(iy), e
	ld	(iy + 1), d
	ld	iy, _eg_table+384
	add	iy, bc
	ld	de, (iy)
	add.sis	hl, de
	ld	iy, (ix - 7)
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, (ix - 67)
	ld	(hl), 0
	ld	bc, (ix + 6)
	push	bc
	pop	hl
	ld	de, (ix - 70)
	add	hl, de
	ld	a, (ix - 64)
	ld	(hl), a
	ld	l, (ix - 43)
	push	hl
	ld	l, (ix - 52)
	push	hl
	ld	l, (ix - 1)
	push	hl
	push	bc
	call	_plist_move
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	d, 16
BB5_64:
	ld	iy, _castling_mask
	ld	a, (ix - 16)
	cp	a, 6
	jr	nz, BB5_66
	ld	de, 292
	ld	hl, (ix + 6)
	ld	bc, (ix - 13)
	add	hl, bc
	add	hl, de
	ld	d, 16
	ld	a, (ix - 22)
	ld	(hl), a
BB5_66:
	ld	hl, (ix - 37)
	ld	e, (hl)
	lea	hl, iy
	ld	bc, (ix - 49)
	add	hl, bc
	ld	a, (hl)
	and	a, e
	ld	bc, (ix - 25)
	add	iy, bc
	and	a, (iy)
	ld	c, a
	ld	hl, (ix - 37)
	ld	(hl), c
	ld	a, e
	cp	a, c
	jp	z, BB5_68
	or	a, a
	sbc	hl, hl
	ld	(ix - 16), c
	ld	l, e
	ld	(ix - 13), hl
	ld	c, 2
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _zobrist_castle
	add	iy, bc
	ld	(ix - 22), iy
	ld	bc, (iy)
	ld	iy, (ix + 6)
	ld	de, 300
	add	iy, de
	ld	(ix - 7), iy
	ld	hl, (iy)
	lea	de, iy + 3
	ld	(ix - 10), de
	push	de
	pop	iy
	ld	e, (iy)
	ld	iy, (ix - 22)
	ld	a, (iy + 3)
	call	__lxor
	push	hl
	pop	bc
	ld	(ix - 22), bc
	ld	a, e
	ld	hl, (ix - 7)
	ld	(hl), bc
	ld	hl, (ix - 10)
	ld	(hl), a
	or	a, a
	sbc	hl, hl
	ld	l, (ix - 16)
	ld	(ix - 16), hl
	ld	c, 2
	call	__ishl
	push	hl
	pop	de
	ld	iy, _zobrist_castle
	add	iy, de
	ld	hl, (iy)
	ld	e, (iy + 3)
	ld	bc, (ix - 22)
	call	__lxor
	ld	iy, (ix - 7)
	ld	(iy), hl
	ld	hl, (ix - 10)
	ld	(hl), e
	ld	a, 1
	ld	hl, (ix - 13)
	ld	c, a
	call	__ishl
	push	hl
	pop	de
	ld	hl, _lock_castle
	add	hl, de
	ld	bc, (hl)
	ld	iy, (ix + 6)
	ld	de, 304
	add	iy, de
	ld	hl, (iy)
	call	__sxor
	ld	e, l
	ld	d, h
	ld	(iy), e
	ld	(iy + 1), d
	ld	hl, (ix - 16)
	ld	c, a
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _lock_castle
	add	hl, bc
	ld	hl, (hl)
	ld	c, e
	ld	b, d
	ld	d, 16
	call	__sxor
	ld	(iy), l
	ld	(iy + 1), h
BB5_68:
	ld	a, (ix - 1)
	or	a, a
	ld	a, -16
	ld	c, -1
	jr	z, BB5_70
	ld	a, d
BB5_70:
	ld	hl, (ix - 34)
	ld	l, (hl)
	ld	e, (ix + 9)
	add	a, e
	bit	6, (ix - 4)
	ld	iy, (ix + 6)
	lea	de, iy
	jr	z, BB5_72
	ld	c, a
BB5_72:
	ld	iy, (ix - 34)
	ld	(iy), c
	ld	a, l
	cp	a, -1
	jp	z, BB5_74
	ld	a, l
	and	a, 7
	ld	(ix - 10), a
	ld	b, 2
	call	__bshl
	or	a, a
	sbc	hl, hl
	ld	(ix - 7), c
	push	hl
	pop	bc
	ld	c, a
	ld	hl, _zobrist_ep_file
	add	hl, bc
	ld	(ix - 13), hl
	ld	bc, (hl)
	ld	iy, (ix + 6)
	ld	de, 300
	add	iy, de
	ld	(ix - 16), iy
	ld	hl, (iy)
	lea	de, iy + 3
	ld	(ix - 4), de
	ld	iy, (ix - 4)
	ld	e, (iy)
	ld	iy, (ix - 13)
	ld	a, (iy + 3)
	call	__lxor
	ld	iy, (ix - 16)
	ld	(iy), hl
	ld	hl, (ix - 4)
	ld	(hl), e
	ld	a, (ix - 10)
	add	a, a
	ld	bc, 0
	ld	c, a
	ld	hl, _lock_ep_file
	add	hl, bc
	ld	bc, (hl)
	ld	iy, (ix + 6)
	ld	de, 304
	add	iy, de
	ld	hl, (iy)
	call	__sxor
	ld	c, (ix - 7)
	ld	(iy), l
	ld	(iy + 1), h
	ld	iy, (ix + 6)
	lea	de, iy
BB5_74:
	ld	a, c
	cp	a, -1
	jr	nz, BB5_76
	ld	hl, (ix - 40)
	ld	bc, (hl)
	ld	hl, (ix - 31)
	ld	a, (hl)
	ld	(ix - 4), a
	push	de
	pop	hl
	push	de
	pop	iy
	ld	de, 304
	add	hl, de
	ld	hl, (hl)
	jp	BB5_77
BB5_76:
	ld	a, c
	and	a, 7
	ld	(ix - 13), a
	ld	b, 2
	call	__bshl
	or	a, a
	sbc	hl, hl
	push	hl
	pop	bc
	ld	c, a
	ld	(ix - 7), bc
	ld	hl, _zobrist_ep_file
	add	hl, bc
	ld	(ix - 4), hl
	ld	bc, (hl)
	ld	iy, (ix + 6)
	ld	de, 300
	add	iy, de
	ld	hl, (iy)
	lea	iy, iy + 3
	ld	e, (iy)
	ld	iy, (ix - 4)
	ld	a, (iy + 3)
	ld	iy, (ix + 6)
	call	__lxor
	ld	(ix - 10), hl
	ld	(ix - 4), e
	ld	a, (ix - 13)
	add	a, a
	ld	bc, (ix - 7)
	ld	c, a
	ld	hl, _lock_ep_file
	add	hl, bc
	ld	bc, (hl)
	lea	hl, iy
	ld	de, 304
	add	hl, de
	ld	hl, (hl)
	call	__sxor
	ld	bc, (ix - 10)
BB5_77:
	ld	(ix - 7), hl
	ld	hl, (ix - 46)
	ld	a, (hl)
	xor	a, 1
	ld	(hl), a
	ld	hl, (_zobrist_side)
	ld	a, (_zobrist_side+3)
	ld	e, a
	ld	a, (ix - 4)
	call	__lxor
	ld	bc, 300
	add	iy, bc
	ld	(iy), hl
	lea	hl, iy + 3
	ld	(hl), e
	ld	hl, _lock_side
	ld	hl, (hl)
	ld	bc, (ix - 7)
	call	__sxor
	ld	iy, (ix - 19)
	ld	(iy), l
	ld	(iy + 1), h
	ld	a, (ix - 1)
	cp	a, 1
	jr	nz, BB5_79
	ld	de, 298
	ld	hl, (ix + 6)
	push	hl
	pop	iy
	add	iy, de
	ld	hl, (iy)
	inc.sis	hl
	ld	(iy), l
	ld	(iy + 1), h
BB5_79:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_plist_remove
_plist_remove:
	ld	hl, -9
	call	__frameset
	ld	iy, (ix + 6)
	or	a, a
	sbc	hl, hl
	push	hl
	pop	de
	ld	e, (ix + 12)
	ld	bc, 160
	add	iy, de
	add	iy, bc
	ld	a, (iy)
	cp	a, -1
	jr	z, BB6_5
	ex	de, hl
	ld	e, (ix + 9)
	ld	bc, 288
	ld	hl, (ix + 6)
	add	hl, de
	add	hl, bc
	ld	b, (hl)
	cp	a, b
	jr	nc, BB6_5
	dec	b
	ld	(ix - 6), hl
	or	a, a
	sbc	hl, hl
	ld	(ix - 3), hl
	ld	hl, (ix - 3)
	ld	l, b
	ld	(ix - 3), hl
	ld	c, 4
	ld	(ix - 9), de
	ex	de, hl
	call	__ishl
	push	hl
	pop	de
	ld	hl, (ix + 6)
	add	hl, de
	ld	de, (ix - 3)
	add	hl, de
	ld	de, 128
	add	hl, de
	ld	c, (hl)
	ld	hl, (ix - 6)
	ld	(hl), b
	cp	a, b
	jr	z, BB6_4
	ld	b, c
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	(ix - 3), hl
	ld	c, 4
	ld	hl, (ix - 9)
	call	__ishl
	push	hl
	pop	de
	ld	hl, (ix + 6)
	add	hl, de
	ld	de, (ix - 3)
	add	hl, de
	ld	de, 128
	add	hl, de
	ld	(hl), b
	or	a, a
	sbc	hl, hl
	ex	de, hl
	ld	e, b
	ld	hl, (ix + 6)
	add	hl, de
	ld	de, 160
	add	hl, de
	ld	(hl), a
BB6_4:
	ld	(iy), -1
BB6_5:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_plist_move
_plist_move:
	ld	hl, -3
	call	__frameset
	ld	iy, (ix + 6)
	ld	de, 0
	push	de
	pop	bc
	ld	c, (ix + 12)
	ld	hl, 160
	add	iy, bc
	push	hl
	pop	bc
	add	iy, bc
	ld	a, (iy)
	cp	a, -1
	jr	z, BB7_3
	push	de
	pop	bc
	ld	c, (ix + 9)
	ld	hl, (ix + 6)
	ld	(ix - 3), bc
	add	hl, bc
	ld	bc, 288
	add	hl, bc
	ld	l, (hl)
	cp	a, l
	jr	nc, BB7_3
	ld	e, a
	ld	c, 4
	ld	hl, (ix - 3)
	call	__ishl
	push	hl
	pop	bc
	ld	hl, (ix + 6)
	add	hl, bc
	add	hl, de
	ld	bc, 128
	add	hl, bc
	ld	c, (ix + 15)
	ld	(hl), c
	ld	e, c
	ld	hl, (ix + 6)
	add	hl, de
	ld	de, 160
	add	hl, de
	ld	(hl), a
	ld	(iy), -1
BB7_3:
	pop	hl
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_board_unmake
_board_unmake:
	ld	hl, -50
	call	__frameset
	ld	hl, (ix + 6)
	ld	iy, (ix + 12)
	xor	a, a
	ld	(ix - 36), a
	ld	a, (ix + 10)
	ld	(ix - 3), a
	ld	a, (iy + 13)
	ld	(ix - 10), a
	ld	e, (iy + 12)
	ld	bc, 294
	add	hl, bc
	ld	a, (hl)
	ld	(ix - 35), a
	xor	a, b
	ld	d, a
	ld	(hl), d
	ld	(ix - 9), e
	ld	a, e
	and	a, 7
	ld	(ix - 19), a
	dec	a
	ld	(ix - 28), a
	ld	e, (ix + 9)
	ld	a, e
	srl	a
	and	a, 56
	ld	l, a
	ld	a, e
	and	a, 7
	ld	e, a
	ld	a, l
	add	a, e
	ld	h, a
	ld	e, (ix - 3)
	ld	a, e
	srl	a
	and	a, 56
	ld	l, a
	ld	a, e
	and	a, 7
	ld	e, a
	ld	a, l
	add	a, e
	ld	b, a
	ld	(ix - 6), d
	ld	a, d
	or	a, a
	jr	z, BB8_2
	ld	l, 0
	jr	BB8_3
BB8_2:
	ld	l, -1
BB8_3:
	ld	a, h
	xor	a, 56
	bit	0, l
	jr	nz, BB8_5
	ld	h, a
BB8_5:
	ld	(ix - 22), h
	ld	a, b
	xor	a, 56
	bit	0, l
	ld	(ix - 37), b
	jr	nz, BB8_7
	ld	b, a
BB8_7:
	ld	(ix - 38), a
	ld	iy, _eg_table
	or	a, a
	sbc	hl, hl
	push	hl
	pop	de
	ld	a, (ix + 9)
	ld	e, a
	ld	(ix - 25), de
	push	hl
	pop	de
	ld	c, (ix - 3)
	ld	e, c
	ld	l, (ix - 6)
	ld	(ix - 13), hl
	ld	a, (ix - 10)
	bit	3, a
	ld	(ix - 16), de
	jr	nz, BB8_9
	ld	de, 0
	push	de
	pop	hl
	ld	l, (ix - 28)
	ld	c, 7
	ld	(ix - 28), hl
	call	__ishl
	ld	a, b
	push	hl
	pop	bc
	ld	hl, _mg_table
	add	hl, bc
	add	a, a
	ld	e, a
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 31), hl
	lea	hl, iy
	add	hl, bc
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 34), hl
	ld	a, (ix - 9)
	ld	iy, (ix + 6)
	jp	BB8_19
BB8_9:
	and	a, 48
	cp	a, 16
	jr	nz, BB8_11
	ld	hl, 3
	ld	iy, _mg_table
	jr	BB8_16
BB8_11:
	cp	a, 32
	ld	iy, _mg_table
	jr	nz, BB8_13
	ld	hl, 2
	ld	a, 1
	ld	(ix - 36), a
	jr	BB8_16
BB8_13:
	cp	a, 48
	jr	nz, BB8_15
	ld	hl, 1
	jr	BB8_16
BB8_15:
	ld	hl, 4
BB8_16:
	ld	a, 7
	ld	(ix - 41), hl
	ld	c, a
	call	__ishl
	push	hl
	pop	de
	ld	(ix - 31), de
	lea	hl, iy
	add	hl, de
	ld	c, 1
	sla	b
	ld	de, 0
	ld	e, b
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 44), hl
	ld	hl, (ix - 13)
	call	__ishl
	push	hl
	pop	bc
	ld	iy, (ix + 6)
	add	iy, bc
	lea	hl, iy
	ld	bc, 306
	add	hl, bc
	ld	(ix - 34), hl
	ld	hl, (ix - 34)
	ld	hl, (hl)
	ld	bc, (ix - 44)
	or	a, a
	sbc.sis	hl, bc
	ld	(ix - 44), hl
	ld	hl, _eg_table
	ld	bc, (ix - 31)
	add	hl, bc
	add	hl, de
	ld	(ix - 50), de
	ld	hl, (hl)
	ld	(ix - 31), hl
	ld	bc, 310
	add	iy, bc
	ld	hl, (iy)
	ld	bc, (ix - 31)
	or	a, a
	sbc.sis	hl, bc
	ld	(ix - 47), hl
	or	a, a
	sbc	hl, hl
	ld	l, (ix - 28)
	ld	(ix - 28), hl
	ld	c, a
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _mg_table
	add	hl, bc
	add	hl, de
	ld	de, (hl)
	ld	(ix - 31), de
	ld	hl, (ix - 44)
	add.sis	hl, de
	ld	e, l
	ld	d, h
	ld	hl, (ix - 34)
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	hl, _eg_table
	add	hl, bc
	ld	de, (ix - 50)
	add	hl, de
	ld	de, (hl)
	ld	(ix - 34), de
	ld	hl, (ix - 47)
	add.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, (ix - 41)
	ld	c, 1
	call	__ishl
	push	hl
	pop	de
	ld	hl, _phase_weight
	add	hl, de
	ld	de, (hl)
	ld	iy, (ix + 6)
	ld	bc, 314
	add	iy, bc
	ld	hl, (iy)
	or	a, a
	sbc.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	iy, (ix + 6)
	bit	0, (ix - 36)
	jr	z, BB8_18
	lea	hl, iy
	ld	de, (ix - 13)
	add	hl, de
	ld	de, 290
	add	hl, de
	dec	(hl)
BB8_18:
	lea	hl, iy
	ld	de, (ix - 16)
	add	hl, de
	ld	a, (ix - 9)
	ld	(hl), a
BB8_19:
	ld	c, 1
	ld	hl, (ix - 13)
	call	__ishl
	push	hl
	pop	de
	add	iy, de
	lea	hl, iy
	ld	de, 306
	add	hl, de
	ld	(ix - 9), hl
	ld	hl, (ix - 9)
	ld	hl, (hl)
	ld	de, (ix - 31)
	or	a, a
	sbc.sis	hl, de
	ld	(ix - 31), hl
	ld	de, 310
	add	iy, de
	ld	hl, (iy)
	ld	de, (ix - 34)
	or	a, a
	sbc.sis	hl, de
	ld	(ix - 34), hl
	ld	c, 7
	ld	hl, (ix - 28)
	call	__ishl
	push	hl
	pop	de
	ld	(ix - 28), de
	ld	hl, _mg_table
	add	hl, de
	ld	e, (ix - 22)
	sla	e
	ld	bc, 0
	ld	c, e
	add	hl, bc
	ld	de, (hl)
	ld	hl, (ix - 31)
	add.sis	hl, de
	ld	e, l
	ld	d, h
	ld	hl, (ix - 9)
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	hl, _eg_table
	ld	de, (ix - 28)
	add	hl, de
	add	hl, bc
	ld	de, (hl)
	ld	hl, (ix - 34)
	add.sis	hl, de
	ld	(ix - 22), iy
	ld	(iy), l
	ld	(iy + 1), h
	ld	bc, (ix + 6)
	push	bc
	pop	hl
	ld	de, (ix - 25)
	add	hl, de
	ld	(hl), a
	push	bc
	pop	hl
	ld	de, (ix - 16)
	add	hl, de
	ld	(hl), 0
	ld	a, (ix + 9)
	ld	l, a
	push	hl
	ld	l, (ix - 3)
	push	hl
	ld	l, (ix - 6)
	push	hl
	push	bc
	call	_plist_move
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	a, (ix - 19)
	cp	a, 6
	jr	nz, BB8_21
	ld	de, 292
	ld	hl, (ix + 6)
	ld	bc, (ix - 13)
	add	hl, bc
	add	hl, de
	ld	a, (ix + 9)
	ld	(hl), a
BB8_21:
	ld	a, (ix - 10)
	bit	1, a
	ld	c, 0
	jp	z, BB8_36
	ld	a, (ix - 6)
	or	a, a
	jr	z, BB8_24
	ld	iyl, 0
	jr	BB8_25
BB8_24:
	ld	iyl, -1
BB8_25:
	ld	bc, 0
	ld	a, (ix + 9)
	ld	l, (ix - 3)
	cp	a, l
	sbc	a, a
	ld	l, a
	bit	0, l
	jr	nz, BB8_27
	ld	a, -1
	jr	BB8_28
BB8_27:
	ld	a, 1
BB8_28:
	ld	e, (ix + 9)
	add	a, e
	ld	iyh, a
	bit	0, l
	jr	nz, BB8_30
	ld	a, -4
	jr	BB8_31
BB8_30:
	ld	a, 3
BB8_31:
	ld	l, (ix + 9)
	add	a, l
	ld	h, a
	srl	a
	and	a, 56
	ld	l, a
	ld	(ix - 13), h
	ld	a, h
	and	a, 7
	ld	h, a
	ld	a, l
	add	a, h
	ld	e, a
	ld	a, iyh
	srl	a
	and	a, 56
	ld	l, a
	ld	a, iyh
	and	a, 7
	ld	h, a
	ld	a, l
	add	a, h
	ld	l, a
	ld	a, e
	xor	a, 56
	ex	de, hl
	ld	d, iyl
	ex	de, hl
	bit	0, h
	jr	nz, BB8_33
	ld	e, a
BB8_33:
	ld	(ix - 28), e
	push	bc
	pop	de
	ld	c, (ix - 13)
	ld	(ix - 25), bc
	push	de
	pop	bc
	push	af
	ld	a, iyh
	ld	(ix - 19), a
	pop	af
	ld	c, iyh
	ld	(ix - 31), bc
	ld	a, l
	xor	a, 56
	bit	0, h
	jr	nz, BB8_35
	ld	l, a
BB8_35:
	ld	iy, _mg_table+384
	sla	l
	push	de
	pop	bc
	ld	c, l
	lea	hl, iy
	add	hl, bc
	ld	de, (hl)
	ld	hl, (ix - 9)
	ld	hl, (hl)
	or	a, a
	sbc.sis	hl, de
	ld	(ix - 34), hl
	ld	hl, _eg_table+384
	add	hl, bc
	ld	bc, (hl)
	ld	hl, (ix - 22)
	ld	hl, (hl)
	or	a, a
	sbc.sis	hl, bc
	ld	a, (ix - 28)
	add	a, a
	ld	bc, 0
	ld	c, a
	add	iy, bc
	ld	de, (iy)
	ld	iy, (ix - 34)
	add.sis	iy, de
	ld	e, iyl
	ld	d, iyh
	ld	iy, (ix - 9)
	ld	(iy), e
	ld	(iy + 1), d
	ld	iy, _eg_table+384
	add	iy, bc
	ld	de, (iy)
	add.sis	hl, de
	ld	iy, (ix - 22)
	ld	(iy), l
	ld	(iy + 1), h
	ld	de, (ix + 6)
	push	de
	pop	iy
	ld	bc, (ix - 31)
	add	iy, bc
	ld	a, (iy)
	push	de
	pop	hl
	ld	bc, (ix - 25)
	add	hl, bc
	ld	(hl), a
	ld	(iy), 0
	ld	l, (ix - 13)
	push	hl
	ld	l, (ix - 19)
	push	hl
	ld	l, (ix - 6)
	push	hl
	push	de
	call	_plist_move
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	c, 0
	ld	a, (ix - 10)
BB8_36:
	bit	2, a
	jp	nz, BB8_43
	ld	hl, (ix + 12)
	ld	l, (hl)
	ld	a, l
	or	a, a
	ld	de, (ix + 6)
	ld	iy, 0
	lea	bc, iy
	jp	z, BB8_56
	ld	(ix - 10), l
	ld	a, l
	and	a, 7
	ld	(ix - 13), a
	ld	l, a
	dec	l
	ld	a, (ix - 35)
	ld	c, a
	ld	(ix - 6), bc
	or	a, a
	jr	z, BB8_40
	ld	a, (ix - 38)
	ld	(ix - 37), a
BB8_40:
	ld	bc, 0
	ld	(ix - 9), bc
	ld	c, l
	push	bc
	pop	hl
	ld	(ix - 19), hl
	ld	c, 7
	call	__ishl
	push	hl
	pop	bc
	ld	(ix - 22), bc
	ld	hl, _mg_table
	add	hl, bc
	ld	a, 1
	ld	c, (ix - 37)
	sla	c
	ld	iy, (ix - 9)
	ld	iyl, c
	ld	(ix - 9), iy
	ld	bc, (ix - 9)
	add	hl, bc
	ld	hl, (hl)
	ld	(ix - 25), hl
	ld	hl, (ix - 6)
	ld	c, a
	call	__ishl
	push	hl
	pop	bc
	ex	de, hl
	add	hl, bc
	ld	(ix - 28), hl
	ld	de, 306
	add	hl, de
	ld	iy, (hl)
	ld	de, (ix - 25)
	add.sis	iy, de
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	hl, _eg_table
	ld	de, (ix - 22)
	add	hl, de
	ld	de, (ix - 9)
	add	hl, de
	ld	de, (hl)
	ld	bc, 310
	ld	iy, (ix - 28)
	add	iy, bc
	ld	hl, (iy)
	add.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, (ix - 19)
	ld	c, a
	call	__ishl
	push	hl
	pop	de
	ld	hl, _phase_weight
	add	hl, de
	ld	de, (hl)
	ld	iy, (ix + 6)
	ld	bc, 314
	add	iy, bc
	ld	bc, (ix - 6)
	ld	hl, (iy)
	add.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	de, (ix + 6)
	push	de
	pop	iy
	ld	a, (ix - 13)
	cp	a, 3
	ld	a, (ix - 10)
	jr	nz, BB8_42
	lea	hl, iy
	add	hl, bc
	ld	de, 290
	add	hl, de
	inc	(hl)
	ld	hl, (ix + 12)
	ld	a, (hl)
BB8_42:
	lea	hl, iy
	ld	de, (ix - 16)
	add	hl, de
	ld	(hl), a
	ld	(ix - 6), de
	ld	a, (ix - 3)
	jp	BB8_55
BB8_43:
	ld	a, (ix - 6)
	or	a, a
	ld	iy, (ix + 6)
	jr	z, BB8_45
	ld	a, -16
	jr	BB8_46
BB8_45:
	ld	a, 16
BB8_46:
	add	a, (ix - 3)
	ld	e, a
	ld	hl, (ix + 12)
	ld	l, (hl)
	ld	a, l
	or	a, a
	jr	nz, BB8_48
	or	a, a
	sbc	hl, hl
	ld	l, (ix - 35)
	ld	(ix - 9), hl
	ld	a, e
	jp	BB8_54
BB8_48:
	ld	(ix - 22), l
	ld	a, l
	and	a, 7
	ld	(ix - 10), a
	ld	c, a
	dec	c
	ld	a, e
	srl	a
	and	a, 56
	ld	l, a
	ld	(ix - 3), e
	ld	a, e
	and	a, 7
	ld	e, a
	ld	a, l
	add	a, e
	ld	d, a
	or	a, a
	sbc	hl, hl
	ld	e, (ix - 35)
	ld	l, e
	ld	(ix - 9), hl
	xor	a, 56
	ld	l, a
	ld	a, e
	or	a, a
	jr	z, BB8_50
	ld	d, l
BB8_50:
	ld	a, d
	ld	de, 0
	push	de
	pop	hl
	ld	l, c
	ld	(ix - 13), hl
	ld	c, 7
	call	__ishl
	ld	(ix - 6), hl
	ld	hl, _mg_table
	ld	bc, (ix - 6)
	add	hl, bc
	ld	c, 1
	add	a, a
	ld	e, a
	ld	(ix - 16), de
	add	hl, de
	ld	de, (hl)
	ld	hl, (ix - 9)
	ld	a, c
	call	__ishl
	push	hl
	pop	bc
	lea	hl, iy
	add	hl, bc
	ld	(ix - 19), hl
	ld	bc, 306
	add	hl, bc
	ld	iy, (hl)
	add.sis	iy, de
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	hl, _eg_table
	ld	bc, (ix - 6)
	add	hl, bc
	ld	de, (ix - 16)
	add	hl, de
	ld	de, (hl)
	ld	bc, 310
	ld	iy, (ix - 19)
	add	iy, bc
	ld	hl, (iy)
	add.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, (ix - 13)
	ld	c, a
	call	__ishl
	push	hl
	pop	de
	ld	hl, _phase_weight
	add	hl, de
	ld	de, (hl)
	ld	iy, (ix + 6)
	ld	bc, 314
	add	iy, bc
	ld	hl, (iy)
	add.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	a, (ix - 10)
	cp	a, 3
	jr	nz, BB8_52
	ld	iy, (ix + 6)
	lea	hl, iy
	ld	de, (ix - 9)
	add	hl, de
	ld	de, 290
	add	hl, de
	inc	(hl)
	ld	hl, (ix + 12)
	ld	c, (hl)
	jr	BB8_53
BB8_52:
	ld	c, (ix - 22)
	ld	iy, (ix + 6)
BB8_53:
	ld	a, (ix - 3)
BB8_54:
	ld	de, 0
	ld	e, a
	ld	(ix - 6), de
	lea	hl, iy
	add	hl, de
	ld	(hl), c
	ld	bc, (ix - 9)
BB8_55:
	ld	de, 288
	ld	iy, (ix + 6)
	add	iy, bc
	add	iy, de
	ld	de, 0
	ld	e, (iy)
	push	bc
	pop	hl
	ld	c, 4
	call	__ishl
	push	hl
	pop	bc
	ld	hl, (ix + 6)
	add	hl, bc
	add	hl, de
	ld	de, 128
	add	hl, de
	ld	(hl), a
	ld	a, (iy)
	ld	de, 160
	ld	hl, (ix + 6)
	ld	bc, (ix - 6)
	add	hl, bc
	add	hl, de
	ld	(hl), a
	inc	(iy)
	ld	de, (ix + 6)
BB8_56:
	ld	hl, (ix + 12)
	push	hl
	pop	iy
	ld	a, (iy + 1)
	ld	bc, 295
	push	de
	pop	hl
	add	hl, bc
	ld	(hl), a
	ld	a, (iy + 2)
	inc	bc
	push	de
	pop	hl
	add	hl, bc
	ld	(hl), a
	ld	a, (iy + 3)
	inc	bc
	push	de
	pop	hl
	add	hl, bc
	ld	(hl), a
	ld	hl, (iy + 4)
	ld	(ix - 3), hl
	push	de
	pop	hl
	inc	bc
	add	hl, bc
	ld	bc, (ix - 3)
	ld	(hl), c
	inc	hl
	ld	(hl), b
	ld	hl, (iy + 6)
	ld	a, (iy + 9)
	push	de
	pop	bc
	push	bc
	pop	iy
	ld	de, 300
	add	iy, de
	ld	(iy), hl
	lea	hl, iy + 3
	ld	(hl), a
	ld	iy, (ix + 12)
	ld	iy, (iy + 10)
	ld	de, 304
	push	bc
	pop	hl
	add	hl, de
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_book_init
_book_init:
	ld	hl, -28
	call	__frameset
	xor	a, a
	ld	de, 0
	ld	hl, _.str
	ld	bc, _.str.1
	ld	(_num_segments), a
	ld	(_total_entries), de
	ld	(_total_entries+3), a
	ld	(_book_ready), a
	push	bc
	push	hl
	call	_ti_Open
	ld	e, a
	pop	hl
	pop	hl
	or	a, a
	jr	nz, BB9_2
	xor	a, a
	jp	BB9_12
BB9_2:
	lea	hl, ix - 9
	ld	(ix - 15), hl
	push	de
	ld	(ix - 12), de
	call	_ti_GetDataPtr
	pop	de
	ld	(_poly_randoms), hl
	ld	hl, (ix - 12)
	push	hl
	call	_ti_Close
	ld	de, 1
	pop	hl
	ld	bc, 100
	ld	iy, _total_entries
	lea	iy, iy + 3
BB9_3:
	ld	a, (_num_segments)
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jp	nc, BB9_10
	cp	a, 40
	jp	nc, BB9_10
	ld	(ix - 12), iy
	push	de
	ld	hl, _.str.3
	push	hl
	ld	hl, _.str.2
	push	hl
	ld	hl, (ix - 15)
	push	hl
	ld	(ix - 18), de
	call	_sprintf
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, _.str.1
	push	hl
	ld	hl, (ix - 15)
	push	hl
	call	_ti_Open
	ld	e, a
	pop	hl
	pop	hl
	or	a, a
	jp	z, BB9_9
	push	de
	ld	(ix - 24), de
	call	_ti_GetDataPtr
	pop	de
	ld	iy, 0
	lea	de, iy
	push	hl
	pop	iy
	ld	e, (iy)
	ld	(ix - 21), de
	ld	d, 0
	ld	bc, 0
	ld	c, (iy + 1)
	ld	a, d
	ld	l, 8
	call	__lshl
	push	bc
	pop	hl
	ld	e, a
	ld	bc, (ix - 21)
	ld	a, d
	call	__ladd
	ld	(ix - 21), hl
	ld	bc, 0
	ld	c, (iy + 2)
	ld	l, 16
	call	__lshl
	ld	hl, (ix - 21)
	call	__ladd
	ld	(ix - 21), hl
	ld	bc, 0
	ld	(ix - 28), iy
	ld	c, (iy + 3)
	ld	a, d
	ld	l, 24
	call	__lshl
	ld	hl, (ix - 21)
	call	__ladd
	ld	(ix - 21), hl
	ld	(ix - 25), e
	ld	hl, (ix - 24)
	push	hl
	call	_ti_Close
	pop	hl
	ld	hl, (ix - 21)
	ld	e, (ix - 25)
	ld	d, e
	call	__lcmpzero
	jr	z, BB9_8
	ld	iy, (ix - 28)
	lea	hl, iy + 4
	ld	(ix - 28), hl
	ld	a, (_num_segments)
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	(ix - 24), hl
	ld	bc, 7
	call	__imulu
	push	hl
	pop	bc
	ld	iy, _segments
	add	iy, bc
	ld	hl, (ix - 28)
	ld	(iy), hl
	ld	bc, (ix - 21)
	ld	(iy + 3), bc
	ld	(iy + 6), d
	ld	hl, (_total_entries)
	ld	iy, (ix - 12)
	ld	e, (iy)
	ld	a, d
	call	__ladd
	ld	a, e
	ld	(_total_entries), hl
	ld	(_total_entries+3), a
	ld	hl, (ix - 24)
	inc	l
	ld	a, l
	ld	(_num_segments), a
BB9_8:
	ld	de, (ix - 18)
	inc	de
	ld	bc, 100
	ld	iy, (ix - 12)
	jp	BB9_3
BB9_9:
	ld	a, (_num_segments)
BB9_10:
	or	a, a
	ld	a, 0
	jr	z, BB9_12
	ld	a, 1
	ld	(_book_ready), a
BB9_12:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_book_probe
_book_probe:
	ld	hl, -189
	call	__frameset
	ld	h, 0
	ld	de, 0
	ld	a, (_book_ready)
	bit	0, a
	jp	z, BB10_61
	ld	bc, -180
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	ld	bc, -137
	lea	hl, ix
	add	hl, bc
	push	ix
	ld	bc, -189
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	iy, (ix + 6)
	ld	hl, 56
	push	ix
	ld	bc, -155
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld.sis	hl, 0
	push	ix
	ld	bc, -146
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	bc, -134
	lea	hl, ix
	add	hl, bc
	push	ix
	ld	bc, -183
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	hl, (_poly_randoms)
	push	ix
	ld	bc, -149
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	bc, 8
	push	de
	pop	hl
	ld	(ix - 3), bc
	push	ix
	ld	bc, -140
	add	ix, bc
	ld	(ix), hl
	pop	ix
	push	ix
	ld	bc, -143
	add	ix, bc
	ld	(ix), hl
	pop	ix
	push	ix
	ld	bc, -186
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	bc, (ix - 3)
BB10_2:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jp	z, BB10_12
	ld	(ix - 3), bc
	ld	bc, -158
	lea	hl, ix
	add	hl, bc
	ld	(hl), de
	ld	de, 0
	ld	bc, (ix - 3)
BB10_4:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jp	z, BB10_11
	ld	(ix - 3), bc
	ld	bc, -152
	lea	hl, ix
	add	hl, bc
	ld	(hl), iy
	add	iy, de
	ld	l, (iy)
	ld	a, l
	or	a, a
	ld	bc, (ix - 3)
	jr	nz, BB10_7
	push	bc
	pop	hl
	ld	(ix - 3), bc
	ld	bc, -152
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	jp	BB10_10
BB10_7:
	push	de
	pop	bc
	ld	a, l
	add	a, a
	and	a, 14
	add	a, -2
	ld	e, a
	ld	a, l
	cp	a, 0
	call	pe, __setflag
	ld	l, 1
	jp	p, BB10_9
	ld	l, 0
BB10_9:
	ld	a, e
	add	a, l
	ld	de, -155
	lea	hl, ix
	add	hl, de
	ld	hl, (hl)
	ld	de, -161
	lea	iy, ix
	add	iy, de
	ld	(iy), bc
	add	hl, bc
	ex	de, hl
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	c, 6
	call	__ishl
	push	hl
	pop	iy
	ex	de, hl
	ld	bc, 255
	call	__iand
	push	hl
	pop	de
	add	iy, de
	lea	hl, iy
	ld	c, 3
	call	__ishl
	push	hl
	pop	de
	ld	(ix - 3), bc
	ld	bc, -149
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	add	iy, de
	ld	hl, (iy)
	ld	de, (iy + 3)
	ld	bc, (ix - 3)
	ld	bc, (iy + 6)
	ld	(ix - 3), de
	ld	de, -146
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -143
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -140
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, (ix - 3)
	call	__llxor
	ld	(ix - 3), bc
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	push	ix
	ld	bc, -143
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	bc, (ix - 3)
	ld	(ix - 3), de
	push	ix
	ld	de, -146
	add	ix, de
	ld	(ix), bc
	pop	ix
	pop	hl
	pop	hl
	pop	hl
	ld	de, (ix - 3)
	ld	bc, -161
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
	ld	bc, 8
	ld	(ix - 3), bc
	push	ix
	ld	bc, -152
	add	ix, bc
	ld	iy, (ix)
	pop	ix
BB10_10:
	ld	bc, (ix - 3)
	inc	de
	jp	BB10_4
BB10_11:
	ld	(ix - 3), bc
	ld	bc, -158
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
	inc	de
	lea	iy, iy + 16
	push	ix
	ld	bc, -152
	add	ix, bc
	ld	(ix), iy
	pop	ix
	ld	bc, (ix - 3)
	push	bc
	pop	iy
	ld	bc, 248
	ld	(ix - 3), de
	push	ix
	ld	de, -155
	add	ix, de
	ld	hl, (ix)
	pop	ix
	add	hl, bc
	lea	bc, iy
	ld	de, -152
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	ix
	ld	de, -155
	add	ix, de
	ld	(ix), hl
	pop	ix
	ld	de, (ix - 3)
	jp	BB10_2
BB10_12:
	ld	de, 295
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	ld	bc, -152
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	and	a, d
	bit	0, a
	jr	nz, BB10_14
	ld	bc, -152
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	jp	BB10_15
BB10_14:
	ld	de, 6144
	ld	bc, -149
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	add	iy, de
	ld	hl, (iy)
	lea	bc, iy
	lea	iy, iy + 3
	ld	de, (iy)
	push	bc
	pop	iy
	lea	iy, iy + 6
	ld	bc, (iy)
	ld	(ix - 3), de
	ld	de, -146
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -143
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -140
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, (ix - 3)
	call	__llxor
	ld	(ix - 3), bc
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	push	ix
	ld	bc, -143
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	bc, (ix - 3)
	ld	(ix - 3), de
	push	ix
	ld	de, -146
	add	ix, de
	ld	(ix), bc
	pop	ix
	pop	hl
	pop	hl
	pop	hl
	ld	bc, -152
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	ld	de, (ix - 3)
BB10_15:
	bit	1, a
	jp	z, BB10_17
	ld	de, 6152
	ld	bc, -149
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	add	iy, de
	ld	hl, (iy)
	lea	bc, iy
	lea	iy, iy + 3
	ld	de, (iy)
	push	bc
	pop	iy
	lea	iy, iy + 6
	ld	bc, (iy)
	ld	(ix - 3), de
	ld	de, -146
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -143
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -140
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, (ix - 3)
	call	__llxor
	ld	(ix - 3), bc
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	push	ix
	ld	bc, -143
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	bc, (ix - 3)
	ld	(ix - 3), de
	push	ix
	ld	de, -146
	add	ix, de
	ld	(ix), bc
	pop	ix
	pop	hl
	pop	hl
	pop	hl
	ld	de, (ix - 3)
BB10_17:
	bit	2, a
	jp	z, BB10_19
	ld	de, 6160
	ld	bc, -149
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	add	iy, de
	ld	hl, (iy)
	lea	bc, iy
	lea	iy, iy + 3
	ld	de, (iy)
	push	bc
	pop	iy
	lea	iy, iy + 6
	ld	bc, (iy)
	ld	(ix - 3), de
	ld	de, -146
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -143
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -140
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, (ix - 3)
	call	__llxor
	ld	(ix - 3), bc
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	push	ix
	ld	bc, -143
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	bc, (ix - 3)
	ld	(ix - 3), de
	push	ix
	ld	de, -146
	add	ix, de
	ld	(ix), bc
	pop	ix
	pop	hl
	pop	hl
	pop	hl
	ld	de, (ix - 3)
BB10_19:
	bit	3, a
	jr	nz, BB10_21
	ld	iy, (ix + 6)
	jp	BB10_22
BB10_21:
	ld	de, 6168
	ld	bc, -149
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	add	iy, de
	ld	hl, (iy)
	lea	bc, iy
	lea	iy, iy + 3
	ld	de, (iy)
	push	bc
	pop	iy
	lea	iy, iy + 6
	ld	bc, (iy)
	ld	(ix - 3), de
	ld	de, -146
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -143
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -140
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, (ix - 3)
	call	__llxor
	ld	(ix - 3), bc
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	push	ix
	ld	bc, -143
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	bc, (ix - 3)
	ld	(ix - 3), de
	push	ix
	ld	de, -146
	add	ix, de
	ld	(ix), bc
	pop	ix
	pop	hl
	pop	hl
	pop	hl
	ld	iy, (ix + 6)
	ld	de, (ix - 3)
BB10_22:
	ld	de, 296
	lea	hl, iy
	add	hl, de
	ld	l, (hl)
	ld	a, l
	cp	a, -1
	ld	de, 294
	jr	nz, BB10_24
	lea	hl, iy
	add	hl, de
	jp	BB10_39
BB10_24:
	ld	a, l
	and	a, 7
	push	ix
	ld	bc, -152
	add	ix, bc
	ld	(ix), a
	pop	ix
	ld	a, l
	ld	b, 4
	call	__bshru
	ld	c, a
	lea	hl, iy
	add	hl, de
	ld	l, (hl)
	ld	a, l
	or	a, a
	ld	de, -158
	lea	iy, ix
	push	af
	add	iy, de
	pop	af
	ld	(iy), l
	jr	z, BB10_26
	ld	e, 0
	jr	BB10_27
BB10_26:
	ld	e, -1
BB10_27:
	ld	a, 1
	ld	(ix - 3), bc
	ld	bc, -152
	lea	hl, ix
	add	hl, bc
	ld	d, (hl)
	ld	bc, (ix - 3)
	bit	0, e
	jr	nz, BB10_29
	ld	a, -1
BB10_29:
	add	a, c
	bit	0, e
	ld	hl, 1
	jr	nz, BB10_31
	ld	hl, 129
BB10_31:
	ld	bc, -155
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	or	a, a
	sbc	hl, hl
	push	hl
	pop	iy
	ld	iyl, d
	ld	l, a
	ld	c, 4
	call	__ishl
	ld	a, d
	or	a, a
	ld	d, 0
	ld	c, d
	jr	z, BB10_36
	push	ix
	ld	bc, -161
	add	ix, bc
	ld	(ix), iy
	pop	ix
	dec	iy
	push	hl
	pop	de
	add	iy, de
	lea	de, iy
	ld	iy, (ix + 6)
	add	iy, de
	ld	e, (iy)
	ld	(ix - 3), de
	ld	de, -155
	lea	iy, ix
	add	iy, de
	ld	bc, (iy)
	ld	a, c
	ld	de, (ix - 3)
	cp	a, e
	jr	z, BB10_34
	ld	c, 0
	jr	BB10_35
BB10_34:
	ld	c, 1
BB10_35:
	ld	de, -152
	lea	iy, ix
	add	iy, de
	ld	a, (iy)
	cp	a, 7
	ld	de, -161
	lea	iy, ix
	push	af
	add	iy, de
	pop	af
	ld	iy, (iy)
	jr	z, BB10_37
BB10_36:
	lea	de, iy
	inc	de
	add	hl, de
	ex	de, hl
	ld	hl, (ix + 6)
	add	hl, de
	ld	l, (hl)
	ld	(ix - 3), bc
	push	ix
	ld	bc, -155
	add	ix, bc
	ld	de, (ix)
	pop	ix
	ld	a, e
	cp	a, l
	ld	bc, (ix - 3)
	jr	z, BB10_40
BB10_37:
	bit	0, c
	jr	nz, BB10_40
	ld	bc, -158
	lea	hl, ix
	add	hl, bc
BB10_39:
	ld	a, (hl)
	jp	BB10_41
BB10_40:
	ld	de, 772
	add	iy, de
	ld	c, d
	lea	hl, iy
	call	__ishl
	push	hl
	pop	de
	ld	(ix - 3), bc
	ld	bc, -149
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	add	iy, de
	ld	hl, (iy)
	ld	de, (iy + 3)
	ld	bc, (ix - 3)
	ld	bc, (iy + 6)
	ld	(ix - 3), de
	ld	de, -146
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -143
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -140
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, (ix - 3)
	call	__llxor
	ld	(ix - 3), bc
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	push	ix
	ld	bc, -143
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	bc, (ix - 3)
	ld	(ix - 3), de
	push	ix
	ld	de, -146
	add	ix, de
	ld	(ix), bc
	pop	ix
	pop	hl
	pop	hl
	pop	hl
	ld	bc, -158
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	ld	de, (ix - 3)
BB10_41:
	or	a, a
	jp	nz, BB10_43
	ld	de, 6240
	ld	bc, -149
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	add	iy, de
	ld	hl, (iy)
	lea	bc, iy
	lea	iy, iy + 3
	ld	de, (iy)
	push	bc
	pop	iy
	lea	iy, iy + 6
	ld	bc, (iy)
	ld	(ix - 3), de
	ld	de, -146
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -143
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, -140
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	push	iy
	ld	de, (ix - 3)
	call	__llxor
	ld	(ix - 3), bc
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	push	ix
	ld	bc, -143
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	bc, (ix - 3)
	ld	(ix - 3), de
	push	ix
	ld	de, -146
	add	ix, de
	ld	(ix), bc
	pop	ix
	pop	hl
	pop	hl
	pop	hl
	ld	iy, 0
	ld	de, (ix - 3)
	jr	BB10_44
BB10_43:
	ld	iy, 0
BB10_44:
	ld	a, (_num_segments)
	ld	de, 0
	ld	e, a
BB10_45:
	ld	bc, 7
	lea	hl, iy
	or	a, a
	sbc	hl, de
	jp	z, BB10_60
	ld	(ix - 3), bc
	ld	bc, -167
	lea	hl, ix
	add	hl, bc
	ld	(hl), de
	push	ix
	ld	de, -170
	add	ix, de
	ld	(ix), iy
	pop	ix
	lea	hl, iy
	ld	bc, (ix - 3)
	call	__imulu
	push	hl
	pop	de
	ld	hl, _segments
	push	hl
	pop	iy
	add	iy, de
	ld	hl, (iy + 3)
	push	ix
	ld	de, -155
	add	ix, de
	ld	(ix), iy
	pop	ix
	ld	a, (iy + 6)
	ld	de, -173
	lea	iy, ix
	add	iy, de
	ld	(iy), hl
	push	ix
	dec	de
	add	ix, de
	ld	(ix), a
	pop	ix
	ld	iy, 0
	push	hl
	pop	bc
	ld	h, 0
	ld	d, h
BB10_47:
	lea	hl, iy
	ld	e, d
	call	__lcmpu
	ld	(ix - 3), bc
	push	ix
	ld	bc, -152
	push	af
	add	ix, bc
	pop	af
	ld	(ix), d
	pop	ix
	ld	bc, (ix - 3)
	jp	nc, BB10_57
	ld	(ix - 3), de
	ld	de, -158
	lea	hl, ix
	add	hl, de
	ld	(hl), bc
	push	bc
	pop	hl
	push	ix
	ld	bc, -177
	add	ix, bc
	ld	(ix), a
	pop	ix
	ld	de, (ix - 3)
	ld	e, a
	lea	bc, iy
	ld	a, d
	call	__lsub
	push	hl
	pop	bc
	ld	a, e
	ld	l, 1
	call	__lshru
	push	bc
	pop	hl
	ld	e, a
	push	ix
	ld	bc, -149
	add	ix, bc
	ld	(ix), iy
	pop	ix
	lea	bc, iy
	ld	a, d
	call	__ladd
	push	hl
	pop	bc
	ld	(ix - 3), de
	ld	de, -164
	lea	iy, ix
	add	iy, de
	ld	(iy), bc
	ld	de, (ix - 3)
	ld	(ix - 3), bc
	push	ix
	ld	bc, -161
	add	ix, bc
	ld	(ix), e
	pop	ix
	push	ix
	ld	bc, -155
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	ld	iy, (hl)
	ld	bc, (ix - 3)
	push	bc
	pop	hl
	ld	c, 4
	call	__ishl
	push	hl
	pop	de
	add	iy, de
	push	iy
	call	_read_be64
	pop	iy
	ld	(ix - 3), bc
	ld	bc, -146
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, -143
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, (ix - 3)
	call	__llcmpu
	pop	hl
	pop	hl
	pop	hl
	ccf
	sbc	a, a
	ld	d, a
	inc	d
	ld	(ix - 3), bc
	ld	bc, -164
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	bc, -161
	lea	iy, ix
	add	iy, bc
	ld	e, (iy)
	ld	bc, (ix - 3)
	ld	bc, 1
	ld	iyh, b
	ld	a, iyh
	call	__ladd
	push	hl
	pop	iy
	bit	0, d
	jr	nz, BB10_50
	ld	(ix - 3), de
	ld	de, -164
	lea	hl, ix
	add	hl, de
	ld	bc, (hl)
	push	ix
	ld	de, -158
	add	ix, de
	ld	(ix), bc
	pop	ix
	ld	de, (ix - 3)
BB10_50:
	bit	0, d
	ld	bc, -177
	lea	hl, ix
	push	af
	add	hl, bc
	pop	af
	ld	a, (hl)
	jr	nz, BB10_52
	ld	bc, -161
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
BB10_52:
	bit	0, d
	ld	(ix - 3), de
	ld	de, -149
	lea	hl, ix
	push	af
	add	hl, de
	pop	af
	ld	bc, (hl)
	ld	de, (ix - 3)
	jr	nz, BB10_54
	push	bc
	pop	iy
BB10_54:
	bit	0, d
	jr	nz, BB10_56
	ld	bc, -152
	lea	hl, ix
	add	hl, bc
	ld	e, (hl)
BB10_56:
	ld	d, e
	ld	(ix - 3), de
	ld	de, -158
	lea	hl, ix
	add	hl, de
	ld	bc, (hl)
	ld	de, (ix - 3)
	jp	BB10_47
BB10_57:
	lea	hl, iy
	ld	e, d
	ld	(ix - 3), de
	push	ix
	ld	de, -173
	add	ix, de
	ld	bc, (ix)
	pop	ix
	push	ix
	dec	de
	add	ix, de
	ld	a, (ix)
	pop	ix
	ld	de, (ix - 3)
	call	__lcmpu
	jr	nc, BB10_59
	ld	de, -149
	lea	hl, ix
	add	hl, de
	ld	(hl), iy
	ld	de, -155
	lea	iy, ix
	add	iy, de
	ld	hl, (iy)
	ld	iy, (hl)
	ld	de, -149
	lea	hl, ix
	add	hl, de
	ld	hl, (hl)
	ld	c, 4
	call	__ishl
	push	hl
	pop	de
	add	iy, de
	push	iy
	call	_read_be64
	pop	iy
	ld	(ix - 3), bc
	ld	bc, -146
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, -143
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, -149
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	bc, (ix - 3)
	call	__llcmpu
	pop	hl
	pop	hl
	pop	hl
	jr	z, BB10_63
BB10_59:
	ld	bc, -170
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	inc	iy
	push	ix
	ld	bc, -167
	add	ix, bc
	ld	de, (ix)
	pop	ix
	jp	BB10_45
BB10_60:
	ld	h, 0
BB10_61:
	ld	a, h
BB10_62:
	ld	sp, ix
	pop	ix
	ret
BB10_63:
	ld	de, -170
	lea	hl, ix
	add	hl, de
	ld	hl, (hl)
	ld	bc, 255
	call	__iand
	push	hl
	pop	de
	ld	h, b
	ld	a, h
	ld	(ix - 3), de
	ld	de, -167
	lea	hl, ix
	add	hl, de
	ld	bc, (hl)
	ld	de, (ix - 3)
BB10_64:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jp	nc, BB10_74
	cp	a, 32
	jp	nc, BB10_74
	ld	bc, -164
	lea	hl, ix
	add	hl, bc
	ld	(hl), de
	ex	de, hl
	ld	bc, 7
	call	__imulu
	push	hl
	pop	de
	lea	hl, iy
	ld	iy, _segments
	add	iy, de
	ld	de, (iy)
	ld	(ix - 3), bc
	push	ix
	ld	bc, -170
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	de, (iy + 3)
	push	ix
	ld	bc, -155
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	d, (iy + 6)
	push	hl
	pop	iy
	or	a, a
	sbc	hl, hl
	push	ix
	ld	bc, -158
	add	ix, bc
	ld	(ix), a
	pop	ix
	ld	l, a
	ld	bc, (ix - 3)
	ld	c, 2
	call	__ishl
	ld	(ix - 3), bc
	push	ix
	ld	bc, -161
	add	ix, bc
	ld	(ix), hl
	pop	ix
BB10_67:
	ld	bc, (ix - 3)
	lea	hl, iy
	push	ix
	ld	bc, -152
	add	ix, bc
	ld	e, (ix)
	pop	ix
	ld	(ix - 3), de
	push	ix
	ld	de, -155
	add	ix, de
	ld	bc, (ix)
	pop	ix
	ld	de, (ix - 3)
	ld	a, d
	call	__lcmpu
	jp	nc, BB10_71
	ld	bc, -174
	lea	hl, ix
	add	hl, bc
	ld	(hl), d
	push	ix
	ld	bc, -161
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	ld	de, 128
	or	a, a
	sbc	hl, de
	jp	z, BB10_72
	lea	hl, iy
	ld	c, 4
	call	__ishl
	push	hl
	pop	de
	ld	(ix - 3), bc
	push	ix
	ld	bc, -170
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	add	hl, de
	push	ix
	ld	de, -173
	add	ix, de
	ld	(ix), hl
	pop	ix
	push	hl
	ld	de, -149
	lea	hl, ix
	add	hl, de
	ld	(hl), iy
	ld	bc, (ix - 3)
	call	_read_be64
	pop	iy
	ld	(ix - 3), bc
	ld	bc, -146
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, -143
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	push	iy
	ld	bc, (ix - 3)
	call	__llcmpu
	pop	hl
	pop	hl
	pop	hl
	ld	(ix - 3), bc
	ld	bc, -180
	lea	hl, ix
	push	af
	add	hl, bc
	pop	af
	ld	hl, (hl)
	ld	bc, (ix - 3)
	jp	nz, BB10_90
	ld	de, -173
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	ld	l, (iy + 8)
	ld	c, l
	ld	b, h
	ld	h, c
	ld	l, b
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	ld	e, (iy + 9)
	ld	d, b
	add.sis	hl, de
	ld	(ix - 3), bc
	ld	bc, -161
	lea	iy, ix
	add	iy, bc
	ld	de, (iy)
	push	ix
	ld	bc, -183
	add	ix, bc
	ld	iy, (ix)
	pop	ix
	add	iy, de
	push	ix
	ld	de, -177
	add	ix, de
	ld	(ix), iy
	pop	ix
	ld	(iy), l
	ld	(iy + 1), h
	ld	bc, (ix - 3)
	ld	h, b
	ld	de, -173
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	ld	l, (iy + 10)
	ld	h, l
	ld	l, b
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	ld	e, (iy + 11)
	ld	(ix - 3), de
	ld	de, -180
	lea	iy, ix
	add	iy, de
	ld	(iy), bc
	ld	de, (ix - 3)
	ld	d, b
	add.sis	hl, de
	push	ix
	ld	bc, -177
	add	ix, bc
	ld	iy, (ix)
	pop	ix
	ld	(iy + 2), l
	ld	(iy + 3), h
	ld	bc, -149
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	bc, -152
	lea	iy, ix
	add	iy, bc
	ld	e, (iy)
	ld	bc, 1
	ld	(ix - 3), bc
	push	ix
	ld	bc, -180
	add	ix, bc
	ld	iy, (ix)
	pop	ix
	ld	a, iyh
	ld	bc, (ix - 3)
	call	__ladd
	push	hl
	pop	iy
	ld	(ix - 3), bc
	push	ix
	ld	bc, -152
	add	ix, bc
	ld	(ix), e
	pop	ix
	push	ix
	ld	bc, -158
	add	ix, bc
	ld	a, (ix)
	pop	ix
	inc	a
	push	ix
	add	ix, bc
	ld	(ix), a
	pop	ix
	ld	de, 4
	push	ix
	ld	bc, -161
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	add	hl, de
	push	ix
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	bc, -174
	lea	hl, ix
	add	hl, bc
	ld	d, (hl)
	jp	BB10_67
BB10_71:
	ld	bc, -180
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	de, 0
	push	de
	pop	iy
	push	ix
	ld	de, -167
	add	ix, de
	ld	bc, (ix)
	pop	ix
	push	ix
	ld	de, -158
	add	ix, de
	ld	a, (ix)
	jr	BB10_73
BB10_72:
	ld	a, 32
	ld	bc, -180
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	de, 0
	push	de
	pop	iy
	push	ix
	ld	de, -167
	add	ix, de
	ld	bc, (ix)
BB10_73:
	pop	ix
	ld	(ix - 3), bc
	push	ix
	ld	bc, -164
	add	ix, bc
	ld	de, (ix)
	pop	ix
	ld	bc, (ix - 3)
	inc	de
	ld	(ix - 3), bc
	push	ix
	ld	bc, -152
	add	ix, bc
	ld	(ix), h
	pop	ix
	ld	bc, (ix - 3)
	jp	BB10_64
BB10_74:
	ld	bc, -180
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	iy, 0
BB10_75:
	ld	e, a
	or	a, a
	jp	z, BB10_61
	ld	bc, 0
	ld	c, e
	lea	de, iy
	ld	(ix - 3), de
	ld	de, -183
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	lea	iy, iy + 2
	push	ix
	ld	de, -146
	add	ix, de
	ld	(ix), bc
	pop	ix
	push	ix
	ld	de, -140
	add	ix, de
	ld	(ix), bc
	pop	ix
	ld	de, (ix - 3)
	push	de
	pop	bc
	push	ix
	ld	de, -180
	add	ix, de
	ld	(ix), hl
	pop	ix
	ld	e, h
	xor	a, a
BB10_77:
	ld	(ix - 3), bc
	ld	bc, -140
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	bc, (ix - 3)
	jr	z, BB10_79
	ld	hl, (iy)
	ld	(ix - 3), de
	push	ix
	ld	de, -143
	add	ix, de
	ld	(ix), bc
	pop	ix
	ld	bc, 0
	ld	c, l
	ld	b, h
	lea	hl, ix
	add	hl, de
	ld	hl, (hl)
	ld	de, (ix - 3)
	call	__ladd
	push	hl
	pop	bc
	lea	iy, iy + 4
	ld	(ix - 3), bc
	push	ix
	ld	bc, -140
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	dec	hl
	push	ix
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	bc, (ix - 3)
	jr	BB10_77
BB10_79:
	push	bc
	pop	hl
	call	__lcmpzero
	jr	nz, BB10_81
BB10_80:
	ld	bc, -180
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	jp	BB10_61
BB10_81:
	ld	(ix - 3), de
	ld	de, -143
	lea	hl, ix
	add	hl, de
	ld	(hl), bc
	ld	de, (ix - 3)
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	(iy), e
	call	_rand
	push	hl
	pop	bc
	push	bc
	pop	iy
	add	iy, iy
	sbc	hl, hl
	push	hl
	pop	de
	push	bc
	pop	hl
	ld	(ix - 3), de
	ld	de, -143
	lea	iy, ix
	add	iy, de
	ld	bc, (iy)
	push	ix
	ld	de, -140
	add	ix, de
	ld	a, (ix)
	pop	ix
	ld	de, (ix - 3)
	call	__lremu
	ld	(ix - 3), bc
	push	ix
	ld	bc, -152
	add	ix, bc
	ld	(ix), hl
	pop	ix
	push	ix
	ld	bc, -155
	add	ix, bc
	ld	(ix), e
	pop	ix
	push	ix
	ld	bc, -183
	add	ix, bc
	ld	iy, (ix)
	pop	ix
	lea	hl, iy + 2
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	ld	bc, -146
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
	ld	bc, (ix - 3)
	push	de
	pop	bc
	ld	(ix - 3), de
	push	ix
	ld	de, -180
	add	ix, de
	ld	hl, (ix)
	pop	ix
	push	ix
	ld	de, -143
	add	ix, de
	ld	(ix), h
	pop	ix
	push	bc
	pop	hl
	ld	de, (ix - 3)
BB10_82:
	ld	bc, -149
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	push	ix
	ld	bc, -186
	push	af
	add	ix, bc
	pop	af
	ld	hl, (ix)
	pop	ix
	jp	z, BB10_86
	ld	bc, -140
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	de, (iy)
	ld	bc, 0
	ld	c, e
	ld	b, d
	xor	a, a
	ld	(ix - 3), bc
	ld	bc, -143
	lea	iy, ix
	add	iy, bc
	ld	e, (iy)
	ld	bc, (ix - 3)
	call	__ladd
	push	hl
	pop	bc
	ld	a, e
	ld	(ix - 3), bc
	push	ix
	ld	bc, -152
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	push	ix
	ld	bc, -155
	add	ix, bc
	ld	e, (ix)
	pop	ix
	ld	bc, (ix - 3)
	ld	(ix - 3), de
	push	ix
	ld	de, -186
	add	ix, de
	ld	(ix), bc
	pop	ix
	push	ix
	ld	de, -143
	add	ix, de
	ld	(ix), a
	pop	ix
	ld	de, (ix - 3)
	call	__lcmpu
	jr	nc, BB10_85
	ld	bc, -140
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	ld	hl, (iy - 2)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	ld	bc, -189
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	push	hl
	call	_poly_move_to_engine
	pop	hl
	pop	hl
	pop	hl
	ld	bc, -189
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	ld	a, (iy)
	cp	a, b
	jp	nz, BB10_89
BB10_85:
	ld	bc, -140
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	lea	iy, iy + 4
	push	ix
	add	ix, bc
	ld	(ix), iy
	pop	ix
	ld	bc, -149
	lea	iy, ix
	add	iy, bc
	ld	hl, (iy)
	dec	hl
	push	ix
	ld	bc, -146
	add	ix, bc
	ld	de, (ix)
	pop	ix
	jp	BB10_82
BB10_86:
	inc	de
BB10_87:
	dec	de
	push	de
	pop	hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB10_80
	ld	bc, -183
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	lea	hl, iy + 4
	push	ix
	ld	bc, -140
	add	ix, bc
	ld	(ix), hl
	pop	ix
	ld	hl, (iy)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	ld	bc, -189
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	push	hl
	ld	bc, -146
	lea	hl, ix
	add	hl, bc
	ld	(hl), de
	call	_poly_move_to_engine
	ld	bc, -146
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
	pop	hl
	pop	hl
	pop	hl
	ld	bc, -189
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	ld	a, (iy)
	cp	a, b
	ld	bc, -140
	lea	iy, ix
	push	af
	add	iy, bc
	pop	af
	ld	hl, (iy)
	push	ix
	ld	bc, -183
	push	af
	add	ix, bc
	pop	af
	ld	(ix), hl
	pop	ix
	jr	z, BB10_87
BB10_89:
	ld	bc, -189
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	ld	hl, (iy + 1)
	ld	de, (ix + 9)
	push	de
	pop	iy
	ld	(iy), a
	ld	(iy + 1), l
	ld	(iy + 2), h
	ld	a, 1
	jp	BB10_62
BB10_90:
	ld	de, 0
	push	de
	pop	iy
	push	ix
	ld	bc, -158
	add	ix, bc
	ld	a, (ix)
	pop	ix
	jp	BB10_75
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_read_be64
_read_be64:
	ld	hl, -9
	call	__frameset
	ld	iy, (ix + 6)
	ld	de, 0
	push	de
	pop	hl
	ld	l, (iy)
	ld.sis	bc, 0
	ld	iy, 56
	push	iy
	call	__llshl
	ld	(ix - 3), hl
	ld	(ix - 6), de
	ld	(ix - 9), bc
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	iy, (ix + 6)
	ld	l, (iy + 1)
	ld	de, 48
	push	de
	ld	de, 0
	ld.sis	bc, 0
	call	__llshl
	pop	iy
	ld	iy, (ix - 9)
	push	iy
	ld	iy, (ix - 6)
	push	iy
	ld	iy, (ix - 3)
	push	iy
	call	__lladd
	ld	(ix - 3), hl
	ld	(ix - 6), de
	ld	(ix - 9), bc
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	iy, (ix + 6)
	ld	l, (iy + 2)
	ld	de, 40
	push	de
	ld	de, 0
	ld.sis	bc, 0
	call	__llshl
	pop	iy
	push	bc
	push	de
	push	hl
	ld	hl, (ix - 3)
	ld	de, (ix - 6)
	ld	bc, (ix - 9)
	call	__lladd
	ld	(ix - 3), hl
	ld	(ix - 6), de
	ld	(ix - 9), bc
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	iy, (ix + 6)
	ld	l, (iy + 3)
	ld	de, 32
	push	de
	ld	de, 0
	ld.sis	bc, 0
	call	__llshl
	pop	iy
	push	bc
	push	de
	push	hl
	ld	hl, (ix - 3)
	ld	de, (ix - 6)
	ld	bc, (ix - 9)
	call	__lladd
	ld	(ix - 3), hl
	ld	(ix - 6), de
	ld	(ix - 9), bc
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	iy, (ix + 6)
	ld	l, (iy + 4)
	ld	de, 24
	push	de
	ld	de, 0
	ld.sis	bc, 0
	call	__llshl
	pop	iy
	push	bc
	push	de
	push	hl
	ld	hl, (ix - 3)
	ld	de, (ix - 6)
	ld	bc, (ix - 9)
	call	__lladd
	ld	(ix - 3), hl
	ld	(ix - 6), de
	ld	(ix - 9), bc
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	iy, (ix + 6)
	ld	l, (iy + 5)
	ld	de, 16
	push	de
	ld	de, 0
	ld.sis	bc, 0
	call	__llshl
	pop	iy
	push	bc
	push	de
	push	hl
	ld	hl, (ix - 3)
	ld	de, (ix - 6)
	ld	bc, (ix - 9)
	call	__lladd
	ld	(ix - 3), hl
	ld	(ix - 6), de
	ld	(ix - 9), bc
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	iy, (ix + 6)
	ld	l, (iy + 6)
	ld	de, 8
	push	de
	ld	de, 0
	ld.sis	bc, 0
	call	__llshl
	pop	iy
	push	bc
	push	de
	push	hl
	ld	hl, (ix - 3)
	ld	de, (ix - 6)
	ld	bc, (ix - 9)
	call	__llor
	ld	(ix - 3), hl
	ld	(ix - 6), de
	pop	iy
	pop	iy
	pop	iy
	ld	de, 0
	ld	iy, (ix + 6)
	ld	e, (iy + 7)
	or	a, a
	sbc	hl, hl
	push	hl
	push	hl
	push	de
	ld	hl, (ix - 3)
	ld	de, (ix - 6)
	call	__llor
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_poly_move_to_engine
_poly_move_to_engine:
	ld	hl, -809
	call	__frameset
	ld	bc, -788
	lea	iy, ix
	add	iy, bc
	ld	de, (ix + 12)
	ld	c, 6
	ld	(ix - 3), bc
	ld	bc, -794
	lea	hl, ix
	add	hl, bc
	ld	(hl), iy
	lea	hl, iy + 14
	ld	bc, -791
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	ld	a, e
	and	a, 7
	ld	bc, -796
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	ld	l, e
	ld	h, d
	ld	bc, (ix - 3)
	call	__sshru
	ld.sis	bc, 7
	call	__sand
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	ld	c, 12
	ld	l, e
	ld	h, d
	call	__sshru
	ld	a, l
	and	a, 7
	ld	(ix - 3), bc
	ld	bc, -795
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	ld	a, e
	ld	bc, (ix - 3)
	ld	b, 3
	call	__bshru
	cpl
	and	a, 7
	ld	(ix - 3), de
	push	ix
	ld	de, -799
	add	ix, de
	ld	(ix), a
	pop	ix
	ld	c, 5
	ld	de, (ix - 3)
	ld	l, e
	ld	h, d
	call	__sshru
	ld	a, l
	and	a, 112
	add	a, iyl
	xor	a, 112
	ld	e, a
	ld	bc, 0
	ld	c, e
	ld	hl, (ix + 9)
	add	hl, bc
	ld	a, (hl)
	and	a, 7
	cp	a, 6
	jr	nz, BB12_4
	ld	(ix - 3), de
	ld	de, -799
	lea	hl, ix
	add	hl, de
	ld	c, (hl)
	ld	b, 4
	push	ix
	ld	de, -802
	add	ix, de
	ld	(ix), iy
	pop	ix
	ld	a, iyl
	cp	a, b
	ld	de, -796
	lea	iy, ix
	push	af
	add	iy, de
	pop	af
	ld	l, (iy)
	ld	de, (ix - 3)
	jr	nz, BB12_6
	ld	a, l
	cp	a, 7
	jr	nz, BB12_6
	ld	a, c
	call	__bshl
	add	a, 6
	ld	(ix - 3), bc
	ld	bc, -796
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	jr	BB12_5
BB12_4:
	ld	bc, -799
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	ld	b, 4
	call	__bshl
	ld	(ix - 3), bc
	ld	bc, -796
	lea	iy, ix
	add	iy, bc
	add	a, (iy)
	push	ix
	add	ix, bc
	ld	(ix), a
	pop	ix
BB12_5:
	ld	bc, (ix - 3)
	jr	BB12_11
BB12_6:
	ld	a, c
	call	__bshl
	ld	h, a
	ld	(ix - 3), de
	ld	de, -802
	lea	iy, ix
	add	iy, de
	ld	bc, (iy)
	ld	a, c
	cp	a, 4
	ld	de, (ix - 3)
	jr	nz, BB12_9
	ld	a, l
	or	a, a
	jr	nz, BB12_9
	ld	a, h
	add	a, 2
	jr	BB12_10
BB12_9:
	ld	a, h
	add	a, l
BB12_10:
	ld	bc, -796
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
BB12_11:
	ld	bc, -794
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	lea	hl, iy
	ld	bc, -805
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	ld	bc, -791
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	push	hl
	push	de
	ld	hl, (ix + 9)
	push	hl
	call	_generate_moves_from
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	push	hl
	pop	de
	ld	bc, -795
	lea	iy, ix
	add	iy, bc
	ld	e, (iy)
	push	ix
	ld	bc, -808
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	l, a
	ld	bc, 3
	call	__imulu
	push	ix
	ld	de, -794
	add	ix, de
	ld	(ix), hl
	pop	ix
	ld	de, 0
BB12_12:
	ld	(ix - 3), bc
	ld	bc, -794
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	or	a, a
	sbc	hl, de
	ld	bc, (ix - 3)
	jp	z, BB12_20
	ld	(ix - 3), bc
	ld	bc, -791
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	push	ix
	ld	bc, -802
	add	ix, bc
	ld	(ix), de
	pop	ix
	add	iy, de
	ld	a, (iy + 1)
	push	ix
	ld	de, -796
	add	ix, de
	ld	l, (ix)
	pop	ix
	cp	a, l
	ld	bc, (ix - 3)
	jp	nz, BB12_19
	ld	de, -799
	lea	hl, ix
	add	hl, de
	ld	(hl), iy
	ld	l, (iy + 2)
	ld	de, -795
	lea	iy, ix
	add	iy, de
	ld	a, (iy)
	or	a, a
	jr	nz, BB12_16
	bit	3, l
	ld	de, -799
	lea	hl, ix
	push	af
	add	hl, de
	pop	af
	ld	iy, (hl)
	jr	z, BB12_18
	jp	BB12_19
BB12_16:
	bit	3, l
	ld	de, -799
	lea	iy, ix
	push	af
	add	iy, de
	pop	af
	ld	iy, (iy)
	jp	z, BB12_19
	ld	a, l
	and	a, 48
	ld	hl, _poly_move_to_engine.promo_flags
	ld	(ix - 3), bc
	ld	bc, -808
	lea	iy, ix
	add	iy, bc
	ld	de, (iy)
	add	hl, de
	ld	l, (hl)
	cp	a, l
	ld	bc, (ix - 3)
	jp	nz, BB12_19
BB12_18:
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	bc, -799
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	bc, -805
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, (ix + 9)
	push	hl
	call	_board_make
	pop	hl
	pop	hl
	pop	hl
	ld	iy, (ix + 9)
	lea	hl, iy
	ld	de, 294
	add	hl, de
	ld	c, (hl)
	ld	a, c
	xor	a, d
	ld	de, 0
	ld	e, a
	lea	hl, iy
	add	hl, de
	ld	de, 292
	add	hl, de
	ld	a, (hl)
	ld	l, c
	push	hl
	ld	l, a
	push	hl
	push	iy
	call	_is_square_attacked
	ld	bc, -809
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	pop	hl
	pop	hl
	pop	hl
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	bc, -799
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	bc, -805
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, (ix + 9)
	push	hl
	call	_board_unmake
	ld	bc, 3
	pop	hl
	pop	hl
	pop	hl
	ld	de, -809
	lea	hl, ix
	add	hl, de
	ld	a, (hl)
	or	a, a
	jr	z, BB12_22
BB12_19:
	ld	de, -802
	lea	hl, ix
	add	hl, de
	ld	hl, (hl)
	add	hl, bc
	ex	de, hl
	jp	BB12_12
BB12_20:
	ld	iy, (ix + 6)
	ld	(iy), -1
	ld	(iy + 1), -1
	ld	(iy + 2), 0
BB12_21:
	lea	hl, iy
	ld	sp, ix
	pop	ix
	ret
BB12_22:
	ld	bc, -791
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	push	ix
	ld	bc, -802
	add	ix, bc
	ld	de, (ix)
	pop	ix
	add	iy, de
	ld	a, (iy)
	ld	hl, (ix + 6)
	push	hl
	pop	de
	ld	(hl), a
	ld	a, (iy + 1)
	lea	hl, iy
	push	de
	pop	iy
	ld	(iy + 1), a
	push	hl
	pop	iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	jr	BB12_21
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_book_close
_book_close:
	xor	a, a
	sbc	hl, hl
	ld	(_book_ready), a
	ld	(_num_segments), a
	ld	(_total_entries), hl
	ld	(_total_entries+3), a
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_init
_engine_init:
	call	__frameset0
	ld	iy, (ix + 6)
	lea	hl, iy
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	nz, BB14_2
	ld	hl, 0
	ld	(_engine_hooks), hl
	jr	BB14_3
BB14_2:
	ld	hl, _engine_hooks
	ld	a, (iy)
	ld	(hl), a
	ld	a, (iy + 1)
	ld	(_engine_hooks+1), a
	ld	a, (iy + 2)
	ld	(_engine_hooks+2), a
BB14_3:
	call	_search_init
	ld	hl, _engine_board
	push	hl
	call	_board_init
	pop	hl
	pop	ix
	jp	_book_init
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_new_game
_engine_new_game:
	call	_search_init
	ld	hl, _engine_board
	push	hl
	call	_board_startpos
	pop	hl
	ld	hl, (_engine_board+300)
	ld	a, (_engine_board+303)
	ld	e, a
	push	de
	push	hl
	call	_search_history_push
	pop	hl
	pop	hl
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_set_position
_engine_set_position:
	call	__frameset0
	ld	iy, (ix + 6)
	ld	a, (iy + 64)
	ld	e, (iy + 65)
	ld	c, (iy + 66)
	ld	d, (iy + 67)
	ld	b, (iy + 68)
	ld	hl, (iy + 69)
	push	hl
	ld	l, b
	push	hl
	ld	l, d
	push	hl
	ld	l, c
	push	hl
	ld	l, e
	push	hl
	ld	l, a
	push	hl
	push	iy
	ld	hl, _engine_board
	push	hl
	call	_board_set_from_ui
	ld	hl, 24
	add	hl, sp
	ld	sp, hl
	ld.sis	hl, 0
	ld	e, l
	ld	d, h
	ld	hl, _pos_history_count
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	hl, _pos_history_irreversible
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	hl, (_engine_board+300)
	ld	a, (_engine_board+303)
	ld	e, a
	push	de
	push	hl
	call	_search_history_push
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_get_position
_engine_get_position:
	ld	hl, -9
	call	__frameset
	ld	iy, (ix + 6)
	ld	hl, _engine_board
	ld	(ix - 3), hl
	ld	de, 0
	ld	bc, 8
	ld	(ix - 6), iy
BB17_1:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jr	z, BB17_10
	ld	(ix - 9), de
	ld	bc, 0
BB17_3:
	push	bc
	pop	hl
	ld	de, 8
	or	a, a
	sbc	hl, de
	jr	z, BB17_9
	ld	iy, (ix - 3)
	add	iy, bc
	ld	l, (iy)
	ld	a, l
	and	a, 7
	ld	h, a
	neg
	ld	iyl, a
	ld	a, l
	cp	a, 0
	call	pe, __setflag
	jp	m, BB17_6
	ex	de, hl
	ld	iyl, d
	ex	de, hl
BB17_6:
	ld	a, l
	or	a, a
	ld	a, 0
	jr	z, BB17_8
	ld	a, iyl
BB17_8:
	ld	iy, (ix - 6)
	add	iy, bc
	ld	(iy), a
	inc	bc
	jr	BB17_3
BB17_9:
	ld	de, (ix - 9)
	inc	de
	ld	iy, (ix - 3)
	lea	iy, iy + 16
	ld	(ix - 3), iy
	ld	iy, (ix - 6)
	lea	iy, iy + 8
	ld	(ix - 6), iy
	ld	bc, 8
	jr	BB17_1
BB17_10:
	ld	a, (_engine_board+294)
	or	a, a
	ld	h, -1
	ld	a, 1
	jr	z, BB17_12
	ld	a, h
BB17_12:
	ld	iy, (ix + 6)
	ld	(iy + 64), a
	ld	a, (_engine_board+295)
	ld	(iy + 65), a
	ld	a, (_engine_board+296)
	ld	l, a
	cp	a, -1
	jr	z, BB17_14
	ld	c, 0
	jr	BB17_15
BB17_14:
	ld	c, -1
BB17_15:
	ld	a, l
	ld	b, 4
	call	__bshru
	ld	e, a
	ld	a, l
	and	a, 7
	bit	0, c
	ld	l, h
	jr	nz, BB17_17
	ld	l, e
BB17_17:
	bit	0, c
	jr	nz, BB17_19
	ld	h, a
BB17_19:
	ld	iy, (ix + 6)
	ld	(iy + 66), l
	ld	(iy + 67), h
	ld	a, (_engine_board+297)
	ld	(iy + 68), a
	ld	hl, _engine_board+298
	ld	hl, (hl)
	ld	(iy + 69), l
	ld	(iy + 70), h
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_get_moves_from
_engine_get_moves_from:
	ld	hl, -805
	call	__frameset
	ld	de, -788
	lea	iy, ix
	add	iy, de
	ld	c, (ix + 9)
	ld	b, 4
	xor	a, a
	dec	de
	lea	hl, ix
	add	hl, de
	ld	(hl), a
	lea	hl, iy + 14
	lea	de, iy
	ld	(ix - 3), bc
	ld	bc, -792
	lea	iy, ix
	add	iy, bc
	ld	(iy), de
	ld	a, (ix + 6)
	ld	bc, (ix - 3)
	call	__bshl
	add	a, c
	ld	c, a
	push	ix
	ld	de, -795
	add	ix, de
	ld	(ix), hl
	pop	ix
	push	hl
	push	bc
	ld	hl, _engine_board
	push	hl
	call	_generate_moves_from
	ld	iy, 0
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
BB18_1:
	push	bc
	pop	hl
	lea	de, iy
	or	a, a
	sbc	hl, de
	jp	z, BB18_6
	ld	de, -789
	lea	hl, ix
	add	hl, de
	ld	a, (hl)
	ld	l, (ix + 15)
	cp	a, l
	jp	nc, BB18_6
	ld	de, -801
	lea	hl, ix
	add	hl, de
	ld	(hl), bc
	lea	de, iy
	lea	bc, iy
	ld	(ix - 3), bc
	ld	bc, -795
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	add	iy, de
	push	hl
	push	hl
	ld	bc, (ix - 3)
	push	ix
	ld	de, -798
	add	ix, de
	ld	(ix), bc
	pop	ix
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	a, (iy)
	push	de
	pop	hl
	ld	(hl), a
	ld	a, (iy + 1)
	lea	hl, iy
	push	de
	pop	iy
	ld	(iy + 1), a
	push	hl
	pop	iy
	ld	bc, -804
	lea	hl, ix
	add	hl, bc
	ld	(hl), iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	push	ix
	ld	bc, -792
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	call	_board_make
	pop	hl
	pop	hl
	pop	hl
	call	_board_is_legal
	or	a, a
	jp	z, BB18_5
	or	a, a
	sbc	hl, hl
	ld	de, -789
	lea	iy, ix
	add	iy, de
	ld	a, (iy)
	ld	l, a
	inc	a
	push	ix
	add	ix, de
	ld	(ix), a
	pop	ix
	ld	bc, 5
	call	__imulu
	push	hl
	pop	de
	ld	hl, (ix + 12)
	add	hl, de
	ld	(ix - 3), bc
	push	ix
	ld	bc, -798
	add	ix, bc
	ld	de, (ix)
	pop	ix
	push	ix
	ld	bc, -795
	add	ix, bc
	ld	iy, (ix)
	pop	ix
	add	iy, de
	ld	e, (iy)
	ld	bc, (ix - 3)
	ld	c, (iy + 1)
	ld	a, (iy + 2)
	ld	(ix - 3), bc
	ld	bc, -805
	lea	iy, ix
	add	iy, bc
	ld	(iy), a
	ld	a, e
	ld	bc, (ix - 3)
	ld	b, 4
	call	__bshru
	ld	d, a
	ld	a, e
	and	a, 7
	ld	e, a
	ld	a, c
	call	__bshru
	ld	b, a
	ld	a, c
	and	a, 7
	push	hl
	pop	iy
	ld	(iy), d
	ld	(iy + 1), e
	ld	(iy + 2), b
	ld	(iy + 3), a
	ld	bc, -805
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	ld	(iy + 4), a
BB18_5:
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	bc, -804
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
	push	de
	pop	hl
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	bc, -792
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
	ld	de, 3
	ld	bc, -798
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	add	iy, de
	push	ix
	ld	de, -801
	add	ix, de
	ld	bc, (ix)
	pop	ix
	jp	BB18_1
BB18_6:
	ld	bc, -789
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_board_is_legal
_board_is_legal:
	ld	iy, _engine_board
	ld	a, (_engine_board+294)
	ld	e, a
	xor	a, 1
	ld	bc, 0
	ld	c, a
	ld	hl, _engine_board+292
	add	hl, bc
	ld	a, (hl)
	push	de
	ld	l, a
	push	hl
	push	iy
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jr	z, BB19_2
	ld	a, 0
	ret
BB19_2:
	ld	a, 1
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_get_all_moves
_engine_get_all_moves:
	ld	hl, -805
	call	__frameset
	ld	bc, -788
	lea	iy, ix
	add	iy, bc
	ld	hl, _engine_board
	xor	a, a
	push	ix
	dec	bc
	add	ix, bc
	ld	(ix), a
	pop	ix
	lea	de, iy + 14
	lea	bc, iy
	ld	(ix - 3), de
	ld	de, -792
	lea	iy, ix
	add	iy, de
	ld	(iy), bc
	ld	bc, 0
	push	bc
	ld	de, (ix - 3)
	push	ix
	ld	bc, -795
	add	ix, bc
	ld	(ix), de
	pop	ix
	push	de
	push	hl
	call	_generate_moves
	ld	iy, 0
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
BB20_1:
	push	bc
	pop	hl
	lea	de, iy
	or	a, a
	sbc	hl, de
	jp	z, BB20_6
	ld	de, -789
	lea	hl, ix
	add	hl, de
	ld	a, (hl)
	ld	l, (ix + 9)
	cp	a, l
	jp	nc, BB20_6
	ld	de, -801
	lea	hl, ix
	add	hl, de
	ld	(hl), bc
	lea	de, iy
	lea	bc, iy
	ld	(ix - 3), bc
	ld	bc, -795
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	add	iy, de
	push	hl
	push	hl
	ld	bc, (ix - 3)
	push	ix
	ld	de, -798
	add	ix, de
	ld	(ix), bc
	pop	ix
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	a, (iy)
	push	de
	pop	hl
	ld	(hl), a
	ld	a, (iy + 1)
	lea	hl, iy
	push	de
	pop	iy
	ld	(iy + 1), a
	push	hl
	pop	iy
	ld	bc, -804
	lea	hl, ix
	add	hl, bc
	ld	(hl), iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	push	ix
	ld	bc, -792
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	call	_board_make
	pop	hl
	pop	hl
	pop	hl
	call	_board_is_legal
	or	a, a
	jp	z, BB20_5
	or	a, a
	sbc	hl, hl
	ld	de, -789
	lea	iy, ix
	add	iy, de
	ld	a, (iy)
	ld	l, a
	inc	a
	push	ix
	add	ix, de
	ld	(ix), a
	pop	ix
	ld	bc, 5
	call	__imulu
	push	hl
	pop	de
	ld	hl, (ix + 6)
	add	hl, de
	ld	(ix - 3), bc
	push	ix
	ld	bc, -798
	add	ix, bc
	ld	de, (ix)
	pop	ix
	push	ix
	ld	bc, -795
	add	ix, bc
	ld	iy, (ix)
	pop	ix
	add	iy, de
	ld	e, (iy)
	ld	bc, (ix - 3)
	ld	c, (iy + 1)
	ld	a, (iy + 2)
	ld	(ix - 3), bc
	ld	bc, -805
	lea	iy, ix
	add	iy, bc
	ld	(iy), a
	ld	a, e
	ld	bc, (ix - 3)
	ld	b, 4
	call	__bshru
	ld	d, a
	ld	a, e
	and	a, 7
	ld	e, a
	ld	a, c
	call	__bshru
	ld	b, a
	ld	a, c
	and	a, 7
	push	hl
	pop	iy
	ld	(iy), d
	ld	(iy + 1), e
	ld	(iy + 2), b
	ld	(iy + 3), a
	ld	bc, -805
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	ld	(iy + 4), a
BB20_5:
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	bc, -804
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
	push	de
	pop	hl
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	bc, -792
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
	ld	de, 3
	ld	bc, -798
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	add	iy, de
	push	ix
	ld	de, -801
	add	ix, de
	ld	bc, (ix)
	pop	ix
	jp	BB20_1
BB20_6:
	ld	bc, -789
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_is_legal_move
_engine_is_legal_move:
	ld	hl, -797
	call	__frameset
	ld	b, 4
	xor	a, a
	ld	de, -792
	lea	hl, ix
	add	hl, de
	ld	(hl), a
	lea	hl, ix - 20
	ld	de, -796
	lea	iy, ix
	add	iy, de
	ld	(iy), hl
	ld	de, -788
	lea	hl, ix
	add	hl, de
	ld	a, (ix + 6)
	ld	e, (ix + 7)
	ld	c, (ix + 8)
	ld	d, (ix + 9)
	ld	iyl, d
	ld	d, (ix + 10)
	ld	(ix - 3), bc
	push	ix
	ld	bc, -797
	add	ix, bc
	ld	(ix), d
	pop	ix
	ld	bc, (ix - 3)
	call	__bshl
	add	a, e
	ld	e, a
	ld	a, c
	call	__bshl
	add	a, iyl
	ld	(ix - 3), bc
	push	ix
	ld	bc, -793
	add	ix, bc
	ld	(ix), a
	pop	ix
	push	ix
	ld	bc, -791
	add	ix, bc
	ld	(ix), hl
	pop	ix
	push	hl
	push	de
	ld	hl, _engine_board
	push	hl
	ld	bc, (ix - 3)
	call	_generate_moves_from
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	bc, 3
	call	__imulu
	ld	bc, 0
	push	hl
	pop	de
BB21_1:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jp	z, BB21_6
	ld	(ix - 3), de
	ld	de, -791
	lea	hl, ix
	add	hl, de
	ld	iy, (hl)
	add	iy, bc
	ld	a, (iy + 1)
	push	ix
	ld	de, -793
	add	ix, de
	ld	l, (ix)
	pop	ix
	cp	a, l
	ld	de, (ix - 3)
	jr	nz, BB21_4
	ld	a, (iy + 2)
	ld	(ix - 3), bc
	ld	bc, -797
	lea	hl, ix
	add	hl, bc
	xor	a, (hl)
	and	a, 56
	or	a, a
	ld	bc, (ix - 3)
	jr	z, BB21_5
BB21_4:
	push	bc
	pop	hl
	ld	bc, 3
	add	hl, bc
	push	hl
	pop	bc
	jr	BB21_1
BB21_5:
	ld	de, -791
	lea	hl, ix
	add	hl, de
	ld	hl, (hl)
	add	hl, bc
	ld	bc, -791
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	bc, -796
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	call	_board_make
	pop	hl
	pop	hl
	pop	hl
	call	_board_is_legal
	ld	bc, -792
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	push	ix
	inc	bc
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	bc, -796
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
BB21_6:
	ld	bc, -792
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_get_move_effects
_engine_get_move_effects:
	call	__frameset0
	ld	iy, (ix + 12)
	ld	e, 0
	ld	(iy), e
	ld	(iy + 5), e
	ld	l, (ix + 10)
	bit	1, l
	jp	z, BB22_7
	ld	(iy), 1
	ld	a, (ix + 6)
	ld	(iy + 1), a
	ld	(iy + 3), a
	ld	c, (ix + 9)
	ld	a, (ix + 7)
	cp	a, c
	sbc	a, a
	bit	0, a
	jr	z, BB22_3
	ld	e, 7
BB22_3:
	bit	0, a
	jr	nz, BB22_5
	ld	a, 3
	jr	BB22_6
BB22_5:
	ld	a, 5
BB22_6:
	ld	(iy + 2), e
	ld	(iy + 4), a
BB22_7:
	bit	2, l
	jr	z, BB22_9
	ld	(iy + 5), 1
	ld	a, (ix + 6)
	ld	(iy + 6), a
	ld	a, (ix + 9)
	ld	(iy + 7), a
BB22_9:
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_make_move
_engine_make_move:
	ld	hl, -808
	call	__frameset
	ld	de, -788
	lea	iy, ix
	add	iy, de
	ld	b, 4
	lea	hl, iy + 14
	push	ix
	ld	de, -802
	add	ix, de
	ld	(ix), iy
	pop	ix
	lea	de, iy
	ld	(ix - 3), bc
	ld	bc, -798
	lea	iy, ix
	add	iy, bc
	ld	(iy), de
	ld	a, (ix + 6)
	ld	e, (ix + 7)
	ld	bc, (ix - 3)
	ld	c, (ix + 8)
	ld	d, (ix + 9)
	ld	iyl, d
	ld	d, (ix + 10)
	ld	(ix - 3), bc
	push	ix
	ld	bc, -794
	add	ix, bc
	ld	(ix), d
	pop	ix
	ld	bc, (ix - 3)
	call	__bshl
	add	a, e
	ld	e, a
	ld	a, c
	call	__bshl
	add	a, iyl
	ld	(ix - 3), bc
	push	ix
	ld	bc, -795
	add	ix, bc
	ld	(ix), a
	pop	ix
	push	ix
	ld	bc, -791
	add	ix, bc
	ld	(ix), hl
	pop	ix
	push	hl
	push	de
	ld	hl, _engine_board
	push	hl
	ld	bc, (ix - 3)
	call	_generate_moves_from
	ld	iy, 0
	ld	e, a
	pop	hl
	pop	hl
	pop	hl
	ld	bc, -794
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	and	a, 48
	push	ix
	ld	bc, -799
	add	ix, bc
	ld	(ix), a
	pop	ix
	or	a, a
	sbc	hl, hl
	ld	l, e
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
BB23_1:
	push	bc
	pop	hl
	lea	de, iy
	or	a, a
	sbc	hl, de
	jp	z, BB23_8
	lea	de, iy
	lea	hl, iy
	ld	(ix - 3), bc
	ld	bc, -791
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	add	iy, de
	push	ix
	ld	de, -794
	add	ix, de
	ld	(ix), iy
	pop	ix
	ld	a, (iy + 1)
	push	hl
	pop	iy
	dec	de
	lea	hl, ix
	add	hl, de
	ld	l, (hl)
	cp	a, l
	ld	bc, (ix - 3)
	jp	nz, BB23_7
	lea	de, iy
	ld	(ix - 3), bc
	ld	bc, -805
	lea	hl, ix
	add	hl, bc
	ld	(hl), iy
	ld	bc, -791
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	add	iy, de
	ld	l, (iy + 2)
	ld	de, -805
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	ld	a, l
	and	a, 48
	bit	3, l
	ld	bc, (ix - 3)
	jr	z, BB23_5
	ld	de, -799
	lea	hl, ix
	add	hl, de
	ld	l, (hl)
	cp	a, l
	jp	nz, BB23_7
BB23_5:
	ld	de, -808
	lea	hl, ix
	add	hl, de
	ld	(hl), bc
	push	hl
	push	hl
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	bc, -794
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy)
	push	de
	pop	hl
	ld	(hl), a
	ld	a, (iy + 1)
	lea	hl, iy
	push	de
	pop	iy
	ld	(iy + 1), a
	push	hl
	pop	iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	ld	bc, -798
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	call	_board_make
	pop	hl
	pop	hl
	pop	hl
	call	_board_is_legal
	or	a, a
	jr	nz, BB23_10
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	bc, -794
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
	push	de
	pop	hl
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	bc, -798
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
	ld	de, -805
	lea	hl, ix
	add	hl, de
	ld	iy, (hl)
	push	ix
	ld	de, -808
	add	ix, de
	ld	bc, (ix)
	pop	ix
BB23_7:
	ld	de, 3
	add	iy, de
	jp	BB23_1
BB23_8:
	xor	a, a
BB23_9:
	ld	sp, ix
	pop	ix
	ret
BB23_10:
	ld	bc, -802
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	ld	a, (iy + 12)
	and	a, 7
	cp	a, 1
	jr	z, BB23_12
	ld	a, (iy + 13)
	and	a, 1
	bit	0, a
	jr	z, BB23_13
BB23_12:
	ld	hl, _pos_history_count
	ld	hl, (hl)
	ld	iy, _pos_history_irreversible
	ld	(iy), l
	ld	(iy + 1), h
BB23_13:
	ld	hl, (_engine_board+300)
	ld	a, (_engine_board+303)
	ld	e, a
	push	de
	push	hl
	call	_search_history_push
	pop	hl
	pop	hl
	call	_compute_status
	jr	BB23_9
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_compute_status
_compute_status:
	ld	hl, -804
	call	__frameset
	ld	iy, 0
	ld	a, (_engine_board+297)
	cp	a, 100
	jr	c, BB24_2
	ld	b, 4
	jp	BB24_22
BB24_2:
	ld	de, -794
	lea	hl, ix
	add	hl, de
	ld	(hl), iy
	ld	b, 6
	ld	a, (_engine_board+288)
	ld	c, a
	ld	a, (_engine_board+289)
	ld	de, -791
	lea	iy, ix
	add	iy, de
	ld	(iy), a
	ld	a, c
	cp	a, 1
	jr	nz, BB24_4
	ld	de, -791
	lea	hl, ix
	add	hl, de
	ld	a, (hl)
	cp	a, 1
	jp	z, BB24_22
BB24_4:
	ld	a, c
	cp	a, 1
	jp	nz, BB24_9
	ld	de, -791
	lea	hl, ix
	add	hl, de
	ld	a, (hl)
	cp	a, 2
	jp	nz, BB24_9
	or	a, a
	sbc	hl, hl
	ex	de, hl
BB24_7:
	ld	(ix - 3), bc
	ld	bc, -800
	lea	hl, ix
	add	hl, bc
	ld	(hl), de
	ex	de, hl
	ld	de, 2
	or	a, a
	sbc	hl, de
	ld	bc, (ix - 3)
	jr	z, BB24_9
	ld	hl, _engine_board+144
	ld	(ix - 3), bc
	ld	bc, -800
	lea	iy, ix
	add	iy, bc
	ld	de, (iy)
	add	hl, de
	push	ix
	ld	bc, -803
	add	ix, bc
	ld	(ix), hl
	pop	ix
	or	a, a
	sbc	hl, hl
	push	ix
	ld	bc, -797
	add	ix, bc
	ld	(ix), hl
	pop	ix
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	bc, (ix - 3)
	ld	a, c
	ld	(ix - 3), de
	push	ix
	ld	de, -803
	add	ix, de
	ld	iy, (ix)
	pop	ix
	ld	l, (iy)
	ld	de, -797
	lea	iy, ix
	add	iy, de
	ld	(iy), hl
	ld	hl, _engine_board
	ld	iyl, b
	push	ix
	add	ix, de
	ld	bc, (ix)
	pop	ix
	add	hl, bc
	ld	b, iyl
	ld	c, a
	ld	a, (hl)
	and	a, 6
	ld	de, (ix - 3)
	inc	de
	cp	a, 2
	jp	nz, BB24_7
	jp	BB24_22
BB24_9:
	ld	a, c
	cp	a, 2
	jr	nz, BB24_14
	ld	de, -791
	lea	hl, ix
	add	hl, de
	ld	a, (hl)
	cp	a, 1
	jr	nz, BB24_14
	ld	iy, _engine_board+128
BB24_12:
	ld	de, -794
	lea	hl, ix
	add	hl, de
	ld	hl, (hl)
	ld	de, 2
	or	a, a
	sbc	hl, de
	jr	z, BB24_14
	lea	hl, iy
	ld	(ix - 3), bc
	ld	bc, -794
	lea	iy, ix
	add	iy, bc
	ld	de, (iy)
	add	hl, de
	ld	de, 0
	ld	e, (hl)
	ld	hl, _engine_board
	ld	iy, _engine_board+128
	add	hl, de
	ld	a, (hl)
	and	a, 6
	ld	de, -794
	lea	hl, ix
	add	hl, de
	ld	hl, (hl)
	inc	hl
	push	ix
	add	ix, de
	ld	(ix), hl
	pop	ix
	cp	a, 2
	ld	bc, (ix - 3)
	jr	nz, BB24_12
	jp	BB24_22
BB24_14:
	ld	bc, -788
	lea	iy, ix
	add	iy, bc
	lea	hl, iy + 14
	push	ix
	ld	bc, -791
	add	ix, bc
	ld	(ix), hl
	pop	ix
	lea	hl, iy
	ld	bc, -794
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	ld	a, (_engine_board+294)
	ld	de, 0
	ld	e, a
	ld	hl, _engine_board+292
	add	hl, de
	ld	l, (hl)
	xor	a, 1
	ld	e, a
	push	de
	push	hl
	ld	hl, _engine_board
	push	hl
	call	_is_square_attacked
	ld	bc, -797
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	push	hl
	ld	bc, -791
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	push	hl
	ld	hl, _engine_board
	push	hl
	call	_generate_moves
	pop	hl
	pop	hl
	pop	hl
	ld	de, 0
	ld	e, a
	inc	de
BB24_15:
	dec	de
	push	de
	pop	hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB24_19
	ld	bc, -791
	lea	hl, ix
	add	hl, bc
	ld	iy, (hl)
	lea	hl, iy + 3
	ld	bc, -803
	lea	iy, ix
	add	iy, bc
	ld	(iy), hl
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	bc, -791
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	bc, -794
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	ld	bc, -800
	lea	hl, ix
	add	hl, bc
	ld	(hl), de
	call	_board_make
	pop	hl
	pop	hl
	pop	hl
	call	_board_is_legal
	ld	bc, -804
	lea	hl, ix
	add	hl, bc
	ld	(hl), a
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	push	ix
	ld	bc, -791
	add	ix, bc
	ld	hl, (ix)
	pop	ix
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	bc, -794
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	(iy + 3), hl
	ld	hl, _engine_board
	push	hl
	call	_board_unmake
	ld	bc, -800
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
	pop	hl
	pop	hl
	pop	hl
	ld	bc, -804
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	or	a, a
	inc	bc
	lea	iy, ix
	push	af
	add	iy, bc
	pop	af
	ld	hl, (iy)
	push	ix
	ld	bc, -791
	push	af
	add	ix, bc
	pop	af
	ld	(ix), hl
	pop	ix
	jp	z, BB24_15
	ld	bc, -797
	lea	hl, ix
	add	hl, bc
	ld	a, (hl)
	or	a, a
	jr	nz, BB24_21
	ld	b, 0
	jr	BB24_22
BB24_19:
	ld	de, -797
	lea	hl, ix
	add	hl, de
	ld	a, (hl)
	or	a, a
	ld	b, 3
	jr	z, BB24_22
	ld	b, 2
	jr	BB24_22
BB24_21:
	ld	b, 1
BB24_22:
	ld	a, b
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_set_max_nodes
_engine_set_max_nodes:
	call	__frameset0
	ld	hl, (ix + 6)
	ld	a, (ix + 9)
	ld	(_engine_max_nodes), hl
	ld	(_engine_max_nodes+3), a
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_think
_engine_think:
	ld	hl, -25
	call	__frameset
	ld	hl, _engine_board
	pea	ix - 15
	push	hl
	call	_book_probe
	pop	hl
	pop	hl
	or	a, a
	jr	nz, BB26_3
	ld	a, (ix + 9)
	ld	hl, (ix + 12)
	ld	e, (ix + 15)
	ld	(ix - 12), a
	ld	(ix - 11), hl
	ld	(ix - 8), e
	ld	hl, (_engine_max_nodes)
	ld	a, (_engine_max_nodes+3)
	ld	(ix - 7), hl
	ld	(ix - 4), a
	ld	hl, (_engine_hooks)
	ld	(ix - 3), hl
	pea	ix - 12
	ld	hl, _engine_board
	push	hl
	pea	ix - 25
	call	_search_go
	pop	hl
	pop	hl
	pop	hl
	ld	e, (ix - 25)
	ld	a, e
	cp	a, -1
	ld	iy, (ix + 6)
	jr	nz, BB26_4
	ld	(iy), -1
	or	a, a
	sbc	hl, hl
	ld	(iy + 1), hl
	ld	(iy + 4), h
	jr	BB26_6
BB26_3:
	ld	e, (ix - 15)
	ld	l, (ix - 14)
	ld	c, (ix - 13)
	ld	a, e
	ld	b, 4
	call	__bshru
	ld	iy, (ix + 6)
	jr	BB26_5
BB26_4:
	ld	l, (ix - 24)
	ld	c, (ix - 23)
	ld	a, e
	ld	b, 4
	call	__bshru
BB26_5:
	ld	(iy), a
	ld	a, e
	and	a, 7
	ld	(iy + 1), a
	ld	a, l
	call	__bshru
	ld	(iy + 2), a
	ld	a, l
	and	a, 7
	ld	(iy + 3), a
	ld	(iy + 4), c
BB26_6:
	lea	hl, iy
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_bench
_engine_bench:
	ld	hl, -22
	call	__frameset
	ld	a, (ix + 9)
	ld	de, (ix + 12)
	ld	c, (ix + 15)
	or	a, a
	sbc	hl, hl
	ld	iy, _engine_board
	ld	(ix - 12), a
	ld	(ix - 11), de
	ld	(ix - 8), c
	ld	(ix - 7), hl
	ld	(ix - 4), h
	ld	hl, (_engine_hooks)
	ld	(ix - 3), hl
	pea	ix - 12
	push	iy
	pea	ix - 22
	call	_search_go
	pop	hl
	pop	hl
	pop	hl
	ld	a, (ix - 17)
	ld	hl, (ix - 16)
	ld	e, (ix - 13)
	ld	iy, (ix + 6)
	ld	(iy), hl
	ld	(iy + 3), e
	ld	(iy + 4), a
	lea	hl, iy
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_get_status
_engine_get_status:
	jp	_compute_status
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_in_check
_engine_in_check:
	ld	bc, _engine_board
	ld	a, (_engine_board+294)
	ld	de, 0
	ld	e, a
	ld	hl, _engine_board+292
	add	hl, de
	ld	l, (hl)
	xor	a, 1
	ld	e, a
	push	de
	push	hl
	push	bc
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_engine_cleanup
_engine_cleanup:
	xor	a, a
	sbc	hl, hl
	ld	(_book_ready), a
	ld	(_num_segments), a
	ld	(_total_entries), hl
	ld	(_total_entries+3), a
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_evaluate
_evaluate:
	ld	hl, -60
	call	__frameset
	ld	bc, (ix + 6)
	ld	de, 306
	push	bc
	pop	hl
	add	hl, de
	ld	hl, (hl)
	ld	de, 308
	push	bc
	pop	iy
	add	iy, de
	ld	de, (iy)
	or	a, a
	sbc.sis	hl, de
	ld	(ix - 19), hl
	ld	de, 310
	push	bc
	pop	hl
	add	hl, de
	ld	hl, (hl)
	ld	de, 312
	push	bc
	pop	iy
	add	iy, de
	ld	bc, (iy)
	or	a, a
	sbc.sis	hl, bc
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	ld	bc, 290
	ld	hl, (ix + 6)
	add	hl, bc
	ld	a, (hl)
	cp	a, 2
	ccf
	sbc	a, a
	ld	hl, (ix - 19)
	ld.sis	de, 30
	add.sis	hl, de
	ld	(ix - 22), iy
	ld.sis	de, 50
	add.sis	iy, de
	ld	c, iyl
	ld	b, iyh
	bit	0, a
	jr	nz, BB31_2
	ld	bc, (ix - 22)
BB31_2:
	bit	0, a
	jr	nz, BB31_4
	ld	hl, (ix - 19)
BB31_4:
	ld	de, 291
	ld	iy, (ix + 6)
	add	iy, de
	ld	a, (iy)
	cp	a, 2
	ccf
	sbc	a, a
	ld	(ix - 22), hl
	ld.sis	de, -30
	add.sis	hl, de
	ld	(ix - 19), hl
	ld	iyl, c
	ld	iyh, b
	ld.sis	de, -50
	add.sis	iy, de
	bit	0, a
	jr	nz, BB31_6
	ld	iyl, c
	ld	iyh, b
BB31_6:
	bit	0, a
	jp	nz, BB31_8
	ld	hl, (ix - 22)
	ld	(ix - 19), hl
BB31_8:
	ld	de, 294
	ld	bc, (ix + 6)
	push	bc
	pop	hl
	add	hl, de
	ld	l, (hl)
	ld	a, l
	or	a, a
	ld	(ix - 41), l
	jr	z, BB31_10
	ld	a, 0
	jr	BB31_11
BB31_10:
	ld	a, -1
BB31_11:
	ld.sis	de, 11
	bit	0, a
	jr	nz, BB31_13
	ld.sis	de, -11
BB31_13:
	ld.sis	hl, 24
	lea	bc, ix - 8
	ld	(ix - 31), bc
	lea	bc, ix - 16
	ld	(ix - 34), bc
	add.sis	iy, de
	ld	(ix - 22), iy
	bit	0, a
	ld	e, l
	ld	d, h
	jr	nz, BB31_15
	ld.sis	de, -24
BB31_15:
	ld	hl, (ix - 19)
	add.sis	hl, de
	ld	(ix - 19), hl
	ld	hl, (ix - 31)
	push	hl
	or	a, a
	sbc	hl, hl
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_build_pawn_files
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (ix - 34)
	push	hl
	ld	hl, 1
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_build_pawn_files
	ld	iy, (ix + 6)
	pop	hl
	pop	hl
	pop	hl
	ld	de, 288
	lea	hl, iy
	add	hl, de
	push	hl
	pop	bc
	ld	de, 128
	lea	hl, iy
	add	hl, de
	ld	(ix - 37), hl
	ld	de, 0
	push	bc
	pop	hl
	ld	e, (hl)
	or	a, a
	sbc	hl, hl
	push	hl
	pop	bc
	ld	(ix - 28), de
BB31_16:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jp	z, BB31_68
	ld	hl, (ix - 37)
	ld	(ix - 25), bc
	add	hl, bc
	ld	a, (hl)
	ld	de, 0
	push	de
	pop	bc
	ld	c, a
	ld	hl, (ix + 6)
	add	hl, bc
	ld	a, (hl)
	and	a, 7
	ld	l, a
	ld	a, c
	and	a, 7
	ld	h, a
	ld	a, l
	cp	a, 1
	jp	nz, BB31_41
	ld	(ix - 56), c
	ld	a, c
	ld	b, 4
	call	__bshru
	ld	c, a
	ld	a, 7
	sub	a, c
	ld	(ix - 50), a
	ld	(ix - 40), h
	ld	e, h
	ld	hl, (ix - 31)
	add	hl, de
	ld	(ix - 44), hl
	ld	b, (hl)
	ld	hl, 1
	ld	(ix - 53), c
	call	__ishl
	ld	a, l
	cpl
	ld	l, a
	ld	a, b
	and	a, l
	or	a, a
	ld	a, -1
	jr	z, BB31_20
	ld	a, 0
BB31_20:
	ld	hl, (ix - 19)
	ld.sis	bc, -11
	add.sis	hl, bc
	ld	bc, (ix - 22)
	ld	iyl, c
	ld	iyh, b
	ld.sis	bc, -56
	add.sis	iy, bc
	bit	0, a
	jr	nz, BB31_22
	ld	c, iyl
	ld	b, iyh
	ld	(ix - 22), bc
BB31_22:
	bit	0, a
	jp	nz, BB31_24
	ld	(ix - 19), hl
BB31_24:
	ld	c, (ix - 40)
	ld	a, c
	or	a, a
	ld	h, 0
	ld	l, h
	ld	iy, (ix - 44)
	jr	z, BB31_26
	ld	l, (iy - 1)
	ld	a, c
	cp	a, 7
	jr	z, BB31_27
BB31_26:
	ld	a, (iy + 1)
	or	a, l
	ld	l, a
BB31_27:
	ld	(ix - 44), de
	ld	a, l
	or	a, a
	ld	a, -1
	jr	z, BB31_29
	ld	a, 0
BB31_29:
	ld	hl, (ix - 19)
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	ld.sis	bc, -15
	add.sis	iy, bc
	ld	bc, (ix - 22)
	ld	l, c
	ld	h, b
	ld.sis	de, -20
	add.sis	hl, de
	bit	0, a
	jr	nz, BB31_31
	ld	l, c
	ld	h, b
BB31_31:
	ld	(ix - 22), hl
	bit	0, a
	ld	(ix - 47), iy
	ld	de, 0
	jp	nz, BB31_33
	ld	hl, (ix - 19)
	ld	(ix - 47), hl
BB31_33:
	ld	l, (ix - 56)
	ld	a, l
	add	a, 17
	ld	c, a
	ld	a, l
	add	a, 15
	ld	iyl, a
	ld	a, c
	and	a, -120
	or	a, a
	ld	h, 0
	ld	b, h
	jr	nz, BB31_37
	ld	e, c
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	cp	a, 1
	ld	b, 1
	jr	z, BB31_36
	ld	b, 0
BB31_36:
	ld	de, 0
BB31_37:
	ld	a, iyl
	and	a, -120
	or	a, a
	jr	nz, BB31_45
	ld	e, iyl
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	cp	a, 1
	ld	a, 1
	jr	z, BB31_40
	ld	a, b
BB31_40:
	ld	de, 0
	jr	BB31_46
BB31_41:
	ld	a, l
	cp	a, 4
	jp	nz, BB31_63
	push	de
	pop	bc
	ld	c, h
	ld	hl, (ix - 31)
	add	hl, bc
	ld	a, (hl)
	or	a, a
	ld	de, (ix - 28)
	jp	nz, BB31_66
	ld	hl, (ix - 34)
	add	hl, bc
	ld	a, (hl)
	or	a, a
	jp	nz, BB31_64
	ld	hl, (ix - 19)
	ld.sis	bc, 43
	add.sis	hl, bc
	ld	(ix - 19), hl
	ld	hl, (ix - 22)
	ld.sis	bc, 21
	jp	BB31_65
BB31_45:
	ld	a, b
BB31_46:
	push	af
	ld	a, (ix - 50)
	ld	iyl, a
	pop	af
	ld	c, (ix - 40)
	bit	0, a
	jp	z, BB31_50
	ld	a, iyl
	cp	a, 2
	jp	c, BB31_50
	ld	a, iyl
	cp	a, 8
	jp	nc, BB31_50
	ld	a, 5
	sub	a, (ix - 53)
	ld	e, a
	ex	de, hl
	ld	a, iyl
	ld	c, 1
	call	__ishl
	push	hl
	pop	de
	ld	hl, _connected_bonus
	add	hl, de
	ld	de, 0
	ld	hl, (hl)
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	ld	bc, (ix - 47)
	add.sis	iy, bc
	ld	(ix - 19), iy
	ld	bc, (ix - 22)
	add.sis	hl, bc
	ld	iyl, a
	ld	(ix - 22), hl
	ld	c, (ix - 40)
	ld	hl, (ix - 19)
	ld	(ix - 47), hl
BB31_50:
	ld	e, (ix - 53)
	ld	(ix - 40), de
	ld	de, (ix - 44)
	dec	de
	ld	a, c
	add	a, 2
	ld	bc, 0
	ld	c, a
BB31_51:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jr	z, BB31_57
	ld	(ix - 19), bc
	ld	a, e
	and	a, -8
	or	a, a
	jr	nz, BB31_56
	ld	hl, (ix - 34)
	ld	(ix - 44), de
	add	hl, de
	ld	a, (hl)
	ld	iyl, a
	ld	bc, 0
BB31_54:
	ld	hl, (ix - 40)
	or	a, a
	sbc	hl, bc
	ld	de, (ix - 44)
	jr	z, BB31_56
	ld	hl, 1
	call	__ishl
	ld	a, l
	ex	de, hl
	ld	e, iyl
	ex	de, hl
	and	a, l
	inc	bc
	or	a, a
	jr	z, BB31_54
	jp	BB31_62
BB31_56:
	inc	de
	push	af
	ld	a, (ix - 50)
	ld	iyl, a
	pop	af
	ld	bc, (ix - 19)
	jr	BB31_51
BB31_57:
	ld	a, iyl
	cp	a, 2
	ld	bc, (ix - 25)
	jr	c, BB31_60
	ld	a, 5
	sub	a, (ix - 53)
	cp	a, 6
	jr	nc, BB31_60
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	c, 1
	call	__ishl
	ld	bc, (ix - 25)
	push	hl
	pop	de
	ld	hl, _passed_mg
	add	hl, de
	push	de
	pop	iy
	ld	hl, (hl)
	ld	de, (ix - 47)
	add.sis	hl, de
	ld	(ix - 19), hl
	ld	hl, _passed_eg
	lea	de, iy
	add	hl, de
	ld	hl, (hl)
	ld	de, (ix - 22)
	add.sis	hl, de
	ld	(ix - 22), hl
	jp	BB31_61
BB31_60:
	ld	hl, (ix - 22)
	ld	(ix - 22), hl
	ld	hl, (ix - 47)
	ld	(ix - 19), hl
BB31_61:
	ld	de, (ix - 28)
	jp	BB31_67
BB31_62:
	ld	hl, (ix - 22)
	ld	(ix - 22), hl
	ld	hl, (ix - 47)
	ld	(ix - 19), hl
BB31_63:
	ld	de, (ix - 28)
	jr	BB31_66
BB31_64:
	ld	hl, (ix - 19)
	ld.sis	bc, 19
	add.sis	hl, bc
	ld	(ix - 19), hl
	ld	hl, (ix - 22)
	ld.sis	bc, 10
BB31_65:
	add.sis	hl, bc
	ld	(ix - 22), hl
BB31_66:
	ld	bc, (ix - 25)
BB31_67:
	inc	bc
	jp	BB31_16
BB31_68:
	ld	de, 289
	ld	hl, (ix + 6)
	add	hl, de
	ld	de, 0
	ld	e, (hl)
	or	a, a
	sbc	hl, hl
	push	hl
	pop	bc
	ld	(ix - 25), de
BB31_69:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jp	z, BB31_121
	ld	iy, (ix + 6)
	lea	hl, iy
	add	hl, bc
	ld	de, 144
	add	hl, de
	ld	e, (hl)
	or	a, a
	sbc	hl, hl
	ld	(ix - 40), bc
	push	hl
	pop	bc
	ld	c, e
	add	iy, bc
	ld	a, (iy)
	and	a, 7
	ld	l, a
	ld	a, e
	and	a, 7
	ld	h, a
	ld	a, l
	cp	a, 1
	jp	nz, BB31_94
	ld	(ix - 59), bc
	ld	(ix - 44), e
	ld	a, e
	ld	b, 4
	call	__bshru
	ld	de, 0
	ld	(ix - 47), h
	ld	e, h
	ld	hl, (ix - 34)
	ld	(ix - 50), de
	add	hl, de
	ld	(ix - 53), hl
	ld	b, (hl)
	ld	hl, 1
	ld	(ix - 60), a
	ld	c, a
	call	__ishl
	ld	a, l
	cpl
	ld	l, a
	ld	a, b
	and	a, l
	or	a, a
	ld	a, -1
	jr	z, BB31_73
	ld	a, 0
BB31_73:
	ld	hl, (ix - 19)
	ld.sis	de, 11
	add.sis	hl, de
	ld	de, (ix - 22)
	ld	iyl, e
	ld	iyh, d
	ld.sis	de, 56
	add.sis	iy, de
	bit	0, a
	jr	nz, BB31_75
	ld	c, iyl
	ld	b, iyh
	ld	(ix - 22), bc
BB31_75:
	bit	0, a
	jp	nz, BB31_77
	ld	(ix - 19), hl
BB31_77:
	ld	c, (ix - 47)
	ld	a, c
	or	a, a
	ld	l, d
	ld	iy, (ix - 53)
	jr	z, BB31_79
	ld	l, (iy - 1)
	ld	a, c
	cp	a, 7
	jr	z, BB31_80
BB31_79:
	ld	a, (iy + 1)
	or	a, l
	ld	l, a
BB31_80:
	ld	a, l
	or	a, a
	ld	a, -1
	jr	z, BB31_82
	ld	a, 0
BB31_82:
	ld	hl, (ix - 19)
	ld.sis	de, 15
	add.sis	hl, de
	ld	(ix - 56), hl
	ld	bc, (ix - 22)
	ld	l, c
	ld	h, b
	ld.sis	de, 20
	add.sis	hl, de
	ld	(ix - 53), hl
	bit	0, a
	jr	nz, BB31_84
	ld	l, c
	ld	h, b
	ld	(ix - 53), hl
BB31_84:
	bit	0, a
	ld	e, (ix - 44)
	jp	nz, BB31_86
	ld	hl, (ix - 19)
	ld	(ix - 56), hl
BB31_86:
	ld	a, e
	add	a, -17
	ld	c, a
	ld	a, e
	add	a, -15
	ld	iyl, a
	ld	a, c
	and	a, -120
	or	a, a
	ld	h, 0
	ld	b, h
	jr	nz, BB31_90
	ld	de, 0
	ld	e, c
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	cp	a, -127
	ld	b, 1
	jr	z, BB31_89
	ld	b, 0
BB31_89:
	ld	e, (ix - 44)
BB31_90:
	ld	a, iyl
	and	a, -120
	or	a, a
	jr	nz, BB31_98
	ld	de, 0
	ld	e, iyl
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	cp	a, -127
	ld	a, 1
	jr	z, BB31_93
	ld	a, b
BB31_93:
	ld	e, (ix - 44)
	jr	BB31_99
BB31_94:
	ld	bc, (ix - 40)
	ld	a, l
	cp	a, 4
	jp	nz, BB31_120
	ld	de, 0
	ld	e, h
	ld	hl, (ix - 34)
	add	hl, de
	ld	a, (hl)
	or	a, a
	jp	nz, BB31_120
	ld	hl, (ix - 31)
	add	hl, de
	ld	a, (hl)
	or	a, a
	jp	nz, BB31_117
	ld.sis	de, -43
	ld	hl, (ix - 19)
	add.sis	hl, de
	ld	(ix - 19), hl
	ld.sis	de, -21
	jp	BB31_118
BB31_98:
	ld	a, b
BB31_99:
	ld	bc, (ix - 59)
	bit	0, a
	jr	z, BB31_103
	ld	a, e
	cp	a, 32
	jr	c, BB31_103
	ld	a, e
	cp	a, 0
	call	pe, __setflag
	jp	m, BB31_103
	ld	a, (ix - 60)
	add	a, -2
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	c, 1
	call	__ishl
	push	hl
	pop	de
	ld	hl, _connected_bonus
	add	hl, de
	ld	bc, (hl)
	ld	hl, (ix - 56)
	or	a, a
	sbc.sis	hl, bc
	ld	(ix - 56), hl
	ld	hl, (ix - 53)
	or	a, a
	sbc.sis	hl, bc
	ld	bc, (ix - 59)
	ld	(ix - 53), hl
BB31_103:
	push	bc
	pop	hl
	ld	c, 4
	call	__ishru
	push	hl
	pop	bc
	ld	a, (ix - 47)
	add	a, 2
	ld	de, 8
	or	a, a
	sbc	hl, de
	ld	(ix - 22), bc
	ld	(ix - 19), bc
	jr	nc, BB31_105
	ld	hl, 7
	ld	(ix - 19), hl
BB31_105:
	ld	bc, (ix - 50)
	dec	bc
	ld	de, 0
	ld	e, a
BB31_106:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jp	z, BB31_112
	ld	a, c
	and	a, -8
	or	a, a
	jp	nz, BB31_111
	ld	hl, (ix - 31)
	ld	(ix - 50), bc
	add	hl, bc
	ld	a, (hl)
	ld	(ix - 47), a
	ld	bc, (ix - 22)
BB31_109:
	ld	hl, (ix - 19)
	push	bc
	pop	iy
	or	a, a
	sbc	hl, bc
	ld	bc, (ix - 50)
	jp	z, BB31_111
	lea	bc, iy
	inc	iy
	ld	hl, 2
	call	__ishl
	ld	a, l
	and	a, (ix - 47)
	or	a, a
	lea	bc, iy
	jp	z, BB31_109
	jp	BB31_116
BB31_111:
	inc	bc
	jp	BB31_106
BB31_112:
	ld	a, (ix - 44)
	cp	a, 32
	ld	bc, (ix - 40)
	jp	c, BB31_115
	ld	a, (ix - 60)
	add	a, -2
	cp	a, 6
	jp	nc, BB31_115
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	c, 1
	call	__ishl
	push	hl
	pop	de
	ld	hl, _passed_mg
	add	hl, de
	ld	bc, (hl)
	ld	hl, (ix - 56)
	or	a, a
	sbc.sis	hl, bc
	ld	bc, (ix - 40)
	ld	(ix - 19), hl
	ld	hl, _passed_eg
	add	hl, de
	ld	de, (hl)
	ld	hl, (ix - 53)
	or	a, a
	sbc.sis	hl, de
	jp	BB31_119
BB31_115:
	ld	hl, (ix - 53)
	ld	(ix - 22), hl
	ld	hl, (ix - 56)
	ld	(ix - 19), hl
	jp	BB31_120
BB31_116:
	ld	hl, (ix - 53)
	ld	(ix - 22), hl
	ld	hl, (ix - 56)
	ld	(ix - 19), hl
	ld	bc, (ix - 40)
	jr	BB31_120
BB31_117:
	ld.sis	de, -19
	ld	hl, (ix - 19)
	add.sis	hl, de
	ld	(ix - 19), hl
	ld.sis	de, -10
BB31_118:
	ld	hl, (ix - 22)
	add.sis	hl, de
BB31_119:
	ld	(ix - 22), hl
BB31_120:
	inc	bc
	ld	de, (ix - 25)
	jp	BB31_69
BB31_121:
	ld	bc, 0
	ld	hl, (ix - 22)
	ld	(ix - 22), hl
	ld	hl, (ix - 19)
	ld	(ix - 19), hl
	ld	de, (ix - 28)
BB31_122:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jp	z, BB31_152
	ld	hl, (ix - 37)
	ld	(ix - 31), bc
	add	hl, bc
	ld	a, (hl)
	ld	de, 0
	ld	(ix - 34), a
	ld	e, a
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	and	a, 7
	cp	a, 2
	jr	nz, BB31_136
	ld	bc, 0
	ld	h, b
	ld	(ix - 40), h
BB31_125:
	push	bc
	pop	hl
	ld	de, 8
	or	a, a
	sbc	hl, de
	jr	z, BB31_133
	ld	hl, _atk_knight_offsets
	add	hl, bc
	ld	a, (hl)
	add	a, (ix - 34)
	ld	l, a
	and	a, -120
	or	a, a
	jr	nz, BB31_132
	ld	(ix - 44), bc
	ld	de, 0
	push	hl
	pop	bc
	ld	e, l
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	cp	a, 1
	call	pe, __setflag
	jp	p, BB31_131
	ld	hl, 1
	push	hl
	push	bc
	ld	hl, (ix + 6)
	push	hl
	call	_pawn_attacks_sq
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	ld	l, 1
	jr	z, BB31_130
	ld	l, 0
BB31_130:
	ld	a, (ix - 40)
	add	a, l
	ld	(ix - 40), a
BB31_131:
	ld	bc, (ix - 44)
BB31_132:
	inc	bc
	jr	BB31_125
BB31_133:
	ld	a, (ix - 40)
	cp	a, 8
	jr	c, BB31_135
	ld	a, 8
BB31_135:
	add	a, a
	ld	de, 0
	ld	e, a
	ld	iy, _knight_mob_mg
	add	iy, de
	ld	hl, _knight_mob_eg
	jp	BB31_150
BB31_136:
	cp	a, 3
	ld	bc, 0
	ld	h, b
	ld	a, h
	ld	de, (ix - 28)
	jp	z, BB31_146
	ld	hl, (ix - 22)
	ld	bc, (ix - 19)
	ld	iyl, c
	ld	iyh, b
	jp	BB31_151
BB31_138:
	ld	(ix - 40), a
	ld	hl, _bishop_offsets
	add	hl, bc
	ld	l, (hl)
	ld	a, (ix - 34)
	add	a, l
	ld	e, a
BB31_139:
	ld	a, e
	and	a, -120
	or	a, a
	jr	nz, BB31_145
	ld	(ix - 47), l
	ld	(ix - 44), bc
	push	de
	pop	bc
	ld	de, 0
	ld	e, c
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	cp	a, 1
	call	pe, __setflag
	jp	p, BB31_144
	ld	(ix - 53), a
	ld	hl, 1
	push	hl
	ld	(ix - 50), bc
	push	bc
	ld	hl, (ix + 6)
	push	hl
	call	_pawn_attacks_sq
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	ld	l, 1
	jr	z, BB31_143
	ld	l, 0
BB31_143:
	ld	a, (ix - 40)
	add	a, l
	ld	(ix - 40), a
	ld	hl, (ix - 50)
	ld	a, l
	ld	l, (ix - 47)
	add	a, l
	ld	e, a
	ld	a, (ix - 53)
	or	a, a
	ld	bc, (ix - 44)
	jr	z, BB31_139
	jr	BB31_145
BB31_144:
	ld	bc, (ix - 44)
BB31_145:
	inc	bc
	ld	a, (ix - 40)
BB31_146:
	push	bc
	pop	hl
	ld	de, 4
	or	a, a
	sbc	hl, de
	jr	nz, BB31_138
	cp	a, 13
	jr	c, BB31_149
	ld	a, 13
BB31_149:
	add	a, a
	ld	de, 0
	ld	e, a
	ld	iy, _bishop_mob_mg
	add	iy, de
	ld	hl, _bishop_mob_eg
BB31_150:
	add	hl, de
	ld	de, (ix - 28)
	ld	bc, (ix - 19)
	ld	iy, (iy)
	add.sis	iy, bc
	ld	hl, (hl)
	ld	bc, (ix - 22)
	add.sis	hl, bc
BB31_151:
	ld	bc, (ix - 31)
	inc	bc
	ld	(ix - 22), hl
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	ld	(ix - 19), hl
	jp	BB31_122
BB31_152:
	ld	bc, 0
	ld	de, (ix - 25)
BB31_153:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jp	z, BB31_184
	ld	iy, (ix + 6)
	lea	hl, iy
	ld	(ix - 28), bc
	add	hl, bc
	ld	de, 144
	add	hl, de
	ld	c, (hl)
	ld	de, 0
	ld	e, c
	lea	hl, iy
	add	hl, de
	ld	a, (hl)
	and	a, 7
	cp	a, 2
	ld	(ix - 31), c
	jp	nz, BB31_169
	ld	bc, 0
	ld	h, b
	ld	a, h
BB31_156:
	push	bc
	pop	hl
	ld	de, 8
	or	a, a
	sbc	hl, de
	jr	z, BB31_166
	ld	(ix - 34), a
	ld	hl, _atk_knight_offsets
	add	hl, bc
	ld	a, (hl)
	add	a, (ix - 31)
	ld	l, a
	ld	(ix - 37), hl
	and	a, -120
	or	a, a
	jr	nz, BB31_162
	ld	(ix - 40), bc
	or	a, a
	sbc	hl, hl
	push	hl
	pop	iy
	lea	de, iy
	ld	bc, (ix - 37)
	ld	e, c
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	cp	a, 0
	call	pe, __setflag
	jp	m, BB31_163
	push	iy
	push	bc
	ld	hl, (ix + 6)
	push	hl
	call	_pawn_attacks_sq
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	ld	l, 1
	jr	z, BB31_161
	ld	l, 0
BB31_161:
	ld	a, (ix - 34)
	add	a, l
	jr	BB31_164
BB31_162:
	ld	a, (ix - 34)
	jr	BB31_165
BB31_163:
	ld	a, (ix - 34)
BB31_164:
	ld	bc, (ix - 40)
BB31_165:
	inc	bc
	jr	BB31_156
BB31_166:
	cp	a, 8
	jr	c, BB31_168
	ld	a, 8
BB31_168:
	add	a, a
	ld	de, 0
	ld	e, a
	ld	hl, _knight_mob_mg
	add	hl, de
	ld	iy, _knight_mob_eg
	add	iy, de
	ld	bc, (ix - 19)
	jp	BB31_182
BB31_169:
	cp	a, 3
	ld	bc, 0
	ld	h, b
	ld	a, h
	ld	de, (ix - 25)
	jp	nz, BB31_183
BB31_170:
	push	bc
	pop	hl
	ld	de, 4
	or	a, a
	sbc	hl, de
	jr	z, BB31_179
	ld	(ix - 34), a
	ld	hl, _bishop_offsets
	add	hl, bc
	ld	l, (hl)
	ld	a, (ix - 31)
	add	a, l
	ld	e, a
BB31_172:
	ld	a, e
	and	a, -120
	or	a, a
	jr	nz, BB31_178
	ld	(ix - 40), l
	ld	(ix - 37), bc
	or	a, a
	sbc	hl, hl
	push	de
	pop	bc
	ex	de, hl
	ld	e, c
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	cp	a, 0
	call	pe, __setflag
	jp	m, BB31_177
	ld	(ix - 47), a
	or	a, a
	sbc	hl, hl
	push	hl
	ld	(ix - 44), bc
	push	bc
	ld	hl, (ix + 6)
	push	hl
	call	_pawn_attacks_sq
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	ld	l, 1
	jr	z, BB31_176
	ld	l, 0
BB31_176:
	ld	a, (ix - 34)
	add	a, l
	ld	(ix - 34), a
	ld	hl, (ix - 44)
	ld	a, l
	ld	l, (ix - 40)
	add	a, l
	ld	e, a
	ld	a, (ix - 47)
	or	a, a
	ld	bc, (ix - 37)
	jr	z, BB31_172
	jr	BB31_178
BB31_177:
	ld	bc, (ix - 37)
BB31_178:
	inc	bc
	ld	a, (ix - 34)
	jr	BB31_170
BB31_179:
	cp	a, 13
	ld	bc, (ix - 19)
	jr	c, BB31_181
	ld	a, 13
BB31_181:
	add	a, a
	ld	de, 0
	ld	e, a
	ld	hl, _bishop_mob_mg
	add	hl, de
	ld	iy, _bishop_mob_eg
	add	iy, de
BB31_182:
	ld	de, (hl)
	ld	l, c
	ld	h, b
	or	a, a
	sbc.sis	hl, de
	ld	e, l
	ld	d, h
	ld	(ix - 19), de
	ld	de, (iy)
	ld	hl, (ix - 22)
	or	a, a
	sbc.sis	hl, de
	ld	(ix - 22), hl
	ld	de, (ix - 25)
BB31_183:
	ld	bc, (ix - 28)
	inc	bc
	jp	BB31_153
BB31_184:
	ld	de, 292
	ld	hl, (ix + 6)
	add	hl, de
	ld	h, (hl)
	ld	a, h
	cp	a, 16
	ld	d, 0
	ld	e, d
	ld	bc, (ix - 19)
	jr	c, BB31_193
	ld	a, h
	and	a, 7
	ld	l, a
	ld	a, h
	add	a, -16
	and	a, -16
	add	a, l
	ld	b, a
	ld	c, -1
	ld	(ix - 25), de
	ld	h, d
BB31_186:
	ld	a, l
	add	a, c
	ld	d, a
	ld	a, c
	cp	a, 2
	jr	z, BB31_192
	ld	a, d
	cp	a, 8
	jr	nc, BB31_191
	ld	a, b
	add	a, c
	ld	de, 0
	ld	e, a
	ld	iy, (ix + 6)
	add	iy, de
	ld	a, (iy)
	cp	a, 1
	ld	d, 1
	jr	z, BB31_190
	ld	d, 0
BB31_190:
	ld	a, h
	add	a, d
	ld	h, a
BB31_191:
	inc	c
	jr	BB31_186
BB31_192:
	ld	de, (ix - 25)
	ld	e, h
	ld	bc, (ix - 19)
BB31_193:
	ld	(ix - 19), bc
	ld	bc, 293
	ld	hl, (ix + 6)
	add	hl, bc
	ld	a, (hl)
	ld	iyl, a
	cp	a, 112
	ld	c, d
	ld	(ix - 25), de
	ld	l, e
	ld	h, d
	jr	nc, BB31_202
	ld	a, iyl
	and	a, 7
	ld	d, a
	ld	a, iyl
	add	a, 16
	and	a, -16
	add	a, d
	ld	b, a
	ld	e, 1
	ld	iyl, 0
	ld	l, h
	ld	(ix - 28), hl
	ld	l, -1
BB31_195:
	ld	a, d
	add	a, l
	ld	c, a
	ld	a, l
	cp	a, 2
	jr	z, BB31_201
	ld	a, c
	cp	a, 8
	jr	nc, BB31_200
	ld	(ix - 31), b
	ld	a, b
	ex	de, hl
	ld	iyh, e
	ex	de, hl
	add	a, l
	ld	bc, 0
	ld	c, a
	ld	hl, (ix + 6)
	add	hl, bc
	ld	a, (hl)
	cp	a, -127
	ld	c, e
	jr	z, BB31_199
	ld	c, iyl
BB31_199:
	ld	hl, (ix - 28)
	ld	a, l
	add	a, c
	ld	l, a
	ld	(ix - 28), hl
	ex	de, hl
	ld	e, iyh
	ex	de, hl
	ld	b, (ix - 31)
BB31_200:
	inc	l
	jr	BB31_195
BB31_201:
	ld	hl, (ix - 25)
	ld	bc, (ix - 28)
BB31_202:
	ld	b, h
	or	a, a
	sbc.sis	hl, bc
	ld.sis	bc, 15
	call	__smulu
	ld	de, (ix - 19)
	add.sis	hl, de
	ld	(ix - 19), hl
	ld	iy, (ix + 6)
	ld	de, 314
	add	iy, de
	ld	de, (iy)
	ld.sis	bc, 24
	ld	l, e
	ld	h, d
	or	a, a
	sbc.sis	hl, bc
	call	pe, __setflag
	jp	m, BB31_204
	ld.sis	hl, 24
	ld	e, l
	ld	d, h
BB31_204:
	ld.sis	bc, 1
	ld	l, e
	ld	h, d
	or	a, a
	sbc.sis	hl, bc
	call	pe, __setflag
	jp	p, BB31_206
	ld.sis	hl, 0
	ld	e, l
	ld	d, h
BB31_206:
	ld	iy, (ix - 19)
	ld	a, iyh
	ld	l, a
	rlc	l
	sbc	hl, hl
	push	hl
	pop	bc
	ld	b, a
	ld	c, iyl
	push	bc
	pop	hl
	push	bc
	pop	iy
	add	iy, iy
	sbc	hl, hl
	push	hl
	pop	iy
	or	a, a
	sbc	hl, hl
	ld	l, e
	ld	h, d
	ld	(ix - 19), hl
	xor	a, a
	push	bc
	pop	hl
	ld	e, iyl
	ld	bc, (ix - 19)
	call	__lmulu
	ld	(ix - 28), hl
	ld	(ix - 31), e
	ld	iy, (ix - 22)
	ld	e, iyh
	ld	l, e
	rlc	l
	sbc	hl, hl
	push	hl
	pop	bc
	ld	b, e
	ld	c, iyl
	push	bc
	pop	hl
	push	bc
	pop	iy
	add	iy, iy
	sbc	hl, hl
	push	hl
	pop	iy
	ld	hl, 24
	ld	de, (ix - 19)
	or	a, a
	sbc	hl, de
	ld	e, a
	ld	a, iyl
	call	__lmulu
	ld	bc, (ix - 28)
	ld	a, (ix - 31)
	call	__ladd
	ld	bc, 24
	ld	iy, (ix - 25)
	ld	a, iyh
	call	__ldivs
	push	hl
	pop	iy
	ld	c, 8
	call	__ishl
	push	hl
	pop	de
	lea	hl, iy
	ld	bc, -256
	call	__imulu
	ld	a, (ix - 41)
	or	a, a
	jr	z, BB31_208
	ex	de, hl
BB31_208:
	ex	de, hl
	ld	c, 8
	call	__ishru
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_build_pawn_files
_build_pawn_files:
	ld	hl, -9
	call	__frameset
	ld	de, 0
	ld	bc, 8
BB32_1:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jr	z, BB32_3
	ld	hl, (ix + 12)
	add	hl, de
	ld	(hl), 0
	inc	de
	jr	BB32_1
BB32_3:
	ld	de, 0
	ld	e, (ix + 9)
	ld	bc, 288
	ld	iy, (ix + 6)
	add	iy, de
	add	iy, bc
	ld	c, 4
	ex	de, hl
	call	__ishl
	push	hl
	pop	de
	ld	hl, (ix + 6)
	add	hl, de
	ld	(ix - 9), hl
	or	a, a
	sbc	hl, hl
	ld	bc, 0
BB32_4:
	ex	de, hl
	ld	e, (iy)
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jr	nc, BB32_8
	ld	(ix - 6), iy
	ld	hl, (ix - 9)
	ld	(ix - 3), bc
	add	hl, bc
	ld	de, 128
	add	hl, de
	ld	c, (hl)
	ld	iy, 0
	lea	de, iy
	ld	e, c
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	and	a, 7
	cp	a, 1
	jr	nz, BB32_7
	ld	a, c
	ld	b, 4
	call	__bshru
	ld	e, a
	ld	a, c
	and	a, 7
	ld.sis	hl, 1
	ld	c, e
	call	__sshl
	lea	de, iy
	ld	e, a
	ld	iy, (ix + 12)
	add	iy, de
	ld	a, (iy)
	or	a, l
	ld	(iy), a
	ld	iy, 0
BB32_7:
	ld	bc, (ix - 3)
	inc	bc
	lea	hl, iy
	ld	iy, (ix - 6)
	jr	BB32_4
BB32_8:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_pawn_attacks_sq
_pawn_attacks_sq:
	call	__frameset0
	ld	iy, (ix + 6)
	ld	e, (ix + 9)
	ld	h, 0
	ld	b, 1
	ld	a, (ix + 12)
	or	a, a
	jr	nz, BB33_5
	ld	a, e
	add	a, 17
	ld	c, a
	ld	a, e
	add	a, 15
	ld	l, a
	ld	de, 0
	ld	a, c
	and	a, -120
	or	a, a
	jr	nz, BB33_3
	ld	de, 0
	ld	e, c
	ld	c, l
	lea	hl, iy
	add	hl, de
	ld	de, 0
	ld	a, (hl)
	ld	l, c
	ld	h, d
	cp	a, 1
	jr	z, BB33_10
BB33_3:
	ld	a, l
	and	a, -120
	or	a, a
	jr	nz, BB33_9
	ld	e, l
	add	iy, de
	ld	a, (iy)
	cp	a, 1
	jr	nz, BB33_9
	jr	BB33_10
BB33_5:
	ld	a, e
	add	a, -17
	ld	c, a
	ld	a, e
	add	a, -15
	ld	l, a
	ld	de, 0
	ld	a, c
	and	a, -120
	or	a, a
	jr	nz, BB33_7
	ld	de, 0
	ld	e, c
	ld	iy, (ix + 6)
	add	iy, de
	ld	de, 0
	ld	a, (iy)
	ld	iy, (ix + 6)
	cp	a, -127
	jr	z, BB33_10
BB33_7:
	ld	a, l
	and	a, -120
	or	a, a
	jr	nz, BB33_9
	ld	e, l
	add	iy, de
	ld	a, (iy)
	cp	a, -127
	jr	z, BB33_10
BB33_9:
	ld	b, h
BB33_10:
	ld	a, b
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_generate_moves
_generate_moves:
	ld	hl, -16
	call	__frameset
	ld	iy, (ix + 6)
	xor	a, a
	ld	de, 294
	lea	hl, iy
	add	hl, de
	ld	l, (hl)
	ld	(ix - 6), l
	ld	de, 0
	ld	e, l
	lea	hl, iy
	add	hl, de
	ld	bc, 288
	add	hl, bc
	ld	(ix - 3), hl
	ld	c, 4
	ex	de, hl
	call	__ishl
	push	hl
	pop	de
	add	iy, de
	ld	(ix - 9), iy
	ld	l, (ix + 12)
	ld	(ix - 12), hl
	ld	l, (ix - 6)
	ld	(ix - 15), hl
	ld	bc, 0
BB34_1:
	ld	de, 0
	ld	hl, (ix - 3)
	ld	e, (hl)
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jr	nc, BB34_3
	ld	hl, (ix - 9)
	add	hl, bc
	ld	de, 128
	add	hl, de
	ld	l, (hl)
	ex	de, hl
	ld	iyl, e
	ex	de, hl
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	(ix - 6), bc
	ld	bc, 3
	call	__imulu
	push	hl
	pop	de
	ld	hl, (ix + 9)
	add	hl, de
	ld	de, (ix - 12)
	push	de
	push	hl
	ld	hl, (ix - 15)
	push	hl
	ex	de, hl
	ld	e, iyl
	ex	de, hl
	push	hl
	ld	hl, (ix + 6)
	push	hl
	ld	(ix - 16), a
	call	_gen_piece_moves
	ld	bc, (ix - 6)
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	add	a, (ix - 16)
	inc	bc
	jr	BB34_1
BB34_3:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_gen_piece_moves
_gen_piece_moves:
	ld	hl, -15
	call	__frameset
	ld	iy, (ix + 6)
	ld	bc, 0
	push	bc
	pop	de
	ld	e, (ix + 9)
	ld	(ix - 5), de
	add	iy, de
	ld	a, (iy)
	and	a, 7
	ld	c, a
	dec	bc
	ld	de, 6
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jr	c, BB35_2
	ld	b, 0
	jp	BB35_107
BB35_2:
	xor	a, a
	ld	(ix - 9), a
	ld	a, (ix + 12)
	ld	l, (ix + 18)
	ex	de, hl
	ld	iyl, e
	ex	de, hl
	ld	l, 1
	ld	(ix - 6), l
	ld	hl, JTI35_0
	add	hl, bc
	add	hl, bc
	add	hl, bc
	ld	hl, (hl)
	jp	(hl)
BB35_3:
	or	a, a
	ld	c, (ix + 9)
	jp	z, BB35_41
	ld	a, 0
	jp	BB35_42
BB35_5:
	xor	a, a
	ld	(ix - 9), a
	ld	iy, (ix + 6)
	ld	de, 0
BB35_6:
	push	de
	pop	hl
	ld	bc, 8
	or	a, a
	sbc	hl, bc
	jp	z, BB35_106
	ld	hl, _atk_knight_offsets
	ld	(ix - 5), de
	add	hl, de
	ld	a, (hl)
	add	a, (ix + 9)
	ld	d, a
	and	a, -120
	or	a, a
	jr	nz, BB35_14
	ld	bc, 0
	ld	c, d
	add	iy, bc
	ld	l, (iy)
	ld	a, l
	or	a, a
	jr	nz, BB35_10
	ld	a, (ix + 18)
	cp	a, 1
	ld	a, 0
	jr	nz, BB35_12
	jr	BB35_13
BB35_10:
	ld	a, l
	ld	b, 7
	call	__bshru
	ld	l, a
	ld	a, (ix + 18)
	cp	a, 2
	jr	z, BB35_13
	ld	a, l
	ld	l, (ix + 12)
	cp	a, l
	ld	a, 1
	jr	z, BB35_13
BB35_12:
	or	a, a
	sbc	hl, hl
	ld	e, (ix - 9)
	ld	l, e
	inc	e
	ld	(ix - 9), e
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix + 15)
	add	iy, bc
	ld	l, (ix + 9)
	ld	(iy), l
	ld	(iy + 1), d
	ld	(iy + 2), a
BB35_13:
	ld	iy, (ix + 6)
BB35_14:
	ld	de, (ix - 5)
	inc	de
	jr	BB35_6
BB35_15:
	ex	de, hl
	ld	e, iyl
	ex	de, hl
	push	hl
	ld	hl, (ix + 15)
	push	hl
	ld	hl, _bishop_offsets
	jr	BB35_17
BB35_16:
	ex	de, hl
	ld	e, iyl
	ex	de, hl
	push	hl
	ld	hl, (ix + 15)
	push	hl
	ld	hl, _rook_offsets
BB35_17:
	push	hl
	ld	l, a
	push	hl
	ld	l, (ix + 9)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_gen_sliding_moves
	ld	b, a
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	jp	BB35_107
BB35_18:
	ex	de, hl
	ld	e, iyl
	ex	de, hl
	push	hl
	ld	hl, (ix + 15)
	push	hl
	ld	hl, _bishop_offsets
	push	hl
	ld	l, a
	push	hl
	ld	l, (ix + 9)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_gen_sliding_moves
	ld	(ix - 5), a
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	bc, 3
	call	__imulu
	push	hl
	pop	de
	ld	iy, (ix + 15)
	add	iy, de
	ld	l, (ix + 18)
	push	hl
	push	iy
	ld	hl, _rook_offsets
	push	hl
	ld	l, (ix + 12)
	push	hl
	ld	l, (ix + 9)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_gen_sliding_moves
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	add	a, (ix - 5)
	ld	b, a
	jp	BB35_107
BB35_19:
	ld	a, 114
	ld	(ix - 10), a
	ld	b, 0
	ld	(ix - 9), b
	ld	iy, (ix + 6)
	ld	de, 0
BB35_20:
	push	de
	pop	hl
	ld	bc, 8
	or	a, a
	sbc	hl, bc
	jr	z, BB35_29
	ld	hl, _atk_ray_offsets
	add	hl, de
	ld	a, (hl)
	add	a, (ix + 9)
	ld	c, a
	and	a, -120
	or	a, a
	jr	nz, BB35_28
	ld	(ix - 5), de
	ld	de, 0
	ld	e, c
	add	iy, de
	ld	l, (iy)
	ld	a, l
	or	a, a
	jr	nz, BB35_24
	ld	a, (ix + 18)
	cp	a, 1
	ld	a, 0
	jr	nz, BB35_26
	jr	BB35_27
BB35_24:
	ld	a, l
	ld	b, 7
	call	__bshru
	ld	l, a
	ld	a, (ix + 18)
	cp	a, 2
	jr	z, BB35_27
	ld	a, l
	ld	l, (ix + 12)
	cp	a, l
	ld	a, 1
	jr	z, BB35_27
BB35_26:
	or	a, a
	sbc	hl, hl
	ld	e, (ix - 9)
	ld	l, e
	inc	e
	ld	(ix - 9), e
	ld	(ix - 11), c
	ld	bc, 3
	call	__imulu
	ld	c, (ix + 9)
	push	hl
	pop	de
	ld	iy, (ix + 15)
	add	iy, de
	ld	(iy), c
	ld	l, (ix - 11)
	ld	(iy + 1), l
	ld	(iy + 2), a
BB35_27:
	ld	iy, (ix + 6)
	ld	de, (ix - 5)
BB35_28:
	inc	de
	jp	BB35_20
BB35_29:
	ld	a, (ix + 18)
	cp	a, 1
	jp	z, BB35_106
	ld	a, (ix + 9)
	cp	a, 116
	jp	nz, BB35_60
	ld	a, (ix + 12)
	or	a, a
	jp	nz, BB35_60
	ld	bc, 295
	lea	de, iy
	add	iy, bc
	ld	l, (iy)
	ld	a, l
	and	a, 3
	or	a, a
	jp	z, BB35_106
	ld	(ix - 5), l
	ld	hl, 1
	push	hl
	ld	hl, 116
	push	hl
	push	de
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	nz, BB35_106
	ld	e, (ix - 5)
	ld	a, e
	and	a, 1
	bit	0, a
	ld	b, (ix - 9)
	ld	iy, (ix + 6)
	jp	z, BB35_88
	ld	a, (iy + 119)
	cp	a, 4
	jp	nz, BB35_88
	ld	a, (iy + 117)
	or	a, a
	jp	nz, BB35_88
	ld	a, (iy + 118)
	or	a, a
	jp	nz, BB35_88
	ld	hl, 1
	push	hl
	ld	hl, 117
	push	hl
	push	iy
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	nz, BB35_87
	ld	hl, 1
	push	hl
	ld	hl, 118
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	nz, BB35_87
	or	a, a
	sbc	hl, hl
	ld	a, (ix - 9)
	ld	l, a
	inc	a
	ld	bc, 3
	call	__imulu
	ld	b, a
	push	hl
	pop	de
	ld	iy, (ix + 15)
	add	iy, de
	ld	(iy), 116
	ld	(iy + 1), 118
	ld	(iy + 2), 2
	ld	hl, (ix + 6)
	push	hl
	pop	iy
	ld	de, 295
	add	iy, de
	ld	e, (iy)
	push	hl
	pop	iy
	jp	BB35_88
BB35_41:
	ld	a, -1
BB35_42:
	bit	0, a
	jr	nz, BB35_44
	ld	b, 16
	jr	BB35_45
BB35_44:
	ld	b, -16
BB35_45:
	ld	(ix - 10), b
	ld	b, 0
	bit	0, a
	jr	nz, BB35_47
	ld	iy, 1
	ld	(ix - 14), iy
	jr	BB35_48
BB35_47:
	ld	hl, 6
	ld	(ix - 14), hl
BB35_48:
	bit	0, a
	jr	nz, BB35_50
	ld	a, 7
	ld	b, a
BB35_50:
	ld	(ix - 11), b
	ld	a, c
	ld	b, 4
	call	__bshru
	ld	l, a
	ld	a, (ix + 18)
	cp	a, 1
	jr	nz, BB35_52
	ld	b, 0
	ld	de, 0
	jp	BB35_74
BB35_52:
	ld	(ix - 15), l
	ld	bc, 255
	ld	iy, 0
	push	af
	ld	a, (ix - 10)
	ld	iyl, a
	pop	af
	ld	de, (ix - 5)
	add	iy, de
	lea	hl, iy
	call	__iand
	push	hl
	pop	de
	lea	hl, iy
	ld	a, l
	and	a, -120
	or	a, a
	jp	nz, BB35_71
	ld	iy, (ix + 6)
	add	iy, de
	ld	a, (iy)
	or	a, a
	jp	nz, BB35_71
	ld	b, l
	ld	c, 4
	ex	de, hl
	call	__ishru
	ld	iy, (ix + 15)
	ld	c, (ix + 9)
	ld	(iy), c
	ld	a, l
	ld	l, (ix - 11)
	cp	a, l
	jr	nz, BB35_56
	ld	a, 8
	ld	(ix - 9), a
	ld	(iy + 3), c
	ld	(iy + 4), b
	ld	(iy + 5), 24
	ld	(iy + 6), c
	ld	(iy + 7), b
	ld	(iy + 8), 40
	ld	(iy + 9), c
	ld	(iy + 10), b
	ld	(iy + 11), 56
	ld	a, 4
	ld	(ix - 6), a
BB35_56:
	ld	(iy + 1), b
	ld	a, (ix - 9)
	ld	(iy + 2), a
	ld	hl, (ix - 14)
	ld	a, l
	ld	l, (ix - 15)
	cp	a, l
	ld	de, 0
	jp	nz, BB35_72
	ld	a, (ix - 10)
	add	a, b
	ld	l, a
	and	a, -120
	or	a, a
	jp	nz, BB35_72
	ld	e, l
	ld	iy, (ix + 6)
	add	iy, de
	ld	a, (iy)
	or	a, a
	ld	b, (ix - 6)
	jp	nz, BB35_73
	ld	(ix - 5), l
	or	a, a
	sbc	hl, hl
	ld	l, b
	inc	b
	ld	a, b
	ld	bc, 3
	call	__imulu
	ld	b, a
	ld	c, (ix + 9)
	push	hl
	pop	de
	ld	iy, (ix + 15)
	add	iy, de
	ld	(iy), c
	ld	a, (ix - 5)
	ld	(iy + 1), a
	ld	(iy + 2), 64
	jp	BB35_73
BB35_60:
	ld	a, (ix + 9)
	cp	a, 4
	jp	nz, BB35_106
	ld	a, (ix + 12)
	cp	a, 1
	jp	nz, BB35_106
	ld	bc, 295
	lea	de, iy
	add	iy, bc
	ld	l, (iy)
	ld	a, l
	and	a, 12
	or	a, a
	jp	z, BB35_106
	ld	(ix - 5), l
	or	a, a
	sbc	hl, hl
	push	hl
	ld	hl, 4
	push	hl
	push	de
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	nz, BB35_106
	ld	e, (ix - 5)
	bit	2, e
	ld	b, (ix - 9)
	ld	iy, (ix + 6)
	jp	z, BB35_97
	ld	a, (iy + 7)
	cp	a, -124
	jp	nz, BB35_97
	ld	a, (iy + 5)
	or	a, a
	jp	nz, BB35_97
	ld	a, (iy + 6)
	or	a, a
	jp	nz, BB35_97
	or	a, a
	sbc	hl, hl
	push	hl
	ld	hl, 5
	push	hl
	push	iy
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	nz, BB35_96
	or	a, a
	sbc	hl, hl
	push	hl
	ld	hl, 6
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	nz, BB35_96
	or	a, a
	sbc	hl, hl
	ld	a, (ix - 9)
	ld	l, a
	inc	a
	ld	bc, 3
	call	__imulu
	ld	b, a
	push	hl
	pop	de
	ld	iy, (ix + 15)
	add	iy, de
	ld	(iy), 4
	ld	(iy + 1), 6
	ld	(iy + 2), 2
	ld	hl, (ix + 6)
	push	hl
	pop	iy
	ld	de, 295
	add	iy, de
	ld	e, (iy)
	push	hl
	pop	iy
	jp	BB35_97
BB35_71:
	ld	b, 0
	ld	c, (ix + 9)
	jr	BB35_73
BB35_72:
	ld	b, (ix - 6)
BB35_73:
	ld	a, (ix + 18)
	cp	a, 2
	ld	de, 0
	jp	z, BB35_107
BB35_74:
	lea	hl, ix - 2
	ld	(ix - 9), hl
	ld	l, (ix - 10)
	ld	a, l
	dec	a
	ld	(ix - 2), a
	inc	l
	ld	(ix - 1), l
	push	de
	pop	iy
BB35_75:
	ld	de, 2
	lea	hl, iy
	or	a, a
	sbc	hl, de
	jp	z, BB35_107
	ld	hl, (ix - 9)
	lea	de, iy
	ld	(ix - 5), de
	add	hl, de
	ld	a, (hl)
	add	a, c
	ld	e, a
	and	a, -120
	or	a, a
	jp	nz, BB35_86
	ld	d, b
	ld	bc, 0
	ld	c, e
	ld	iy, (ix + 6)
	add	iy, bc
	ld	c, (iy)
	ld	a, c
	ld	b, 7
	call	__bshru
	ld	l, a
	ld	a, c
	or	a, a
	jr	z, BB35_79
	ld	a, l
	ld	l, (ix + 12)
	cp	a, l
	jr	nz, BB35_82
BB35_79:
	ld	iy, (ix + 6)
	ld	bc, 296
	add	iy, bc
	ld	l, (iy)
	ld	a, e
	cp	a, l
	jr	nz, BB35_81
	or	a, a
	sbc	hl, hl
	ld	l, d
	inc	d
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix + 15)
	add	iy, bc
	ld	b, d
	ld	c, (ix + 9)
	ld	(iy), c
	ld	(iy + 1), e
	ld	(iy + 2), 5
	jp	BB35_86
BB35_81:
	ld	c, (ix + 9)
	jp	BB35_85
BB35_82:
	ld	a, e
	ld	b, 4
	call	__bshru
	ld	c, d
	inc	d
	or	a, a
	sbc	hl, hl
	ld	(ix - 6), c
	ld	l, c
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix + 15)
	add	iy, bc
	ld	c, (ix + 9)
	ld	(iy), c
	ld	(iy + 1), e
	ld	l, (ix - 11)
	cp	a, l
	jp	nz, BB35_84
	ld	(iy + 2), 9
	ld	a, (ix - 6)
	add	a, 2
	ld	(ix - 10), a
	or	a, a
	sbc	hl, hl
	ld	l, d
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	hl, (ix + 15)
	push	hl
	pop	iy
	add	iy, bc
	ld	a, (ix + 9)
	ld	(iy), a
	ld	(iy + 1), e
	ld	(iy + 2), 25
	ld	d, (ix - 6)
	ld	a, d
	add	a, 3
	ld	(ix - 14), a
	or	a, a
	sbc	hl, hl
	ld	l, (ix - 10)
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix + 15)
	add	iy, bc
	ld	a, (ix + 9)
	ld	(iy), a
	ld	(iy + 1), e
	ld	(iy + 2), 41
	ld	a, d
	add	a, 4
	or	a, a
	sbc	hl, hl
	ld	l, (ix - 14)
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix + 15)
	add	iy, bc
	ld	b, a
	ld	c, (ix + 9)
	ld	(iy), c
	ld	(iy + 1), e
	ld	(iy + 2), 57
	jr	BB35_86
BB35_84:
	ld	(iy + 2), 1
BB35_85:
	ld	b, d
BB35_86:
	ld	iy, (ix - 5)
	inc	iy
	jp	BB35_75
BB35_87:
	ld	iy, (ix + 6)
	ld	b, (ix - 9)
	ld	e, (ix - 5)
BB35_88:
	bit	1, e
	jp	z, BB35_107
	ld	a, (iy + 112)
	cp	a, 4
	jp	nz, BB35_107
	ld	a, (iy + 115)
	or	a, a
	jp	nz, BB35_107
	ld	a, (iy + 114)
	or	a, a
	jp	nz, BB35_107
	ld	a, (iy + 113)
	or	a, a
	jp	nz, BB35_107
	ld	(ix - 9), b
	ld	hl, 1
	push	hl
	ld	hl, 115
	push	hl
	push	iy
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	nz, BB35_106
	ld	hl, 1
	push	hl
	ld	hl, 114
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	nz, BB35_106
	or	a, a
	sbc	hl, hl
	ld	a, (ix - 9)
	ld	l, a
	ld	bc, 3
	call	__imulu
	push	hl
	pop	de
	ld	hl, (ix + 15)
	add	hl, de
	push	hl
	pop	de
	ld	(hl), 116
	jr	BB35_105
BB35_96:
	ld	iy, (ix + 6)
	ld	b, (ix - 9)
	ld	e, (ix - 5)
BB35_97:
	bit	3, e
	jr	z, BB35_107
	ld	a, (iy)
	cp	a, -124
	jr	nz, BB35_107
	ld	a, (iy + 3)
	or	a, a
	jr	nz, BB35_107
	ld	a, (iy + 2)
	or	a, a
	jr	nz, BB35_107
	ld	(ix - 9), b
	ld	a, (iy + 1)
	or	a, a
	jr	nz, BB35_106
	or	a, a
	sbc	hl, hl
	push	hl
	ld	hl, 3
	push	hl
	push	iy
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jr	nz, BB35_106
	or	a, a
	sbc	hl, hl
	push	hl
	ld	hl, 2
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jr	nz, BB35_106
	or	a, a
	sbc	hl, hl
	ld	a, (ix - 9)
	ld	l, a
	ld	bc, 3
	call	__imulu
	push	hl
	pop	de
	ld	hl, (ix + 15)
	add	hl, de
	push	hl
	pop	de
	ld	(hl), 4
	ld	l, 2
	ld	(ix - 10), l
BB35_105:
	ld	b, a
	inc	b
	push	de
	pop	iy
	ld	a, (ix - 10)
	ld	(iy + 1), a
	ld	(iy + 2), 2
	jr	BB35_107
BB35_106:
	ld	b, (ix - 9)
BB35_107:
	ld	a, b
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits
	section	.rodata,"a",@progbits
	private	JTI35_0
JTI35_0:
	dl	BB35_3
	dl	BB35_5
	dl	BB35_15
	dl	BB35_16
	dl	BB35_18
	dl	BB35_19

	section	.text,"ax",@progbits
	private	_gen_sliding_moves
_gen_sliding_moves:
	ld	hl, -6
	call	__frameset
	ld	bc, 0
	xor	a, a
BB36_1:
	ld	de, 4
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jp	z, BB36_16
	ld	e, a
	ld	hl, (ix + 15)
	add	hl, bc
	ld	a, (hl)
	ld	(ix - 2), a
	add	a, (ix + 9)
BB36_3:
	ld	iyl, a
	or	a, a
	sbc	hl, hl
	and	a, -120
	or	a, a
	jr	nz, BB36_9
	ld	(ix - 5), bc
	ld	(ix - 1), e
	push	hl
	pop	bc
	push	af
	ld	a, iyl
	ld	(ix - 6), a
	pop	af
	ld	c, iyl
	ld	iy, (ix + 6)
	add	iy, bc
	ld	c, (iy)
	ld	a, c
	or	a, a
	jr	nz, BB36_10
	ld	a, (ix + 21)
	cp	a, 1
	jr	nz, BB36_7
	ld	e, (ix - 1)
	ld	a, (ix - 6)
	jr	BB36_8
BB36_7:
	ld	e, (ix - 1)
	ld	l, e
	inc	e
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	iy, (ix + 18)
	add	iy, bc
	lea	bc, iy
	ld	a, (ix + 9)
	push	bc
	pop	hl
	ld	(hl), a
	ld	a, (ix - 6)
	push	bc
	pop	iy
	ld	(iy + 1), a
	ld	(iy + 2), 0
BB36_8:
	ld	bc, (ix - 5)
	add	a, (ix - 2)
	jr	BB36_3
BB36_9:
	ld	a, e
	jr	BB36_15
BB36_10:
	ld	a, c
	ld	b, 7
	call	__bshru
	ld	c, a
	ld	a, (ix + 21)
	cp	a, 2
	jr	nz, BB36_12
	ld	a, (ix - 1)
	jr	BB36_14
BB36_12:
	ld	a, c
	ld	c, (ix + 12)
	cp	a, c
	ld	a, (ix - 1)
	jr	z, BB36_14
	ld	l, a
	inc	a
	ld	(ix - 1), a
	ld	bc, 3
	call	__imulu
	push	hl
	pop	bc
	ld	hl, (ix + 18)
	add	hl, bc
	push	hl
	pop	bc
	ld	a, (ix + 9)
	ld	(hl), a
	ld	a, (ix - 6)
	push	bc
	pop	iy
	ld	(iy + 1), a
	ld	a, (ix - 1)
	ld	(iy + 2), 1
BB36_14:
	ld	bc, (ix - 5)
BB36_15:
	inc	bc
	jp	BB36_1
BB36_16:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_is_square_attacked
_is_square_attacked:
	ld	hl, -4
	call	__frameset
	ld	l, 0
	ld	de, 0
	ld	a, (ix + 12)
	or	a, a
	ld	(ix - 1), l
	jr	z, BB37_2
	ld	a, -128
	ld	(ix - 1), a
BB37_2:
	ld	iy, 16
BB37_3:
	ld	bc, 8
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jr	z, BB37_9
	ld	hl, _atk_knight_offsets
	add	hl, de
	ld	a, (hl)
	add	a, (ix + 9)
	ld	l, a
	ld	bc, 0
	and	a, -120
	or	a, a
	jr	nz, BB37_8
	ld	c, l
	ld	hl, (ix + 6)
	add	hl, bc
	ld	l, (hl)
	ld	a, l
	or	a, a
	jr	z, BB37_8
	ld	a, l
	and	a, -128
	ld	h, a
	ld	a, l
	and	a, 7
	ld	l, a
	ld	a, h
	ld	c, (ix - 1)
	cp	a, c
	jr	nz, BB37_8
	ld	a, l
	cp	a, 2
	jr	z, BB37_15
BB37_8:
	inc	de
	jr	BB37_3
BB37_9:
	ld	a, (ix + 12)
	or	a, a
	jr	z, BB37_11
	ld	iy, -16
BB37_11:
	ld	e, (ix - 1)
	inc	e
	ld	bc, 0
	ld	c, (ix + 9)
	add	iy, bc
	lea	hl, iy
	ld	bc, 255
	add	hl, bc
	ld	a, l
	and	a, -120
	or	a, a
	jr	nz, BB37_13
	ld	bc, 255
	call	__iand
	push	hl
	pop	bc
	ld	hl, (ix + 6)
	add	hl, bc
	ld	bc, 255
	ld	a, (hl)
	cp	a, e
	jr	z, BB37_15
BB37_13:
	inc	iy
	ld	a, iyl
	and	a, -120
	or	a, a
	jr	nz, BB37_16
	lea	hl, iy
	call	__iand
	push	hl
	pop	bc
	ld	hl, (ix + 6)
	add	hl, bc
	ld	a, (hl)
	cp	a, e
	jr	nz, BB37_16
BB37_15:
	ld	a, 1
	jp	BB37_41
BB37_16:
	ld	de, 0
BB37_17:
	ld	bc, 8
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jr	z, BB37_23
	ld	hl, _atk_ray_offsets
	add	hl, de
	ld	a, (hl)
	add	a, (ix + 9)
	ld	l, a
	and	a, -120
	or	a, a
	jr	nz, BB37_22
	ld	bc, 0
	ld	c, l
	ld	hl, (ix + 6)
	add	hl, bc
	ld	h, (hl)
	ld	a, h
	and	a, -128
	ld	c, a
	ld	a, h
	and	a, 7
	ld	l, a
	ld	a, h
	or	a, a
	jr	z, BB37_22
	ld	a, c
	ld	c, (ix - 1)
	cp	a, c
	jr	nz, BB37_22
	ld	a, l
	cp	a, 6
	jr	z, BB37_15
BB37_22:
	inc	de
	jr	BB37_17
BB37_23:
	ld	bc, 4
	ld	de, 0
	push	de
	pop	iy
BB37_24:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jr	z, BB37_32
	ld	hl, _bishop_offsets
	ld	(ix - 4), de
	add	hl, de
	ld	b, (hl)
	ld	a, b
	add	a, (ix + 9)
	ld	c, a
BB37_26:
	ld	a, c
	and	a, -120
	or	a, a
	jr	nz, BB37_31
	ld	de, 0
	ld	e, c
	ld	hl, (ix + 6)
	add	hl, de
	ld	iy, 0
	ld	h, (hl)
	ld	a, c
	add	a, b
	ld	c, a
	ld	a, h
	or	a, a
	jr	z, BB37_26
	ld	a, h
	and	a, -128
	ld	l, (ix - 1)
	cp	a, l
	jr	nz, BB37_31
	ld	a, h
	and	a, 7
	cp	a, 3
	jp	z, BB37_15
	cp	a, 5
	jp	z, BB37_15
BB37_31:
	ld	de, (ix - 4)
	inc	de
	ld	bc, 4
	jr	BB37_24
BB37_32:
	lea	de, iy
BB37_33:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jr	z, BB37_40
	ld	hl, _rook_offsets
	add	hl, de
	ld	b, (hl)
	ld	a, b
	add	a, (ix + 9)
	ld	c, a
BB37_35:
	ld	a, c
	and	a, -120
	or	a, a
	jr	nz, BB37_39
	push	de
	pop	iy
	ld	de, 0
	ld	e, c
	ld	hl, (ix + 6)
	add	hl, de
	lea	de, iy
	ld	h, (hl)
	ld	a, c
	add	a, b
	ld	c, a
	ld	a, h
	or	a, a
	jr	z, BB37_35
	ld	a, h
	and	a, -128
	ld	c, a
	ld	a, h
	and	a, 6
	ld	l, a
	ld	a, c
	ld	c, (ix - 1)
	cp	a, c
	jr	nz, BB37_39
	ld	a, l
	cp	a, 4
	jp	z, BB37_15
BB37_39:
	inc	de
	ld	bc, 4
	jr	BB37_33
BB37_40:
	xor	a, a
BB37_41:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_generate_moves_from
_generate_moves_from:
	call	__frameset0
	ld	hl, (ix + 6)
	ld	b, 7
	ld	de, 0
	ld	e, (ix + 9)
	push	hl
	pop	iy
	add	iy, de
	ld	c, (iy)
	push	hl
	pop	iy
	ld	de, 294
	add	hl, de
	ld	d, (hl)
	ld	a, c
	call	__bshru
	ld	e, a
	ld	a, c
	or	a, a
	jr	z, BB38_3
	ld	a, e
	cp	a, d
	ld	a, 0
	jr	nz, BB38_4
	ld	hl, (ix + 12)
	ld	bc, 0
	push	bc
	push	hl
	ld	l, d
	push	hl
	ld	l, (ix + 9)
	push	hl
	push	iy
	call	_gen_piece_moves
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	jr	BB38_4
BB38_3:
	xor	a, a
BB38_4:
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_search_history_push
_search_history_push:
	call	__frameset0
	ld	iy, _pos_history_count
	ld	de, (iy)
	ld.sis	bc, 512
	ld	l, e
	ld	h, d
	or	a, a
	sbc.sis	hl, bc
	jr	nc, BB39_2
	ld	a, (ix + 9)
	or	a, a
	sbc	hl, hl
	ld	l, e
	ld	h, d
	inc.sis	de
	ld	(iy), e
	ld	(iy + 1), d
	ld	c, 2
	call	__ishl
	push	hl
	pop	de
	ld	iy, _pos_history
	add	iy, de
	ld	hl, (ix + 6)
	ld	(iy), hl
	ld	(iy + 3), a
BB39_2:
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_search_history_pop
_search_history_pop:
	ld	iy, _pos_history_count
	ld	hl, (iy)
	add.sis	hl, bc
	or	a, a
	sbc.sis	hl, bc
	jr	z, BB40_2
	dec.sis	hl
	ld	(iy), l
	ld	(iy + 1), h
BB40_2:
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_search_history_clear
_search_history_clear:
	ld.sis	bc, 0
	ld	iy, _pos_history_count
	ld	de, _pos_history_irreversible
	ld	(iy), c
	ld	(iy + 1), b
	ex	de, hl
	ld	(hl), c
	inc	hl
	ld	(hl), b
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_search_history_set_irreversible
_search_history_set_irreversible:
	ld	hl, _pos_history_count
	ld	iy, _pos_history_irreversible
	ld	hl, (hl)
	ld	(iy), l
	ld	(iy + 1), h
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_search_init
_search_init:
	ld	hl, -6
	call	__frameset
	ld	hl, _tt
	xor	a, a
	ld.sis	iy, 0
	ld	de, _history
	ld	(ix - 3), de
	ld	(_tt), a
	push	hl
	pop	de
	inc	de
	ld	bc, 32767
	ldir
	ld	hl, _pos_history_count
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	hl, _pos_history_irreversible
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	hl, _move_sp
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	de, 384
	ld	iy, 0
BB43_1:
	lea	hl, iy
	or	a, a
	sbc	hl, de
	jr	z, BB43_3
	lea	bc, iy
	lea	hl, iy
	ld	iy, _killers+2
	add	iy, bc
	ld	(iy - 2), -1
	ld	(iy - 1), -1
	ld	(iy), 0
	ld	(iy + 1), -1
	ld	(iy + 2), -1
	ld	(iy + 3), 0
	push	hl
	pop	iy
	ld	bc, 6
	add	iy, bc
	jr	BB43_1
BB43_3:
	ld	bc, 0
BB43_4:
	push	bc
	pop	hl
	ld	de, 2
	or	a, a
	sbc	hl, de
	jr	z, BB43_9
	ld	(ix - 6), bc
	ld	iy, 0
BB43_6:
	lea	hl, iy
	ld	de, 256
	or	a, a
	sbc	hl, de
	jr	z, BB43_8
	lea	bc, iy
	ld	hl, (ix - 3)
	add	hl, bc
	ld.sis	bc, 0
	ld	(hl), c
	inc	hl
	ld	(hl), b
	ld	bc, 2
	add	iy, bc
	jr	BB43_6
BB43_8:
	ld	bc, (ix - 6)
	inc	bc
	ld	hl, (ix - 3)
	ld	de, 256
	add	hl, de
	ld	(ix - 3), hl
	jr	BB43_4
BB43_9:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_search_go
_search_go:
	ld	hl, -12
	call	__frameset
	ld	iy, (ix + 12)
	or	a, a
	sbc	hl, hl
	ld	c, h
	ld	b, -1
	ld.sis	de, 0
	ld	(_search_nodes), hl
	ld	a, c
	ld	(_search_nodes+3), a
	ld	(_search_stopped), a
	ld	a, b
	ld	(_search_best_root_move), a
	ld	(_search_best_root_move+1), a
	ld	a, c
	ld	(_search_best_root_move+2), a
	ld	hl, _move_sp
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	hl, (iy + 9)
	ld	(ix - 6), hl
	ld	(_search_time_fn), hl
	ld	hl, (iy + 1)
	ld	d, (iy + 4)
	ld	(ix - 3), hl
	ld	e, d
	call	__lcmpzero
	jr	z, BB44_3
	ld	iy, (ix - 6)
	lea	hl, iy
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	hl, 0
	jr	z, BB44_4
	call	__indcall
	push	hl
	pop	bc
	ld	a, e
	ld	hl, (ix + 12)
	push	hl
	pop	iy
	ld	hl, (iy + 1)
	ld	d, (iy + 4)
	ld	(ix - 3), hl
	ld	e, d
	call	__ladd
	ld	b, -1
	ld	c, e
	jr	BB44_4
BB44_3:
	or	a, a
	sbc	hl, hl
BB44_4:
	ld	(_search_deadline), hl
	ld	a, c
	ld	(_search_deadline+3), a
	ld	iy, (ix + 12)
	ld	hl, (iy + 5)
	ld	a, (iy + 8)
	ld	(_search_max_nodes), hl
	ld	(_search_max_nodes+3), a
	ld	c, (iy)
	ld	hl, (ix - 3)
	ld	e, d
	call	__lcmpzero
	jr	z, BB44_6
	ld	e, 0
	jr	BB44_7
BB44_6:
	ld	e, 1
BB44_7:
	or	a, a
	sbc	hl, hl
	ld	a, c
	or	a, a
	jr	z, BB44_9
	ld	e, c
BB44_9:
	ld	iy, (ix + 6)
	ld	a, e
	or	a, a
	jr	nz, BB44_11
	ld	e, 63
BB44_11:
	ld	c, 0
	ld	d, 1
	ld	(iy), -1
	ld	(iy + 1), -1
	ld	(iy + 2), hl
	ld	(iy + 5), hl
	ld.sis	hl, 0
	ld	(iy + 8), l
	ld	(iy + 9), h
	ld	(ix - 6), hl
BB44_12:
	ld	a, e
	cp	a, d
	call	pe, __setflag
	jp	m, BB44_35
	ld	(ix - 9), e
	ld	a, b
	ld	(_search_best_root_move), a
	ld	(_search_best_root_move+1), a
	ld	a, c
	ld	(_search_best_root_move+2), a
	ld	e, (iy)
	ld	a, d
	cp	a, 2
	call	pe, __setflag
	ld	l, -1
	jp	m, BB44_15
	ld	l, 0
BB44_15:
	ld	(ix - 7), d
	ld	(ix - 8), e
	ld	a, e
	cp	a, -1
	ld	e, -1
	jr	z, BB44_17
	ld	e, 0
BB44_17:
	ld	a, l
	or	a, e
	ld	hl, (ix - 6)
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	ld.sis	de, -25
	add.sis	iy, de
	ld.sis	de, 25
	add.sis	hl, de
	bit	0, a
	ld.sis	de, 30000
	ld	c, e
	ld	b, d
	jr	nz, BB44_19
	ld	c, l
	ld	b, h
BB44_19:
	bit	0, a
	ld.sis	hl, -30000
	ld	(ix - 3), hl
	ld	a, (ix - 7)
	jr	nz, BB44_21
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	ld	(ix - 3), hl
BB44_21:
	or	a, a
	sbc	hl, hl
	push	hl
	ld	de, 1
	push	de
	push	hl
	ld	(ix - 12), bc
	push	bc
	ld	hl, (ix - 3)
	push	hl
	ld	l, a
	push	hl
	ld	hl, (ix + 9)
	push	hl
	call	_negamax
	ld	e, l
	ld	d, h
	ld	hl, 21
	add	hl, sp
	ld	sp, hl
	ld	a, (_search_stopped)
	bit	0, a
	jp	nz, BB44_25
	ld	hl, (ix - 3)
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	jp	p, BB44_24
	ld	l, e
	ld	h, d
	ld	bc, (ix - 12)
	or	a, a
	sbc.sis	hl, bc
	call	pe, __setflag
	jp	m, BB44_30
BB44_24:
	ld	a, -1
	ld	(_search_best_root_move), a
	ld	(_search_best_root_move+1), a
	inc	a
	ld	(_search_best_root_move+2), a
	or	a, a
	sbc	hl, hl
	push	hl
	ld	de, 1
	push	de
	push	hl
	ld	hl, 30000
	push	hl
	ld	hl, -30000
	push	hl
	ld	l, (ix - 7)
	push	hl
	ld	hl, (ix + 9)
	push	hl
	call	_negamax
	ld	e, l
	ld	d, h
	ld	hl, 21
	add	hl, sp
	ld	sp, hl
	ld	a, (_search_stopped)
	bit	0, a
	jr	z, BB44_30
BB44_25:
	ld	e, (ix - 8)
	ld	a, e
	cp	a, -1
	ld	iy, (ix + 6)
	jp	nz, BB44_36
	ld	a, (_search_best_root_move)
	ld	l, a
	ld	a, (_search_deadline+3)
	ld	e, a
	ld	a, l
	cp	a, -1
	jp	nz, BB44_40
	ld	hl, (_search_deadline)
	ld	iy, (_search_time_fn)
	call	__lcmpzero
	jp	z, BB44_41
	lea	hl, iy
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB44_41
	call	__indcall
	ld	bc, 5000
	xor	a, a
	call	__ladd
	ld	c, a
	ld	a, e
	ld	(_search_deadline), hl
	ld	(_search_deadline+3), a
	xor	a, a
	ld	(_search_stopped), a
	ld	d, (ix - 7)
	dec	d
	ld	b, -1
	ld	iy, (ix + 6)
	jr	BB44_33
BB44_30:
	ld	a, (_search_best_root_move)
	cp	a, -1
	ld	c, 0
	jr	nz, BB44_32
	ld	b, -1
	ld	iy, (ix + 6)
	ld	e, (ix - 9)
	ld	d, (ix - 7)
	jr	BB44_34
BB44_32:
	ld	hl, _search_best_root_move
	ld	a, (hl)
	ld	iy, (ix + 6)
	ld	(iy), a
	ld	a, (_search_best_root_move+1)
	ld	(iy + 1), a
	ld	a, (_search_best_root_move+2)
	ld	(iy + 2), a
	ld	(iy + 3), e
	ld	(iy + 4), d
	ld	b, (ix - 7)
	ld	(iy + 5), b
	ld	hl, (_search_nodes)
	ld	a, (_search_nodes+3)
	ld	(iy + 6), hl
	ld	(iy + 9), a
	ld	(ix - 6), de
	ld	d, b
	ld	b, -1
BB44_33:
	ld	e, (ix - 9)
BB44_34:
	inc	d
	jp	BB44_12
BB44_35:
	ld	e, (iy)
BB44_36:
	ld	a, (_search_best_root_move)
	ld	l, a
	ld	a, e
	cp	a, -1
	jr	nz, BB44_39
	ld	a, l
	cp	a, -1
	jr	z, BB44_39
	ld	hl, _search_best_root_move
	ld	a, (hl)
	ld	(iy), a
	ld	a, (_search_best_root_move+1)
	ld	(iy + 1), a
	ld	a, (_search_best_root_move+2)
	ld	(iy + 2), a
	ld.sis	hl, 0
	ld	(iy + 3), l
	ld	(iy + 4), h
	ld	(iy + 5), h
	ld	hl, (_search_nodes)
	ld	a, (_search_nodes+3)
	ld	(iy + 6), hl
	ld	(iy + 9), a
BB44_39:
	lea	hl, iy
	ld	sp, ix
	pop	ix
	ret
BB44_40:
	ld	e, -1
	jr	BB44_36
BB44_41:
	ld	e, -1
	ld	iy, (ix + 6)
	jr	BB44_36
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_negamax
_negamax:
	ld	hl, -141
	call	__frameset
	ld	d, 0
	ld.sis	iy, 0
	or	a, a
	sbc	hl, hl
	ld	a, (_search_stopped)
	bit	0, a
	jp	nz, BB45_14
	ld	(ix - 51), hl
	ld	iy, _search_nodes
	ld	bc, 1
	ld	hl, (_search_nodes)
	lea	iy, iy + 3
	ld	e, (iy)
	ld	a, d
	call	__ladd
	ld	a, e
	ld	(_search_nodes), hl
	ld	(_search_nodes+3), a
	call	_check_time
	ld	a, (_search_stopped)
	bit	0, a
	jr	z, BB45_3
BB45_2:
	ld.sis	iy, 0
	jp	BB45_14
BB45_3:
	ld	iy, (ix + 6)
	ld	hl, (ix + 12)
	ld	(ix - 60), hl
	ld	h, 0
	ld	a, (ix + 18)
	or	a, a
	ld	bc, 300
	jp	nz, BB45_9
	ld	a, (ix + 9)
	cp	a, 1
	call	pe, __setflag
	jp	m, BB45_12
	ld	e, l
	ld	d, h
	ld	iy, (ix + 6)
	add	iy, bc
	ld	bc, (iy)
	lea	hl, iy + 3
	ld	iy, (ix + 6)
	ld	l, (hl)
BB45_6:
	ld	(ix - 57), bc
	lea	bc, ix - 11
	ld	(ix - 70), bc
	ld	e, (ix + 18)
	ld	(ix - 54), de
	ld	(ix - 11), -1
	ld	(ix - 10), -1
	ld	(ix - 9), 0
	ld	de, 304
	add	iy, de
	ld	(ix - 67), iy
	ld	de, (iy)
	pea	ix - 15
	pea	ix - 14
	pea	ix - 8
	pea	ix - 13
	push	de
	push	hl
	ld	hl, (ix - 57)
	push	hl
	call	_tt_probe
	ld	bc, (ix + 6)
	ld	hl, 21
	add	hl, sp
	ld	sp, hl
	or	a, a
	ld.sis	de, 28937
	jp	z, BB45_25
	ld	iy, (ix - 13)
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	jp	m, BB45_20
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	ld	de, (ix - 54)
	or	a, a
	sbc.sis	hl, de
	ld	e, l
	ld	d, h
	ld	(ix - 13), e
	ld	(ix - 12), d
	jp	BB45_23
BB45_9:
	add	iy, bc
	ld	hl, (iy)
	ld	(ix - 57), hl
	lea	hl, iy + 3
	ld	a, (hl)
	ld	(ix - 61), a
	ld	hl, _pos_history_count
	ld	bc, (hl)
	ld.sis	de, 3
	ld	l, c
	ld	h, b
	or	a, a
	sbc.sis	hl, de
	jr	nc, BB45_15
BB45_10:
	ld	de, 297
	ld	iy, (ix + 6)
	lea	hl, iy
	add	hl, de
	ld	a, (hl)
	cp	a, 100
	jp	nc, BB45_2
	ld	a, (ix + 9)
	cp	a, 1
	call	pe, __setflag
	ld	d, 0
	jp	p, BB45_18
BB45_12:
	or	a, a
	sbc	hl, hl
	push	hl
	ld	l, (ix + 18)
	push	hl
	ld	hl, (ix + 15)
	push	hl
	ld	hl, (ix + 12)
	push	hl
	push	iy
	call	_quiescence
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
BB45_13:
	pop	hl
BB45_14:
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	ld	sp, ix
	pop	ix
	ret
BB45_15:
	ld	iy, _pos_history_irreversible
	ld	de, 0
	push	de
	pop	hl
	ld	l, c
	ld	h, b
	ld	(ix - 54), hl
	ld	bc, (iy)
	ld	e, c
	ld	d, b
	ld	(ix - 64), de
	ld	c, 2
	call	__ishl
	push	hl
	pop	de
	ld	iy, _pos_history
	add	iy, de
	lea	bc, iy - 12
	ld	hl, (ix - 54)
	dec	hl
	ld	(ix - 54), hl
	ld	a, (ix - 61)
BB45_16:
	ld	hl, -2
	ex	de, hl
	ld	hl, (ix - 54)
	add	hl, de
	ld	(ix - 54), hl
	ld	de, (ix - 64)
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB45_10
	push	bc
	pop	iy
	lea	hl, iy - 8
	ld	(ix - 67), hl
	push	bc
	pop	hl
	ld	hl, (hl)
	ld	e, (iy + 3)
	ld	bc, (ix - 57)
	call	__lcmpu
	ld	bc, (ix - 67)
	jp	z, BB45_2
	jr	BB45_16
BB45_18:
	ld	a, (ix + 18)
	cp	a, 64
	ld	l, (ix - 61)
	ld	bc, (ix - 57)
	jp	c, BB45_6
	push	iy
	jp	BB45_122
BB45_20:
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	ld.sis	de, -28936
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	jp	p, BB45_22
	ld	de, (ix - 54)
	add.sis	iy, de
	push	iy
	ex	(sp), hl
	ld	(ix - 13), l
	ld	(ix - 12), h
	pop	hl
BB45_22:
	ld	e, iyl
	ld	d, iyh
BB45_23:
	ld	a, (ix - 14)
	ld	l, (ix + 9)
	cp	a, l
	call	pe, __setflag
	jp	p, BB45_33
BB45_24:
	ld	hl, (ix - 8)
	add.sis	hl, bc
	or	a, a
	sbc.sis	hl, bc
	push	hl
	ld	hl, (ix - 70)
	push	hl
	call	nz, _tt_unpack_move
	pop	hl
	pop	hl
	ld	hl, (ix + 6)
	push	hl
	pop	bc
BB45_25:
	lea	hl, ix - 45
	ld	(ix - 79), hl
	push	hl
	push	bc
	call	_compute_legal_info
	ld	c, (ix + 24)
	pop	hl
	pop	hl
	ld	e, (ix - 45)
	ld	a, c
	cp	a, 2
	sbc	a, a
	ld	l, a
	ld	(ix - 64), e
	ld	a, e
	or	a, a
	jr	nz, BB45_27
	ld	e, 0
	jr	BB45_28
BB45_27:
	ld	e, -1
BB45_28:
	ld	a, l
	and	a, e
	and	a, 1
	ld	l, a
	add	a, c
	ld	e, a
	ld	(ix - 88), de
	ld	a, l
	add	a, (ix + 9)
	ld	(ix - 61), a
	ld	a, (ix + 18)
	or	a, a
	ld	hl, (ix + 6)
	jp	z, BB45_47
	ld	a, (ix - 64)
	or	a, a
	jp	nz, BB45_47
	ld	a, (ix - 61)
	cp	a, 3
	call	pe, __setflag
	jp	p, BB45_47
	push	hl
	call	_evaluate
	ld	e, l
	ld	d, h
	pop	hl
	ld	a, d
	ld	l, a
	rlc	l
	sbc	hl, hl
	push	hl
	pop	bc
	ld	b, a
	ld	c, e
	ld	a, (ix - 61)
	cp	a, 1
	jp	z, BB45_42
	ld	hl, 500
	jp	BB45_43
BB45_33:
	ld	a, (ix - 15)
	cp	a, 1
	jr	nz, BB45_35
	ld	iyl, e
	ld	iyh, d
	jp	BB45_14
BB45_35:
	cp	a, 3
	jr	nz, BB45_38
	ld	l, e
	ld	h, d
	ld	de, (ix + 15)
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	jp	m, BB45_24
BB45_37:
	ld	hl, (ix + 15)
	jp	BB45_41
BB45_38:
	cp	a, 2
	jp	nz, BB45_24
	ld	hl, (ix + 12)
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	jp	m, BB45_24
	ld	hl, (ix + 12)
BB45_41:
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	jp	BB45_14
BB45_42:
	ld	hl, 200
BB45_43:
	add	hl, bc
	ex	de, hl
	ld	bc, (ix + 12)
	ld	a, b
	ld	l, a
	rlc	l
	sbc	hl, hl
	ld	h, a
	ld	l, c
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB45_45
	ld	hl, 0
	jr	BB45_46
BB45_45:
	ld	hl, 1
BB45_46:
	ld	(ix - 51), hl
BB45_47:
	ld	a, (ix + 18)
	or	a, a
	jr	z, BB45_51
	ld	a, (ix + 21)
	or	a, a
	jr	z, BB45_51
	ld	a, (ix - 64)
	or	a, a
	jr	nz, BB45_51
	ld	a, (ix - 61)
	cp	a, 3
	call	pe, __setflag
	jp	p, BB45_123
BB45_51:
	ld	iy, _killers
	ld.sis	hl, -30000
	ld	(ix - 57), hl
	lea	hl, ix - 29
	ld	(ix - 85), hl
	lea	hl, ix - 32
	ld	(ix - 73), hl
	lea	hl, ix - 48
	ld	(ix - 76), hl
	ld	(ix - 32), -1
	ld	(ix - 31), -1
	ld	(ix - 30), 0
	ld	e, (ix - 61)
	ld	a, e
	dec	a
	ld	(ix - 67), a
	ld	a, (ix + 18)
	ld	d, a
	ld	c, a
	inc	d
	ld	hl, (ix + 15)
	call	__sneg
	ld	(ix - 91), hl
	ld	a, e
	add	a, -2
	ld	l, a
	ld	(ix - 103), hl
	or	a, a
	sbc	hl, hl
	ld	l, c
	ld	bc, 6
	call	__imulu
	push	hl
	pop	bc
	add	iy, bc
	ld	(ix - 109), iy
	lea	hl, iy + 3
	ld	(ix - 115), hl
	ld	a, e
	rlc	a
	sbc	hl, hl
	ld	l, e
	push	hl
	pop	bc
	call	__imulu
	ld	(ix - 112), hl
	ld	l, (ix + 18)
	ld	(ix - 82), hl
	ld	l, d
	ld	(ix - 94), hl
	ld	a, (ix - 67)
	ld	l, a
	ld	(ix - 97), hl
	ld	l, d
	ld	(ix - 106), hl
	ld	(ix - 100), hl
	ld	c, a
	ld	h, 2
	ld	d, 0
	ld	e, d
	ld	a, d
	ld	iy, (ix - 54)
BB45_52:
	bit	0, e
	jp	nz, BB45_113
	cp	a, 2
	jp	nc, BB45_113
	ld	(ix - 128), d
	ld	(ix - 67), h
	ld	de, -137
	lea	hl, ix
	add	hl, de
	ld	(hl), bc
	ld	bc, -138
	lea	iy, ix
	add	iy, bc
	ld	(iy), a
	or	a, a
	ld	a, 1
	ld	l, a
	jr	z, BB45_56
	ld	a, 2
	ld	l, a
BB45_56:
	push	hl
	ld	hl, _raw_moves_buf
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_generate_moves
	ld	c, a
	pop	hl
	pop	hl
	pop	hl
	ld	hl, _move_sp
	ld	de, (hl)
	or	a, a
	sbc	hl, hl
	push	hl
	pop	iy
	ld	(ix - 3), bc
	push	ix
	ld	bc, -131
	add	ix, bc
	ld	(ix), de
	pop	ix
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	ld	bc, (ix - 3)
	ld	(ix - 121), bc
	ld	e, c
	lea	hl, iy
	ld	(ix - 118), de
	add	hl, de
	ld	(ix - 127), hl
	ld	de, 2049
	or	a, a
	sbc	hl, de
	jp	nc, BB45_121
	lea	hl, iy
	ld	bc, 5
	call	__imulu
	push	hl
	pop	de
	ld	hl, _move_pool
	push	hl
	pop	iy
	add	iy, de
	ld	hl, (ix - 118)
	ld	de, _raw_moves_buf
	ld	(ix - 124), iy
	ld	(ix - 3), bc
	push	ix
	ld	bc, -134
	add	ix, bc
	ld	(ix), iy
	pop	ix
	ld	bc, (ix - 3)
BB45_58:
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB45_60
	push	de
	pop	iy
	ld	a, (iy)
	lea	bc, iy
	ld	de, -134
	lea	iy, ix
	add	iy, de
	ld	iy, (iy)
	ld	(iy), a
	lea	de, iy
	push	bc
	pop	iy
	ld	a, (iy + 1)
	push	de
	pop	iy
	ld	(iy + 1), a
	push	bc
	pop	iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	ld.sis	de, 0
	ld	(iy + 3), e
	ld	(iy + 4), d
	lea	iy, iy + 5
	push	ix
	ld	de, -134
	add	ix, de
	ld	(ix), iy
	pop	ix
	push	bc
	pop	iy
	lea	iy, iy + 3
	lea	de, iy
	dec	hl
	jr	BB45_58
BB45_60:
	ld	hl, _move_sp
	ld	de, (ix - 127)
	ld	(hl), e
	inc	hl
	ld	(hl), d
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	hl, (ix - 70)
	ld	a, (hl)
	ld	(iy), a
	ld	a, (ix - 10)
	ld	(iy + 1), a
	ld	a, (ix - 9)
	ld	(iy + 2), a
	ld	hl, (ix - 82)
	push	hl
	ld	hl, (ix - 121)
	push	hl
	ld	hl, (ix - 124)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_score_moves
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (ix - 124)
	ld	(ix - 127), hl
	ld	e, 0
	ld	c, e
	ld	a, (ix - 128)
	ld	iy, (ix - 57)
	ld	hl, (ix - 118)
BB45_61:
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB45_100
	ld	(ix - 57), a
	push	ix
	ld	bc, -134
	add	ix, bc
	ld	(ix), iy
	pop	ix
	ld	(ix - 118), hl
	ld	bc, -141
	lea	hl, ix
	add	hl, bc
	ld	(hl), de
	push	de
	ld	hl, (ix - 121)
	push	hl
	ld	hl, (ix - 124)
	push	hl
	call	_pick_move
	pop	hl
	pop	hl
	pop	hl
	ld	iy, (ix - 127)
	ld	a, (iy)
	ld	hl, (ix - 76)
	ld	(hl), a
	ld	a, (iy + 1)
	ld	(ix - 47), a
	ld	a, (iy + 2)
	ld	(ix - 46), a
	push	hl
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	a, (iy)
	push	de
	pop	hl
	ld	(hl), a
	ld	a, (iy + 1)
	lea	hl, iy
	push	de
	pop	iy
	ld	(iy + 1), a
	push	hl
	pop	iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 79)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_is_evasion_candidate
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jr	nz, BB45_65
BB45_63:
	ld	e, 0
	ld	c, e
	ld	a, (ix - 57)
BB45_64:
	ld	(ix - 3), bc
	ld	bc, -141
	lea	hl, ix
	add	hl, bc
	ld	de, (hl)
	inc	e
	ld	iy, (ix - 127)
	lea	iy, iy + 5
	ld	(ix - 127), iy
	ld	hl, (ix - 118)
	dec	hl
	ld	bc, -134
	lea	iy, ix
	add	iy, bc
	ld	iy, (iy)
	ld	bc, (ix - 3)
	jp	BB45_61
BB45_65:
	ld	hl, (ix - 51)
	bit	0, l
	jr	z, BB45_68
	ld	a, (ix - 57)
	or	a, a
	jr	z, BB45_68
	ld	a, (ix - 46)
	and	a, 9
	or	a, a
	jr	z, BB45_63
BB45_68:
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	hl, (ix - 76)
	ld	a, (hl)
	ld	(iy), a
	ld	a, (ix - 47)
	ld	(iy + 1), a
	ld	a, (ix - 46)
	ld	(iy + 2), a
	ld	hl, (ix - 79)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_move_needs_legality_check
	ld	(ix - 128), a
	pop	hl
	pop	hl
	pop	hl
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	de, (ix - 127)
	push	de
	pop	hl
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 85)
	ld	(iy + 3), hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_make
	pop	hl
	pop	hl
	pop	hl
	ld	a, (ix - 128)
	or	a, a
	jr	z, BB45_71
	ld	hl, (ix + 6)
	push	hl
	call	_board_is_legal.25
	pop	hl
	or	a, a
	jr	nz, BB45_71
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	hl, (ix - 76)
	ld	a, (hl)
	ld	(iy), a
	ld	a, (ix - 47)
	ld	(iy + 1), a
	ld	a, (ix - 46)
	ld	(iy + 2), a
	ld	hl, (ix - 85)
	ld	(iy + 3), hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
	jp	BB45_63
BB45_71:
	ld	a, (ix - 57)
	inc	a
	ld	(ix - 128), a
	ld	a, (_search_best_root_move)
	ld	l, a
	ld	a, (ix + 18)
	or	a, a
	jr	nz, BB45_74
	ld	a, l
	cp	a, -1
	jr	nz, BB45_74
	ld	hl, (ix - 76)
	ld	a, (hl)
	ld	hl, _search_best_root_move
	ld	(hl), a
	ld	a, (ix - 47)
	ld	(_search_best_root_move+1), a
	ld	a, (ix - 46)
	ld	(_search_best_root_move+2), a
BB45_74:
	ld	iy, (ix + 6)
	ld	de, 300
	add	iy, de
	ld	de, (iy)
	lea	hl, iy + 3
	ld	l, (hl)
	push	hl
	push	de
	call	_search_history_push
	pop	hl
	pop	hl
	ld	a, (ix - 57)
	or	a, a
	jp	nz, BB45_77
	ld	hl, (ix - 60)
	call	__sneg
	ld	e, l
	ld	d, h
BB45_76:
	ld	hl, (ix - 88)
	push	hl
	ld	hl, 1
	push	hl
	ld	hl, (ix - 94)
	push	hl
	push	de
	ld	hl, (ix - 91)
	push	hl
	ld	hl, (ix - 97)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_negamax
	ld	iy, 21
	add	iy, sp
	ld	sp, iy
	call	__sneg
	ld	c, l
	ld	b, h
	jp	BB45_87
BB45_77:
	ld	a, (ix - 64)
	or	a, a
	jp	nz, BB45_83
	ld	a, (ix - 128)
	cp	a, 5
	jp	c, BB45_83
	ld	a, (ix - 61)
	cp	a, 3
	call	pe, __setflag
	jp	m, BB45_83
	ld	a, (ix - 46)
	and	a, 9
	or	a, a
	jp	nz, BB45_83
	ld	hl, (ix - 60)
	call	__sneg
	ld	c, l
	ld	b, h
	ld	hl, (ix - 60)
	call	__snot
	ld	de, (ix - 88)
	push	de
	ld	de, 1
	push	de
	ld	de, (ix - 106)
	push	de
	ld	(ix - 57), bc
	push	bc
	push	hl
	ld	hl, (ix - 103)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_negamax
	ld	iy, 21
	add	iy, sp
	ld	sp, iy
	call	__sneg
	ld	c, l
	ld	b, h
	ld	a, (_search_stopped)
	ld	hl, (ix - 60)
	or	a, a
	sbc.sis	hl, bc
	call	pe, __setflag
	jp	p, BB45_87
	bit	0, a
	ld	iy, _pos_history_count
	jp	z, BB45_86
	jp	BB45_88
BB45_83:
	ld	hl, (ix - 60)
	call	__sneg
	ld	c, l
	ld	b, h
	ld	hl, (ix - 60)
	call	__snot
	ld	de, (ix - 88)
	push	de
	ld	de, 1
	push	de
	ld	de, (ix - 100)
	push	de
	ld	(ix - 57), bc
	push	bc
	push	hl
	ld	bc, -137
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_negamax
	ld	iy, 21
	add	iy, sp
	ld	sp, iy
	call	__sneg
	ld	c, l
	ld	b, h
	ld	hl, (ix - 60)
	or	a, a
	sbc.sis	hl, bc
	call	pe, __setflag
	jp	p, BB45_87
	ld	a, (_search_stopped)
	ld	l, c
	ld	h, b
	ld	de, (ix + 15)
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	ld	iy, _pos_history_count
	jp	p, BB45_88
	bit	0, a
	jr	nz, BB45_88
BB45_86:
	ld	de, (ix - 57)
	jp	BB45_76
BB45_87:
	ld	iy, _pos_history_count
BB45_88:
	ld	(ix - 57), bc
	ld	hl, (iy)
	add.sis	hl, bc
	or	a, a
	sbc.sis	hl, bc
	jr	z, BB45_90
	dec.sis	hl
	ld	(iy), l
	ld	(iy + 1), h
BB45_90:
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	hl, (ix - 76)
	ld	a, (hl)
	ld	(iy), a
	ld	a, (ix - 47)
	ld	(iy + 1), a
	ld	a, (ix - 46)
	ld	(iy + 2), a
	ld	hl, (ix - 85)
	ld	(iy + 3), hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
	ld	a, (_search_stopped)
	bit	0, a
	jp	nz, BB45_128
	ld	bc, -134
	lea	hl, ix
	add	hl, bc
	ld	hl, (hl)
	ld	de, (ix - 57)
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	jp	p, BB45_97
	ld	hl, (ix - 76)
	ld	a, (hl)
	ld	hl, (ix - 73)
	ld	(hl), a
	ld	a, (ix - 47)
	ld	(ix - 31), a
	ld	a, (ix - 46)
	ld	(ix - 30), a
	ld	a, (ix + 18)
	or	a, a
	ld	e, 0
	ld	iyl, e
	ld	e, (ix - 128)
	jr	nz, BB45_94
	ld	hl, (ix - 76)
	ld	a, (hl)
	ld	hl, _search_best_root_move
	ld	(hl), a
	ld	a, (ix - 47)
	ld	(_search_best_root_move+1), a
	ld	a, (ix - 46)
	ld	(_search_best_root_move+2), a
BB45_94:
	ld	hl, (ix - 60)
	ld	bc, (ix - 57)
	or	a, a
	sbc.sis	hl, bc
	call	pe, __setflag
	jp	p, BB45_98
	ld	l, c
	ld	h, b
	ld	de, (ix + 15)
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	jp	p, BB45_102
	ld	a, 1
	ld	(ix - 67), a
	ld	a, (ix - 128)
	ld	de, -134
	lea	hl, ix
	add	hl, de
	ld	(hl), bc
	ld	l, c
	ld	h, b
	ld	(ix - 60), hl
	jr	BB45_99
BB45_97:
	ld	a, (ix - 128)
	ld	e, 0
	ld	c, e
	jp	BB45_64
BB45_98:
	ld	a, e
	ld	de, -134
	lea	hl, ix
	add	hl, de
	ld	(hl), bc
BB45_99:
	ld	c, iyl
	jp	BB45_64
BB45_100:
	ld	e, c
	ld	d, a
	ld	(ix - 57), iy
	ld	iy, (ix - 54)
BB45_101:
	ld	hl, _move_sp
	ld	(ix - 3), de
	push	ix
	ld	de, -131
	add	ix, de
	ld	bc, (ix)
	pop	ix
	ld	(hl), c
	inc	hl
	ld	(hl), b
	ld	de, -138
	lea	hl, ix
	add	hl, de
	ld	a, (hl)
	inc	a
	ld	h, (ix - 67)
	push	ix
	inc	de
	add	ix, de
	ld	bc, (ix)
	pop	ix
	ld	de, (ix - 3)
	jp	BB45_52
BB45_102:
	ld	d, (ix - 46)
	ld	a, d
	and	a, 1
	bit	0, a
	jp	nz, BB45_112
	ld	c, (ix - 48)
	ld	b, (ix - 47)
	ld	iy, (ix - 109)
	ld	e, (iy)
	ld	a, c
	cp	a, e
	jr	nz, BB45_106
	ld	e, (iy + 1)
	ld	a, b
	cp	a, e
	jr	nz, BB45_106
	ld	e, (iy + 2)
	ld	a, d
	cp	a, e
	jr	z, BB45_107
BB45_106:
	ld	a, (iy)
	ld	hl, (ix - 115)
	ld	(hl), a
	ld	a, (iy + 1)
	ld	(iy + 4), a
	ld	a, (iy + 2)
	ld	(iy + 5), a
	ld	(iy), c
	ld	(iy + 1), b
	ld	(iy + 2), d
BB45_107:
	ld	iy, (ix + 6)
	ld	de, 294
	add	iy, de
	ld	de, 0
	push	de
	pop	hl
	ld	l, (iy)
	ld	e, b
	ld	c, 8
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _history
	push	hl
	pop	iy
	add	iy, bc
	ex	de, hl
	ld	c, 1
	call	__ishl
	push	hl
	pop	de
	add	iy, de
	ld	(ix - 60), iy
	ld	iy, (iy)
	ld	a, iyh
	ld	l, a
	rlc	l
	sbc	hl, hl
	push	hl
	pop	bc
	ld	b, a
	ld	c, iyl
	ld	de, (ix - 112)
	push	de
	pop	hl
	call	__imulu
	ld	bc, -16384
	call	__idivs
	add	hl, de
	ld	e, l
	ld	d, h
	add.sis	iy, de
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	ld.sis	de, 4000
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	jp	m, BB45_109
	ld.sis	hl, 4000
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
BB45_109:
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	ld.sis	de, -3999
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	jp	p, BB45_111
	ld.sis	hl, -4000
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
BB45_111:
	ld	hl, (ix - 60)
	push	de
	ld	e, iyl
	ld	d, iyh
	ld	(hl), e
	inc	hl
	ld	(hl), d
	pop	de
	ld	bc, (ix - 57)
BB45_112:
	ld	a, 3
	ld	(ix - 67), a
	ld	e, 1
	ld	l, c
	ld	h, b
	ld	(ix - 60), hl
	ld	iy, (ix - 54)
	ld	d, (ix - 128)
	jp	BB45_101
BB45_113:
	ld	a, d
	or	a, a
	ld	bc, (ix - 57)
	jr	nz, BB45_116
	ld.sis	de, -29000
	add.sis	iy, de
	ld	a, (ix - 64)
	or	a, a
	ld.sis	hl, 0
	jp	nz, BB45_14
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	jp	BB45_14
BB45_116:
	ld	(ix - 67), h
	ld	l, c
	ld	h, b
	ld.sis	de, -28936
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	jp	m, BB45_118
	ld.sis	hl, 0
BB45_118:
	call	__sneg
	ld	e, l
	ld	d, h
	ld	l, c
	ld	h, b
	ld.sis	bc, 28937
	or	a, a
	sbc.sis	hl, bc
	call	pe, __setflag
	jp	p, BB45_120
	ld	iyl, e
	ld	iyh, d
BB45_120:
	ld	de, (ix - 57)
	add.sis	iy, de
	ld	(ix - 54), iy
	ld	hl, (ix + 6)
	push	hl
	pop	iy
	ld	de, 300
	add	hl, de
	ld	hl, (hl)
	ld	(ix - 60), hl
	ld	de, 304
	add	iy, de
	ld	hl, (iy)
	ld	(ix - 51), hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	hl, (ix - 73)
	ld	a, (hl)
	ld	(iy), a
	ld	a, (ix - 31)
	ld	(iy + 1), a
	ld	a, (ix - 30)
	ld	(iy + 2), a
	call	_tt_pack_move
	ld	e, l
	ld	d, h
	pop	hl
	ld	hl, (ix - 60)
	ld	bc, 4095
	call	__iand
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _tt
	add	iy, bc
	ld	hl, (ix - 51)
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, (ix - 54)
	ld	(iy + 2), l
	ld	(iy + 3), h
	ld	(iy + 4), e
	ld	(iy + 5), d
	ld	a, (ix - 61)
	ld	(iy + 6), a
	ld	a, (ix - 67)
	ld	(iy + 7), a
	ld	iy, (ix - 57)
	jp	BB45_14
BB45_121:
	ld	hl, (ix + 6)
	push	hl
BB45_122:
	call	_evaluate
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	jp	BB45_13
BB45_123:
	ld	iy, (ix + 6)
	lea	hl, iy
	ld	de, 294
	add	hl, de
	ld	a, (hl)
	ld	de, 0
	ld	(ix - 57), a
	ld	e, a
	ld	bc, 288
	lea	hl, iy
	add	hl, de
	add	hl, bc
	ld	iy, 0
	push	af
	ld	a, (hl)
	ld	iyl, a
	pop	af
	ld	c, 4
	ex	de, hl
	call	__ishl
	ld	de, 128
	add	hl, de
	push	hl
	pop	bc
BB45_124:
	lea	hl, iy
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB45_51
	ld	hl, (ix + 6)
	add	hl, bc
	ld	de, 0
	ld	e, (hl)
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	and	a, 7
	cp	a, 1
	jr	z, BB45_127
	cp	a, 6
	jr	nz, BB45_129
BB45_127:
	inc	bc
	dec	iy
	jr	BB45_124
BB45_128:
	ld	hl, _move_sp
	ld	bc, -131
	lea	iy, ix
	add	iy, bc
	ld	de, (iy)
	ld	(hl), e
	inc	hl
	ld	(hl), d
	jp	BB45_2
BB45_129:
	ld	de, 296
	ld	iy, (ix + 6)
	lea	hl, iy
	add	hl, de
	ld	a, (hl)
	ld	(ix - 76), a
	ld	de, 300
	add	iy, de
	ld	bc, (iy)
	lea	hl, iy + 3
	ld	(ix - 73), hl
	ld	a, (hl)
	ld	(ix - 82), a
	ld	hl, (ix - 67)
	ld	hl, (hl)
	ld	(ix - 85), hl
	ld	a, (ix - 57)
	xor	a, d
	ld	hl, (ix + 6)
	ld	de, 294
	add	hl, de
	ld	(ix - 97), hl
	ld	(hl), a
	ld	hl, (_zobrist_side)
	ld	a, (_zobrist_side+3)
	ld	e, a
	ld	(ix - 94), bc
	ld	a, (ix - 82)
	call	__lxor
	ld	(ix - 57), hl
	ld	(ix - 91), iy
	ld	(iy), hl
	ld	hl, (ix - 73)
	ld	(hl), e
	ld	hl, _lock_side
	ld	hl, (hl)
	ld	bc, (ix - 85)
	call	__sxor
	ld	a, (ix - 76)
	ld	iy, (ix - 67)
	ld	(iy), l
	ld	(iy + 1), h
	cp	a, -1
	jr	nz, BB45_131
	ld	l, e
	ld	iy, (ix + 6)
	jp	BB45_132
BB45_131:
	and	a, 7
	ld	d, a
	ld	b, 2
	call	__bshl
	ld	(ix - 100), hl
	or	a, a
	sbc	hl, hl
	push	hl
	pop	bc
	ld	c, a
	ld	(ix - 103), bc
	ld	hl, _zobrist_ep_file
	push	hl
	pop	iy
	add	iy, bc
	ld	hl, (iy)
	ld	a, e
	ld	e, (iy + 3)
	ld	bc, (ix - 57)
	call	__lxor
	ld	(ix - 57), hl
	ld	iy, (ix - 91)
	ld	(iy), hl
	ld	hl, (ix - 73)
	ld	(hl), e
	sla	d
	ld	bc, (ix - 103)
	ld	c, d
	ld	hl, _lock_ep_file
	add	hl, bc
	ld	hl, (hl)
	ld	bc, (ix - 100)
	call	__sxor
	ld	iy, (ix + 6)
	ld	bc, 304
	add	iy, bc
	ld	(iy), l
	ld	(iy + 1), h
	ld	iy, (ix + 6)
	ld	l, e
BB45_132:
	ld	de, 296
	add	iy, de
	ld	(ix - 100), iy
	ld	(iy), -1
	push	hl
	ld	hl, (ix - 57)
	push	hl
	call	_search_history_push
	pop	hl
	pop	hl
	ld	a, (ix - 61)
	add	a, -3
	ld	iyl, a
	ld	bc, (ix + 15)
	ld	l, c
	ld	h, b
	call	__sneg
	ld	e, l
	ld	d, h
	ld.sis	hl, 1
	or	a, a
	sbc.sis	hl, bc
	ld	a, (ix + 18)
	inc	a
	ld	bc, (ix - 88)
	push	bc
	ld	bc, 0
	push	bc
	ld	c, a
	push	bc
	push	hl
	push	de
	push	iy
	ld	hl, (ix + 6)
	push	hl
	call	_negamax
	ld	e, l
	ld	d, h
	ld	hl, 21
	add	hl, sp
	ld	sp, hl
	ld	iy, _pos_history_count
	ld	hl, (iy)
	add.sis	hl, bc
	or	a, a
	sbc.sis	hl, bc
	jr	z, BB45_134
	dec.sis	hl
	ld	(iy), l
	ld	(iy + 1), h
BB45_134:
	ld	hl, (ix - 97)
	ld	a, (hl)
	xor	a, 1
	ld	(hl), a
	ld	hl, (ix - 91)
	ld	bc, (ix - 94)
	ld	(hl), bc
	ld	hl, (ix - 73)
	ld	a, (ix - 82)
	ld	(hl), a
	ld	hl, (ix - 67)
	ld	bc, (ix - 85)
	ld	(hl), c
	inc	hl
	ld	(hl), b
	ld	a, (ix - 76)
	ld	hl, (ix - 100)
	ld	(hl), a
	ld	a, (_search_stopped)
	bit	0, a
	jp	nz, BB45_2
	ld	l, e
	ld	h, d
	call	__sneg
	ld	de, (ix + 15)
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	jp	p, BB45_37
	jp	BB45_51
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_check_time
_check_time:
	ld	hl, -3
	call	__frameset
	ld	bc, (_search_max_nodes)
	ld	a, (_search_max_nodes+3)
	ld	d, a
	ld	hl, (_search_nodes)
	ld	(ix - 3), hl
	ld	a, (_search_nodes+3)
	push	bc
	pop	hl
	ld	e, d
	call	__lcmpzero
	jr	z, BB46_2
	ld	hl, (ix - 3)
	ld	e, a
	ld	a, d
	call	__lcmpu
	jr	nc, BB46_6
BB46_2:
	ld	iy, (_search_time_fn)
	ld	a, (_search_deadline+3)
	lea	hl, iy
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB46_7
	ld	hl, (_search_deadline)
	ld	e, a
	call	__lcmpzero
	jr	z, BB46_7
	ld	hl, (ix - 3)
	ld	a, l
	or	a, a
	jr	nz, BB46_7
	call	__indcall
	ld	bc, (_search_deadline)
	ld	a, (_search_deadline+3)
	call	__lcmpu
	jr	c, BB46_7
BB46_6:
	ld	a, 1
	ld	(_search_stopped), a
BB46_7:
	pop	hl
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_quiescence
_quiescence:
	ld	hl, -72
	call	__frameset
	ld.sis	hl, 0
	ld	a, (_search_stopped)
	bit	0, a
	jr	nz, BB47_3
	ld	iy, _search_nodes
	ld	bc, 1
	ld	hl, (_search_nodes)
	lea	iy, iy + 3
	ld	e, (iy)
	ld	iyl, b
	ld	a, iyl
	call	__ladd
	ld	a, e
	ld	(_search_nodes), hl
	ld	(_search_nodes+3), a
	call	_check_time
	ld	a, (_search_stopped)
	bit	0, a
	jr	z, BB47_4
BB47_2:
	ld.sis	hl, 0
BB47_3:
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	jr	BB47_7
BB47_4:
	ld	hl, (ix + 6)
	ld	a, (ix + 15)
	cp	a, 64
	jr	nc, BB47_6
	ld	a, (ix + 18)
	cp	a, 8
	jr	c, BB47_8
BB47_6:
	push	hl
	call	_evaluate
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	pop	hl
BB47_7:
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	ld	sp, ix
	pop	ix
	ret
BB47_8:
	lea	de, ix - 14
	ld	(ix - 39), de
	lea	de, ix - 27
	ld	(ix - 42), de
	push	de
	push	hl
	call	_compute_legal_info
	pop	hl
	pop	hl
	ld	a, (ix - 27)
	or	a, a
	jp	nz, BB47_15
	ld	hl, _raw_moves_buf
	ld	(ix - 36), hl
	ld	hl, (ix + 6)
	push	hl
	call	_evaluate
	ld	c, l
	ld	b, h
	pop	hl
	ld	l, c
	ld	h, b
	ld	de, (ix + 12)
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	ex	de, hl
	jp	p, BB47_17
	ld	a, b
	rlc	a
	sbc	hl, hl
	push	hl
	pop	iy
	ld	iyh, b
	ld	iyl, c
	ld	e, c
	ld	d, b
	ld	bc, (ix + 9)
	push	bc
	pop	hl
	ld	c, e
	ld	b, d
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	jp	m, BB47_12
	ld	hl, (ix + 9)
	ld	c, l
	ld	b, h
BB47_12:
	ld	de, 1100
	add	iy, de
	ld	a, b
	ld	l, a
	rlc	l
	sbc	hl, hl
	push	hl
	pop	de
	ld	d, a
	ld	e, c
	lea	hl, iy
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB47_47
	ld	(ix - 48), bc
	ld	hl, 1
	push	hl
	ld	hl, _raw_moves_buf
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_generate_moves
	ld	c, a
	pop	hl
	pop	hl
	pop	hl
	ld	hl, _move_sp
	ld	hl, (hl)
	ld	de, 0
	push	de
	pop	iy
	ld	(ix - 63), hl
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	ld	(ix - 51), bc
	ld	e, c
	lea	hl, iy
	add	hl, de
	ld	bc, 2049
	ld	(ix - 54), hl
	or	a, a
	sbc	hl, bc
	jp	c, BB47_34
	ld	hl, (ix - 48)
	jp	BB47_3
BB47_15:
	or	a, a
	sbc	hl, hl
	push	hl
	ld	hl, _raw_moves_buf
	ld	(ix - 36), hl
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_generate_moves
	ld	bc, 0
	ld	e, a
	pop	hl
	pop	hl
	pop	hl
	ld	hl, _move_sp
	ld	hl, (hl)
	push	bc
	pop	iy
	ld	(ix - 57), hl
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	ld	(ix - 51), de
	ld	c, e
	lea	hl, iy
	add	hl, bc
	ld	de, 2049
	ld	(ix - 54), hl
	or	a, a
	sbc	hl, de
	jr	c, BB47_18
	ld	hl, (ix + 6)
	jp	BB47_6
BB47_17:
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	jp	BB47_7
BB47_18:
	lea	hl, ix - 30
	ld	(ix - 60), hl
	ld	(ix - 48), bc
	ld	bc, 5
	lea	hl, iy
	call	__imulu
	push	hl
	pop	de
	ld	iy, _move_pool
	add	iy, de
	ld	hl, (ix - 48)
	ld	(ix - 45), iy
	lea	de, iy
BB47_19:
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB47_21
	ld	iy, (ix - 36)
	ld	a, (iy)
	lea	bc, iy
	push	de
	pop	iy
	ld	(iy), a
	push	bc
	pop	iy
	ld	a, (iy + 1)
	push	de
	pop	iy
	ld	(iy + 1), a
	push	bc
	pop	iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	ld.sis	de, 0
	ld	(iy + 3), e
	ld	(iy + 4), d
	lea	iy, iy + 5
	lea	de, iy
	push	bc
	pop	iy
	lea	iy, iy + 3
	ld	(ix - 36), iy
	dec	hl
	jr	BB47_19
BB47_21:
	ld	hl, _move_sp
	ld	de, (ix - 54)
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	(ix - 30), -1
	ld	(ix - 29), -1
	ld	(ix - 28), 0
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	hl, (ix - 60)
	ld	a, (hl)
	ld	(iy), a
	ld	a, (ix - 29)
	ld	(iy + 1), a
	ld	a, (ix - 28)
	ld	(iy + 2), a
	ld	l, (ix + 15)
	push	hl
	ld	hl, (ix - 51)
	push	hl
	ld	hl, (ix - 45)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_score_moves
	ld	bc, (ix - 48)
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (ix + 12)
	call	__sneg
	ld	(ix - 66), hl
	ld	a, (ix + 15)
	inc	a
	ld	l, (ix + 18)
	inc	l
	ld	(ix - 69), hl
	ld	l, a
	ld	(ix - 72), hl
	ld	hl, (ix - 45)
	ld	(ix - 36), hl
	ld	e, 0
	ld	a, e
	ld	iy, (ix + 9)
BB47_22:
	push	bc
	pop	hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB47_32
	ld	(ix - 63), a
	ld	(ix - 48), bc
	ld	(ix - 60), iy
	ld	(ix - 54), de
	push	de
	ld	hl, (ix - 51)
	push	hl
	ld	hl, (ix - 45)
	push	hl
	call	_pick_move
	pop	hl
	pop	hl
	pop	hl
	push	hl
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	iy, (ix - 36)
	ld	a, (iy)
	push	de
	pop	hl
	ld	(hl), a
	ld	a, (iy + 1)
	lea	hl, iy
	push	de
	pop	iy
	ld	(iy + 1), a
	push	hl
	pop	iy
	ld	(ix - 36), iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 42)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_is_evasion_candidate
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jp	z, BB47_26
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	de, (ix - 36)
	push	de
	pop	hl
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 39)
	ld	(iy + 3), hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_make
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_is_legal.25
	pop	hl
	or	a, a
	jr	nz, BB47_28
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	de, (ix - 36)
	push	de
	pop	hl
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 39)
	ld	(iy + 3), hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
BB47_26:
	ld	hl, (ix - 60)
	ld	a, (ix - 63)
BB47_27:
	ld	de, (ix - 54)
	inc	e
	ld	iy, (ix - 36)
	lea	iy, iy + 5
	ld	(ix - 36), iy
	push	hl
	pop	iy
	ld	bc, (ix - 48)
	dec	bc
	jp	BB47_22
BB47_28:
	ld	hl, (ix - 60)
	call	__sneg
	ld	de, (ix - 69)
	push	de
	ld	de, (ix - 72)
	push	de
	push	hl
	ld	hl, (ix - 66)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_quiescence
	pop	de
	pop	de
	pop	de
	pop	de
	pop	de
	call	__sneg
	ld	(ix - 63), hl
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	de, (ix - 36)
	push	de
	pop	hl
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 39)
	ld	(iy + 3), hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
	ld	a, (_search_stopped)
	bit	0, a
	jp	nz, BB47_48
	ld	bc, (ix - 60)
	ld	l, c
	ld	h, b
	ld	de, (ix - 63)
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	ld	a, 1
	ld	de, (ix + 12)
	push	bc
	pop	hl
	jp	p, BB47_27
	ld	bc, (ix - 63)
	ld	l, c
	ld	h, b
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	ld	l, c
	ld	h, b
	ld	a, 1
	jp	m, BB47_27
	ld	hl, _move_sp
	ld	bc, (ix - 57)
	jp	BB47_52
BB47_32:
	ld	hl, _move_sp
	ld	de, (ix - 57)
	ld	(hl), e
	inc	hl
	ld	(hl), d
	or	a, a
	jp	nz, BB47_7
	ld	iyh, 0
	push	af
	ld	a, (ix + 15)
	ld	iyl, a
	pop	af
	ld.sis	de, -29000
	add.sis	iy, de
	jp	BB47_7
BB47_34:
	lea	hl, ix - 33
	ld	(ix - 66), hl
	ld	bc, 5
	lea	hl, iy
	call	__imulu
	push	hl
	pop	bc
	ld	iy, _move_pool
	add	iy, bc
	push	de
	pop	hl
	ld	(ix - 45), iy
	ld	(ix - 60), iy
	ld	(ix - 57), de
BB47_35:
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB47_37
	ld	iy, (ix - 36)
	ld	a, (iy)
	lea	bc, iy
	ld	iy, (ix - 60)
	ld	(iy), a
	lea	de, iy
	push	bc
	pop	iy
	ld	a, (iy + 1)
	push	de
	pop	iy
	ld	(iy + 1), a
	push	bc
	pop	iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	ld.sis	de, 0
	ld	(iy + 3), e
	ld	(iy + 4), d
	lea	iy, iy + 5
	ld	(ix - 60), iy
	push	bc
	pop	iy
	lea	iy, iy + 3
	ld	(ix - 36), iy
	dec	hl
	jr	BB47_35
BB47_37:
	ld	hl, _move_sp
	ld	de, (ix - 54)
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	(ix - 33), -1
	ld	(ix - 32), -1
	ld	(ix - 31), 0
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	hl, (ix - 66)
	ld	a, (hl)
	ld	(iy), a
	ld	a, (ix - 32)
	ld	(iy + 1), a
	ld	a, (ix - 31)
	ld	(iy + 2), a
	ld	l, (ix + 15)
	push	hl
	ld	hl, (ix - 51)
	push	hl
	ld	hl, (ix - 45)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_score_moves
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (ix + 12)
	call	__sneg
	ld	(ix - 60), hl
	ld	e, (ix + 15)
	inc	e
	ld	a, (ix + 18)
	inc	a
	ld	l, a
	ld	(ix - 66), hl
	ld	l, e
	ld	(ix - 69), hl
	ld	hl, (ix - 45)
	ld	(ix - 36), hl
	ld	e, 0
	ld	bc, (ix - 48)
BB47_38:
	ld	hl, (ix - 57)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB47_46
	ld	(ix - 48), bc
	ld	(ix - 54), de
	push	de
	ld	hl, (ix - 51)
	push	hl
	ld	hl, (ix - 45)
	push	hl
	call	_pick_move
	pop	hl
	pop	hl
	pop	hl
	push	hl
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	iy, (ix - 36)
	ld	a, (iy)
	push	de
	pop	hl
	ld	(hl), a
	ld	a, (iy + 1)
	lea	hl, iy
	push	de
	pop	iy
	ld	(iy + 1), a
	push	hl
	pop	iy
	ld	a, (iy + 2)
	push	de
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 42)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_move_needs_legality_check
	ld	(ix - 72), a
	pop	hl
	pop	hl
	pop	hl
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	hl, (ix - 36)
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	ld	iy, (ix - 36)
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	ld	iy, (ix - 36)
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 39)
	ld	(iy + 3), hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_make
	pop	hl
	pop	hl
	pop	hl
	ld	a, (ix - 72)
	or	a, a
	jr	z, BB47_42
	ld	hl, (ix + 6)
	push	hl
	call	_board_is_legal.25
	pop	hl
	or	a, a
	jr	nz, BB47_42
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	de, (ix - 36)
	push	de
	pop	hl
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 39)
	ld	(iy + 3), hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
	ld	bc, (ix - 48)
	jp	BB47_45
BB47_42:
	ld	hl, (ix - 48)
	call	__sneg
	ld	de, (ix - 66)
	push	de
	ld	de, (ix - 69)
	push	de
	push	hl
	ld	hl, (ix - 60)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_quiescence
	pop	de
	pop	de
	pop	de
	pop	de
	pop	de
	call	__sneg
	ld	(ix - 72), hl
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	ld	de, (ix - 36)
	push	de
	pop	hl
	ld	a, (hl)
	ld	(iy), a
	lea	hl, iy
	push	de
	pop	iy
	ld	a, (iy + 1)
	push	hl
	pop	iy
	ld	(iy + 1), a
	push	de
	pop	iy
	ld	a, (iy + 2)
	push	hl
	pop	iy
	ld	(iy + 2), a
	ld	hl, (ix - 39)
	ld	(iy + 3), hl
	ld	hl, (ix + 6)
	push	hl
	call	_board_unmake
	pop	hl
	pop	hl
	pop	hl
	ld	a, (_search_stopped)
	bit	0, a
	jr	nz, BB47_49
	ld	bc, (ix - 48)
	ld	l, c
	ld	h, b
	ld	de, (ix - 72)
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	ld	de, (ix + 12)
	jp	p, BB47_45
	ld	bc, (ix - 72)
	ld	l, c
	ld	h, b
	or	a, a
	sbc.sis	hl, de
	call	pe, __setflag
	jp	p, BB47_51
BB47_45:
	ld	de, (ix - 54)
	inc	e
	ld	iy, (ix - 36)
	lea	iy, iy + 5
	ld	(ix - 36), iy
	ld	hl, (ix - 57)
	dec	hl
	ld	(ix - 57), hl
	jp	BB47_38
BB47_46:
	ld	hl, _move_sp
	ld	de, (ix - 63)
	ld	(hl), e
	inc	hl
	ld	(hl), d
BB47_47:
	ld	iyl, c
	ld	iyh, b
	jp	BB47_7
BB47_48:
	ld	hl, _move_sp
	ld	de, (ix - 57)
	jr	BB47_50
BB47_49:
	ld	hl, _move_sp
	ld	de, (ix - 63)
BB47_50:
	ld	(hl), e
	inc	hl
	ld	(hl), d
	jp	BB47_2
BB47_51:
	ld	hl, _move_sp
	ld	bc, (ix - 63)
BB47_52:
	ld	(hl), c
	inc	hl
	ld	(hl), b
	ld	iyl, e
	ld	iyh, d
	jp	BB47_7
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_compute_legal_info
_compute_legal_info:
	ld	hl, -9
	call	__frameset
	ld	iy, (ix + 6)
	xor	a, a
	ld	(ix - 2), a
	ld	de, 294
	lea	hl, iy
	add	hl, de
	ld	a, (hl)
	ld	de, 0
	ld	e, a
	ld	bc, 292
	lea	hl, iy
	add	hl, de
	add	hl, bc
	ld	(ix - 5), a
	cp	a, b
	jr	z, BB48_2
	ld	a, -128
	ld	(ix - 2), a
BB48_2:
	ld	a, (hl)
	ld	(ix - 1), a
	ld	iy, (ix + 9)
	ld	(iy), 0
	ld	(iy + 1), 0
	ld	(iy + 4), 0
	ld	de, 8
	ld	bc, 0
BB48_3:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jr	z, BB48_9
	ld	hl, _atk_knight_offsets
	ld	(ix - 8), bc
	add	hl, bc
	ld	a, (hl)
	add	a, (ix - 1)
	ld	c, a
	and	a, -120
	or	a, a
	jr	nz, BB48_8
	ld	de, 0
	ld	e, c
	ld	hl, (ix + 6)
	add	hl, de
	ld	de, 8
	ld	l, (hl)
	ld	a, l
	or	a, a
	jr	z, BB48_8
	ld	a, l
	and	a, -128
	ld	e, a
	ld	a, l
	and	a, 7
	ld	l, a
	ld	a, e
	ld	e, (ix - 2)
	cp	a, e
	ld	de, 8
	jr	nz, BB48_8
	ld	a, l
	cp	a, 2
	push	bc
	push	iy
	call	z, _add_checker
	ld	iy, (ix + 9)
	pop	hl
	pop	hl
	ld	de, 8
BB48_8:
	ld	bc, (ix - 8)
	inc	bc
	jr	BB48_3
BB48_9:
	ld	a, (ix - 5)
	cp	a, 1
	ld	a, 16
	jr	z, BB48_11
	ld	a, -16
BB48_11:
	ld	l, (ix - 2)
	inc	l
	ld	(ix - 5), l
	add	a, (ix - 1)
	ld	l, a
	ld	c, l
	dec	c
	ld	a, c
	and	a, -120
	or	a, a
	jr	nz, BB48_13
	ld	(ix - 8), hl
	ld	de, 0
	ld	e, c
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	ld	l, (ix - 5)
	cp	a, l
	push	bc
	push	iy
	call	z, _add_checker
	ld	iy, (ix + 9)
	pop	hl
	pop	hl
	ld	de, 8
	ld	hl, (ix - 8)
BB48_13:
	inc	l
	ld	a, l
	and	a, -120
	or	a, a
	jr	nz, BB48_15
	ld	de, 0
	ld	e, l
	push	hl
	pop	bc
	ld	hl, (ix + 6)
	add	hl, de
	ld	a, (hl)
	ld	l, (ix - 5)
	cp	a, l
	push	bc
	push	iy
	call	z, _add_checker
	pop	hl
	pop	hl
	ld	de, 8
BB48_15:
	ld	bc, 0
	push	bc
	pop	iy
BB48_16:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jr	z, BB48_22
	ld	hl, _atk_ray_offsets
	ld	(ix - 5), bc
	add	hl, bc
	ld	a, (hl)
	add	a, (ix - 1)
	ld	c, a
	and	a, -120
	or	a, a
	jr	nz, BB48_21
	ld	de, 0
	ld	e, c
	ld	hl, (ix + 6)
	add	hl, de
	push	bc
	pop	de
	ld	c, (hl)
	ld	a, c
	and	a, -128
	ld	l, a
	ld	a, c
	and	a, 7
	ld	h, a
	ld	a, c
	ld	iy, 0
	or	a, a
	jr	z, BB48_21
	ld	a, l
	ld	l, (ix - 2)
	cp	a, l
	jr	nz, BB48_21
	ld	a, h
	cp	a, 6
	push	de
	ld	hl, (ix + 9)
	push	hl
	call	z, _add_checker
	pop	hl
	pop	hl
	ld	iy, 0
BB48_21:
	ld	bc, (ix - 5)
	inc	bc
	ld	de, 8
	jr	BB48_16
BB48_22:
	lea	bc, iy
BB48_23:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jp	z, BB48_39
	ld	hl, _atk_ray_offsets
	add	hl, bc
	ld	e, (hl)
	ld	(ix - 5), bc
	ld	a, c
	dec	a
	ld	(ix - 8), a
	and	a, 63
	ld	b, a
	ld	a, 45
	call	__bshru
	and	a, 1
	ld	(ix - 9), a
	ld	c, -1
	ld	b, (ix - 1)
BB48_25:
	ld	a, b
	add	a, e
	ld	iyl, a
	ld	a, e
	add	a, b
	ld	d, a
	and	a, -120
	or	a, a
	jr	nz, BB48_38
	ld	a, c
	ld	bc, 0
	ld	c, d
	ld	hl, (ix + 6)
	add	hl, bc
	ld	c, a
	ld	d, (hl)
	ld	a, d
	or	a, a
	ld	b, iyl
	jr	z, BB48_25
	ld	a, d
	and	a, -128
	ld	l, (ix - 2)
	cp	a, l
	jr	z, BB48_29
	ld	a, c
	cp	a, -1
	ld	c, iyl
	ld	b, iyl
	jr	z, BB48_25
	jr	BB48_38
BB48_29:
	ld	a, (ix - 8)
	cp	a, 6
	jr	nc, BB48_32
	bit	0, (ix - 9)
	jr	z, BB48_32
	ld	a, d
	and	a, 6
	cp	a, 4
	jr	z, BB48_34
	jr	BB48_38
BB48_32:
	ld	a, d
	and	a, 7
	cp	a, 3
	jr	z, BB48_34
	cp	a, 5
	jr	nz, BB48_38
BB48_34:
	ld	a, c
	cp	a, -1
	jr	nz, BB48_36
	push	iy
	ld	hl, (ix + 9)
	push	hl
	call	_add_checker
	pop	hl
	pop	hl
	jr	BB48_38
BB48_36:
	ld	iy, (ix + 9)
	ld	a, (iy + 4)
	cp	a, 8
	jr	nc, BB48_38
	ld	de, 0
	ld	e, a
	inc	a
	ld	iy, (ix + 9)
	ld	(iy + 4), a
	add	iy, de
	ld	(iy + 5), c
BB48_38:
	ld	bc, (ix - 5)
	inc	bc
	ld	de, 8
	jp	BB48_23
BB48_39:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_score_moves
_score_moves:
	ld	hl, -15
	call	__frameset
	ld	a, (ix + 12)
	ld	iy, _killers
	ld	l, (ix + 19)
	ld	(ix - 10), l
	ld	l, (ix + 20)
	ld	(ix - 11), l
	or	a, a
	sbc	hl, hl
	ld	l, (ix + 15)
	ld	bc, 6
	call	__imulu
	push	hl
	pop	de
	add	iy, de
	ld	(ix - 9), iy
	ld	bc, 0
	ld	c, a
	ld	iy, (ix + 9)
	lea	iy, iy + 3
BB49_1:
	push	bc
	pop	hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	z, BB49_28
	ld	e, (iy - 3)
	ld	h, (iy - 2)
	ld	d, (iy - 1)
	ld	a, e
	ld	l, (ix + 18)
	cp	a, l
	jr	nz, BB49_6
	ld	a, h
	ld	l, (ix - 10)
	cp	a, l
	jr	nz, BB49_6
	ld	a, d
	xor	a, (ix - 11)
	and	a, 56
	or	a, a
	jr	nz, BB49_6
	ld.sis	hl, 30000
	ld	(iy), l
	ld	(iy + 1), h
	jp	BB49_27
BB49_6:
	ld	a, d
	and	a, 1
	bit	0, a
	ld	(ix - 3), bc
	ld	(ix - 6), iy
	jp	nz, BB49_15
	ld	(ix - 12), h
	ld	a, (ix + 15)
	cp	a, 64
	jp	nc, BB49_14
	ld	hl, (ix - 9)
	ld	l, (hl)
	ld	a, e
	cp	a, l
	jp	nz, BB49_11
	ld	iy, (ix - 9)
	ld	l, (iy + 1)
	ld	a, (ix - 12)
	cp	a, l
	jp	nz, BB49_11
	ld	iy, (ix - 9)
	ld	l, (iy + 2)
	ld	a, d
	cp	a, l
	ld.sis	hl, 9000
	jp	z, BB49_22
BB49_11:
	ld	iy, (ix - 9)
	ld	l, (iy + 3)
	ld	a, e
	cp	a, l
	jp	nz, BB49_14
	ld	iy, (ix - 9)
	ld	l, (iy + 4)
	ld	a, (ix - 12)
	cp	a, l
	jp	nz, BB49_14
	ld	iy, (ix - 9)
	ld	l, (iy + 5)
	ld	a, d
	cp	a, l
	ld.sis	hl, 8000
	jp	z, BB49_22
BB49_14:
	ld	iy, (ix + 6)
	ld	a, d
	ld	de, 294
	add	iy, de
	ld	de, 0
	push	de
	pop	hl
	ld	l, (iy)
	ld	e, (ix - 12)
	ld	c, 8
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _history
	add	iy, bc
	ex	de, hl
	ld	c, 1
	call	__ishl
	push	hl
	pop	de
	add	iy, de
	ld	d, a
	ld	hl, (iy)
	jp	BB49_22
BB49_15:
	ld	(ix - 15), e
	ld	(ix - 12), d
	ld	de, 0
	ld	e, h
	ld	hl, (ix + 6)
	add	hl, de
	ld	d, (ix - 12)
	ld	a, (hl)
	and	a, 7
	ld	c, a
	bit	2, d
	jr	z, BB49_17
	ld	c, 1
BB49_17:
	ld	a, c
	or	a, a
	ld.sis	hl, 10000
	ld	e, (ix - 15)
	jp	z, BB49_22
	ld	a, c
	cp	a, 7
	ld.sis	hl, 10000
	jp	z, BB49_22
	ld	a, e
	ld	de, 0
	ld	e, a
	ld	hl, (ix + 6)
	add	hl, de
	ld	d, (ix - 12)
	ld	a, (hl)
	and	a, 7
	ld	e, a
	or	a, a
	ld.sis	hl, 10000
	jp	z, BB49_22
	ld	a, e
	cp	a, 7
	ld.sis	hl, 10000
	jr	z, BB49_22
	or	a, a
	sbc	hl, hl
	ld	l, c
	ld	bc, 0
	ld	c, e
	ld	(ix - 15), bc
	dec	hl
	ld	bc, 6
	call	__imulu
	push	hl
	pop	de
	ld	iy, _mvv_lva
	add	iy, de
	ld	de, (ix - 15)
	add	iy, de
	ld	h, b
	ld	l, (iy - 1)
	ld.sis	de, 10000
	add.sis	hl, de
	ld	d, (ix - 12)
BB49_22:
	ld	iy, (ix - 6)
	ld	(iy), l
	ld	(iy + 1), h
	bit	3, d
	ld	bc, (ix - 3)
	jr	z, BB49_27
	ld	a, d
	and	a, 48
	or	a, a
	jr	nz, BB49_25
	ld.sis	de, 5000
	jr	BB49_26
BB49_25:
	ld.sis	de, 1000
BB49_26:
	add.sis	hl, de
	ld	(iy), l
	ld	(iy + 1), h
BB49_27:
	lea	iy, iy + 5
	dec	bc
	jp	BB49_1
BB49_28:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_pick_move
_pick_move:
	ld	hl, -14
	call	__frameset
	lea	hl, ix - 5
	ld	(ix - 8), hl
	or	a, a
	sbc	hl, hl
	ld	l, (ix + 12)
	ld	bc, 5
	ld	(ix - 14), hl
	call	__imulu
	push	hl
	pop	de
	ld	iy, (ix + 6)
	add	iy, de
	ld	de, (iy + 3)
	ld	a, (ix + 12)
	inc	a
	or	a, a
	sbc	hl, hl
	ld	l, a
	call	__imulu
	push	hl
	pop	bc
	ld	l, (ix + 9)
	ld	iy, (ix + 6)
	add	iy, bc
	lea	iy, iy + 3
	ld	h, (ix + 12)
BB50_1:
	cp	a, l
	jr	nc, BB50_7
	ld	(ix - 11), h
	ld	bc, (iy)
	ld	l, e
	ld	h, d
	or	a, a
	sbc.sis	hl, bc
	call	pe, __setflag
	ld	l, a
	jp	m, BB50_4
	ld	l, (ix - 11)
BB50_4:
	ld	(ix - 11), l
	ld	l, e
	ld	h, d
	or	a, a
	sbc.sis	hl, bc
	call	pe, __setflag
	jp	m, BB50_6
	ld	c, e
	ld	b, d
BB50_6:
	lea	iy, iy + 5
	inc	a
	ld	h, (ix - 11)
	ld	e, c
	ld	d, b
	ld	l, (ix + 9)
	jr	BB50_1
BB50_7:
	ld	a, h
	ld	l, (ix + 12)
	cp	a, l
	jr	z, BB50_9
	ld	bc, 5
	ld	a, h
	ld	hl, (ix - 14)
	call	__imulu
	push	hl
	pop	de
	ld	iy, (ix + 6)
	lea	hl, iy
	add	hl, de
	push	hl
	pop	bc
	ld	(ix - 11), bc
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	(ix - 14), hl
	ld	de, (ix - 8)
	push	bc
	pop	hl
	ld	bc, 5
	ldir
	ld	hl, (ix - 14)
	ld	bc, 5
	call	__imulu
	push	hl
	pop	de
	add	iy, de
	ld	de, (ix - 11)
	lea	hl, iy
	ldir
	lea	de, iy
	ld	hl, (ix - 8)
	ld	bc, 5
	ldir
BB50_9:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_is_evasion_candidate
_is_evasion_candidate:
	ld	hl, -5
	call	__frameset
	ld	iy, (ix + 9)
	ld	e, 1
	or	a, a
	sbc	hl, hl
	ld	a, (iy)
	or	a, a
	jr	z, BB51_5
	ld	(ix - 3), hl
	ld	hl, (ix + 6)
	ld	a, (ix + 12)
	ld	bc, 0
	ld	c, a
	add	hl, bc
	ld	a, (hl)
	and	a, 7
	cp	a, 6
	jr	nz, BB51_3
BB51_2:
	ld	e, 1
	jr	BB51_5
BB51_3:
	ld	a, (iy + 1)
	cp	a, 2
	jr	c, BB51_6
BB51_4:
	ld	e, 0
BB51_5:
	ld	a, e
	ld	sp, ix
	pop	ix
	ret
BB51_6:
	ld	l, (iy + 2)
	ld	e, (ix + 13)
	ld	a, e
	cp	a, l
	jr	z, BB51_2
	bit	2, (ix + 14)
	jr	z, BB51_12
	ld	d, l
	ld	hl, (ix + 6)
	ld	bc, 294
	add	hl, bc
	ld	a, (hl)
	or	a, a
	jr	z, BB51_10
	ld	a, -16
	jr	BB51_11
BB51_10:
	ld	a, 16
BB51_11:
	ld	l, d
	add	a, e
	cp	a, l
	jr	z, BB51_2
BB51_12:
	ld	(ix - 4), l
	ld	(ix - 5), e
	ld	de, 0
	push	de
	pop	bc
	ld	c, l
	ld	iy, (ix + 6)
	lea	hl, iy
	add	hl, bc
	ld	a, (hl)
	and	a, 7
	add	a, -3
	cp	a, 3
	jr	nc, BB51_4
	lea	hl, iy
	ld	bc, 294
	add	hl, bc
	ld	e, (hl)
	ld	bc, 292
	add	iy, de
	add	iy, bc
	ld	a, (iy)
	ld	de, 8
BB51_14:
	ld	bc, (ix - 3)
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jr	z, BB51_4
	ld	hl, _atk_ray_offsets
	add	hl, bc
	ld	l, (hl)
	ld	c, a
	ld	h, a
BB51_16:
	ld	a, l
	add	a, h
	and	a, -120
	or	a, a
	jr	nz, BB51_18
	ld	a, h
	add	a, l
	ld	h, a
	ld	a, (ix - 4)
	cp	a, h
	jr	nz, BB51_16
	jr	BB51_19
BB51_18:
	ld	hl, (ix - 3)
	inc	hl
	ld	(ix - 3), hl
	ld	a, c
	jr	BB51_14
BB51_19:
	ld	a, (ix - 4)
	sub	a, l
	ld	h, a
BB51_20:
	ld	e, c
	ld	a, e
	add	a, l
	ld	c, a
	ld	a, h
	cp	a, e
	jp	z, BB51_4
	ld	a, (ix - 5)
	cp	a, c
	jr	nz, BB51_20
	jp	BB51_2
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_move_needs_legality_check
_move_needs_legality_check:
	call	__frameset0
	ld	iy, (ix + 9)
	ld	d, 0
	ld	e, 1
	ld	a, (iy)
	or	a, a
	jr	nz, BB52_7
	bit	2, (ix + 14)
	jr	nz, BB52_7
	ld	hl, (ix + 6)
	ld	a, (ix + 12)
	ld	bc, 0
	ld	c, a
	add	hl, bc
	ld	a, (hl)
	and	a, 7
	cp	a, 6
	jr	z, BB52_7
	or	a, a
	sbc	hl, hl
	ld	l, (iy + 4)
	lea	iy, iy + 5
	ld	c, (ix + 12)
BB52_4:
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB52_6
	dec	hl
	ld	a, (iy)
	inc	iy
	cp	a, c
	jr	nz, BB52_4
	jr	BB52_7
BB52_6:
	ld	e, d
BB52_7:
	ld	a, e
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_board_is_legal.25
_board_is_legal.25:
	call	__frameset0
	ld	bc, (ix + 6)
	ld	de, 294
	push	bc
	pop	hl
	add	hl, de
	ld	l, (hl)
	ld	a, l
	xor	a, d
	ld	de, 0
	ld	e, a
	push	bc
	pop	iy
	add	iy, de
	ld	de, 292
	add	iy, de
	ld	a, (iy)
	push	hl
	ld	l, a
	push	hl
	push	bc
	call	_is_square_attacked
	pop	hl
	pop	hl
	pop	hl
	or	a, a
	jr	z, BB53_2
	ld	a, 0
	jr	BB53_3
BB53_2:
	ld	a, 1
BB53_3:
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_add_checker
_add_checker:
	call	__frameset0
	ld	iy, (ix + 6)
	ld	a, (iy + 1)
	cp	a, 2
	jr	nc, BB54_2
	ld	l, (ix + 9)
	ld	de, 0
	ld	e, a
	lea	bc, iy
	add	iy, de
	ld	(iy + 2), l
	push	bc
	pop	iy
BB54_2:
	inc	a
	ld	(iy + 1), a
	ld	(iy), 1
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_tt_clear
_tt_clear:
	ld	hl, _tt
	xor	a, a
	ld	(_tt), a
	push	hl
	pop	de
	inc	de
	ld	bc, 32767
	ldir
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_tt_probe
_tt_probe:
	ld	hl, -3
	call	__frameset
	ld	hl, (ix + 6)
	ld	bc, 4095
	ld	iy, _tt
	call	__iand
	push	hl
	pop	de
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	add	iy, bc
	ld	(ix - 3), iy
	ld	a, (iy + 7)
	or	a, a
	jr	nz, BB56_2
	xor	a, a
	jp	BB56_4
BB56_2:
	ld	c, 3
	push	de
	pop	hl
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _tt
	add	hl, bc
	ld	hl, (hl)
	ld	bc, (ix + 12)
	or	a, a
	sbc.sis	hl, bc
	ld	a, 0
	jr	nz, BB56_4
	ld	a, 1
	ld	c, 3
	ex	de, hl
	call	__ishl
	push	hl
	pop	de
	ld	hl, _tt
	add	hl, de
	push	hl
	pop	bc
	push	bc
	pop	iy
	ld	de, (iy + 2)
	ld	hl, (ix + 15)
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	de, (iy + 4)
	ld	hl, (ix + 18)
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	l, (iy + 6)
	ld	iy, (ix + 21)
	ld	(iy), l
	ld	iy, (ix - 3)
	ld	l, (iy + 7)
	ld	iy, (ix + 24)
	ld	(iy), l
BB56_4:
	pop	hl
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_tt_store
_tt_store:
	call	__frameset0
	ld	hl, (ix + 6)
	ld	a, (ix + 21)
	ld	e, (ix + 24)
	ld	bc, 4095
	ld	iy, _tt
	call	__iand
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	add	iy, bc
	ld	hl, (ix + 12)
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, (ix + 15)
	ld	(iy + 2), l
	ld	(iy + 3), h
	ld	hl, (ix + 18)
	ld	(iy + 4), l
	ld	(iy + 5), h
	ld	(iy + 6), a
	ld	(iy + 7), e
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_tt_pack_move
_tt_pack_move:
	call	__frameset0
	ld	l, (ix + 6)
	ld	a, l
	srl	a
	and	a, 56
	ld	e, a
	ld	a, l
	and	a, 7
	ld	l, a
	ld	a, e
	add	a, l
	ld	e, a
	ld	l, (ix + 7)
	ld	a, l
	srl	a
	and	a, 56
	ld	c, a
	ld	a, l
	and	a, 7
	ld	l, a
	ld	a, c
	add	a, l
	ld	l, a
	ld	d, 0
	ld	h, d
	ld	c, 6
	call	__sshl
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
	add.sis	iy, de
	ld	a, (ix + 8)
	bit	3, a
	jr	z, BB58_2
	ld	b, 4
	ld.sis	de, 4096
	call	__bshru
	and	a, 3
	ld	l, a
	ld	h, e
	ld	c, 13
	call	__sshl
	ld	c, l
	ld	b, h
	add.sis	iy, bc
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	ld	c, e
	ld	b, d
	call	__sor
	ex	de, hl
	ld	iyl, e
	ld	iyh, d
	ex	de, hl
BB58_2:
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_tt_unpack_move
_tt_unpack_move:
	call	__frameset0
	ld	de, (ix + 6)
	ld	iy, (ix + 9)
	ld	c, 6
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	call	__sshru
	ld	a, iyl
	add	a, a
	and	a, 112
	ld	c, a
	ld	a, iyl
	and	a, 7
	ld	b, a
	ld	a, c
	add	a, b
	push	de
	pop	iy
	ld	(iy), a
	ld	a, l
	add	a, a
	and	a, 112
	ld	c, a
	ld	a, l
	and	a, 7
	ld	l, a
	ld	a, c
	add	a, l
	ld	(iy + 1), a
	ld	iy, (ix + 9)
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	ld.sis	bc, 4096
	call	__sand
	ld	e, l
	ld	d, h
	ld	c, 9
	ex	de, hl
	ld	e, iyl
	ld	d, iyh
	ex	de, hl
	call	__sshru
	ld	a, l
	and	a, 48
	add	a, 8
	ld	l, e
	ld	h, d
	ld	e, 0
	add.sis	hl, bc
	or	a, a
	sbc.sis	hl, bc
	jr	z, BB59_2
	ld	e, a
BB59_2:
	ld	hl, (ix + 6)
	push	hl
	pop	iy
	ld	(iy + 2), e
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_zobrist_is_initialized
_zobrist_is_initialized:
	ld	a, (_zobrist_initialized)
	and	a, 1
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_zobrist_init
_zobrist_init:
	ld	hl, -12
	call	__frameset
	ld	hl, (ix + 6)
	ld	a, (ix + 9)
	ld	bc, 0
	ld	e, a
	call	__lcmpzero
	jr	z, BB61_2
	ld	d, 0
	jr	BB61_3
BB61_2:
	ld	d, 1
BB61_3:
	bit	0, d
	jr	z, BB61_5
	ld	hl, 3430008
BB61_5:
	ld	iyl, 1
	bit	0, d
	jr	z, BB61_7
	ld	a, 18
BB61_7:
	ld	de, _zobrist_piece
	ld	(ix - 3), de
	ld	de, _lock_piece
	ld	(ix - 6), de
	ld	(_prng_state), hl
	ld	(_prng_state+3), a
	ld	a, iyl
	ld	(_zobrist_initialized), a
	ld	de, 12
	push	bc
	pop	iy
BB61_8:
	lea	hl, iy
	or	a, a
	sbc	hl, de
	push	bc
	pop	hl
	jr	z, BB61_12
BB61_9:
	ld	(ix - 9), hl
	ld	de, 256
	or	a, a
	sbc	hl, de
	jr	z, BB61_11
	ld	(ix - 12), iy
	call	_prng_next
	ld	a, e
	ld	bc, (ix - 9)
	push	bc
	pop	de
	ld	iy, (ix - 3)
	add	iy, de
	ld	(iy), hl
	push	bc
	pop	hl
	ld	(iy + 3), a
	ld	iy, (ix - 12)
	ld	bc, 0
	ld	de, 4
	add	hl, de
	jr	BB61_9
BB61_11:
	inc	iy
	ld	hl, (ix - 3)
	ld	de, 256
	add	hl, de
	ld	(ix - 3), hl
	ld	de, 12
	jr	BB61_8
BB61_12:
	ld	de, 64
	push	bc
	pop	iy
BB61_13:
	lea	hl, iy
	or	a, a
	sbc	hl, de
	jr	z, BB61_15
	ld	(ix - 3), iy
	call	_prng_next
	ld	bc, (ix - 3)
	ld	iy, _zobrist_castle
	add	iy, bc
	ld	(iy), hl
	ld	(iy + 3), e
	ld	iy, (ix - 3)
	ld	bc, 0
	ld	de, 4
	add	iy, de
	ld	de, 64
	jr	BB61_13
BB61_15:
	ld	(ix - 3), bc
BB61_16:
	call	_prng_next
	push	hl
	pop	iy
	ld	hl, (ix - 3)
	ld	bc, 32
	or	a, a
	sbc	hl, bc
	jr	z, BB61_18
	ld	hl, (ix - 3)
	ld	(ix - 9), hl
	ld	(ix - 12), iy
	ld	iy, _zobrist_ep_file
	ld	bc, (ix - 9)
	add	iy, bc
	ld	bc, (ix - 12)
	ld	(iy), bc
	ld	(iy + 3), e
	ld	de, 4
	add	hl, de
	ld	(ix - 3), hl
	jr	BB61_16
BB61_18:
	ld	(_zobrist_side), iy
	ld	a, e
	ld	(_zobrist_side+3), a
	ld	de, 0
	ld	(ix - 3), de
	ld	bc, 12
BB61_19:
	ld	hl, (ix - 3)
	or	a, a
	sbc	hl, bc
	push	de
	pop	hl
	jr	z, BB61_23
BB61_20:
	push	bc
	pop	iy
	ld	(ix - 9), hl
	ld	bc, 128
	or	a, a
	sbc	hl, bc
	jr	z, BB61_22
	call	_prng_next16
	ld	bc, (ix - 9)
	push	bc
	pop	de
	ld	iy, (ix - 6)
	add	iy, de
	ld	(iy), l
	ld	(iy + 1), h
	push	bc
	pop	hl
	ld	de, 0
	ld	bc, 2
	add	hl, bc
	ld	bc, 12
	jr	BB61_20
BB61_22:
	ld	hl, (ix - 3)
	inc	hl
	ld	(ix - 3), hl
	ld	hl, (ix - 6)
	ld	bc, 128
	add	hl, bc
	ld	(ix - 6), hl
	lea	bc, iy
	jr	BB61_19
BB61_23:
	push	de
	pop	iy
BB61_24:
	lea	hl, iy
	ld	bc, 32
	or	a, a
	sbc	hl, bc
	jr	z, BB61_26
	ld	(ix - 3), iy
	call	_prng_next16
	ld	de, (ix - 3)
	ld	iy, _lock_castle
	add	iy, de
	ld	(iy), l
	ld	(iy + 1), h
	ld	iy, (ix - 3)
	ld	de, 0
	ld	bc, 2
	add	iy, bc
	jr	BB61_24
BB61_26:
	ld	(ix - 3), de
BB61_27:
	call	_prng_next16
	ld	e, l
	ld	d, h
	ld	iy, (ix - 3)
	lea	hl, iy
	ld	bc, 16
	or	a, a
	sbc	hl, bc
	jr	z, BB61_29
	lea	bc, iy
	ld	hl, _lock_ep_file
	add	hl, bc
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	de, 2
	add	iy, de
	ld	(ix - 3), iy
	jr	BB61_27
BB61_29:
	ld	hl, _lock_side
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_prng_next
_prng_next:
	ld	iy, _prng_state
	ld	bc, (_prng_state)
	lea	hl, iy + 3
	ld	d, (hl)
	ld	l, 13
	push	bc
	pop	iy
	ld	a, d
	call	__lshl
	push	bc
	pop	hl
	ld	e, a
	lea	bc, iy
	ld	a, d
	call	__lxor
	push	hl
	pop	iy
	ld	d, e
	ld	l, 17
	lea	bc, iy
	ld	a, d
	call	__lshru
	push	bc
	pop	hl
	ld	e, a
	lea	bc, iy
	ld	a, d
	call	__lxor
	push	hl
	pop	iy
	ld	d, e
	ld	l, 5
	lea	bc, iy
	ld	a, d
	call	__lshl
	push	bc
	pop	hl
	ld	e, a
	lea	bc, iy
	ld	a, d
	call	__lxor
	ld	(_prng_state), hl
	ld	a, e
	ld	(_prng_state+3), a
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_prng_next16
_prng_next16:
	call	_prng_next
	push	hl
	pop	bc
	ld	a, e
	ld	l, 16
	call	__lshru
	ld	l, c
	ld	h, b
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	public	_main
_main:
	ld	hl, -44
	call	__frameset
	ld	hl, _piece_sprites
	ld	(ix - 11), hl
	ld	hl, _piece_sprites-20
	ld	(ix - 14), hl
	ld	hl, _piece_spr_data+2
	ld	(ix - 17), hl
	lea	hl, ix - 5
	ld	(ix - 41), hl
	call	_gfx_Begin
	ld	hl, 1
	push	hl
	call	_gfx_SetDraw
	pop	hl
	ld.sis	hl, 4228
	ld	iy, -1900032
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 31606
	ld	iy, -1900030
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 23084
	ld	iy, -1900028
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 31696
	ld	iy, -1900026
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 24360
	ld	iy, -1900024
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 26445
	ld	iy, -1900022
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 22151
	ld	iy, -1900020
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 31677
	ld	iy, -1900018
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 2115
	ld	e, l
	ld	d, h
	ld	hl, -1900016
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld.sis	hl, 8457
	ld	iy, -1900014
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 6655
	ld	iy, -1900012
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 28539
	ld	iy, -1900010
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 8732
	ld	iy, -1900008
	ld	(iy), l
	ld	(iy + 1), h
	ld	hl, -1900006
	ld	(hl), e
	inc	hl
	ld	(hl), d
	ld.sis	hl, 6343
	ld	iy, -1900004
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 5285
	ld	iy, -1900002
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 13004
	ld	iy, -1900000
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 11050
	ld	iy, -1899998
	ld	(iy), l
	ld	(iy + 1), h
	ld.sis	hl, 27879
	ld	iy, -1899996
	ld	(iy), l
	ld	(iy + 1), h
	ld	de, 6
	ld	bc, 0
BB64_1:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jp	z, BB64_38
	ld	(ix - 32), bc
	push	bc
	pop	hl
	ld	c, 1
	call	__ishl
	ld	(ix - 35), hl
	ld	hl, (ix - 17)
	ld	(ix - 8), hl
	ld	bc, 0
BB64_3:
	push	bc
	pop	hl
	ld	de, 2
	or	a, a
	sbc	hl, de
	jp	z, BB64_37
	push	bc
	pop	iy
	ld	de, (ix - 35)
	add	iy, de
	ld	(ix - 29), bc
	push	bc
	pop	hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	a, 7
	ld	(ix - 26), a
	jr	z, BB64_6
	ld	a, 8
	ld	(ix - 26), a
BB64_6:
	lea	hl, iy
	ld	bc, 402
	call	__imulu
	push	hl
	pop	de
	ld	iy, _piece_spr_data
	add	iy, de
	ld	(iy), 20
	ld	(iy + 1), 20
	ld	hl, (ix - 8)
	ld	(ix - 20), hl
	ld	hl, (ix - 11)
	ld	(ix - 23), hl
	ld	bc, 0
BB64_7:
	push	bc
	pop	hl
	ld	de, 20
	or	a, a
	sbc	hl, de
	jr	z, BB64_15
	ld	(ix - 38), bc
	ld	de, 0
BB64_9:
	push	de
	pop	hl
	ld	bc, 20
	or	a, a
	sbc	hl, bc
	jr	z, BB64_14
	ld	iy, (ix - 23)
	add	iy, de
	ld	a, (iy)
	cp	a, 1
	ld	l, (ix - 26)
	jr	z, BB64_13
	cp	a, 2
	ld	l, 9
	jr	z, BB64_13
	ld	l, 0
BB64_13:
	ld	iy, (ix - 20)
	add	iy, de
	ld	(iy), l
	inc	de
	jr	BB64_9
BB64_14:
	ld	bc, (ix - 38)
	inc	bc
	ld	iy, (ix - 23)
	lea	iy, iy + 20
	ld	(ix - 23), iy
	ld	iy, (ix - 20)
	lea	iy, iy + 20
	ld	(ix - 20), iy
	jr	BB64_7
BB64_15:
	ld	hl, (ix - 8)
	ld	(ix - 23), hl
	ld	hl, (ix - 14)
	ld	(ix - 20), hl
	ld	iy, 0
BB64_16:
	ld	bc, (ix - 29)
	lea	hl, iy
	ld	de, 20
	or	a, a
	sbc	hl, de
	jp	z, BB64_36
	lea	hl, iy
	inc	hl
	ld	(ix - 38), hl
	ld	de, 0
BB64_18:
	push	de
	pop	hl
	ld	bc, 20
	or	a, a
	sbc	hl, bc
	jp	z, BB64_35
	ld	(ix - 26), iy
	ld	iy, (ix - 20)
	add	iy, de
	ld	a, (iy + 20)
	cp	a, 1
	jr	nz, BB64_34
	ld	hl, (ix - 26)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	a, 1
	ld	c, a
	jr	z, BB64_24
	ld	a, (iy)
	or	a, a
	ld	a, -1
	jr	z, BB64_23
	ld	a, 0
BB64_23:
	ld	hl, (ix - 26)
	ld	bc, 19
	or	a, a
	sbc	hl, bc
	ld	c, a
	ld	a, 1
	ld	b, a
	jr	z, BB64_28
BB64_24:
	ld	l, (iy + 40)
	ld	a, l
	or	a, a
	ld	a, -1
	ld	b, a
	jr	z, BB64_26
	ld	a, 0
	ld	b, a
BB64_26:
	bit	0, c
	jr	nz, BB64_28
	ld	a, l
	or	a, a
	jr	nz, BB64_34
BB64_28:
	ld	iy, (ix - 23)
	add	iy, de
	ld	(iy), 9
	bit	0, c
	jr	z, BB64_31
	ld	hl, (ix - 26)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB64_31
	ld	iy, (ix - 23)
	add	iy, de
	ld	(iy - 20), 9
BB64_31:
	bit	0, b
	jr	z, BB64_34
	ld	hl, (ix - 26)
	ld	bc, 19
	or	a, a
	sbc	hl, bc
	jr	z, BB64_34
	ld	iy, (ix - 23)
	add	iy, de
	ld	(iy + 20), 9
BB64_34:
	inc	de
	ld	iy, (ix - 26)
	jp	BB64_18
BB64_35:
	ld	iy, (ix - 20)
	lea	iy, iy + 20
	ld	(ix - 20), iy
	ld	iy, (ix - 23)
	lea	iy, iy + 20
	ld	(ix - 23), iy
	ld	iy, (ix - 38)
	jp	BB64_16
BB64_36:
	inc	bc
	ld	de, 402
	ld	hl, (ix - 8)
	add	hl, de
	ld	(ix - 8), hl
	jp	BB64_3
BB64_37:
	ld	iy, (ix - 32)
	inc	iy
	ld	hl, (ix - 11)
	ld	de, 400
	add	hl, de
	ld	(ix - 11), hl
	ld	hl, (ix - 17)
	ld	bc, 804
	add	hl, bc
	lea	bc, iy
	ld	(ix - 17), hl
	ld	hl, (ix - 14)
	add	hl, de
	ld	(ix - 14), hl
	ld	de, 6
	jp	BB64_1
BB64_38:
	call	_clock
	push	hl
	call	_srand
	pop	hl
	or	a, a
	sbc	hl, hl
	ld	(_state), hl
	inc	l
	xor	a, a
	ld	(_menu_cursor), a
	ld	a, l
	ld	(_running), a
BB64_39:
	call	_clock
	ld	(ix - 8), hl
	ld	(ix - 11), e
	call	_kb_Scan
	ld	hl, -720878
	push	de
	ld	e, (hl)
	inc	hl
	ld	d, (hl)
	ld	l, e
	ld	h, d
	pop	de
	ld	(ix - 17), hl
	ld	a, l
	ld	(_cur_g1), a
	ld	hl, -720868
	push	de
	ld	e, (hl)
	inc	hl
	ld	d, (hl)
	ld	l, e
	ld	h, d
	pop	de
	ld	(ix - 14), hl
	ld	a, l
	ld	(_cur_g6), a
	ld	hl, -720866
	push	de
	ld	e, (hl)
	inc	hl
	ld	d, (hl)
	ld	iyl, e
	ld	iyh, d
	pop	de
	ld	a, iyl
	ld	(_cur_g7), a
	ld	de, (_state)
	push	de
	pop	hl
	ld	bc, 6
	or	a, a
	sbc	hl, bc
	jp	nc, BB64_192
	ld	hl, JTI64_0
	add	hl, de
	add	hl, de
	add	hl, de
	ld	hl, (hl)
	jp	(hl)
BB64_41:
	ld	a, (_prev_g7)
	cpl
	and	a, iyl
	ld	c, a
	ld	a, (_prev_g6)
	cpl
	ld	hl, (ix - 14)
	and	a, l
	ld	e, a
	ld	a, (_prev_g1)
	cpl
	ld	l, a
	ld	a, c
	and	a, 1
	ld	h, a
	ld	a, (_menu_cursor)
	ld	d, a
	xor	a, 1
	ld	b, a
	ld	a, h
	and	a, b
	ld	h, a
	or	a, d
	ld	d, a
	bit	3, c
	ld	a, -1
	jr	nz, BB64_43
	ld	a, 0
BB64_43:
	and	a, d
	ld	b, a
	xor	a, 1
	and	a, d
	ld	c, a
	bit	0, h
	jr	nz, BB64_45
	bit	0, b
	jr	z, BB64_46
BB64_45:
	ld	a, c
	and	a, 1
	ld	(_menu_cursor), a
BB64_46:
	ld	b, e
	ld	a, e
	and	a, 1
	ld	h, a
	ld	de, (ix - 17)
	ld	a, e
	and	a, 32
	and	a, l
	bit	0, h
	jp	nz, BB64_136
	or	a, a
	jp	nz, BB64_136
	bit	6, b
	jp	nz, BB64_165
	ld	hl, 13
	push	hl
	call	_gfx_FillScreen
	pop	hl
	ld	hl, 3
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 7
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, _.str.3.56
	push	hl
	call	_gfx_GetStringWidth
	push	hl
	pop	de
	pop	hl
	ld	hl, 320
	or	a, a
	sbc	hl, de
	ld	de, 2
	push	de
	pop	bc
	call	__idivs
	ld	de, 40
	push	de
	push	hl
	ld	hl, _.str.3.56
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 9
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 160
	push	hl
	ld	hl, 72
	push	hl
	ld	hl, 80
	push	hl
	call	_gfx_HorizLine_NoClip
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 2
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	push	hl
	pop	de
	push	hl
	pop	iy
BB64_50:
	push	hl
	pop	bc
	ld	de, 6
	or	a, a
	sbc	hl, de
	jp	z, BB64_166
	ld	(ix - 17), bc
	ld	hl, ___const.draw_menu.items
	add	hl, bc
	ld	hl, (hl)
	push	hl
	ld	(ix - 14), iy
	call	_gfx_GetStringWidth
	ld	bc, (ix - 14)
	push	hl
	pop	de
	pop	hl
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB64_53
	push	bc
	pop	de
BB64_53:
	ld	bc, 3
	ld	hl, (ix - 17)
	add	hl, bc
	push	de
	pop	iy
	jr	BB64_50
BB64_54:
	ld	a, (_prev_g7)
	cpl
	and	a, iyl
	ld	e, a
	ld	a, (_prev_g6)
	cpl
	ld	hl, (ix - 14)
	and	a, l
	ld	(ix - 14), a
	ld	a, (_prev_g1)
	cpl
	ld	(ix - 20), a
	ld	(ix - 23), e
	ld	a, e
	and	a, 1
	ld	hl, (_color_cursor)
	push	hl
	pop	iy
	ld	de, 2
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	ld	e, -1
	ld	l, e
	jp	m, BB64_56
	ld	l, 0
BB64_56:
	and	a, l
	ld	d, a
	ld	l, d
	ld	bc, 1
	call	__iand
	push	hl
	pop	bc
	add	iy, bc
	bit	3, (ix - 23)
	ld	a, e
	jr	nz, BB64_58
	ld	a, 0
BB64_58:
	ld	(ix - 23), iy
	lea	hl, iy
	ld	bc, 1
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	ld	l, e
	jp	p, BB64_60
	ld	l, 0
BB64_60:
	and	a, l
	bit	0, d
	jr	nz, BB64_62
	bit	0, a
	jr	z, BB64_63
BB64_62:
	ld	l, a
	ld	c, 23
	call	__ishl
	push	hl
	pop	iy
	add	iy, iy
	sbc	hl, hl
	push	hl
	pop	de
	ld	hl, (ix - 23)
	add	hl, de
	ld	(_color_cursor), hl
BB64_63:
	ld	c, (ix - 14)
	ld	a, c
	and	a, 1
	ld	l, a
	ld	de, (ix - 17)
	ld	a, e
	and	a, 32
	and	a, (ix - 20)
	bit	0, l
	jp	nz, BB64_149
	or	a, a
	jp	nz, BB64_149
	bit	6, c
	jp	nz, BB64_138
	ld	hl, 13
	push	hl
	call	_gfx_FillScreen
	pop	hl
	ld	hl, 2
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 7
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, _.str.16
	push	hl
	call	_gfx_GetStringWidth
	push	hl
	pop	de
	pop	hl
	ld	hl, 320
	or	a, a
	sbc	hl, de
	ld	bc, 2
	call	__idivs
	ld	de, 40
	push	de
	push	hl
	ld	hl, _.str.16
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 9
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 160
	push	hl
	ld	hl, 62
	push	hl
	ld	hl, 80
	push	hl
	call	_gfx_HorizLine_NoClip
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 2
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	push	hl
	pop	de
	push	hl
	pop	iy
BB64_67:
	push	hl
	pop	bc
	ld	de, 9
	or	a, a
	sbc	hl, de
	jp	z, BB64_154
	ld	(ix - 17), bc
	ld	hl, ___const.draw_color_select.items
	add	hl, bc
	ld	hl, (hl)
	push	hl
	ld	(ix - 14), iy
	call	_gfx_GetStringWidth
	ld	bc, (ix - 14)
	push	hl
	pop	de
	pop	hl
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB64_70
	push	bc
	pop	de
BB64_70:
	ld	bc, 3
	ld	hl, (ix - 17)
	add	hl, bc
	push	de
	pop	iy
	jr	BB64_67
BB64_71:
	ld	a, (_prev_g7)
	cpl
	and	a, iyl
	ld	e, a
	ld	a, (_prev_g6)
	cpl
	ld	hl, (ix - 14)
	and	a, l
	ld	(ix - 14), a
	ld	a, (_prev_g1)
	cpl
	ld	(ix - 20), a
	ld	(ix - 23), e
	bit	2, e
	ld	e, -1
	ld	a, e
	jr	nz, BB64_73
	ld	a, 0
BB64_73:
	ld	iy, (_promo_cursor)
	lea	hl, iy
	ld	bc, 3
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	ld	l, e
	jp	m, BB64_75
	ld	l, 0
BB64_75:
	and	a, l
	ld	d, a
	ld	l, d
	ld	bc, 1
	call	__iand
	push	hl
	pop	bc
	add	iy, bc
	bit	1, (ix - 23)
	ld	a, e
	jr	nz, BB64_77
	ld	a, 0
BB64_77:
	ld	(ix - 23), iy
	lea	hl, iy
	ld	bc, 1
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	ld	l, e
	jp	p, BB64_79
	ld	l, 0
BB64_79:
	and	a, l
	ld	l, a
	ld	c, 23
	call	__ishl
	push	hl
	pop	iy
	add	iy, iy
	sbc	hl, hl
	push	hl
	pop	bc
	ld	iy, (ix - 23)
	add	iy, bc
	bit	0, d
	jr	nz, BB64_81
	bit	0, a
	jr	z, BB64_82
BB64_81:
	lea	hl, iy
	ld	(_promo_cursor), hl
BB64_82:
	ld	c, (ix - 14)
	ld	a, c
	and	a, 1
	ld	l, a
	ld	de, (ix - 17)
	ld	a, e
	and	a, 32
	and	a, (ix - 20)
	bit	0, l
	jp	nz, BB64_133
	or	a, a
	jp	nz, BB64_133
	bit	6, c
	jp	nz, BB64_159
	call	_render_playing
	ld	hl, 14
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 60
	push	hl
	ld	hl, 140
	push	hl
	ld	hl, 90
	push	hl
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 11
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 60
	push	hl
	ld	hl, 140
	push	hl
	ld	hl, 90
	push	hl
	push	hl
	call	_gfx_Rectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 11
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, 94
	push	hl
	ld	hl, 120
	push	hl
	ld	hl, _.str.32
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (_current_turn)
	ld	de, 1
	or	a, a
	sbc	hl, de
	ld	hl, _promo_pieces_white
	ld	(ix - 20), hl
	jr	z, BB64_87
	ld	hl, _promo_pieces_black
	ld	(ix - 20), hl
BB64_87:
	ld	hl, 100
	push	hl
	pop	iy
	ld	bc, 0
BB64_88:
	push	bc
	pop	hl
	ld	de, 4
	or	a, a
	sbc	hl, de
	jp	z, BB64_191
	ld	(ix - 14), iy
	ld	de, -4
	add	iy, de
	ld	(ix - 23), iy
	ld	de, (_promo_cursor)
	ld	(ix - 17), bc
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	ld	a, 10
	ld	l, a
	jr	z, BB64_91
	ld	a, 2
	ld	l, a
BB64_91:
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 36
	push	hl
	ld	hl, 30
	push	hl
	ld	hl, 108
	push	hl
	ld	hl, (ix - 23)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (ix - 20)
	ld	de, (ix - 17)
	add	hl, de
	ld	a, (hl)
	ld	hl, 110
	push	hl
	ld	hl, (ix - 14)
	push	hl
	ld	l, a
	push	hl
	call	_draw_piece
	ld	bc, (ix - 17)
	ld	iy, (ix - 14)
	pop	hl
	pop	hl
	pop	hl
	inc	bc
	ld	de, 34
	add	iy, de
	jr	BB64_88
BB64_92:
	ld	a, (_prev_g7)
	cpl
	and	a, iyl
	ld	e, a
	ld	a, (_prev_g6)
	cpl
	ld	hl, (ix - 14)
	and	a, l
	ld	(ix - 14), a
	ld	a, (_prev_g1)
	cpl
	ld	(ix - 23), a
	ld	(ix - 20), e
	ld	a, e
	and	a, 1
	ld	iy, (_difficulty_cursor)
	lea	hl, iy
	ld	de, 2
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	ld	d, -1
	ld	l, d
	jp	m, BB64_94
	ld	l, 0
BB64_94:
	and	a, l
	ld	e, a
	ld	l, e
	ld	bc, 1
	call	__iand
	push	hl
	pop	bc
	add	iy, bc
	bit	3, (ix - 20)
	ld	a, d
	jr	nz, BB64_96
	ld	a, 0
BB64_96:
	ld	(ix - 20), iy
	lea	hl, iy
	ld	bc, 1
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	ld	l, d
	jp	p, BB64_98
	ld	l, 0
BB64_98:
	and	a, l
	ld	l, a
	ld	c, 23
	call	__ishl
	push	hl
	pop	iy
	add	iy, iy
	sbc	hl, hl
	push	hl
	pop	bc
	ld	hl, (ix - 20)
	add	hl, bc
	bit	0, e
	jr	nz, BB64_100
	bit	0, a
	jr	z, BB64_101
BB64_100:
	ld	(_difficulty_cursor), hl
BB64_101:
	ld	c, (ix - 14)
	ld	a, c
	and	a, 1
	ld	b, a
	ld	de, (ix - 17)
	ld	a, e
	and	a, 32
	and	a, (ix - 23)
	bit	0, b
	jp	nz, BB64_139
	or	a, a
	jp	nz, BB64_139
	bit	6, c
	jp	nz, BB64_171
	ld	hl, 13
	push	hl
	call	_gfx_FillScreen
	pop	hl
	ld	hl, 2
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 7
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, _.str.5
	push	hl
	call	_gfx_GetStringWidth
	push	hl
	pop	de
	pop	hl
	ld	hl, 320
	or	a, a
	sbc	hl, de
	ld	bc, 2
	call	__idivs
	ld	de, 24
	push	de
	push	hl
	ld	hl, _.str.5
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 9
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 160
	push	hl
	ld	hl, 48
	push	hl
	ld	hl, 80
	push	hl
	call	_gfx_HorizLine_NoClip
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 2
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	or	a, a
	sbc	hl, hl
	push	hl
	pop	de
	push	hl
	pop	iy
BB64_105:
	push	hl
	pop	bc
	ld	de, 9
	or	a, a
	sbc	hl, de
	jp	z, BB64_172
	ld	(ix - 14), bc
	ld	hl, _difficulty_labels
	add	hl, bc
	ld	hl, (hl)
	push	hl
	ld	(ix - 17), iy
	call	_gfx_GetStringWidth
	ld	bc, (ix - 17)
	push	hl
	pop	de
	pop	hl
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB64_108
	push	bc
	pop	de
BB64_108:
	ld	bc, 3
	ld	hl, (ix - 14)
	add	hl, bc
	push	de
	pop	iy
	jr	BB64_105
BB64_109:
	ld	a, (_prev_g7)
	cpl
	and	a, iyl
	ld	c, a
	ld	a, (_prev_g6)
	cpl
	ld	hl, (ix - 14)
	and	a, l
	ld	e, a
	ld	a, (_prev_g1)
	cpl
	ld	hl, (ix - 17)
	and	a, l
	ld	(ix - 14), a
	ld	a, (_anim_active)
	bit	0, a
	jp	z, BB64_140
	call	_clock
	ld	bc, (_anim_start)
	ld	a, (_anim_start+3)
	call	__lsub
	ld	bc, (_anim_duration)
	ld	a, (_anim_duration+3)
	ld	d, a
	call	__lcmpu
	jp	nc, BB64_150
	ld	(ix - 29), e
	ld	(ix - 26), hl
	ld	(ix - 20), bc
	ld	hl, (_board_flipped)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	a, -1
	jr	z, BB64_113
	ld	a, 0
BB64_113:
	ld	bc, (_anim_from_c)
	ld	iy, 7
	lea	hl, iy
	or	a, a
	sbc	hl, bc
	bit	0, a
	jr	nz, BB64_115
	push	hl
	pop	bc
BB64_115:
	ld	(ix - 14), bc
	ld	bc, (_anim_from_r)
	lea	hl, iy
	ld	(ix - 17), bc
	or	a, a
	sbc	hl, bc
	bit	0, a
	jr	nz, BB64_117
	ld	(ix - 17), hl
BB64_117:
	ld	(ix - 23), d
	ld	de, (_anim_to_c)
	lea	hl, iy
	or	a, a
	sbc	hl, de
	bit	0, a
	jr	nz, BB64_119
	ex	de, hl
BB64_119:
	ld	(ix - 35), de
	ld	de, (_anim_to_r)
	lea	hl, iy
	or	a, a
	sbc	hl, de
	bit	0, a
	ld	bc, (ix - 14)
	jr	nz, BB64_121
	ex	de, hl
BB64_121:
	push	bc
	pop	hl
	ld	bc, 26
	call	__imulu
	ld	(ix - 38), hl
	push	hl
	pop	iy
	ld	bc, 16
	add	iy, bc
	ld	(ix - 14), iy
	ld	hl, (ix - 17)
	ld	bc, 26
	call	__imulu
	ld	(ix - 32), hl
	push	hl
	pop	iy
	ld	bc, 16
	add	iy, bc
	ld	(ix - 17), iy
	ld	hl, (ix - 35)
	ld	bc, 26
	call	__imulu
	push	hl
	pop	iy
	ex	de, hl
	call	__imulu
	ld	(ix - 35), hl
	lea	hl, iy
	ld	de, (ix - 38)
	or	a, a
	sbc	hl, de
	push	hl
	pop	bc
	push	bc
	pop	iy
	add	iy, iy
	sbc	hl, hl
	push	hl
	pop	iy
	ld	hl, (ix - 26)
	ld	e, (ix - 29)
	ld	a, iyl
	call	__lmulu
	ld	bc, (ix - 20)
	ld	a, (ix - 23)
	call	__ldivu
	push	hl
	pop	de
	ld	hl, (ix - 14)
	add	hl, de
	ld	(ix - 14), hl
	ld	hl, (ix - 35)
	ld	de, (ix - 32)
	or	a, a
	sbc	hl, de
	push	hl
	pop	bc
	push	bc
	pop	iy
	add	iy, iy
	sbc	hl, hl
	push	hl
	pop	iy
	ld	hl, (ix - 26)
	ld	e, (ix - 29)
	ld	a, iyl
	call	__lmulu
	ld	bc, (ix - 20)
	ld	a, (ix - 23)
	call	__ldivu
	push	hl
	pop	de
	ld	hl, (ix - 17)
	add	hl, de
	ld	(ix - 17), hl
	call	_render_playing
	ld	a, (_anim_piece)
	ld	l, a
	ld	de, (ix - 17)
	push	de
	ld	de, (ix - 14)
	push	de
	push	hl
	call	_draw_piece
	jp	BB64_190
BB64_122:
	ld	a, (_prev_g6)
	cpl
	ld	hl, (ix - 14)
	and	a, l
	ld	l, a
	and	a, 1
	bit	0, a
	jp	nz, BB64_132
	ld	a, (_prev_g1)
	cpl
	and	a, 32
	ld	de, (ix - 17)
	and	a, e
	or	a, a
	jp	nz, BB64_132
	bit	6, l
	jp	nz, BB64_132
	or	a, a
	sbc	hl, hl
	push	hl
	call	_gfx_FillScreen
	pop	hl
	ld	hl, 3
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 12
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	de, (_winner)
	push	de
	pop	hl
	ld	bc, -1
	or	a, a
	sbc	hl, bc
	ld	bc, _.str.39
	jr	z, BB64_127
	ld	bc, _.str.40
BB64_127:
	ex	de, hl
	ld	de, 1
	or	a, a
	sbc	hl, de
	ld	hl, _.str.38
	jr	z, BB64_129
	push	bc
	pop	hl
BB64_129:
	ld	(ix - 14), hl
	push	hl
	call	_strlen
	pop	de
	ld	bc, -24
	call	__imulu
	ld	de, 320
	add	hl, de
	ld	bc, 2
	call	__idivs
	ld	de, 60
	push	de
	push	hl
	ld	hl, (ix - 14)
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 11
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	a, (_game_over_reason)
	add	a, -2
	cp	a, 5
	ld	hl, _.str.46
	jr	nc, BB64_131
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	bc, 3
	call	__imulu
	push	hl
	pop	de
	ld	hl, _switch.table.main
	add	hl, de
	ld	hl, (hl)
BB64_131:
	ld	(ix - 14), hl
	push	hl
	call	_strlen
	pop	de
	ld	bc, -8
	call	__imulu
	ld	de, 320
	add	hl, de
	ld	bc, 2
	call	__idivs
	ld	de, 100
	push	de
	push	hl
	ld	hl, (ix - 14)
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 160
	push	hl
	ld	hl, 72
	push	hl
	ld	hl, _.str.47
	jp	BB64_189
BB64_132:
	or	a, a
	sbc	hl, hl
	ld	(_state), hl
	xor	a, a
	ld	(_menu_cursor), a
	jp	BB64_192
BB64_133:
	ld	hl, (_current_turn)
	ld	de, 1
	or	a, a
	sbc	hl, de
	ld	hl, _promo_pieces_white
	jr	z, BB64_135
	ld	hl, _promo_pieces_black
BB64_135:
	lea	de, iy
	add	hl, de
	ld	a, (hl)
	ld	hl, (_promo_r)
	ld	de, (_promo_c)
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _board
	add	hl, bc
	add	hl, de
	ld	(hl), a
	ld	a, (_pending_move+4)
	and	a, 1
	ld	e, a
	ld	hl, _update_promotion.promo_flags
	lea	bc, iy
	add	hl, bc
	ld	a, (hl)
	or	a, e
	or	a, 8
	ld	(_pending_move+4), a
	push	hl
	push	hl
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	hl, _pending_move
	ld	bc, 5
	ldir
	call	_apply_engine_move
	pop	hl
	pop	hl
	or	a, a
	jp	nz, BB64_192
	jp	BB64_162
BB64_136:
	bit	0, c
	jp	z, BB64_148
	ld	a, 1
	ld	(_game_mode), a
	or	a, a
	sbc	hl, hl
	ld	(_difficulty_cursor), hl
BB64_138:
	ld	hl, 1
	jp	BB64_163
BB64_139:
	ld	c, 2
	call	__ishl
	push	hl
	pop	de
	ld	iy, _difficulty_times
	add	iy, de
	ld	hl, (iy)
	ld	a, (iy + 3)
	ld	(_think_time_ms), hl
	ld	(_think_time_ms+3), a
	ld	hl, 2
	ld	(_color_cursor), hl
	jp	BB64_163
BB64_140:
	ld	hl, (_ai_thinking)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jp	nz, BB64_152
	ld	a, c
	or	a, a
	jr	nz, BB64_144
	ld	a, e
	or	a, a
	jr	nz, BB64_144
	ld	a, (ix - 14)
	or	a, a
	jp	z, BB64_192
BB64_144:
	ld	(ix - 20), e
	ld	iy, (_cur_r)
	ld	hl, (_cur_c)
	ld	(ix - 26), hl
	ld	hl, (_board_flipped)
	ld	a, c
	and	a, 8
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	(ix - 29), iy
	jp	nz, BB64_195
	or	a, a
	jp	z, BB64_207
	ld	iy, (ix - 29)
	lea	hl, iy
	ld	de, 1
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB64_205
	ld	iy, 0
	jp	BB64_206
BB64_148:
	xor	a, a
	ld	(_game_mode), a
BB64_149:
	call	_start_game
	jp	BB64_192
BB64_150:
	ld	a, (_anim_piece)
	ld	(ix - 17), a
	ld	bc, (_anim_to_r)
	ld	(ix - 14), bc
	ld	de, (_anim_to_c)
	ld	hl, (_has_last_move)
	ld	(ix - 20), hl
	ld	hl, (_last_from_r)
	ld	(ix - 23), hl
	ld	hl, (_last_from_c)
	ld	(ix - 26), hl
	ld	hl, (_last_to_r)
	ld	(ix - 29), hl
	ld	hl, (_last_to_c)
	ld	(ix - 32), hl
	xor	a, a
	ld	(_anim_active), a
	inc	a
	ld	(_screen_dirty), a
	push	bc
	pop	hl
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _board
	add	iy, bc
	add	iy, de
	ld	a, (ix - 17)
	ld	(iy), a
	ld	hl, (_anim_from_r)
	ld	(ix - 35), hl
	ld	(_last_from_r), hl
	ld	hl, (_anim_from_c)
	ld	(ix - 38), hl
	ld	(_last_from_c), hl
	ld	hl, (ix - 14)
	ld	(_last_to_r), hl
	ld	(ix - 17), de
	ld	(_last_to_c), de
	ld	hl, 1
	ld	(_has_last_move), hl
	ld	a, (_pending_move+4)
	ld	c, a
	bit	3, c
	jp	nz, BB64_179
BB64_151:
	push	hl
	push	hl
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	hl, _pending_move
	ld	bc, 5
	ldir
	call	_apply_engine_move
	pop	hl
	pop	hl
	jp	BB64_192
BB64_152:
	ld	de, 1
	or	a, a
	sbc	hl, de
	jp	nz, BB64_184
	ld	hl, 2
	ld	(_ai_thinking), hl
	call	_draw_playing
	jp	BB64_192
BB64_154:
	ld	hl, 320
	lea	de, iy
	or	a, a
	sbc	hl, de
	ld	bc, 2
	call	__idivs
	ld	(ix - 26), hl
	ld	de, -6
	add	hl, de
	ld	(ix - 32), hl
	ld	de, 12
	add	iy, de
	ld	hl, ___const.draw_color_select.items
	ld	(ix - 17), hl
	ld	hl, 80
	ld	(ix - 20), hl
	ld	a, 78
	ld	l, a
	ld	(ix - 23), hl
	ld	bc, 0
BB64_155:
	push	bc
	pop	hl
	ld	de, 3
	or	a, a
	sbc	hl, de
	jp	z, BB64_164
	ld	(ix - 14), iy
	ld	de, (_color_cursor)
	ld	(ix - 29), bc
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	ld	hl, 11
	jr	nz, BB64_158
	ld	hl, 12
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 22
	push	hl
	ld	hl, (ix - 14)
	push	hl
	ld	hl, (ix - 23)
	push	hl
	ld	hl, (ix - 32)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 13
BB64_158:
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, (ix - 17)
	ld	bc, (hl)
	ld	hl, (ix - 20)
	push	hl
	ld	de, (ix - 26)
	push	de
	push	bc
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	bc, (ix - 29)
	inc	bc
	ld	hl, (ix - 23)
	ld	a, l
	add	a, 36
	ld	l, a
	ld	(ix - 23), hl
	ld	de, 36
	ld	hl, (ix - 20)
	add	hl, de
	ld	(ix - 20), hl
	ld	iy, (ix - 17)
	lea	iy, iy + 3
	ld	(ix - 17), iy
	ld	iy, (ix - 14)
	jp	BB64_155
BB64_159:
	ld	hl, (_current_turn)
	ld	de, 1
	or	a, a
	sbc	hl, de
	ld	a, e
	jr	z, BB64_161
	ld	a, -1
BB64_161:
	ld	hl, (_promo_from_r)
	ld	de, (_promo_from_c)
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _board
	lea	hl, iy
	add	hl, bc
	add	hl, de
	ld	(hl), a
	ld	a, (_promo_captured)
	ld	hl, (_promo_r)
	ld	de, (_promo_c)
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	lea	hl, iy
	add	hl, bc
	add	hl, de
	ld	(hl), a
	ld	hl, (_promo_saved_has_last)
	ld	(_has_last_move), hl
	ld	hl, (_promo_saved_from_r)
	ld	(_last_from_r), hl
	ld	hl, (_promo_saved_from_c)
	ld	(_last_from_c), hl
	ld	hl, (_promo_saved_to_r)
	ld	(_last_to_r), hl
	ld	hl, (_promo_saved_to_c)
	ld	(_last_to_c), hl
	scf
	sbc	hl, hl
	ld	(_sel_r), hl
	ld	(_sel_c), hl
	xor	a, a
	ld	(_legal_target_count), a
BB64_162:
	ld	hl, 3
BB64_163:
	ld	(_state), hl
	jp	BB64_192
BB64_164:
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 9
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, 222
	push	hl
	ld	hl, 16
	push	hl
	ld	hl, _.str.17
	jp	BB64_189
BB64_165:
	xor	a, a
	ld	(_running), a
	jp	BB64_192
BB64_166:
	ld	hl, 320
	lea	de, iy
	or	a, a
	sbc	hl, de
	ld	bc, 2
	call	__idivs
	ld	(ix - 29), hl
	ld	de, -6
	add	hl, de
	ld	(ix - 35), hl
	ld	de, 12
	add	iy, de
	ld	hl, ___const.draw_menu.items
	ld	(ix - 17), hl
	ld	hl, 95
	ld	(ix - 20), hl
	ld	a, 93
	ld	l, a
	ld	(ix - 23), hl
	ld	bc, 0
BB64_167:
	push	bc
	pop	hl
	ld	de, 2
	or	a, a
	sbc	hl, de
	jp	z, BB64_187
	ld	(ix - 14), iy
	ld	hl, (ix - 17)
	ld	hl, (hl)
	ld	(ix - 32), hl
	push	hl
	ld	(ix - 26), bc
	call	_gfx_GetStringWidth
	pop	hl
	ld	a, (_menu_cursor)
	ld	l, a
	ld	bc, 1
	call	__iand
	push	hl
	pop	de
	ld	hl, (ix - 26)
	or	a, a
	sbc	hl, de
	ld	hl, 11
	jr	nz, BB64_170
	ld	hl, 12
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 22
	push	hl
	ld	hl, (ix - 14)
	push	hl
	ld	hl, (ix - 23)
	push	hl
	ld	hl, (ix - 35)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 13
BB64_170:
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, (ix - 20)
	push	hl
	ld	hl, (ix - 29)
	push	hl
	ld	hl, (ix - 32)
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	bc, (ix - 26)
	inc	bc
	ld	hl, (ix - 23)
	ld	a, l
	add	a, 40
	ld	l, a
	ld	(ix - 23), hl
	ld	de, 40
	ld	hl, (ix - 20)
	add	hl, de
	ld	(ix - 20), hl
	ld	iy, (ix - 17)
	lea	iy, iy + 3
	ld	(ix - 17), iy
	ld	iy, (ix - 14)
	jp	BB64_167
BB64_171:
	or	a, a
	sbc	hl, hl
	jp	BB64_163
BB64_172:
	ld	hl, 320
	lea	de, iy
	or	a, a
	sbc	hl, de
	ld	bc, 2
	call	__idivs
	ld	(ix - 29), hl
	ld	de, -6
	add	hl, de
	ld	(ix - 44), hl
	ld	de, 12
	add	iy, de
	ld	hl, _difficulty_subtexts
	ld	(ix - 20), hl
	ld	hl, _difficulty_labels
	ld	(ix - 23), hl
	ld	hl, 80
	ld	(ix - 14), hl
	ld	a, 60
	ld	l, a
	ld	(ix - 26), hl
	ld	bc, 0
BB64_173:
	push	bc
	pop	hl
	ld	de, 3
	or	a, a
	sbc	hl, de
	jp	z, BB64_188
	ld	(ix - 17), iy
	ld	hl, (ix - 14)
	ld	de, -18
	add	hl, de
	ld	(ix - 35), hl
	ld	de, (_difficulty_cursor)
	ld	(ix - 32), bc
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	ld	hl, 11
	jr	nz, BB64_176
	ld	hl, 12
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 32
	push	hl
	ld	hl, (ix - 17)
	push	hl
	ld	hl, (ix - 26)
	push	hl
	ld	hl, (ix - 44)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 13
BB64_176:
	ld	(ix - 38), hl
	ld	hl, 2
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, (ix - 38)
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, (ix - 23)
	ld	hl, (hl)
	ld	de, (ix - 35)
	push	de
	ld	de, (ix - 29)
	push	de
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	de, (_difficulty_cursor)
	ld	hl, (ix - 32)
	or	a, a
	sbc	hl, de
	ld	a, 13
	ld	l, a
	jr	z, BB64_178
	ld	a, 11
	ld	l, a
BB64_178:
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, (ix - 20)
	ld	bc, (hl)
	ld	hl, (ix - 14)
	push	hl
	ld	de, (ix - 29)
	push	de
	push	bc
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	bc, (ix - 32)
	inc	bc
	ld	hl, (ix - 26)
	ld	a, l
	add	a, 38
	ld	l, a
	ld	(ix - 26), hl
	ld	de, 38
	ld	hl, (ix - 14)
	add	hl, de
	ld	(ix - 14), hl
	ld	iy, (ix - 23)
	lea	iy, iy + 3
	ld	(ix - 23), iy
	ld	iy, (ix - 20)
	lea	iy, iy + 3
	ld	(ix - 20), iy
	ld	iy, (ix - 17)
	jp	BB64_173
BB64_179:
	ld	a, (_game_mode)
	bit	0, a
	jp	z, BB64_198
	ld	de, (_player_color)
	ld	hl, (_current_turn)
	or	a, a
	sbc	hl, de
	jp	z, BB64_198
	ld	a, c
	and	a, 48
	ld	l, a
	or	a, a
	jp	nz, BB64_283
	ex	de, hl
	ld	bc, -65536
	call	__imulu
	ld	de, 65536
	or	a, a
	sbc	hl, de
	ld	a, 5
	jp	z, BB64_292
	ld	a, -5
	jp	BB64_292
BB64_184:
	ld	hl, (_think_time_ms)
	ld	a, (_think_time_ms+3)
	ld	e, a
	push	de
	push	hl
	or	a, a
	sbc	hl, hl
	push	hl
	ld	hl, (ix - 41)
	push	hl
	call	_engine_think
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	a, (ix - 5)
	cp	a, -1
	jp	nz, BB64_199
	call	_compute_status
	ld	l, a
	cp	a, 2
	jp	z, BB64_200
	ld	de, 0
	jp	BB64_201
BB64_187:
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 9
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, 222
	push	hl
	ld	hl, 12
	push	hl
	ld	hl, _.str.4
	jr	BB64_189
BB64_188:
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 9
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, 222
	push	hl
	ld	hl, 12
	push	hl
	ld	hl, _.str.6
BB64_189:
	push	hl
	call	_gfx_PrintStringXY
BB64_190:
	pop	hl
	pop	hl
	pop	hl
BB64_191:
	call	_gfx_SwapDraw
BB64_192:
	ld	a, (_cur_g1)
	ld	(_prev_g1), a
	ld	a, (_cur_g6)
	ld	(_prev_g6), a
	ld	a, (_cur_g7)
	ld	(_prev_g7), a
BB64_193:
	call	_clock
	ld	bc, (ix - 8)
	ld	a, (ix - 11)
	call	__lsub
	ld	bc, 546
	xor	a, a
	call	__lcmpu
	jr	c, BB64_193
	ld	a, (_running)
	bit	0, a
	jp	nz, BB64_39
	jp	BB64_293
BB64_195:
	or	a, a
	jp	z, BB64_213
	ld	iy, (ix - 29)
	lea	hl, iy
	ld	de, 7
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB64_211
	ld	iy, 7
	jp	BB64_212
BB64_198:
	ld	hl, (ix - 20)
	ld	(_promo_saved_has_last), hl
	ld	hl, (ix - 23)
	ld	(_promo_saved_from_r), hl
	ld	hl, (ix - 26)
	ld	(_promo_saved_from_c), hl
	ld	hl, (ix - 29)
	ld	(_promo_saved_to_r), hl
	ld	hl, (ix - 32)
	ld	(_promo_saved_to_c), hl
	ld	hl, (ix - 14)
	ld	(_promo_r), hl
	ld	hl, (ix - 17)
	ld	(_promo_c), hl
	ld	hl, (ix - 35)
	ld	(_promo_from_r), hl
	ld	hl, (ix - 38)
	ld	(_promo_from_c), hl
	ld	a, (_anim_captured)
	ld	(_promo_captured), a
	or	a, a
	sbc	hl, hl
	ld	(_promo_cursor), hl
	ld	hl, 4
	jp	BB64_163
BB64_199:
	ld	de, _pending_move
	ld	(ix - 14), a
	ld	hl, (ix - 41)
	ld	bc, 5
	ldir
	push	hl
	push	hl
	push	hl
	ld	iy, 0
	add	iy, sp
	lea	de, iy
	ld	hl, (ix - 41)
	ld	bc, 5
	ldir
	ld	hl, _pending_effects
	ld	(iy + 6), hl
	call	_engine_get_move_effects
	pop	hl
	pop	hl
	pop	hl
	ld	bc, 0
	push	bc
	pop	iy
	push	af
	ld	a, (ix - 14)
	ld	iyl, a
	pop	af
	push	bc
	pop	de
	ld	e, (ix - 4)
	ld	c, (ix - 3)
	or	a, a
	sbc	hl, hl
	ld	l, (ix - 2)
	push	hl
	push	bc
	push	de
	push	iy
	call	_start_move_anim
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	jr	BB64_204
BB64_200:
	ld	de, (_player_color)
BB64_201:
	ld	(_winner), de
	ld	a, l
	or	a, a
	ld	a, 3
	jr	z, BB64_203
	ld	a, l
BB64_203:
	ld	(_game_over_reason), a
	ld	hl, 5
	ld	(_state), hl
BB64_204:
	or	a, a
	sbc	hl, hl
	ld	(_ai_thinking), hl
	jp	BB64_192
BB64_205:
	dec	iy
BB64_206:
	ld	(_cur_r), iy
BB64_207:
	ld	a, c
	and	a, 1
	bit	0, a
	jr	nz, BB64_209
	ld	e, (ix - 20)
	jr	BB64_219
BB64_209:
	lea	hl, iy
	ld	de, 7
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB64_217
	ld	iy, 7
	jr	BB64_218
BB64_211:
	inc	iy
BB64_212:
	ld	(_cur_r), iy
BB64_213:
	ld	a, c
	and	a, 1
	bit	0, a
	jr	nz, BB64_215
	ld	e, (ix - 20)
	jr	BB64_224
BB64_215:
	lea	hl, iy
	ld	de, 1
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB64_222
	ld	iy, 0
	jr	BB64_223
BB64_217:
	inc	iy
BB64_218:
	ld	e, (ix - 20)
	ld	(_cur_r), iy
BB64_219:
	bit	1, c
	ld	hl, (ix - 26)
	ld	(ix - 17), hl
	ld	(ix - 23), iy
	jr	z, BB64_229
	ld	iy, (ix - 26)
	lea	hl, iy
	ld	de, 1
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB64_227
	ld	iy, 0
	jr	BB64_228
BB64_222:
	dec	iy
BB64_223:
	ld	e, (ix - 20)
	ld	(_cur_r), iy
BB64_224:
	bit	1, c
	ld	hl, (ix - 26)
	ld	(ix - 17), hl
	ld	(ix - 23), iy
	jr	z, BB64_234
	ld	iy, (ix - 26)
	lea	hl, iy
	ld	de, 7
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB64_232
	ld	iy, 7
	jr	BB64_233
BB64_227:
	dec	iy
BB64_228:
	ld	(ix - 17), iy
	ld	(_cur_c), iy
	ld	e, (ix - 20)
	ld	iy, (ix - 23)
BB64_229:
	bit	2, c
	jr	z, BB64_242
	ld	iy, (ix - 17)
	lea	hl, iy
	ld	de, 7
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB64_238
	ld	hl, 7
	jr	BB64_237
BB64_232:
	inc	iy
BB64_233:
	ld	(ix - 17), iy
	ld	(_cur_c), iy
	ld	e, (ix - 20)
	ld	iy, (ix - 23)
BB64_234:
	bit	2, c
	jr	z, BB64_242
	ld	iy, (ix - 17)
	lea	hl, iy
	ld	de, 1
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB64_239
	or	a, a
	sbc	hl, hl
BB64_237:
	ld	(ix - 17), hl
	jr	BB64_241
BB64_238:
	inc	iy
	jr	BB64_240
BB64_239:
	dec	iy
BB64_240:
	ld	(ix - 17), iy
BB64_241:
	ld	e, (ix - 20)
	ld	hl, (ix - 17)
	ld	(_cur_c), hl
BB64_242:
	ld	a, c
	or	a, a
	jr	z, BB64_245
	ld	a, e
	or	a, a
	jr	nz, BB64_245
	ld	a, (ix - 14)
	or	a, a
	jp	z, BB64_280
BB64_245:
	ld	a, e
	and	a, 1
	bit	0, a
	jr	nz, BB64_247
	bit	5, (ix - 14)
	jp	z, BB64_272
BB64_247:
	ld	a, 1
	ld	(_screen_dirty), a
	ld	bc, (_sel_r)
	push	bc
	pop	hl
	ld	de, 0
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB64_255
	ld	hl, (ix - 23)
	ld	c, 3
	call	__ishl
	push	hl
	pop	de
	ld	hl, _board
	add	hl, de
	ld	de, (ix - 17)
	add	hl, de
	ld	l, (hl)
	ld	a, l
	or	a, a
	jp	z, BB64_272
	ld	de, (_current_turn)
	ld	a, l
	cp	a, 1
	call	pe, __setflag
	ld	a, -1
	jp	p, BB64_251
	ld	a, 0
BB64_251:
	push	de
	pop	hl
	ld	bc, 1
	or	a, a
	sbc	hl, bc
	jr	nz, BB64_253
	bit	0, a
	jp	nz, BB64_270
BB64_253:
	ex	de, hl
	ld	de, -1
	or	a, a
	sbc	hl, de
	jp	nz, BB64_272
	bit	0, a
	jp	nz, BB64_272
	jp	BB64_270
BB64_255:
	ld	de, (_sel_c)
	ld	hl, (ix - 23)
	or	a, a
	sbc	hl, bc
	jr	nz, BB64_258
	ld	hl, (ix - 17)
	or	a, a
	sbc	hl, de
	jr	nz, BB64_258
	scf
	sbc	hl, hl
	ld	(_sel_r), hl
	ld	(_sel_c), hl
	xor	a, a
	jp	BB64_271
BB64_258:
	ld	(ix - 29), de
	ld	(ix - 26), bc
	ld	hl, (ix - 23)
	ld	c, 3
	call	__ishl
	push	hl
	pop	de
	ld	hl, _board
	add	hl, de
	ld	de, (ix - 17)
	add	hl, de
	ld	l, (hl)
	ld	a, l
	or	a, a
	jr	z, BB64_265
	ld	de, (_current_turn)
	ld	a, l
	cp	a, 1
	call	pe, __setflag
	ld	a, -1
	jp	p, BB64_261
	ld	a, 0
BB64_261:
	push	de
	pop	hl
	ld	bc, 1
	or	a, a
	sbc	hl, bc
	jr	nz, BB64_263
	bit	0, a
	jr	nz, BB64_270
BB64_263:
	ex	de, hl
	ld	de, -1
	or	a, a
	sbc	hl, de
	jr	nz, BB64_265
	bit	0, a
	jr	z, BB64_270
BB64_265:
	ld	a, (_legal_target_count)
	ld	bc, 0
	push	bc
	pop	de
	ld	e, a
	ld	iy, _legal_targets
BB64_266:
	push	de
	pop	hl
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB64_272
	ld	c, (iy + 2)
	ld	hl, (ix - 23)
	or	a, a
	sbc	hl, bc
	jr	nz, BB64_269
	ld	bc, 0
	ld	c, (iy + 3)
	ld	hl, (ix - 17)
	or	a, a
	sbc	hl, bc
	jp	z, BB64_286
BB64_269:
	lea	iy, iy + 5
	dec	de
	ld	bc, 0
	jr	BB64_266
BB64_270:
	ld	de, (ix - 23)
	ld	(_sel_r), de
	ld	bc, (ix - 17)
	ld	(_sel_c), bc
	ld	hl, 64
	push	hl
	ld	hl, _legal_targets
	push	hl
	push	bc
	push	de
	call	_engine_get_moves_from
	pop	hl
	pop	hl
	pop	hl
	pop	hl
BB64_271:
	ld	(_legal_target_count), a
BB64_272:
	bit	6, (ix - 20)
	jr	z, BB64_275
	ld	a, 1
	ld	(_screen_dirty), a
	ld	hl, (_sel_r)
	ld	de, 0
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB64_279
	scf
	sbc	hl, hl
	ld	(_sel_r), hl
	ld	(_sel_c), hl
	xor	a, a
	ld	(_legal_target_count), a
BB64_275:
	bit	6, (ix - 14)
	jr	nz, BB64_279
	ld	hl, (_state)
	ld	a, (_screen_dirty)
	ld	de, 3
	or	a, a
	sbc	hl, de
	jp	nz, BB64_192
	bit	0, a
	jp	z, BB64_192
	call	_draw_playing
	xor	a, a
	ld	(_screen_dirty), a
	jp	BB64_192
BB64_279:
	ld	hl, (_current_turn)
	call	__ineg
	ld	(_winner), hl
	xor	a, a
	ld	(_game_over_reason), a
	ld	hl, 5
	jp	BB64_163
BB64_280:
	ld	hl, (ix - 23)
	ld	bc, (ix - 29)
	or	a, a
	sbc	hl, bc
	jr	nz, BB64_282
	ld	hl, (ix - 17)
	ld	bc, (ix - 26)
	or	a, a
	sbc	hl, bc
	jp	z, BB64_245
BB64_282:
	or	a, a
	sbc	hl, hl
	push	hl
	call	_gfx_Blit
	pop	hl
	ld	hl, (ix - 26)
	push	hl
	ld	hl, (ix - 29)
	push	hl
	call	_draw_square
	pop	hl
	pop	hl
	ld	hl, (_cur_r)
	ld	de, (_cur_c)
	push	de
	push	hl
	call	_draw_square
	pop	hl
	pop	hl
	call	_draw_cursor_border
	jp	BB64_191
BB64_283:
	ld	a, l
	cp	a, 16
	jr	nz, BB64_287
	ld	a, e
	cp	a, -1
	ld	a, 4
	jr	z, BB64_292
	ld	a, -4
	jr	BB64_292
BB64_286:
	ld	de, _pending_move
	lea	hl, iy
	ld	bc, 5
	ldir
	push	hl
	push	hl
	push	hl
	ld	hl, 0
	add	hl, sp
	ld	(ix - 32), hl
	ld	de, (ix - 32)
	lea	hl, iy
	ld	bc, 5
	ldir
	ld	hl, _pending_effects
	ld	iy, (ix - 32)
	ld	(iy + 6), hl
	call	_engine_get_move_effects
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (ix - 17)
	push	hl
	ld	hl, (ix - 23)
	push	hl
	ld	hl, (ix - 29)
	push	hl
	ld	hl, (ix - 26)
	push	hl
	call	_start_move_anim
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	jp	BB64_272
BB64_287:
	ld	a, l
	cp	a, 32
	jr	nz, BB64_290
	ld	a, e
	cp	a, -1
	ld	a, 3
	jr	z, BB64_292
	ld	a, -3
	jr	BB64_292
BB64_290:
	ld	a, e
	cp	a, -1
	ld	a, 2
	jr	z, BB64_292
	ld	a, -2
BB64_292:
	ld	(iy), a
	jp	BB64_151
BB64_293:
	xor	a, a
	ld	(_book_ready), a
	ld	(_num_segments), a
	sbc	hl, hl
	ld	(_total_entries), hl
	ld	(_total_entries+3), a
	call	_gfx_End
	or	a, a
	sbc	hl, hl
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits
	section	.rodata,"a",@progbits
	private	JTI64_0
JTI64_0:
	dl	BB64_41
	dl	BB64_92
	dl	BB64_54
	dl	BB64_109
	dl	BB64_71
	dl	BB64_122

	section	.text,"ax",@progbits
	private	_start_game
_start_game:
	ld	hl, -9
	call	__frameset
	ld	hl, _ce_time_ms
	ld	de, _board
	ld	(ix - 6), de
	ld	(ix - 3), hl
	pea	ix - 3
	call	_engine_init
	pop	hl
	call	_engine_new_game
	ld	bc, 8
	ld	de, 0
BB65_1:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	jr	z, BB65_6
	ld	(ix - 9), de
	ld	bc, 0
BB65_3:
	push	bc
	pop	hl
	ld	de, 8
	or	a, a
	sbc	hl, de
	jr	z, BB65_5
	ld	iy, (ix - 6)
	add	iy, bc
	ld	(iy), 0
	inc	bc
	jr	BB65_3
BB65_5:
	ld	de, (ix - 9)
	inc	de
	ld	iy, (ix - 6)
	lea	iy, iy + 8
	ld	(ix - 6), iy
	ld	bc, 8
	jr	BB65_1
BB65_6:
	ld	l, -4
	ld	a, l
	ld	(_board), a
	ld	e, -2
	ld	a, e
	ld	(_board+1), a
	ld	c, -3
	ld	a, c
	ld	(_board+2), a
	ld	a, -5
	ld	(_board+3), a
	dec	a
	ld	(_board+4), a
	ld	a, c
	ld	(_board+5), a
	ld	a, e
	ld	(_board+6), a
	ld	a, l
	ld	(_board+7), a
	ld	de, 0
	ld	bc, 1
BB65_7:
	push	de
	pop	iy
	ex	de, hl
	ld	de, 8
	or	a, a
	sbc	hl, de
	jr	z, BB65_9
	ld	hl, _board+8
	lea	de, iy
	add	hl, de
	ld	(hl), -1
	inc	de
	jr	BB65_7
BB65_9:
	push	bc
	pop	iy
	ld	l, 4
	ld	a, l
	ld	(_board+56), a
	ld	e, 2
	ld	a, e
	ld	(_board+57), a
	ld	c, 3
	ld	a, c
	ld	(_board+58), a
	ld	a, 5
	ld	(_board+59), a
	inc	a
	ld	(_board+60), a
	ld	a, c
	ld	(_board+61), a
	ld	a, e
	ld	(_board+62), a
	ld	a, l
	ld	(_board+63), a
	ld	bc, 0
	ld	de, 8
BB65_10:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jr	z, BB65_12
	ld	hl, _board+48
	add	hl, bc
	ld	(hl), 1
	inc	bc
	jr	BB65_10
BB65_12:
	ld	hl, 7
	ld	(_cur_r), hl
	ld	hl, 4
	ld	(_cur_c), hl
	scf
	sbc	hl, hl
	ld	(_sel_r), hl
	ld	(_sel_c), hl
	ld	(_current_turn), iy
	inc	hl
	push	hl
	pop	de
	ld	(_has_last_move), de
	ld	a, l
	ld	(_legal_target_count), a
	ld	(_ai_thinking), de
	xor	a, a
	ld	(_anim_active), a
	ld	a, l
	ld	(_game_over_reason), a
	ld	a, (_game_mode)
	bit	0, a
	jr	z, BB65_14
	ld	hl, (_color_cursor)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	nz, BB65_16
BB65_14:
	ld	(_player_color), iy
	or	a, a
	sbc	hl, hl
	ld	(_board_flipped), hl
BB65_15:
	ld	a, 1
	ld	(_screen_dirty), a
	ld	hl, 3
	ld	(_state), hl
	ld	sp, ix
	pop	ix
	ret
BB65_16:
	ld	de, 1
	or	a, a
	sbc	hl, de
	jr	nz, BB65_18
	scf
	sbc	hl, hl
	ld	(_player_color), hl
	ld	(_board_flipped), iy
	jr	BB65_22
BB65_18:
	call	_rand
	ld	iy, -1
	ld	bc, 1
	call	__iand
	push	hl
	pop	de
	bit	0, e
	jr	z, BB65_20
	push	bc
	pop	iy
BB65_20:
	ld	(_player_color), iy
	ld	a, (_game_mode)
	push	de
	pop	hl
	call	__ixor
	push	bc
	pop	iy
	ld	(_board_flipped), hl
	bit	0, a
	jr	z, BB65_15
	bit	0, e
	jr	nz, BB65_15
BB65_22:
	ld	(_ai_thinking), iy
	jr	BB65_15
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_apply_engine_move
_apply_engine_move:
	call	__frameset0
	lea	hl, ix + 6
	push	de
	push	de
	ex	de, hl
	ld	hl, 0
	add	hl, sp
	ex	de, hl
	ld	bc, 5
	ldir
	call	_engine_make_move
	pop	hl
	pop	hl
	cp	a, 2
	jr	nz, BB66_2
	ld	a, 2
	ld	hl, (_current_turn)
	ld	(_winner), hl
	ld	(_game_over_reason), a
	call	__ineg
	ld	(_current_turn), hl
	scf
	sbc	hl, hl
	ld	(_sel_r), hl
	ld	(_sel_c), hl
	xor	a, a
	ld	(_legal_target_count), a
	ld	hl, 5
	ld	(_state), hl
	inc	a
	jr	BB66_8
BB66_2:
	ld	de, 5
	ld	bc, -1
	ld	iyl, d
	cp	a, 3
	jr	c, BB66_4
	or	a, a
	sbc	hl, hl
	ld	(_winner), hl
	ld	(_game_over_reason), a
	ld	hl, (_current_turn)
	call	__ineg
	ld	(_current_turn), hl
	ld	(_sel_r), bc
	ld	(_sel_c), bc
	ld	a, iyl
	ld	(_legal_target_count), a
	ld	(_state), de
	ld	a, 1
	jr	BB66_8
BB66_4:
	ld	hl, (_current_turn)
	call	__ineg
	push	hl
	pop	de
	ld	(_current_turn), de
	ld	(_sel_r), bc
	ld	(_sel_c), bc
	ld	a, iyl
	ld	(_legal_target_count), a
	ld	a, (_game_mode)
	bit	0, a
	jr	z, BB66_7
	ld	hl, (_player_color)
	or	a, a
	sbc	hl, de
	jr	z, BB66_7
	ld	hl, 1
	ld	(_ai_thinking), hl
BB66_7:
	ld	a, iyl
BB66_8:
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_render_playing
_render_playing:
	ld	hl, -24
	call	__frameset
	ld	hl, 25
	ld	(ix - 6), hl
	ld	hl, _.str.20
	ld	(ix - 18), hl
	ld	hl, _.str.22
	ld	(ix - 15), hl
	or	a, a
	sbc	hl, hl
	push	hl
	call	_gfx_FillScreen
	pop	hl
	ld	de, 8
	or	a, a
	sbc	hl, hl
	ld	(ix - 3), hl
	ld	bc, 0
BB67_1:
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	jr	z, BB67_12
	ld	iy, 7
	lea	hl, iy
	or	a, a
	sbc	hl, bc
	ld	(ix - 24), hl
	or	a, a
	sbc	hl, hl
	ld	(ix - 9), hl
BB67_3:
	lea	hl, iy
	ld	de, -1
	or	a, a
	sbc	hl, de
	jr	z, BB67_11
	ld	hl, (_board_flipped)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	a, -1
	jr	z, BB67_6
	ld	a, 0
BB67_6:
	bit	0, a
	push	bc
	pop	hl
	jr	nz, BB67_8
	ld	hl, (ix - 24)
BB67_8:
	ld	(ix - 12), bc
	bit	0, a
	ld	de, (ix - 9)
	jr	nz, BB67_10
	lea	de, iy
BB67_10:
	push	de
	push	hl
	ld	(ix - 21), iy
	call	_draw_square
	ld	iy, (ix - 21)
	pop	hl
	pop	hl
	ld	hl, (ix - 9)
	inc	hl
	ld	(ix - 9), hl
	dec	iy
	ld	bc, (ix - 12)
	jr	BB67_3
BB67_11:
	inc	bc
	ld	de, 8
	jr	BB67_1
BB67_12:
	call	_draw_cursor_border
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 11
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, 26
	push	hl
	pop	iy
	ld	bc, 7
	push	bc
	pop	de
	or	a, a
	sbc	hl, hl
	ld	(ix - 9), hl
	ex	de, hl
BB67_13:
	ld	(ix - 12), hl
	ld	de, -1
	or	a, a
	sbc	hl, de
	jr	z, BB67_17
	ld	hl, (_board_flipped)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	hl, (ix - 9)
	jr	z, BB67_16
	ld	hl, (ix - 12)
BB67_16:
	ld	(ix - 24), hl
	ld	hl, 226
	push	hl
	push	iy
	ld	(ix - 21), iy
	call	_gfx_SetTextXY
	pop	hl
	pop	hl
	ld	hl, (ix - 24)
	ld	a, l
	add	a, 97
	ld	l, a
	push	hl
	call	_gfx_PrintChar
	ld	iy, (ix - 21)
	pop	hl
	ld	hl, (ix - 9)
	inc	hl
	ld	(ix - 9), hl
	ld	hl, (ix - 12)
	dec	hl
	ld	de, 26
	add	iy, de
	ld	bc, 7
	jr	BB67_13
BB67_17:
	push	bc
	pop	hl
	ld	de, -1
	or	a, a
	sbc	hl, de
	jr	z, BB67_21
	ld	hl, (_board_flipped)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	hl, (ix - 3)
	jr	z, BB67_20
	push	bc
	pop	hl
BB67_20:
	ld	(ix - 12), hl
	ld	hl, (ix - 6)
	push	hl
	ld	hl, 6
	push	hl
	ld	(ix - 9), bc
	call	_gfx_SetTextXY
	pop	hl
	pop	hl
	ld	a, 56
	ld	hl, (ix - 12)
	sub	a, l
	ld	l, a
	push	hl
	call	_gfx_PrintChar
	ld	bc, (ix - 9)
	pop	hl
	ld	hl, (ix - 3)
	inc	hl
	ld	(ix - 3), hl
	dec	bc
	ld	de, 26
	ld	hl, (ix - 6)
	add	hl, de
	ld	(ix - 6), hl
	jr	BB67_17
BB67_21:
	ld	hl, 15
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, -16
	push	hl
	ld	hl, 88
	push	hl
	or	a, a
	sbc	hl, hl
	push	hl
	ld	hl, 230
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, 11
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	a, (_game_mode)
	bit	0, a
	ld	de, _.str.19
	jr	nz, BB67_23
	ld	de, _.str.18
BB67_23:
	ld	hl, 6
	push	hl
	ld	hl, 234
	push	hl
	push	de
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 9
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 84
	push	hl
	ld	hl, 20
	push	hl
	ld	hl, 232
	push	hl
	call	_gfx_HorizLine_NoClip
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 1
	push	hl
	push	hl
	call	_gfx_SetTextScale
	pop	hl
	pop	hl
	ld	hl, (_current_turn)
	ld	de, 1
	or	a, a
	sbc	hl, de
	ld	l, 7
	jr	z, BB67_25
	ld	a, 11
	ld	l, a
BB67_25:
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, (_current_turn)
	ld	de, 1
	or	a, a
	sbc	hl, de
	ld	de, _.str.13
	jr	z, BB67_27
	ld	de, _.str.14
BB67_27:
	ld	hl, 26
	push	hl
	ld	hl, 234
	push	hl
	push	de
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (_ai_thinking)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	de, 12
	jr	nz, BB67_29
	call	_engine_in_check
	or	a, a
	ld	hl, 10
	ex	de, hl
	ld	hl, _.str.21
	ld	(ix - 18), hl
	jr	z, BB67_30
BB67_29:
	push	de
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, (ix - 18)
	ld	(ix - 15), hl
BB67_30:
	ld	hl, 38
	push	hl
	ld	hl, 234
	push	hl
	ld	hl, (ix - 15)
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (_sel_r)
	ld	de, 0
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB67_32
	ld	hl, 9
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 84
	push	hl
	ld	hl, 53
	push	hl
	ld	hl, 232
	push	hl
	call	_gfx_HorizLine_NoClip
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 10
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, 60
	push	hl
	ld	hl, 234
	push	hl
	call	_gfx_SetTextXY
	pop	hl
	pop	hl
	ld	hl, _.str.23
	push	hl
	call	_gfx_PrintString
	pop	hl
	ld	a, (_sel_c)
	add	a, 97
	ld	l, a
	push	hl
	call	_gfx_PrintChar
	pop	hl
	ld	a, (_sel_r)
	ld	l, a
	ld	a, 56
	sub	a, l
	ld	l, a
	push	hl
	call	_gfx_PrintChar
	pop	hl
BB67_32:
	ld	hl, 9
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 84
	push	hl
	ld	hl, 78
	push	hl
	ld	hl, 232
	push	hl
	call	_gfx_HorizLine_NoClip
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 11
	push	hl
	call	_gfx_SetTextFGColor
	pop	hl
	ld	hl, 84
	push	hl
	ld	hl, 232
	push	hl
	ld	hl, _.str.24
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 96
	push	hl
	ld	hl, 232
	push	hl
	ld	hl, _.str.25
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 112
	push	hl
	ld	hl, 232
	push	hl
	ld	hl, _.str.26
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 124
	push	hl
	ld	hl, 232
	push	hl
	ld	hl, _.str.27
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 140
	push	hl
	ld	hl, 232
	push	hl
	ld	hl, _.str.28
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 152
	push	hl
	ld	hl, 232
	push	hl
	ld	hl, _.str.29
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 168
	push	hl
	ld	hl, 232
	push	hl
	ld	hl, _.str.30
	push	hl
	call	_gfx_PrintStringXY
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 180
	push	hl
	ld	hl, 232
	push	hl
	ld	hl, _.str.31
	push	hl
	call	_gfx_PrintStringXY
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_draw_piece
_draw_piece:
	call	__frameset0
	ld	d, (ix + 6)
	ld	a, d
	or	a, a
	jr	z, BB68_5
	ld	iy, _piece_spr_data
	ld	a, d
	rlc	a
	sbc	a, a
	ld	l, a
	ld	a, d
	add	a, l
	xor	a, l
	or	a, a
	sbc	hl, hl
	ld	l, a
	ld	c, 1
	call	__ishl
	ld	bc, -2
	add	hl, bc
	ld	a, d
	cp	a, 1
	call	pe, __setflag
	jp	m, BB68_3
	ld	bc, 0
	jr	BB68_4
BB68_3:
	ld	bc, 1
BB68_4:
	add	hl, bc
	ld	bc, 402
	call	__imulu
	push	hl
	pop	bc
	add	iy, bc
	lea	bc, iy
	ld	iy, (ix + 9)
	ld	de, 3
	add	iy, de
	ld	a, (ix + 12)
	add	a, e
	ld	l, a
	push	hl
	push	iy
	push	bc
	call	_gfx_TransparentSprite_NoClip
	pop	hl
	pop	hl
	pop	hl
BB68_5:
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_draw_playing
_draw_playing:
	call	_render_playing
	jp	_gfx_SwapDraw
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_start_move_anim
_start_move_anim:
	ld	hl, -9
	call	__frameset
	ld	hl, (ix + 6)
	ld	iy, (ix + 9)
	ld	bc, (ix + 12)
	or	a, a
	sbc	hl, bc
	push	hl
	pop	de
	lea	hl, iy
	ld	bc, (ix + 15)
	or	a, a
	sbc	hl, bc
	ld	(ix - 3), hl
	push	de
	pop	hl
	push	de
	pop	iy
	add	iy, iy
	sbc	hl, hl
	push	hl
	pop	bc
	ex	de, hl
	add	hl, bc
	call	__ixor
	ld	(ix - 6), hl
	ld	hl, (ix - 3)
	push	hl
	pop	iy
	push	hl
	pop	de
	add	iy, iy
	sbc	hl, hl
	push	hl
	pop	bc
	ex	de, hl
	ld	de, (ix - 6)
	add	hl, bc
	call	__ixor
	push	hl
	pop	bc
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB70_2
	push	bc
	pop	de
BB70_2:
	ex	de, hl
	ld	bc, 50
	call	__imulu
	push	hl
	pop	bc
	ld	de, 200
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB70_4
	ld	bc, 200
BB70_4:
	ld	de, 2
	push	bc
	pop	hl
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	p, BB70_6
	ld	bc, 1
BB70_6:
	ld	(ix - 9), bc
	ld	c, 3
	ld	hl, (ix + 6)
	call	__ishl
	push	hl
	pop	de
	ld	iy, _board
	add	iy, de
	ld	hl, (ix + 9)
	ex	de, hl
	add	iy, de
	ld	(ix - 3), iy
	ld	a, (iy)
	ld	(_anim_piece), a
	ld	iy, (ix + 12)
	lea	hl, iy
	call	__ishl
	push	hl
	pop	de
	ld	hl, _board
	add	hl, de
	ld	de, (ix + 15)
	add	hl, de
	ld	(ix - 6), hl
	ld	a, (hl)
	ld	(_anim_captured), a
	ld	hl, (ix + 6)
	ld	(_anim_from_r), hl
	ld	hl, (ix + 9)
	ld	(_anim_from_c), hl
	ld	(_anim_to_r), iy
	ld	(_anim_to_c), de
	ld	c, 15
	ld	hl, (ix - 9)
	call	__ishl
	ld	bc, 1000
	call	__idivu
	ld	(_anim_duration), hl
	xor	a, a
	ld	(_anim_duration+3), a
	call	_clock
	ld	a, e
	ld	(_anim_start), hl
	ld	(_anim_start+3), a
	ld	a, 1
	ld	(_anim_active), a
	ld	hl, (ix - 3)
	ld	(hl), 0
	ld	hl, (ix - 6)
	ld	(hl), 0
	ld	a, (_pending_effects+5)
	or	a, a
	jr	z, BB70_8
	ld	a, (_pending_effects+6)
	ld	de, 0
	push	de
	pop	hl
	ld	l, a
	ld	a, (_pending_effects+7)
	ld	e, a
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	ld	hl, _board
	add	hl, bc
	add	hl, de
	ld	(hl), d
BB70_8:
	ld	a, (_pending_effects)
	or	a, a
	jr	z, BB70_10
	ld	a, (_pending_effects+1)
	ld	de, 0
	push	de
	pop	hl
	ld	l, a
	ld	a, (_pending_effects+2)
	push	de
	pop	bc
	ld	c, a
	ld	(ix - 3), bc
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	ld	iy, _board
	lea	hl, iy
	add	hl, bc
	ld	bc, (ix - 3)
	add	hl, bc
	ld	a, (hl)
	ld	(ix - 3), a
	ld	(hl), d
	ld	a, (_pending_effects+3)
	push	de
	pop	hl
	ld	l, a
	ld	a, (_pending_effects+4)
	ld	e, a
	ld	c, 3
	call	__ishl
	push	hl
	pop	bc
	add	iy, bc
	add	iy, de
	ld	a, (ix - 3)
	ld	(iy), a
BB70_10:
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_draw_square
_draw_square:
	ld	hl, -15
	call	__frameset
	ld	de, 7
	ld	hl, (_board_flipped)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB71_2
	ld	a, 0
	jr	BB71_3
BB71_2:
	ld	a, -1
BB71_3:
	ex	de, hl
	ld	de, (ix + 6)
	or	a, a
	sbc	hl, de
	bit	0, a
	push	de
	pop	iy
	jr	nz, BB71_5
	push	hl
	pop	iy
BB71_5:
	ld	bc, 26
	ld	hl, 7
	ld	de, (ix + 9)
	or	a, a
	sbc	hl, de
	bit	0, a
	jr	nz, BB71_7
	ex	de, hl
BB71_7:
	ex	de, hl
	call	__imulu
	ld	(ix - 12), hl
	ld	de, 16
	add	hl, de
	ld	(ix - 3), hl
	lea	hl, iy
	call	__imulu
	ld	(ix - 15), hl
	add	hl, de
	ld	(ix - 6), hl
	ld	hl, (ix + 9)
	ld	de, (ix + 6)
	add	hl, de
	ld	bc, 1
	call	__iand
	ld	(ix - 9), hl
	ld	de, (_sel_r)
	ld	iy, (_sel_c)
	dec	bc
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	jp	m, BB71_12
	ex	de, hl
	ld	de, (ix + 6)
	or	a, a
	sbc	hl, de
	jr	nz, BB71_12
	lea	hl, iy
	ld	de, (ix + 9)
	or	a, a
	sbc	hl, de
	jr	nz, BB71_12
	ld	hl, (ix - 9)
	bit	0, l
	jr	z, BB71_23
	ld	l, 4
	jr	BB71_24
BB71_12:
	ld	hl, (_has_last_move)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	ld	bc, (ix + 9)
	jr	z, BB71_19
	ld	hl, (_last_from_r)
	ld	de, (ix + 6)
	or	a, a
	sbc	hl, de
	jr	nz, BB71_15
	ld	hl, (_last_from_c)
	or	a, a
	sbc	hl, bc
	jr	z, BB71_17
BB71_15:
	ld	hl, (_last_to_r)
	ld	de, (ix + 6)
	or	a, a
	sbc	hl, de
	jr	nz, BB71_19
	ld	hl, (_last_to_c)
	or	a, a
	sbc	hl, bc
	jr	nz, BB71_19
BB71_17:
	ld	hl, (ix - 9)
	bit	0, l
	jr	z, BB71_22
	ld	l, 6
	jr	BB71_24
BB71_19:
	ld	hl, (ix - 9)
	bit	0, l
	jr	z, BB71_21
	ld	l, 2
	jr	BB71_24
BB71_21:
	ld	l, 1
	jr	BB71_24
BB71_22:
	ld	l, 5
	jr	BB71_24
BB71_23:
	ld	l, 3
BB71_24:
	push	hl
	call	_gfx_SetColor
	pop	hl
	ld	hl, 26
	push	hl
	push	hl
	ld	hl, (ix - 6)
	push	hl
	ld	hl, (ix - 3)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (_sel_r)
	ld	de, 0
	or	a, a
	sbc	hl, de
	call	pe, __setflag
	jp	m, BB71_31
	ld	hl, (ix + 9)
	push	hl
	ld	hl, (ix + 6)
	push	hl
	call	_is_legal_target
	ld	e, a
	pop	hl
	pop	hl
	or	a, a
	jp	z, BB71_31
	ld	hl, 16
	push	hl
	ld	(ix - 9), e
	call	_gfx_SetColor
	pop	hl
	ld	a, (ix - 9)
	cp	a, 1
	jr	nz, BB71_29
	ld	c, 3
	ld	hl, (ix + 6)
	call	__ishl
	push	hl
	pop	de
	ld	hl, _board
	add	hl, de
	ld	de, (ix + 9)
	add	hl, de
	ld	a, (hl)
	or	a, a
	jr	nz, BB71_29
	ld	de, 29
	ld	hl, (ix - 12)
	add	hl, de
	ld	de, (ix - 15)
	ld	a, e
	add	a, 29
	ld	e, a
	ld	bc, 4
	push	bc
	push	de
	push	hl
	call	_gfx_FillCircle_NoClip
	jr	BB71_30
BB71_29:
	ld	hl, 4
	push	hl
	push	hl
	ld	hl, (ix - 6)
	push	hl
	ld	hl, (ix - 3)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (ix - 12)
	ld	de, 38
	add	hl, de
	ld	(ix - 12), hl
	ld	de, 4
	push	de
	push	de
	ld	de, (ix - 6)
	push	de
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (ix - 15)
	ld	a, l
	add	a, 38
	ld	e, a
	ld	(ix - 9), de
	ld	hl, 4
	push	hl
	push	hl
	push	de
	ld	hl, (ix - 3)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 4
	push	hl
	push	hl
	ld	hl, (ix - 9)
	push	hl
	ld	hl, (ix - 12)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
BB71_30:
	pop	hl
	pop	hl
	pop	hl
BB71_31:
	ld	c, 3
	ld	hl, (ix + 6)
	call	__ishl
	push	hl
	pop	de
	ld	hl, _board
	add	hl, de
	ld	de, (ix + 9)
	add	hl, de
	ld	l, (hl)
	ld	a, l
	or	a, a
	ld	de, (ix - 6)
	push	de
	ld	de, (ix - 3)
	push	de
	push	hl
	call	nz, _draw_piece
	pop	hl
	pop	hl
	pop	hl
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_draw_cursor_border
_draw_cursor_border:
	ld	hl, -12
	call	__frameset
	ld	hl, (_board_flipped)
	ld	(ix - 9), hl
	ld	iy, (_cur_r)
	ld	hl, (_cur_c)
	ld	(ix - 3), hl
	ld	de, (_sel_r)
	ld	bc, 0
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	call	pe, __setflag
	jp	m, BB72_5
	lea	hl, iy
	or	a, a
	sbc	hl, de
	lea	bc, iy
	ld	iy, 10
	jr	nz, BB72_3
	ld	de, (_sel_c)
	ld	hl, (ix - 3)
	or	a, a
	sbc	hl, de
	jr	z, BB72_8
BB72_3:
	ld	hl, (ix - 3)
	push	hl
	ld	(ix - 6), bc
	push	bc
	call	_is_legal_target
	pop	hl
	pop	hl
	or	a, a
	jr	z, BB72_6
	ld	iyl, 17
	jr	BB72_7
BB72_5:
	lea	bc, iy
	ld	iy, 10
	jr	BB72_8
BB72_6:
	ld	iyl, 18
BB72_7:
	ld	bc, (ix - 6)
BB72_8:
	ld	de, 7
	ld	hl, (ix - 9)
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB72_10
	ld	a, 0
	jr	BB72_11
BB72_10:
	ld	a, -1
BB72_11:
	push	de
	pop	hl
	or	a, a
	sbc	hl, bc
	bit	0, a
	jr	nz, BB72_13
	push	hl
	pop	bc
BB72_13:
	ld	(ix - 6), bc
	ld	bc, 26
	ex	de, hl
	ld	de, (ix - 3)
	or	a, a
	sbc	hl, de
	bit	0, a
	jr	nz, BB72_15
	ex	de, hl
BB72_15:
	ex	de, hl
	call	__imulu
	ld	(ix - 9), hl
	ld	de, 16
	add	hl, de
	ld	(ix - 3), hl
	push	iy
	call	_gfx_SetColor
	pop	hl
	ld	hl, (ix - 6)
	ld	e, 26
	ld	d, l
	mlt	de
	ld	(ix - 12), de
	ld	a, e
	add	a, 16
	ld	e, a
	ld	(ix - 6), de
	ld	hl, 2
	push	hl
	ld	hl, 26
	push	hl
	push	de
	ld	hl, (ix - 3)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, (ix - 12)
	ld	a, l
	add	a, 40
	ld	l, a
	ld	de, 2
	push	de
	ld	de, 26
	push	de
	push	hl
	ld	hl, (ix - 3)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	hl, 26
	push	hl
	ld	hl, 2
	push	hl
	ld	hl, (ix - 6)
	push	hl
	ld	hl, (ix - 3)
	push	hl
	call	_gfx_FillRectangle_NoClip
	pop	hl
	pop	hl
	pop	hl
	pop	hl
	ld	de, 40
	ld	iy, (ix - 9)
	add	iy, de
	ld	hl, 26
	push	hl
	ld	hl, 2
	push	hl
	ld	hl, (ix - 6)
	push	hl
	push	iy
	call	_gfx_FillRectangle_NoClip
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_is_legal_target
_is_legal_target:
	call	__frameset0
	ld	e, 0
	ld	iy, _legal_targets+4
	ld	a, (_legal_target_count)
	ld	bc, 0
	ld	c, a
BB73_1:
	push	bc
	pop	hl
	ld	a, e
	add	hl, bc
	or	a, a
	sbc	hl, bc
	jr	z, BB73_7
	or	a, a
	sbc	hl, hl
	ld	l, (iy - 2)
	ld	de, (ix + 6)
	sbc	hl, de
	jr	nz, BB73_4
	or	a, a
	sbc	hl, hl
	ld	l, (iy - 1)
	ld	de, (ix + 9)
	sbc	hl, de
	jr	z, BB73_5
BB73_4:
	lea	iy, iy + 5
	dec	bc
	ld	e, a
	jr	BB73_1
BB73_5:
	ld	a, (iy)
	and	a, 5
	or	a, a
	ld	a, 1
	jr	z, BB73_7
	ld	e, 2
	ld	a, e
BB73_7:
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.text,"ax",@progbits
	private	_ce_time_ms
_ce_time_ms:
	ld	hl, -4
	call	__frameset
	call	_clock
	push	hl
	pop	iy
	ld	d, e
	ld	l, 15
	lea	bc, iy
	ld	a, d
	call	__lshru
	push	bc
	pop	hl
	ld	e, a
	ld	bc, 1000
	xor	a, a
	call	__lmulu
	ld	(ix - 3), hl
	ld	(ix - 4), e
	lea	hl, iy
	ld	e, d
	ld	bc, 32767
	call	__land
	ld	bc, 1000
	call	__lmulu
	push	hl
	pop	bc
	ld	a, e
	ld	l, 15
	call	__lshru
	push	bc
	pop	hl
	ld	e, a
	ld	bc, (ix - 3)
	ld	a, (ix - 4)
	call	__ladd
	ld	sp, ix
	pop	ix
	ret
	section	.text,"ax",@progbits

	section	.rodata,"a",@progbits
	private	_board_startpos.start
_board_startpos.start:
	db	""
	db	8 dup 255
	db	8 dup 0
	db	8 dup 0
	db	8 dup 0
	db	8 dup 0
	db	8 dup 1
	db	""

	section	.rodata,"a",@progbits
	private	_castling_mask
_castling_mask:
	db	""

	section	.bss,"aw",@nobits
	private	_num_segments
_num_segments:
	rb	1

	section	.bss,"aw",@nobits
	private	_total_entries
_total_entries:
	rb	4

	section	.bss,"aw",@nobits
	private	_book_ready
_book_ready:
	rb	1

	section	.rodata,"a",@progbits
	private	_.str
_.str:
	db	"CHBKRN", 0

	section	.rodata,"a",@progbits
	private	_.str.1
_.str.1:
	db	"r", 0

	section	.bss,"aw",@nobits
	private	_poly_randoms
_poly_randoms:
	rb	3

	section	.rodata,"a",@progbits
	private	_.str.2
_.str.2:
	db	"%s%02u", 0

	section	.rodata,"a",@progbits
	private	_.str.3
_.str.3:
	db	"CHBM", 0

	section	.bss,"aw",@nobits
	private	_segments
_segments:
	rb	280

	section	.rodata,"a",@progbits
	private	_poly_move_to_engine.promo_flags
_poly_move_to_engine.promo_flags:
	db	0, "0 ", 0

	section	.bss,"aw",@nobits
	private	_engine_hooks
_engine_hooks:
	rb	3

	section	.bss,"aw",@nobits
	public	_engine_board
_engine_board:
	rb	316

	section	.bss,"aw",@nobits
	private	_engine_max_nodes
_engine_max_nodes:
	rb	4

	section	.rodata,"a",@progbits
	public	_phase_weight
_phase_weight:
	dw	0
	dw	1
	dw	1
	dw	2
	dw	4
	dw	0

	section	.rodata,"a",@progbits
	public	_mg_table
_mg_table:
	dw	82
	dw	82
	dw	82
	dw	82
	dw	82
	dw	82
	dw	82
	dw	82
	dw	180
	dw	216
	dw	143
	dw	177
	dw	150
	dw	208
	dw	116
	dw	71
	dw	76
	dw	89
	dw	108
	dw	113
	dw	147
	dw	138
	dw	107
	dw	62
	dw	68
	dw	95
	dw	88
	dw	103
	dw	105
	dw	94
	dw	99
	dw	59
	dw	55
	dw	80
	dw	77
	dw	94
	dw	99
	dw	88
	dw	92
	dw	57
	dw	56
	dw	78
	dw	78
	dw	72
	dw	85
	dw	85
	dw	115
	dw	70
	dw	47
	dw	81
	dw	62
	dw	59
	dw	67
	dw	106
	dw	120
	dw	60
	dw	82
	dw	82
	dw	82
	dw	82
	dw	82
	dw	82
	dw	82
	dw	82
	dw	170
	dw	248
	dw	303
	dw	288
	dw	398
	dw	240
	dw	322
	dw	230
	dw	264
	dw	296
	dw	409
	dw	373
	dw	360
	dw	399
	dw	344
	dw	320
	dw	290
	dw	397
	dw	374
	dw	402
	dw	421
	dw	466
	dw	410
	dw	381
	dw	328
	dw	354
	dw	356
	dw	390
	dw	374
	dw	406
	dw	355
	dw	359
	dw	324
	dw	341
	dw	353
	dw	350
	dw	365
	dw	356
	dw	358
	dw	329
	dw	314
	dw	328
	dw	349
	dw	347
	dw	356
	dw	354
	dw	362
	dw	321
	dw	308
	dw	284
	dw	325
	dw	334
	dw	336
	dw	355
	dw	323
	dw	318
	dw	232
	dw	316
	dw	279
	dw	304
	dw	320
	dw	309
	dw	318
	dw	314
	dw	336
	dw	369
	dw	283
	dw	328
	dw	340
	dw	323
	dw	372
	dw	357
	dw	339
	dw	381
	dw	347
	dw	352
	dw	395
	dw	424
	dw	383
	dw	318
	dw	349
	dw	402
	dw	408
	dw	405
	dw	400
	dw	415
	dw	402
	dw	363
	dw	361
	dw	370
	dw	384
	dw	415
	dw	402
	dw	402
	dw	372
	dw	363
	dw	359
	dw	378
	dw	378
	dw	391
	dw	399
	dw	377
	dw	375
	dw	369
	dw	365
	dw	380
	dw	380
	dw	380
	dw	379
	dw	392
	dw	383
	dw	375
	dw	369
	dw	380
	dw	381
	dw	365
	dw	372
	dw	386
	dw	398
	dw	366
	dw	332
	dw	362
	dw	351
	dw	344
	dw	352
	dw	353
	dw	326
	dw	344
	dw	509
	dw	519
	dw	509
	dw	528
	dw	540
	dw	486
	dw	508
	dw	520
	dw	504
	dw	509
	dw	535
	dw	539
	dw	557
	dw	544
	dw	503
	dw	521
	dw	472
	dw	496
	dw	503
	dw	513
	dw	494
	dw	522
	dw	538
	dw	493
	dw	453
	dw	466
	dw	484
	dw	503
	dw	501
	dw	512
	dw	469
	dw	457
	dw	441
	dw	451
	dw	465
	dw	476
	dw	486
	dw	470
	dw	483
	dw	454
	dw	432
	dw	452
	dw	461
	dw	460
	dw	480
	dw	477
	dw	472
	dw	444
	dw	433
	dw	461
	dw	457
	dw	468
	dw	476
	dw	488
	dw	471
	dw	406
	dw	458
	dw	464
	dw	478
	dw	494
	dw	493
	dw	484
	dw	440
	dw	451
	dw	997
	dw	1025
	dw	1054
	dw	1037
	dw	1084
	dw	1069
	dw	1068
	dw	1070
	dw	1001
	dw	986
	dw	1020
	dw	1026
	dw	1009
	dw	1082
	dw	1053
	dw	1079
	dw	1012
	dw	1008
	dw	1032
	dw	1033
	dw	1054
	dw	1081
	dw	1072
	dw	1082
	dw	998
	dw	998
	dw	1009
	dw	1009
	dw	1024
	dw	1042
	dw	1023
	dw	1026
	dw	1016
	dw	999
	dw	1016
	dw	1015
	dw	1023
	dw	1021
	dw	1028
	dw	1022
	dw	1011
	dw	1027
	dw	1014
	dw	1023
	dw	1020
	dw	1027
	dw	1039
	dw	1030
	dw	990
	dw	1017
	dw	1036
	dw	1027
	dw	1033
	dw	1040
	dw	1022
	dw	1026
	dw	1024
	dw	1007
	dw	1016
	dw	1035
	dw	1010
	dw	1000
	dw	994
	dw	975
	dw	65471
	dw	23
	dw	16
	dw	65521
	dw	65480
	dw	65502
	dw	2
	dw	13
	dw	29
	dw	65535
	dw	65516
	dw	65529
	dw	65528
	dw	65532
	dw	65498
	dw	65507
	dw	65527
	dw	24
	dw	2
	dw	65520
	dw	65516
	dw	6
	dw	22
	dw	65514
	dw	65519
	dw	65516
	dw	65524
	dw	65509
	dw	65506
	dw	65511
	dw	65513
	dw	65500
	dw	65487
	dw	65535
	dw	65509
	dw	65497
	dw	65490
	dw	65492
	dw	65503
	dw	65485
	dw	65522
	dw	65522
	dw	65514
	dw	65490
	dw	65492
	dw	65506
	dw	65521
	dw	65509
	dw	1
	dw	7
	dw	65528
	dw	65472
	dw	65493
	dw	65520
	dw	9
	dw	8
	dw	65521
	dw	36
	dw	12
	dw	65482
	dw	8
	dw	65508
	dw	24
	dw	14

	section	.rodata,"a",@progbits
	public	_eg_table
_eg_table:
	dw	94
	dw	94
	dw	94
	dw	94
	dw	94
	dw	94
	dw	94
	dw	94
	dw	272
	dw	267
	dw	252
	dw	228
	dw	241
	dw	226
	dw	259
	dw	281
	dw	188
	dw	194
	dw	179
	dw	161
	dw	150
	dw	147
	dw	176
	dw	178
	dw	126
	dw	118
	dw	107
	dw	99
	dw	92
	dw	98
	dw	111
	dw	111
	dw	107
	dw	103
	dw	91
	dw	87
	dw	87
	dw	86
	dw	97
	dw	93
	dw	98
	dw	101
	dw	88
	dw	95
	dw	94
	dw	89
	dw	93
	dw	86
	dw	107
	dw	102
	dw	102
	dw	84
	dw	107
	dw	94
	dw	96
	dw	87
	dw	94
	dw	94
	dw	94
	dw	94
	dw	94
	dw	94
	dw	94
	dw	94
	dw	223
	dw	243
	dw	268
	dw	253
	dw	250
	dw	254
	dw	218
	dw	182
	dw	256
	dw	273
	dw	256
	dw	279
	dw	272
	dw	256
	dw	257
	dw	229
	dw	257
	dw	261
	dw	291
	dw	290
	dw	280
	dw	272
	dw	262
	dw	240
	dw	264
	dw	284
	dw	303
	dw	303
	dw	303
	dw	292
	dw	289
	dw	263
	dw	263
	dw	275
	dw	297
	dw	306
	dw	297
	dw	298
	dw	285
	dw	263
	dw	258
	dw	278
	dw	280
	dw	296
	dw	291
	dw	278
	dw	261
	dw	259
	dw	239
	dw	261
	dw	271
	dw	276
	dw	279
	dw	261
	dw	258
	dw	237
	dw	252
	dw	230
	dw	258
	dw	266
	dw	259
	dw	263
	dw	231
	dw	217
	dw	283
	dw	276
	dw	286
	dw	289
	dw	290
	dw	288
	dw	280
	dw	273
	dw	289
	dw	293
	dw	304
	dw	285
	dw	294
	dw	284
	dw	293
	dw	283
	dw	299
	dw	289
	dw	297
	dw	296
	dw	295
	dw	303
	dw	297
	dw	301
	dw	294
	dw	306
	dw	309
	dw	306
	dw	311
	dw	307
	dw	300
	dw	299
	dw	291
	dw	300
	dw	310
	dw	316
	dw	304
	dw	307
	dw	294
	dw	288
	dw	285
	dw	294
	dw	305
	dw	307
	dw	310
	dw	300
	dw	290
	dw	282
	dw	283
	dw	279
	dw	290
	dw	296
	dw	301
	dw	288
	dw	282
	dw	270
	dw	274
	dw	288
	dw	274
	dw	292
	dw	288
	dw	281
	dw	292
	dw	280
	dw	525
	dw	522
	dw	530
	dw	527
	dw	524
	dw	524
	dw	520
	dw	517
	dw	523
	dw	525
	dw	525
	dw	523
	dw	509
	dw	515
	dw	520
	dw	515
	dw	519
	dw	519
	dw	519
	dw	517
	dw	516
	dw	509
	dw	507
	dw	509
	dw	516
	dw	515
	dw	525
	dw	513
	dw	514
	dw	513
	dw	511
	dw	514
	dw	515
	dw	517
	dw	520
	dw	516
	dw	507
	dw	506
	dw	504
	dw	501
	dw	508
	dw	512
	dw	507
	dw	511
	dw	505
	dw	500
	dw	504
	dw	496
	dw	506
	dw	506
	dw	512
	dw	514
	dw	503
	dw	503
	dw	501
	dw	509
	dw	503
	dw	514
	dw	515
	dw	511
	dw	507
	dw	499
	dw	516
	dw	492
	dw	927
	dw	958
	dw	958
	dw	963
	dw	963
	dw	955
	dw	946
	dw	956
	dw	919
	dw	956
	dw	968
	dw	977
	dw	994
	dw	961
	dw	966
	dw	936
	dw	916
	dw	942
	dw	945
	dw	985
	dw	983
	dw	971
	dw	955
	dw	945
	dw	939
	dw	958
	dw	960
	dw	981
	dw	993
	dw	976
	dw	993
	dw	972
	dw	918
	dw	964
	dw	955
	dw	983
	dw	967
	dw	970
	dw	975
	dw	959
	dw	920
	dw	909
	dw	951
	dw	942
	dw	945
	dw	953
	dw	946
	dw	941
	dw	914
	dw	913
	dw	906
	dw	920
	dw	920
	dw	913
	dw	900
	dw	904
	dw	903
	dw	908
	dw	914
	dw	893
	dw	931
	dw	904
	dw	916
	dw	895
	dw	65462
	dw	65501
	dw	65518
	dw	65518
	dw	65525
	dw	15
	dw	4
	dw	65519
	dw	65524
	dw	17
	dw	14
	dw	17
	dw	17
	dw	38
	dw	23
	dw	11
	dw	10
	dw	17
	dw	23
	dw	15
	dw	20
	dw	45
	dw	44
	dw	13
	dw	65528
	dw	22
	dw	24
	dw	27
	dw	26
	dw	33
	dw	26
	dw	3
	dw	65518
	dw	65532
	dw	21
	dw	24
	dw	27
	dw	23
	dw	9
	dw	65525
	dw	65517
	dw	65533
	dw	11
	dw	21
	dw	23
	dw	16
	dw	7
	dw	65527
	dw	65509
	dw	65525
	dw	4
	dw	13
	dw	14
	dw	4
	dw	65531
	dw	65519
	dw	65483
	dw	65502
	dw	65515
	dw	65525
	dw	65508
	dw	65522
	dw	65512
	dw	65493

	section	.rodata,"a",@progbits
	private	_connected_bonus
_connected_bonus:
	dw	0
	dw	7
	dw	8
	dw	12
	dw	29
	dw	48
	dw	86

	section	.rodata,"a",@progbits
	private	_passed_mg
_passed_mg:
	dw	0
	dw	0
	dw	0
	dw	20
	dw	120
	dw	240

	section	.rodata,"a",@progbits
	private	_passed_eg
_passed_eg:
	dw	10
	dw	20
	dw	30
	dw	50
	dw	100
	dw	170

	section	.rodata,"a",@progbits
	private	_knight_mob_mg
_knight_mob_mg:
	dw	65498
	dw	65511
	dw	65524
	dw	0
	dw	12
	dw	25
	dw	31
	dw	33
	dw	38

	section	.rodata,"a",@progbits
	private	_knight_mob_eg
_knight_mob_eg:
	dw	65503
	dw	65513
	dw	65523
	dw	65535
	dw	7
	dw	14
	dw	22
	dw	24
	dw	27

	section	.rodata,"a",@progbits
	private	_bishop_offsets
_bishop_offsets:
	db	""

	section	.rodata,"a",@progbits
	private	_bishop_mob_mg
_bishop_mob_mg:
	dw	65511
	dw	65525
	dw	3
	dw	17
	dw	22
	dw	34
	dw	37
	dw	44
	dw	51
	dw	56
	dw	59
	dw	62
	dw	66
	dw	78

	section	.rodata,"a",@progbits
	private	_bishop_mob_eg
_bishop_mob_eg:
	dw	65506
	dw	65520
	dw	65534
	dw	12
	dw	22
	dw	32
	dw	43
	dw	51
	dw	59
	dw	64
	dw	68
	dw	72
	dw	75
	dw	73

	section	.rodata,"a",@progbits
	private	_rook_offsets
_rook_offsets:
	db	""

	section	.bss,"aw",@nobits
	private	_pos_history_count
_pos_history_count:
	rb	2

	section	.bss,"aw",@nobits
	private	_pos_history
_pos_history:
	rb	2048

	section	.bss,"aw",@nobits
	private	_pos_history_irreversible
_pos_history_irreversible:
	rb	2

	section	.bss,"aw",@nobits
	private	_move_sp
_move_sp:
	rb	2

	section	.bss,"aw",@nobits
	private	_killers
_killers:
	rb	384

	section	.bss,"aw",@nobits
	private	_history
_history:
	rb	512

	section	.bss,"aw",@nobits
	private	_search_nodes
_search_nodes:
	rb	4

	section	.bss,"aw",@nobits
	private	_search_stopped
_search_stopped:
	rb	1

	section	.bss,"aw",@nobits
	private	_search_best_root_move
_search_best_root_move:
	rb	3

	section	.bss,"aw",@nobits
	private	_search_time_fn
_search_time_fn:
	rb	3

	section	.bss,"aw",@nobits
	private	_search_deadline
_search_deadline:
	rb	4

	section	.bss,"aw",@nobits
	private	_search_max_nodes
_search_max_nodes:
	rb	4

	section	.bss,"aw",@nobits
	private	_raw_moves_buf
_raw_moves_buf:
	rb	768

	section	.bss,"aw",@nobits
	private	_move_pool
_move_pool:
	rb	10240

	section	.rodata,"a",@progbits
	private	_atk_knight_offsets
_atk_knight_offsets:
	db	"!"

	section	.rodata,"a",@progbits
	private	_atk_ray_offsets
_atk_ray_offsets:
	db	""

	section	.rodata,"a",@progbits
	private	_mvv_lva
_mvv_lva:
	db	"", 13, "", 10
	db	""
	db	""
	db	"#""! "
	db	"-,+*)("
	db	6 dup 0

	section	.bss,"aw",@nobits
	private	_tt
_tt:
	rb	32768

	section	.bss,"aw",@nobits
	private	_zobrist_initialized
_zobrist_initialized:
	rb	1

	section	.bss,"aw",@nobits
	private	_prng_state
_prng_state:
	rb	4

	section	.bss,"aw",@nobits
	public	_zobrist_piece
_zobrist_piece:
	rb	3072

	section	.bss,"aw",@nobits
	public	_zobrist_castle
_zobrist_castle:
	rb	64

	section	.bss,"aw",@nobits
	public	_zobrist_ep_file
_zobrist_ep_file:
	rb	32

	section	.bss,"aw",@nobits
	public	_zobrist_side
_zobrist_side:
	rb	4

	section	.bss,"aw",@nobits
	public	_lock_piece
_lock_piece:
	rb	1536

	section	.bss,"aw",@nobits
	public	_lock_castle
_lock_castle:
	rb	32

	section	.bss,"aw",@nobits
	public	_lock_ep_file
_lock_ep_file:
	rb	16

	section	.bss,"aw",@nobits
	public	_lock_side
_lock_side:
	rb	2

	section	.bss,"aw",@nobits
	private	_state
_state:
	rb	3

	section	.bss,"aw",@nobits
	private	_menu_cursor
_menu_cursor:
	rb	1

	section	.bss,"aw",@nobits
	private	_running
_running:
	rb	1

	section	.bss,"aw",@nobits
	private	_cur_g1
_cur_g1:
	rb	1

	section	.bss,"aw",@nobits
	private	_cur_g6
_cur_g6:
	rb	1

	section	.bss,"aw",@nobits
	private	_cur_g7
_cur_g7:
	rb	1

	section	.bss,"aw",@nobits
	private	_prev_g1
_prev_g1:
	rb	1

	section	.bss,"aw",@nobits
	private	_prev_g6
_prev_g6:
	rb	1

	section	.bss,"aw",@nobits
	private	_prev_g7
_prev_g7:
	rb	1

	section	.bss,"aw",@nobits
	private	_piece_spr_data
_piece_spr_data:
	rb	4824

	section	.rodata,"a",@progbits
	private	_piece_sprites
_piece_sprites:
	db	20 dup 0
	db	20 dup 0
	db	0, 0, 0, 0, 0, 0, 0, ""
	db	8 dup 0
	db	0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, 0, 0, ""
	db	8 dup 0
	db	0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0, 0
	db	20 dup 0
	db	20 dup 0
	db	0, 0, 0, 0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, "", 0, 0, 0
	db	0, 0, "", 0, 0, 0
	db	0, 0, "", 0, 0, 0
	db	0, 0, "", 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0
	db	0, 0, 0, 0, 0, 0, "", 0, 0, 0
	db	0, 0, 0, 0, 0, 0, "", 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0
	db	0, 0, "", 0, 0
	db	0, 0, "", 0, 0
	db	0, 0, "", 0, 0
	db	0, 0, "", 0, 0
	db	0, 0, 0, 0, 0, 0, 0, 0, ""
	db	8 dup 0
	db	0, 0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0
	db	20 dup 0
	db	20 dup 0
	db	0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, "", 0, 0, 0
	db	0, 0, "", 0, 0, 0
	db	0, 0, "", 0, 0, 0
	db	0, 0, "", 0, 0, 0
	db	0, 0, "", 0, 0, 0
	db	20 dup 0
	db	0, 0, 0, 0, 0, 0, 0, 0, ""
	db	8 dup 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0
	db	0, 0, 0, 0, 0, 0, 0, 0, ""
	db	8 dup 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0, 0
	db	0, 0, 0, 0, 0, "", 0, 0, 0, 0, 0
	db	0, 0, 0, 0, "", 0, 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0
	db	0, 0, 0, "", 0, 0, 0

	section	.bss,"aw",@nobits
	private	_game_mode
_game_mode:
	rb	1

	section	.bss,"aw",@nobits
	private	_difficulty_cursor
_difficulty_cursor:
	rb	3

	section	.bss,"aw",@nobits
	private	_cur_r
_cur_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_cur_c
_cur_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_sel_r
_sel_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_sel_c
_sel_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_current_turn
_current_turn:
	rb	3

	section	.bss,"aw",@nobits
	private	_has_last_move
_has_last_move:
	rb	3

	section	.bss,"aw",@nobits
	private	_legal_target_count
_legal_target_count:
	rb	1

	section	.bss,"aw",@nobits
	private	_ai_thinking
_ai_thinking:
	rb	3

	section	.bss,"aw",@nobits
	private	_anim_active
_anim_active:
	rb	1

	section	.bss,"aw",@nobits
	private	_game_over_reason
_game_over_reason:
	rb	1

	section	.bss,"aw",@nobits
	private	_color_cursor
_color_cursor:
	rb	3

	section	.bss,"aw",@nobits
	private	_player_color
_player_color:
	rb	3

	section	.bss,"aw",@nobits
	private	_board_flipped
_board_flipped:
	rb	3

	section	.bss,"aw",@nobits
	private	_screen_dirty
_screen_dirty:
	rb	1

	section	.bss,"aw",@nobits
	private	_board
_board:
	rb	64

	section	.rodata,"a",@progbits
	private	_.str.57
_.str.57:
	db	"Play vs. Human", 0

	section	.rodata,"a",@progbits
	private	_.str.2.58
_.str.2.58:
	db	"Play vs. Computer", 0

	section	.rodata,"a",@progbits
	private	___const.draw_menu.items
___const.draw_menu.items:
	dl	_.str.57
	dl	_.str.2.58

	section	.rodata,"a",@progbits
	private	_.str.3.56
_.str.3.56:
	db	"CHESS", 0

	section	.rodata,"a",@progbits
	private	_.str.4
_.str.4:
	db	"arrows: move  enter: select  clear: quit", 0

	section	.rodata,"a",@progbits
	private	_difficulty_times
_difficulty_times:
	dd	5000
	dd	10000
	dd	15000

	section	.bss,"aw",@nobits
	private	_think_time_ms
_think_time_ms:
	rb	4

	section	.rodata,"a",@progbits
	private	_.str.5
_.str.5:
	db	"Difficulty", 0

	section	.rodata,"a",@progbits
	private	_difficulty_labels
_difficulty_labels:
	dl	_.str.7
	dl	_.str.8
	dl	_.str.9

	section	.rodata,"a",@progbits
	private	_difficulty_subtexts
_difficulty_subtexts:
	dl	_.str.10
	dl	_.str.11
	dl	_.str.12

	section	.rodata,"a",@progbits
	private	_.str.6
_.str.6:
	db	"arrows: move  enter: select  clear: back", 0

	section	.rodata,"a",@progbits
	private	_.str.7
_.str.7:
	db	"Medium", 0

	section	.rodata,"a",@progbits
	private	_.str.8
_.str.8:
	db	"Hard", 0

	section	.rodata,"a",@progbits
	private	_.str.9
_.str.9:
	db	"Expert", 0

	section	.rodata,"a",@progbits
	private	_.str.10
_.str.10:
	db	"5s think time", 0

	section	.rodata,"a",@progbits
	private	_.str.11
_.str.11:
	db	"10s think time", 0

	section	.rodata,"a",@progbits
	private	_.str.12
_.str.12:
	db	"15s think time", 0

	section	.rodata,"a",@progbits
	private	_.str.13
_.str.13:
	db	"White", 0

	section	.rodata,"a",@progbits
	private	_.str.14
_.str.14:
	db	"Black", 0

	section	.rodata,"a",@progbits
	private	_.str.15
_.str.15:
	db	"Random", 0

	section	.rodata,"a",@progbits
	private	___const.draw_color_select.items
___const.draw_color_select.items:
	dl	_.str.13
	dl	_.str.14
	dl	_.str.15

	section	.rodata,"a",@progbits
	private	_.str.16
_.str.16:
	db	"Play as...", 0

	section	.rodata,"a",@progbits
	private	_.str.17
_.str.17:
	db	"arrows: move  enter: start  clear: back", 0

	section	.bss,"aw",@nobits
	private	_winner
_winner:
	rb	3

	section	.bss,"aw",@nobits
	private	_pending_move
_pending_move:
	rb	5

	section	.bss,"aw",@nobits
	private	_pending_effects
_pending_effects:
	rb	8

	section	.bss,"aw",@nobits
	private	_legal_targets
_legal_targets:
	rb	320

	section	.bss,"aw",@nobits
	private	_anim_start
_anim_start:
	rb	4

	section	.bss,"aw",@nobits
	private	_anim_duration
_anim_duration:
	rb	4

	section	.bss,"aw",@nobits
	private	_anim_from_c
_anim_from_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_anim_from_r
_anim_from_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_anim_to_c
_anim_to_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_anim_to_r
_anim_to_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_anim_piece
_anim_piece:
	rb	1

	section	.bss,"aw",@nobits
	private	_last_from_r
_last_from_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_last_from_c
_last_from_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_last_to_r
_last_to_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_last_to_c
_last_to_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_promo_saved_has_last
_promo_saved_has_last:
	rb	3

	section	.bss,"aw",@nobits
	private	_promo_saved_from_r
_promo_saved_from_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_promo_saved_from_c
_promo_saved_from_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_promo_saved_to_r
_promo_saved_to_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_promo_saved_to_c
_promo_saved_to_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_promo_r
_promo_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_promo_c
_promo_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_promo_from_r
_promo_from_r:
	rb	3

	section	.bss,"aw",@nobits
	private	_promo_from_c
_promo_from_c:
	rb	3

	section	.bss,"aw",@nobits
	private	_anim_captured
_anim_captured:
	rb	1

	section	.bss,"aw",@nobits
	private	_promo_captured
_promo_captured:
	rb	1

	section	.bss,"aw",@nobits
	private	_promo_cursor
_promo_cursor:
	rb	3

	section	.rodata,"a",@progbits
	private	_.str.18
_.str.18:
	db	"vs Human", 0

	section	.rodata,"a",@progbits
	private	_.str.19
_.str.19:
	db	"vs CPU", 0

	section	.rodata,"a",@progbits
	private	_.str.20
_.str.20:
	db	"Thinking", 0

	section	.rodata,"a",@progbits
	private	_.str.21
_.str.21:
	db	"CHECK!", 0

	section	.rodata,"a",@progbits
	private	_.str.22
_.str.22:
	db	"to move", 0

	section	.rodata,"a",@progbits
	private	_.str.23
_.str.23:
	db	"Sel: ", 0

	section	.rodata,"a",@progbits
	private	_.str.24
_.str.24:
	db	"D-pad", 0

	section	.rodata,"a",@progbits
	private	_.str.25
_.str.25:
	db	" Move", 0

	section	.rodata,"a",@progbits
	private	_.str.26
_.str.26:
	db	"Enter", 0

	section	.rodata,"a",@progbits
	private	_.str.27
_.str.27:
	db	" Select", 0

	section	.rodata,"a",@progbits
	private	_.str.28
_.str.28:
	db	"Clear", 0

	section	.rodata,"a",@progbits
	private	_.str.29
_.str.29:
	db	" Deselect", 0

	section	.rodata,"a",@progbits
	private	_.str.30
_.str.30:
	db	"Mode", 0

	section	.rodata,"a",@progbits
	private	_.str.31
_.str.31:
	db	" Resign", 0

	section	.rodata,"a",@progbits
	private	_update_promotion.promo_flags
_update_promotion.promo_flags:
	db	0, " 0"

	section	.rodata,"a",@progbits
	private	_promo_pieces_white
_promo_pieces_white:
	db	""

	section	.rodata,"a",@progbits
	private	_promo_pieces_black
_promo_pieces_black:
	db	""

	section	.rodata,"a",@progbits
	private	_.str.32
_.str.32:
	db	"Promote to:", 0

	section	.rodata,"a",@progbits
	private	_.str.38
_.str.38:
	db	"White wins!", 0

	section	.rodata,"a",@progbits
	private	_.str.39
_.str.39:
	db	"Black wins!", 0

	section	.rodata,"a",@progbits
	private	_.str.40
_.str.40:
	db	"Draw", 0

	section	.rodata,"a",@progbits
	private	_.str.41
_.str.41:
	db	"Checkmate", 0

	section	.rodata,"a",@progbits
	private	_.str.42
_.str.42:
	db	"Stalemate", 0

	section	.rodata,"a",@progbits
	private	_.str.43
_.str.43:
	db	"50-move rule", 0

	section	.rodata,"a",@progbits
	private	_.str.44
_.str.44:
	db	"Repetition", 0

	section	.rodata,"a",@progbits
	private	_.str.45
_.str.45:
	db	"Insufficient material", 0

	section	.rodata,"a",@progbits
	private	_.str.46
_.str.46:
	db	"Resignation", 0

	section	.rodata,"a",@progbits
	private	_.str.47
_.str.47:
	db	"Enter: Return to menu", 0

	section	.rodata,"a",@progbits
	private	_switch.table.main
_switch.table.main:
	dl	_.str.41
	dl	_.str.42
	dl	_.str.43
	dl	_.str.44
	dl	_.str.45

	ident	"clang version 15.0.0 (https://github.com/CE-Programming/llvm-project 23b78267b5d376b232475d0805a937e54b61e0d0)"
	ident	"clang version 15.0.0 (https://github.com/CE-Programming/llvm-project 23b78267b5d376b232475d0805a937e54b61e0d0)"
	ident	"clang version 15.0.0 (https://github.com/CE-Programming/llvm-project 23b78267b5d376b232475d0805a937e54b61e0d0)"
	ident	"clang version 15.0.0 (https://github.com/CE-Programming/llvm-project 23b78267b5d376b232475d0805a937e54b61e0d0)"
	ident	"clang version 15.0.0 (https://github.com/CE-Programming/llvm-project 23b78267b5d376b232475d0805a937e54b61e0d0)"
	ident	"clang version 15.0.0 (https://github.com/CE-Programming/llvm-project 23b78267b5d376b232475d0805a937e54b61e0d0)"
	ident	"clang version 15.0.0 (https://github.com/CE-Programming/llvm-project 23b78267b5d376b232475d0805a937e54b61e0d0)"
	ident	"clang version 15.0.0 (https://github.com/CE-Programming/llvm-project 23b78267b5d376b232475d0805a937e54b61e0d0)"
	ident	"clang version 15.0.0 (https://github.com/CE-Programming/llvm-project 23b78267b5d376b232475d0805a937e54b61e0d0)"
	extern	_gfx_PrintChar
	extern	__lcmpzero
	extern	__sxor
	extern	__idivu
	extern	__idivs
	extern	_gfx_Blit
	extern	__lladd
	extern	__ineg
	extern	_sprintf
	extern	_gfx_FillScreen
	extern	__imulu
	extern	__lxor
	extern	_gfx_TransparentSprite_NoClip
	extern	_gfx_End
	extern	__bshru
	extern	__frameset0
	extern	_gfx_SetTextXY
	extern	__ldivs
	extern	__ldivu
	extern	_gfx_SetTextFGColor
	extern	_gfx_Begin
	extern	__sshl
	extern	__sshru
	extern	_strlen
	extern	__setflag
	extern	__iand
	extern	__lmulu
	extern	_gfx_SwapDraw
	extern	__lshl
	extern	_ti_GetDataPtr
	extern	_clock
	extern	__llxor
	extern	_srand
	extern	__Unwind_SjLj_Register
	extern	__sneg
	extern	__ixor
	extern	_ti_Open
	extern	_gfx_HorizLine_NoClip
	extern	__lremu
	extern	_gfx_FillRectangle_NoClip
	extern	__lsub
	extern	__ishru
	extern	__llcmpu
	extern	__llshl
	extern	__lcmpu
	extern	__snot
	extern	__indcall
	extern	_gfx_Rectangle_NoClip
	extern	_rand
	extern	_ti_Close
	extern	__sand
	extern	_gfx_PrintString
	extern	__ishl
	extern	__ladd
	extern	__smulu
	extern	__llor
	extern	_gfx_FillCircle_NoClip
	extern	__lshru
	extern	__frameset
	extern	_kb_Scan
	extern	_gfx_GetStringWidth
	extern	_gfx_SetDraw
	extern	__Unwind_SjLj_Unregister
	extern	__bshl
	extern	__sor
	extern	_gfx_SetColor
	extern	_gfx_PrintStringXY
	extern	_gfx_SetTextScale
	extern	__land
